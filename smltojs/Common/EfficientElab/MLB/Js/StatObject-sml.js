if ((typeof(basics$StatObject$)) == "undefined") {basics$StatObject$ = {};
};
(function(){basics$StatObject$.eq_eq_significant$4953 = function(v$4955,v$4956){switch (v$4955) { case 0: {switch (v$4956) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4956) { case 1: {return true;
 break; }default: {return false;
} };
 break; } };
};
basics$StatObject$.eq_TVNames$4957 = function(v$4959,v$4960){return (v$4959 == null)?((v$4960 == null)?true:false):((v$4960 == null)?false:(v$4959 == v$4960));
};
basics$StatObject$.eq_free_or_bound$4964 = function(v$4966,v$4967){switch (v$4966) { case 0: {switch (v$4967) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4967) { case 1: {return true;
 break; }default: {return false;
} };
 break; } };
};
var print_type_levels$75 = [false];
var ONE$137 = syntax_objects$Lab$.mk_IntegerLab$104(1);
var TWO$138 = syntax_objects$Lab$.mk_IntegerLab$104(2);
var THREE$139 = syntax_objects$Lab$.mk_IntegerLab$104(3);
basics$StatObject$.GENERIC$140 = -1;
var level_ref$142 = [0];
basics$StatObject$.push$143 = function(v$145){return (level_ref$142[0] = (SmlPrims.chk_ovf_i32(level_ref$142[0] + 1)),0);
};
basics$StatObject$.pop$146 = function(v$148){return (level_ref$142[0] = (SmlPrims.chk_ovf_i32(level_ref$142[0] - 1)),0);
};
basics$StatObject$.current$149 = function(v$151){return level_ref$142[0];
};
basics$StatObject$.pr$152 = function(i$155){if (i$155 == (-1)) {return "generic";
} else {if (i$155 == 0) {return "nongeneric";
} else {return basis$Int32$.toString$449(i$155);
};
};
};
[special_objects$TyName$$1.current$72(0)];
var fix$8317 = {};
fix$8317.$findType = function(ty$196){lab$findType: while (true) {var v$203 = ty$196[0];
switch (v$203[0]) { case 0: {var v$205 = v$203[1];
switch (v$205[0][0]) { case 0: {var v$225 = v$205[0][1];
var v$213 = v$225[0];
switch (v$213[0]) { case 0: {var v$215 = v$213[1];
switch (v$215[0][0]) { case 0: {var v$219 = v$215[0][1];
(v$205[0] = [0,v$219],0);
var t$8318 = v$219;
var ty$196 = t$8318;
continue lab$findType;
 break; }default: {return v$225;
} };
 break; }default: {return v$225;
} };
 break; }default: {return ty$196;
} };
 break; }default: {return ty$196;
} };
};
};
var findType$193 = fix$8317.$findType;
var fix$8319 = {};
fix$8319.$findRecType = function(r$234){switch (r$234[0]) { case 0: {var v$243 = r$234[1];
var v$244 = v$243[0];
switch (v$244[0][0]) { case 0: {var v$249 = v$244[0][1];
var r$$$246 = fix$8319.$findRecType(v$249);
(v$244[0] = [0,r$$$246],0);
return r$$$246;
 break; }default: {return r$234;
} };
 break; }default: {return r$234;
} };
};
var findRecType$231 = fix$8319.$findRecType;
var fix$8320 = {};
fix$8320.$sanitiseRecType = function(r$254){var v$264 = findRecType$231(r$254);
switch (v$264[0]) { case 2: {return [tools$SortedFinMap$.empty$48(0),[1]];
 break; }case 0: {return [tools$SortedFinMap$.empty$48(0),[0,v$264[1]]];
 break; }default: {var v$273 = v$264[1];
var v$274 = v$273[0];
var v$275 = v$273[1];
var v$276 = v$273[2];
var v$270 = fix$8320.$sanitiseRecType(v$276);
var v$271 = v$270[0];
var v$272 = v$270[1];
var t$8761;
var fix$8760 = {};
fix$8760.$add = function(v$8185,v$8186,v$7444){if (v$7444 == null) {return [[v$8185,v$8186],null];
} else {var v$7447 = v$7444;
var v$7448 = v$7447[0];
var v$7449 = v$7448[0];
var v$7450 = v$7448[1];
var v$7451 = v$7447[1];
return (syntax_objects$Lab$.eq_lab$138(v$7449,v$8185))?[[v$8185,v$8186],v$7451]:((syntax_objects$Lab$.s$j$49(v$7449,v$8185))?[[v$7449,v$7450],fix$8760.$add(v$8185,v$8186,v$7451)]:[[v$8185,v$8186],[[v$7449,v$7450],v$7451]]);
};
};
var add$7442 = fix$8760.$add;
t$8761 = (add$7442(v$274,v$275,v$271));
return [t$8761,v$272];
} };
};
var sanitiseRecType$251 = fix$8320.$sanitiseRecType;
basics$StatObject$.newTVNames$281 = function(v$283){return [null];
};
var fix$8321 = {};
fix$8321.$norm_Type = function(ty$288){var v$331 = findType$193(ty$288);
var v$332 = v$331[0];
var v$333 = v$331[1];
var t$8756;
switch (v$332[0]) { case 0: {var v$316 = v$332[1];
switch (v$316[0][0]) { case 1: {var v$327 = v$316[0][1];
var v$321 = v$327[4];
switch (v$321[0][0]) { case 0: {t$8756 = (tools$Crash$.impossible$50("StatObject.norm_Type.TYVAR"));
 break; }default: {t$8756 = v$332;
} };
 break; }default: {t$8756 = (tools$Crash$.impossible$50("StatObject.norm_Type.TYVAR2"));
} };
 break; }case 3: {var v$312 = v$332[1];
var v$313 = v$312[0];
var v$314 = v$312[1];
t$8756 = [3,[fix$8321.$norm_Type(v$313),fix$8321.$norm_Type(v$314)]];
 break; }case 1: {var v$310 = v$332[1];
t$8756 = [1,fix$8321.$norm_RecType(v$310)];
 break; }default: {var v$328 = v$332[1];
var v$329 = v$328[0];
var v$330 = v$328[1];
var t$8759;
var t$8758;
var fix$8757 = {};
fix$8757.$map = function(v$5027){if (v$5027 == null) {return null;
} else {var v$5028 = v$5027;
var v$5029 = v$5028[0];
var v$5030 = v$5028[1];
return [fix$8321.$norm_Type(v$5029),fix$8757.$map(v$5030)];
};
};
var map$5026 = fix$8757.$map;
t$8758 = (map$5026(v$329));
t$8759 = [t$8758,v$330];
t$8756 = [2,t$8759];
} };
return [t$8756,v$333];
};
fix$8321.$norm_RecType = function(rt$336){var v$345 = findRecType$231(rt$336);
switch (v$345[0]) { case 2: {return [2];
 break; }case 0: {return tools$Crash$.impossible$50("StatObject.norm_RecType.uninstantiated rowvar");
 break; }default: {var v$347 = v$345[1];
var v$348 = v$347[0];
var v$349 = v$347[1];
var v$350 = v$347[2];
return [1,[v$348,fix$8321.$norm_Type(v$349),fix$8321.$norm_RecType(v$350)]];
} };
};
var norm_Type$285 = fix$8321.$norm_Type;
var norm_RecType$284 = fix$8321.$norm_RecType;
var pu_TyVarDesc$351 = pickle$pickle$.convert$2333([function(v$5031){var v$5032 = v$5031[0];
var v$5033 = v$5032[0];
var v$5034 = v$5033[0];
var v$5035 = v$5033[1];
var v$5036 = v$5032[1];
var v$5037 = v$5032[2];
var v$5038 = v$5031[1];
return [v$5035,v$5036,v$5031[2],v$5034,[[1]],v$5038,v$5037];
},function(v$5039){return [[[v$5039[3],v$5039[0]],v$5039[1],v$5039[6]],v$5039[5],v$5039[2]];
}],pickle$pickle$.tup3Gen0$2340(pickle$pickle$.tup3Gen0$2340(pickle$pickle$.pairGen0$974(pickle$pickle$.int$720,pickle$pickle$.string$900),pickle$pickle$.bool$723,special_objects$TyName$$1.pu_rankrefOne$111),pickle$pickle$.optionGen$2125(special_objects$TyName$$3.pu$3087(special_objects$TyName$$1.pu$366)),pickle$pickle$.optionGen$2125(syntax_objects$SyntaxTyVar$.pu$84)));
var pu_TyLink$393 = pickle$pickle$.convert$2333([function(v$394){return [1,v$394];
},function(v$399){switch (v$399[0]) { case 1: {return v$399[1];
 break; }default: {return tools$Crash$.impossible$50("StatObject.pu_TyLink.NO_TY_LINK");
} };
}],pu_TyVarDesc$351);
var pu_TyVar$402 = pickle$pickle$.ref0Gen$1255(pu_TyLink$393);
var pu_Type$403 = (pickle$pickle$.cache$2475("Type"))(function(pu_td$420){return pickle$pickle$.convert$2333([function(v$5042){return [v$5042[0],v$5042[1]];
},function(v$5043){return [v$5043[0],v$5043[1]];
}],pickle$pickle$.pairGen0$974(pu_td$420,pickle$pickle$.ref0EqGen$1154(function(v$424){var v$425 = v$424[0];
var v$426 = v$424[1];
return v$425[0] == v$426[0];
},pickle$pickle$.int$720)));
});
var pu_Types$427 = (pickle$pickle$.cache$2475("Types"))(function(pu_td$430){return pickle$pickle$.listGen$2100(pu_Type$403(pu_td$430));
});
var v$4815;
var TypeDescFuns$4925 = [function(v$5064){return pickle$pickle$.con1$2005(function(v$5065){return [0,v$5065];
},function(v$5066){switch (v$5066[0]) { case 0: {return v$5066[1];
 break; }default: {return tools$Crash$.impossible$50("StatObject.pu_TypeDesc.TYVAR");
} };
},pu_TyVar$402);
},[function(v$5069){var v$5070 = v$5069[0];
return pickle$pickle$.con1$2005(function(v$5071){return [3,v$5071];
},function(v$5072){switch (v$5072[0]) { case 3: {return v$5072[1];
 break; }default: {return tools$Crash$.impossible$50("StatObject.pu_TypeDesc.ARROW");
} };
},pickle$pickle$.pairGen0$974(pu_Type$403(v$5070),pu_Type$403(v$5070)));
},[function(v$5075){var v$5076 = v$5075[1];
return pickle$pickle$.con1$2005(function(v$5077){return [1,v$5077];
},function(v$5078){switch (v$5078[0]) { case 1: {return v$5078[1];
 break; }default: {return tools$Crash$.impossible$50("StatObject.pu_TypeDesc.RECTYPE");
} };
},v$5076);
},[function(v$5081){var v$5082 = v$5081[0];
return pickle$pickle$.con1$2005(function(x$5088){var v$7454 = [x$5088[1],x$5088[0]];
return [2,v$7454];
},function(v$5089){switch (v$5089[0]) { case 2: {var v$5090 = v$5089[1];
return [v$5090[1],v$5090[0]];
 break; }default: {return tools$Crash$.impossible$50("StatObject.pu_TypeDesc.CONSTYPE");
} };
},pickle$pickle$.pairGen0$974(special_objects$TyName$$1.pu$366,pu_Types$427(v$5082)));
},null]]]];
var RecTypeFuns$4926 = [function(v$5094){var v$5095 = v$5094[1];
return pickle$pickle$.con0$1979([2],v$5095);
},[function(v$5096){var v$5097 = v$5096[0];
var v$5098 = v$5096[1];
return pickle$pickle$.con1$2005(function(v$5099){return [1,v$5099];
},function(v$5100){switch (v$5100[0]) { case 1: {return v$5100[1];
 break; }default: {return tools$Crash$.impossible$50("StatObject.pu_RecType.ROWrec");
} };
},pickle$pickle$.tup3Gen0$2340(syntax_objects$Lab$.pu$106,pu_Type$403(v$5097),v$5098));
},null]];
v$4815 = (pickle$pickle$.data2Gen$1483("StatObject.TypeDesc",function(v$5103){switch (v$5103[0]) { case 0: {return 0;
 break; }case 3: {return 1;
 break; }case 1: {return 2;
 break; }default: {return 3;
} };
},TypeDescFuns$4925,"StatObject.RecType",function(v$5104){switch (v$5104[0]) { case 2: {return 0;
 break; }case 1: {return 1;
 break; }default: {return tools$Crash$.impossible$50("StatObject.RecTypeToInt");
} };
},RecTypeFuns$4926));
var v$4816 = v$4815[0];
var pu_Type$440 = pu_Type$403(v$4816);
basics$StatObject$.equality$441 = function(v$444){switch (v$444[0][0]) { case 1: {return v$444[0][1][1];
 break; }default: {return tools$Crash$.impossible$50("StatObject.TyVar.equality");
} };
};
basics$StatObject$.eq$456 = function(v$479,v$480){if (v$479 == v$480) {return true;
} else {switch (v$479[0][0]) { case 1: {switch (v$480[0][0]) { case 1: {var v$477 = v$479[0][1];
var v$478 = v$480[0][1];
var v$5115 = v$477[3];
var v$5116 = v$477[0];
var v$5118 = v$478[3];
var v$5119 = v$478[0];
return (v$5115 == v$5118)?(v$5116 == v$5119):false;
 break; }default: {return tools$Crash$.impossible$50("StatObject.TyVar.eq_tv2");
} };
 break; }default: {return tools$Crash$.impossible$50("StatObject.TyVar.eq_tv1");
} };
};
};
basics$StatObject$.resolve_overloaded$522 = function(v$525){switch (v$525[0][0]) { case 1: {var v$533 = v$525[0][1];
var v$534 = v$533[5];
switch (v$534[0]) { case 0: {return v$534[1];
 break; }default: {return tools$Crash$.impossible$50("StatObject.resolve_overloaded");
} };
 break; }default: {return tools$Crash$.impossible$50("StatObject.resolve_overloaded");
} };
};
basics$StatObject$.is_overloaded$547 = function(tv$550){var t$8322;
switch (tv$550[0][0]) { case 1: {t$8322 = tv$550[0][1][5];
 break; }default: {t$8322 = (tools$Crash$.impossible$50("StatObject.TyVar.get_overloaded"));
} };
switch (t$8322[0]) { case 0: {return true;
 break; }default: {return false;
} };
};
var r$588 = [0];
basics$StatObject$.fresh_normal$607 = function(v$609){var v$6943 = [1];
var v$6944 = [1];
var t$8324;
var t$8323;
var v$5177;
(r$588[0] = (SmlPrims.chk_ovf_i32(r$588[0] + 1)),0);
v$5177 = r$588[0];
var v$5179 = special_objects$Name$.baseGet$56(0);
var v$5180 = [special_objects$TyName$$1.current$72(0)];
t$8323 = [v$5179,false,v$6943,v$5177,[[1]],v$6944,v$5180];
t$8324 = [1,t$8323];
return [t$8324];
};
basics$StatObject$.fresh_overloaded$613 = function(tynames$616){var v$6948 = [1];
var v$6949 = [0,special_objects$TyName$$3.fromList$2946(tynames$616)];
var t$8326;
var t$8325;
var v$5185;
(r$588[0] = (SmlPrims.chk_ovf_i32(r$588[0] + 1)),0);
v$5185 = r$588[0];
var v$5187 = special_objects$Name$.baseGet$56(0);
var v$5188 = [special_objects$TyName$$1.current$72(0)];
t$8325 = [v$5187,false,v$6948,v$5185,[[1]],v$6949,v$5188];
t$8326 = [1,t$8325];
return [t$8326];
};
basics$StatObject$.from_ExplicitTyVar$620 = function(extv$623){var v$6952 = syntax_objects$SyntaxTyVar$.isEquality$59(extv$623);
var v$6953 = [0,extv$623];
var v$6954 = [1];
var t$8328;
var t$8327;
var v$5193;
(r$588[0] = (SmlPrims.chk_ovf_i32(r$588[0] + 1)),0);
v$5193 = r$588[0];
var v$5195 = special_objects$Name$.baseGet$56(0);
var v$5196 = [special_objects$TyName$$1.current$72(0)];
t$8327 = [v$5195,v$6952,v$6953,v$5193,[[1]],v$6954,v$5196];
t$8328 = [1,t$8327];
return [t$8328];
};
var ordA$646 = 97;
basics$StatObject$.string$$735 = function(pr_ty$738,tv$741){var v$7788 = null;
var fix$8329 = {};
fix$8329.$pretty_string = function(v$7790,v$7791){switch (v$7791[0][0]) { case 1: {var v$7792 = v$7791[0][1];
var v$7793 = v$7792[1];
var v$7794 = v$7792[5];
var v$7795 = v$7792[3];
var boring$7796 = "U" + (basis$Int32$.toString$449(v$7795));
var t$8338;
var t$8337;
var t$8336;
switch (v$7794[0]) { case 0: {t$8336 = true;
 break; }default: {t$8336 = false;
} };
t$8337 = (t$8336?"OVERLOADED":"");
t$8338 = (t$8337 + (v$7793?"''":"'"));
var t$8330;
if (v$7788 == null) {t$8330 = boring$7796;
} else {var v$7797 = v$7788;
var L$$7798 = v$7797[0];
try {var v$7799 = edlib$edList$.first$1106(function(v$7800){return v$7800[1] == v$7795;
},L$$7798);
var v$7801 = v$7799[0];
t$8330 = (SmlPrims.implode([basis$General$.chr$187(SmlPrims.chk_ovf_i32(ordA$646 + v$7801)),null]));
} catch(v$8331) {t$8330 = ((function(v$7802){var t$8332 = v$7802;
if (t$8332[0] == edlib$edList$.en$First$1105) {var len$7803;
var fix$8333 = {};
fix$8333.$acc = function(v$7805,v$7806){lab$acc: while (true) {if (v$7805 == null) {return v$7806;
} else {var v$7807 = v$7805;
var v$7808 = v$7807[1];
var t$8334 = v$7808;
var t$8335 = SmlPrims.chk_ovf_i32(v$7806 + 1);
var v$7805 = t$8334;
var v$7806 = t$8335;
continue lab$acc;
};
};
};
var acc$7804 = fix$8333.$acc;
len$7803 = (acc$7804(L$$7798,0));
(v$7797[0] = (basis$List$.s$n$645([L$$7798,[[len$7803,v$7795],null]])),0);
return SmlPrims.implode([basis$General$.chr$187(SmlPrims.chk_ovf_i32(ordA$646 + len$7803)),null]);
} else {throw v$7802;
};
})(v$8331));
};
};
return t$8338 + t$8330;
 break; }default: {var v$7809 = v$7791[0][1];
var ty$7810 = findType$193(v$7809);
var v$7811 = ty$7810[0];
switch (v$7811[0]) { case 0: {var v$7812 = v$7811[1];
return (((fix$8329.$pretty_string(v$7790,v$7812)) + "{") + (basis$Int32$.toString$449(ty$7810[1][0]))) + "}";
 break; }default: {return (((v$7790(ty$7810)) + "{") + (basis$Int32$.toString$449(ty$7810[1][0]))) + "}";
} };
} };
};
var pretty_string$7789 = fix$8329.$pretty_string;
return pretty_string$7789(pr_ty$738,tv$741);
};
basics$StatObject$.pretty_string$749 = function(a$752){var fix$8339 = {};
fix$8339.$pretty_string = function(v$8058){switch (v$8058[0][0]) { case 1: {var v$8059 = v$8058[0][1];
var v$8060 = v$8059[1];
var v$8061 = v$8059[5];
var v$8062 = v$8059[3];
var boring$8063 = "U" + (basis$Int32$.toString$449(v$8062));
var t$8348;
var t$8347;
var t$8346;
switch (v$8061[0]) { case 0: {t$8346 = true;
 break; }default: {t$8346 = false;
} };
t$8347 = (t$8346?"OVERLOADED":"");
t$8348 = (t$8347 + (v$8060?"''":"'"));
var t$8340;
if (a$752 == null) {t$8340 = boring$8063;
} else {var v$8064 = a$752;
var L$$8065 = v$8064[0];
try {var v$8066 = edlib$edList$.first$1106(function(v$8067){return v$8067[1] == v$8062;
},L$$8065);
var v$8068 = v$8066[0];
t$8340 = (SmlPrims.implode([basis$General$.chr$187(SmlPrims.chk_ovf_i32(ordA$646 + v$8068)),null]));
} catch(v$8341) {t$8340 = ((function(v$8069){var t$8342 = v$8069;
if (t$8342[0] == edlib$edList$.en$First$1105) {var len$8070;
var fix$8343 = {};
fix$8343.$acc = function(v$8072,v$8073){lab$acc: while (true) {if (v$8072 == null) {return v$8073;
} else {var v$8074 = v$8072;
var v$8075 = v$8074[1];
var t$8344 = v$8075;
var t$8345 = SmlPrims.chk_ovf_i32(v$8073 + 1);
var v$8072 = t$8344;
var v$8073 = t$8345;
continue lab$acc;
};
};
};
var acc$8071 = fix$8343.$acc;
len$8070 = (acc$8071(L$$8065,0));
(v$8064[0] = (basis$List$.s$n$645([L$$8065,[[len$8070,v$8062],null]])),0);
return SmlPrims.implode([basis$General$.chr$187(SmlPrims.chk_ovf_i32(ordA$646 + len$8070)),null]);
} else {throw v$8069;
};
})(v$8341));
};
};
return t$8348 + t$8340;
 break; }default: {var v$8076 = v$8058[0][1];
var ty$8077 = findType$193(v$8076);
var v$8078 = ty$8077[0];
switch (v$8078[0]) { case 0: {var v$8079 = v$8078[1];
return (((fix$8339.$pretty_string(v$8079)) + "{") + (basis$Int32$.toString$449(ty$8077[1][0]))) + "}";
 break; }default: {return ("(ty_link){" + (basis$Int32$.toString$449(ty$8077[1][0]))) + "}";
} };
} };
};
var pretty_string$8057 = fix$8339.$pretty_string;
return function(v$8310){return pretty_string$8057(v$8310);
};
};
basics$StatObject$.string$755;
var a$5229 = null;
var fix$8349 = {};
fix$8349.$pretty_string = function(v$8084){switch (v$8084[0][0]) { case 1: {var v$8085 = v$8084[0][1];
var v$8086 = v$8085[1];
var v$8087 = v$8085[5];
var v$8088 = v$8085[3];
var boring$8089 = "U" + (basis$Int32$.toString$449(v$8088));
var t$8358;
var t$8357;
var t$8356;
switch (v$8087[0]) { case 0: {t$8356 = true;
 break; }default: {t$8356 = false;
} };
t$8357 = (t$8356?"OVERLOADED":"");
t$8358 = (t$8357 + (v$8086?"''":"'"));
var t$8350;
if (a$5229 == null) {t$8350 = boring$8089;
} else {var v$8090 = a$5229;
var L$$8091 = v$8090[0];
try {var v$8092 = edlib$edList$.first$1106(function(v$8093){return v$8093[1] == v$8088;
},L$$8091);
var v$8094 = v$8092[0];
t$8350 = (SmlPrims.implode([basis$General$.chr$187(SmlPrims.chk_ovf_i32(ordA$646 + v$8094)),null]));
} catch(v$8351) {t$8350 = ((function(v$8095){var t$8352 = v$8095;
if (t$8352[0] == edlib$edList$.en$First$1105) {var len$8096;
var fix$8353 = {};
fix$8353.$acc = function(v$8098,v$8099){lab$acc: while (true) {if (v$8098 == null) {return v$8099;
} else {var v$8100 = v$8098;
var v$8101 = v$8100[1];
var t$8354 = v$8101;
var t$8355 = SmlPrims.chk_ovf_i32(v$8099 + 1);
var v$8098 = t$8354;
var v$8099 = t$8355;
continue lab$acc;
};
};
};
var acc$8097 = fix$8353.$acc;
len$8096 = (acc$8097(L$$8091,0));
(v$8090[0] = (basis$List$.s$n$645([L$$8091,[[len$8096,v$8088],null]])),0);
return SmlPrims.implode([basis$General$.chr$187(SmlPrims.chk_ovf_i32(ordA$646 + len$8096)),null]);
} else {throw v$8095;
};
})(v$8351));
};
};
return t$8358 + t$8350;
 break; }default: {var v$8102 = v$8084[0][1];
var ty$8103 = findType$193(v$8102);
var v$8104 = ty$8103[0];
switch (v$8104[0]) { case 0: {var v$8105 = v$8104[1];
return (((fix$8349.$pretty_string(v$8105)) + "{") + (basis$Int32$.toString$449(ty$8103[1][0]))) + "}";
 break; }default: {return ("(ty_link){" + (basis$Int32$.toString$449(ty$8103[1][0]))) + "}";
} };
} };
};
var pretty_string$8083 = fix$8349.$pretty_string;
basics$StatObject$.string$755 = (function(v$8311){return pretty_string$8083(v$8311);
});
basics$StatObject$.layout$756 = function(x$5234){var v$7462 = basics$StatObject$.string$755(x$5234);
return [1,v$7462];
};
basics$StatObject$.unionTyVarSet$779 = function(v$787,v$788){var t$8367 = basis$List$.s$n$645;
var t$8366;
var t$8365 = v$787;
var t$8360;
var fix$8359 = {};
fix$8359.$filter = function(v$5256){if (v$5256 == null) {return null;
} else {var v$5257 = v$5256;
var v$5258 = v$5257[0];
var v$5259 = v$5257[1];
var t$8364;
var t$8363;
var fix$8361 = {};
fix$8361.$exists = function(v$5273){lab$exists: while (true) {if (v$5273 == null) {return false;
} else {var v$5274 = v$5273;
var v$5275 = v$5274[0];
var v$5276 = v$5274[1];
if (basics$StatObject$.eq$456(v$5258,v$5275)) {return true;
} else {var t$8362 = v$5276;
var v$5273 = t$8362;
continue lab$exists;
};
};
};
};
var exists$5272 = fix$8361.$exists;
t$8363 = (exists$5272(v$787));
t$8364 = (t$8363?false:true);
if (t$8364) {return [v$5258,fix$8359.$filter(v$5259)];
} else {return fix$8359.$filter(v$5259);
};
};
};
var filter$5255 = fix$8359.$filter;
t$8360 = (filter$5255(v$788));
t$8366 = [t$8365,t$8360];
return t$8367(t$8366);
};
basics$StatObject$.intersectTyVarSet$799 = function(v$807,v$808){var fix$8368 = {};
fix$8368.$filter = function(v$5281){if (v$5281 == null) {return null;
} else {var v$5282 = v$5281;
var v$5283 = v$5282[0];
var v$5284 = v$5282[1];
var t$8371;
var fix$8369 = {};
fix$8369.$exists = function(v$5297){lab$exists: while (true) {if (v$5297 == null) {return false;
} else {var v$5298 = v$5297;
var v$5299 = v$5298[0];
var v$5300 = v$5298[1];
if (basics$StatObject$.eq$456(v$5283,v$5299)) {return true;
} else {var t$8370 = v$5300;
var v$5297 = t$8370;
continue lab$exists;
};
};
};
};
var exists$5296 = fix$8369.$exists;
t$8371 = (exists$5296(v$807));
if (t$8371) {return [v$5283,fix$8368.$filter(v$5284)];
} else {return fix$8368.$filter(v$5284);
};
};
};
var filter$5280 = fix$8368.$filter;
return filter$5280(v$808);
};
var pr_tyvars$809 = function(l$812){var fix$8372 = {};
fix$8372.$pr_l = function(v$816){lab$pr_l: while (true) {if (v$816 == null) {return "";
} else {var v$827 = v$816;
var v$828 = v$827[1];
if (v$828 == null) {var v$834 = v$827[0];
return basics$StatObject$.string$755(v$834);
} else {var v$830 = v$827[0];
var v$831 = v$828;
var v$832 = v$831[0];
var v$833 = v$831[1];
return ((basics$StatObject$.string$755(v$830)) + ",") + (fix$8372.$pr_l([v$832,v$833]));
};
};
};
};
var pr_l$813 = fix$8372.$pr_l;
return ("(" + (pr_l$813(l$812))) + ")";
};
basics$StatObject$.pu$835 = pu_TyVar$402;
basics$StatObject$.Id$836 = 0;
basics$StatObject$.oo$838 = function(v$8187,v$8188){return 0;
};
basics$StatObject$.on$845 = function(v$8189,v$851){return findType$193(v$851);
};
basics$StatObject$.onScheme$852 = function(v$8190,v$859){var v$860 = v$859[0];
var v$861 = v$859[1];
return [v$860,findType$193(v$861)];
};
var r$862 = [0];
var fix$8373 = {};
fix$8373.$layout = function(ty$873){var ty$874 = findType$193(ty$873);
var st$875;
var v$892 = ty$874[0];
switch (v$892[0]) { case 2: {var v$905 = v$892[1];
var v$906 = v$905[0];
if (v$906 == null) {var v$907 = v$905[1];
st$875 = (special_objects$TyName$$4.layout$3528(v$907));
} else {var v$913 = v$905[1];
var t$8752;
var v$909 = ") " + (special_objects$TyName$$1.pr_TyName$289(v$913[0],v$913[1],v$913[2],v$913[3],v$913[4],v$913[5]));
var t$8754;
var fix$8753 = {};
fix$8753.$map = function(v$5323){if (v$5323 == null) {return null;
} else {var v$5324 = v$5323;
var v$5325 = v$5324[0];
var v$5326 = v$5324[1];
return [fix$8373.$layout(v$5325),fix$8753.$map(v$5326)];
};
};
var map$5322 = fix$8753.$map;
t$8754 = (map$5322(v$906));
t$8752 = [t$8754,[2,", "],v$909,1,"("];
st$875 = [0,t$8752];
};
 break; }case 1: {var v$903 = v$892[1];
st$875 = (fix$8373.$RecType_layout(v$903));
 break; }case 3: {var v$899 = v$892[1];
var v$900 = v$899[0];
var v$901 = v$899[1];
st$875 = [0,[[fix$8373.$layout(v$900),[fix$8373.$layout(v$901),null]],[2," -> "],")",1,"("]];
 break; }default: {var v$914 = v$892[1];
var v$7464 = basics$StatObject$.string$755(v$914);
st$875 = [1,v$7464];
} };
if (print_type_levels$75[0]) {var t$8755;
var v$929 = [0,", "];
t$8755 = [[st$875,[[1,basis$Int32$.toString$449(ty$874[1][0])],null]],v$929,"]",1,"["];
return [0,t$8755];
} else {return st$875;
};
};
fix$8373.$RecType_layout = function(r$934){var v$951 = sanitiseRecType$251(r$934);
var v$952 = v$951[0];
var v$953 = v$951[1];
var finish$938;
switch (v$953[0]) { case 0: {var v$945 = v$953[1];
var v$946 = v$945[0];
var t$8751;
var t$8750 = " ... ";
var t$8749;
switch (v$946[0][0]) { case 1: {var v$5315 = v$946[0][1];
t$8749 = ("'r" + (basis$Int32$.toString$449(v$5315)));
 break; }default: {t$8749 = (tools$Crash$.impossible$50("StatObject.pr_RowVar"));
} };
t$8751 = (t$8750 + t$8749);
finish$938 = (t$8751 + "}");
 break; }default: {finish$938 = "}";
} };
return (((tools$SortedFinMap$.layoutMap$347(" : ",finish$938,", ","{"))(function(v$8226){return tools$PrettyPrint$.layoutAtom$176(function(v$8312){return syntax_objects$Lab$.pr_Lab$94(v$8312);
},v$8226);
}))(function(v$8313){return fix$8373.$layout(v$8313);
}))(v$952);
};
basics$StatObject$.layout$870 = fix$8373.$layout;
var RecType_layout$869 = fix$8373.$RecType_layout;
var fix$8374 = {};
fix$8374.$RecType_eq0 = function(eq_significant$1066,v$1070){var v$1131 = v$1070[0];
var v$1132 = v$1070[1];
var v$7027 = findRecType$231(v$1131);
var v$7028 = findRecType$231(v$1132);
switch (v$7027[0]) { case 2: {switch (v$7028[0]) { case 2: {return true;
 break; }default: {return false;
} };
 break; }case 0: {switch (v$7028[0]) { case 0: {var v$1102 = v$7027[1];
var v$1103 = v$1102[0];
var v$1104 = v$1102[1];
var v$1105 = v$7028[1];
var v$1106 = v$1105[0];
var v$1107 = v$1105[1];
return (v$1104[0] == v$1107[0])?(v$1103 == v$1106):false;
 break; }default: {return false;
} };
 break; }default: {switch (v$7028[0]) { case 1: {var v$1120 = v$7027[1];
var v$1121 = v$1120[0];
var v$1122 = v$1120[1];
var v$1123 = v$1120[2];
var v$1124 = v$7028[1];
var v$1125 = v$1124[0];
var v$1126 = v$1124[1];
var v$1127 = v$1124[2];
if (syntax_objects$Lab$.eq_lab$138(v$1121,v$1125)) {if (fix$8374.$Type_eq0(eq_significant$1066,[v$1122,v$1126])) {return fix$8374.$RecType_eq0(eq_significant$1066,[v$1123,v$1127]);
} else {return false;
};
} else {return false;
};
 break; }default: {return false;
} };
} };
};
fix$8374.$Type_eq0 = function(eq_significant$969,v$973){var v$1062 = v$973[0];
var v$1063 = v$973[1];
var v$7009 = findType$193(v$1062);
var v$7010 = findType$193(v$1063);
var v$1054 = v$7009[0];
var v$1055 = v$7009[1];
var v$1057 = v$7010[0];
var v$1058 = v$7010[1];
if (v$1055[0] == v$1058[0]) {switch (v$1054[0]) { case 0: {var v$1034 = v$1054[1];
switch (v$1034[0][0]) { case 1: {switch (v$1057[0]) { case 0: {var v$1038 = v$1057[1];
switch (v$1038[0][0]) { case 1: {switch (eq_significant$969) { case 1: {return basics$StatObject$.eq$456(v$1034,v$1038);
 break; }default: {if (basics$StatObject$.eq$456(v$1034,v$1038)) {var t$8747;
switch (v$1034[0][0]) { case 1: {t$8747 = v$1034[0][1][1];
 break; }default: {t$8747 = (tools$Crash$.impossible$50("StatObject.TyVar.equality"));
} };
var t$8746;
switch (v$1038[0][0]) { case 1: {t$8746 = v$1038[0][1][1];
 break; }default: {t$8746 = (tools$Crash$.impossible$50("StatObject.TyVar.equality"));
} };
return t$8747 == t$8746;
} else {return false;
};
} };
 break; }default: {return false;
} };
 break; }default: {return false;
} };
 break; }default: {return false;
} };
 break; }case 3: {switch (v$1057[0]) { case 3: {var v$1027 = v$1054[1];
var v$1028 = v$1027[0];
var v$1029 = v$1027[1];
var v$1030 = v$1057[1];
var v$1031 = v$1030[0];
var v$1032 = v$1030[1];
if (fix$8374.$Type_eq0(eq_significant$969,[v$1028,v$1031])) {return fix$8374.$Type_eq0(eq_significant$969,[v$1029,v$1032]);
} else {return false;
};
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1057[0]) { case 1: {var v$1017 = v$1054[1];
var v$1018 = v$1057[1];
return fix$8374.$RecType_eq0(eq_significant$969,[v$1017,v$1018]);
 break; }default: {return false;
} };
 break; }default: {switch (v$1057[0]) { case 2: {var v$1046 = v$1054[1];
var v$1047 = v$1046[0];
var v$1048 = v$1046[1];
var v$1049 = v$1057[1];
var v$1050 = v$1049[0];
var v$1051 = v$1049[1];
var t$8748;
var v$5378 = v$1048[2];
var v$5379 = v$1051[2];
var v$5380 = v$5378[0][1];
var v$5381 = v$5379[0][1];
t$8748 = ((v$5380[0] == v$5381[0])?(v$5380[1] == v$5381[1]):false);
if (t$8748) {return fix$8374.$TypeList_eq0(eq_significant$969,[v$1047,v$1050]);
} else {return false;
};
 break; }default: {return false;
} };
} };
} else {return false;
};
};
fix$8374.$TypeList_eq0 = function(eq_significant$1135,v$1139){var v$1156 = v$1139[0];
var v$1157 = v$1139[1];
try {var fix$8741 = {};
fix$8741.$foldl = function(v$5340,v$5341){lab$foldl: while (true) {if (v$5341 == null) {return v$5340;
} else {var v$5342 = v$5341;
var v$5343 = v$5342[0];
var v$5344 = v$5342[1];
var t$8742;
var v$5347 = v$5343[0];
var v$5348 = v$5343[1];
t$8742 = (v$5340?(fix$8374.$Type_eq0(eq_significant$1135,[v$5347,v$5348])):false);
var t$8743 = t$8742;
var t$8744 = v$5344;
var v$5340 = t$8743;
var v$5341 = t$8744;
continue lab$foldl;
};
};
};
var foldl$5339 = fix$8741.$foldl;
var v$8228 = tools$BasisCompat$.zipEq$46(v$1156,v$1157);
return foldl$5339(true,v$8228);
} catch(v$8740) {return (function(BasisCompat$ListPair$UnequalLengths$1155){var t$8745 = BasisCompat$ListPair$UnequalLengths$1155;
if (t$8745[0] == tools$BasisCompat$.en$UnequalLengths$45) {return false;
} else {throw BasisCompat$ListPair$UnequalLengths$1155;
};
})(v$8740);
};
};
var RecType_eq0$965 = fix$8374.$RecType_eq0;
var Type_eq0$966 = fix$8374.$Type_eq0;
var TypeList_eq0$964 = fix$8374.$TypeList_eq0;
var RecType_eq$1158;
var v$8229 = 0;
RecType_eq$1158 = (function(v$8230){return RecType_eq0$965(v$8229,v$8230);
});
basics$StatObject$.eq$1159;
var v$8231 = 0;
basics$StatObject$.eq$1159 = (function(v$8232){return Type_eq0$966(v$8231,v$8232);
});
var fix$8375 = {};
fix$8375.$ziptypes = function(v$1190,v$1193){if (v$1193 == null) {return null;
} else {if (v$1190 == null) {var fix$8739 = {};
fix$8739.$map = function(v$5400){if (v$5400 == null) {return null;
} else {var v$5401 = v$5400;
var v$5403 = v$5401[1];
return [[1],fix$8739.$map(v$5403)];
};
};
var map$5399 = fix$8739.$map;
return map$5399(v$1193);
} else {var v$1210 = v$1190;
var v$1211 = v$1210[0];
var v$1212 = v$1210[1];
var v$1213 = v$1193;
var v$1215 = v$1213[1];
return [[0,v$1211],fix$8375.$ziptypes(v$1212,v$1215)];
};
};
};
var ziptypes$1187 = fix$8375.$ziptypes;
var TyName_string_as_opt$1257 = function(v$1277,v$1278){switch (v$1278[0]) { case 0: {var v$1276 = v$1278[1];
var t$8377;
var v$5442 = v$1277[2];
var v$5443 = v$1276[2];
var v$5444 = v$5442[0][1];
var v$5445 = v$5443[0][1];
t$8377 = ((v$5444[0] == v$5445[0])?(v$5444[1] == v$5445[1]):false);
if (t$8377) {return special_objects$TyName$$1.pr_TyName$289(v$1277[0],v$1277[1],v$1277[2],v$1277[3],v$1277[4],v$1277[5]);
} else {var t$8376;
var v$7039 = v$1277[4];
var v$7040 = v$1276[4];
t$8376 = (syntax_objects$TyCon$.eq_tycon$215(v$7039,v$7040));
if (t$8376) {var v$5453 = v$1277[2][0][1];
var v$5454 = v$5453[0];
var v$5455 = v$5453[1];
return SmlPrims.concat([special_objects$TyName$$1.pr_TyName$289(v$1277[0],v$1277[1],v$1277[2],v$1277[3],v$1277[4],v$1277[5]),["<",[basis$Int32$.toString$449(v$5454),["-",[v$5455,[">",null]]]]]]);
} else {return special_objects$TyName$$1.pr_TyName$289(v$1277[0],v$1277[1],v$1277[2],v$1277[3],v$1277[4],v$1277[5]);
};
};
 break; }default: {return special_objects$TyName$$1.pr_TyName$289(v$1277[0],v$1277[1],v$1277[2],v$1277[3],v$1277[4],v$1277[5]);
} };
};
var fix$8378 = {};
fix$8378.$pretty_string_as_opt = function(names$1283,precedence$1286,v$1290){var v$1415 = v$1290[0];
var v$1416 = v$1290[1];
var ty$1291 = findType$193(v$1415);
var ty$_opt$1292;
switch (v$1416[0]) { case 0: {var v$5546 = v$1416[1];
ty$_opt$1292 = [0,findType$193(v$5546)];
 break; }default: {ty$_opt$1292 = [1];
} };
var st_ty$1293;
var v$1307 = ty$1291[0];
switch (v$1307[0]) { case 0: {var v$1356 = v$1307[1];
var fix$8718 = {};
fix$8718.$pretty_string = function(v$8110){switch (v$8110[0][0]) { case 1: {var v$8111 = v$8110[0][1];
var v$8112 = v$8111[1];
var v$8113 = v$8111[5];
var v$8114 = v$8111[3];
var boring$8115 = "U" + (basis$Int32$.toString$449(v$8114));
var t$8727;
var t$8726;
var t$8725;
switch (v$8113[0]) { case 0: {t$8725 = true;
 break; }default: {t$8725 = false;
} };
t$8726 = (t$8725?"OVERLOADED":"");
t$8727 = (t$8726 + (v$8112?"''":"'"));
var t$8719;
if (names$1283 == null) {t$8719 = boring$8115;
} else {var v$8116 = names$1283;
var L$$8117 = v$8116[0];
try {var v$8118 = edlib$edList$.first$1106(function(v$8119){return v$8119[1] == v$8114;
},L$$8117);
var v$8120 = v$8118[0];
t$8719 = (SmlPrims.implode([basis$General$.chr$187(SmlPrims.chk_ovf_i32(ordA$646 + v$8120)),null]));
} catch(v$8720) {t$8719 = ((function(v$8121){var t$8721 = v$8121;
if (t$8721[0] == edlib$edList$.en$First$1105) {var len$8122;
var fix$8722 = {};
fix$8722.$acc = function(v$8124,v$8125){lab$acc: while (true) {if (v$8124 == null) {return v$8125;
} else {var v$8126 = v$8124;
var v$8127 = v$8126[1];
var t$8723 = v$8127;
var t$8724 = SmlPrims.chk_ovf_i32(v$8125 + 1);
var v$8124 = t$8723;
var v$8125 = t$8724;
continue lab$acc;
};
};
};
var acc$8123 = fix$8722.$acc;
len$8122 = (acc$8123(L$$8117,0));
(v$8116[0] = (basis$List$.s$n$645([L$$8117,[[len$8122,v$8114],null]])),0);
return SmlPrims.implode([basis$General$.chr$187(SmlPrims.chk_ovf_i32(ordA$646 + len$8122)),null]);
} else {throw v$8121;
};
})(v$8720));
};
};
return t$8727 + t$8719;
 break; }default: {var v$8128 = v$8110[0][1];
var ty$8129 = findType$193(v$8128);
var v$8130 = ty$8129[0];
switch (v$8130[0]) { case 0: {var v$8131 = v$8130[1];
return (((fix$8718.$pretty_string(v$8131)) + "{") + (basis$Int32$.toString$449(ty$8129[1][0]))) + "}";
 break; }default: {return ("(ty_link){" + (basis$Int32$.toString$449(ty$8129[1][0]))) + "}";
} };
} };
};
var pretty_string$8109 = fix$8718.$pretty_string;
st_ty$1293 = (pretty_string$8109(v$1356));
 break; }case 1: {var v$1354 = v$1307[1];
var r$1328 = findRecType$231(v$1354);
var v$1351 = sanitiseRecType$251(r$1328);
var v$1352 = v$1351[0];
var v$1353 = v$1351[1];
var v$7758 = tools$SortedFinMap$.matches$268(function(v$5552){var v$5553 = v$5552[0];
var v$5554 = v$5552[1];
return syntax_objects$Lab$.is_LabN$74(v$5554,SmlPrims.chk_ovf_i32(v$5553 + 1));
},v$1352);
var rhs1$1333 = function(obj$1350){var fields$1339;
var fix$8705 = {};
fix$8705.$map = function(v$5557){if (v$5557 == null) {return null;
} else {var v$5558 = v$5557;
var v$5559 = v$5558[0];
var v$5560 = v$5558[1];
return [v$5559[1],fix$8705.$map(v$5560)];
};
};
var map$5556 = fix$8705.$map;
fields$1339 = (map$5556(v$1352));
var fields$$1340;
switch (ty$_opt$1292[0]) { case 0: {var v$5564 = ty$_opt$1292[1];
var v$5565 = v$5564[0];
switch (v$5565[0]) { case 1: {var v$5566 = v$5565[1];
var r$$5567 = findRecType$231(v$5566);
var v$5568 = sanitiseRecType$251(r$$5567);
var v$5569 = v$5568[0];
var t$8708 = ziptypes$1187;
var t$8707;
var fix$8706 = {};
fix$8706.$map = function(v$5572){if (v$5572 == null) {return null;
} else {var v$5573 = v$5572;
var v$5574 = v$5573[0];
var v$5575 = v$5573[1];
return [v$5574[1],fix$8706.$map(v$5575)];
};
};
var map$5571 = fix$8706.$map;
t$8707 = (map$5571(v$5569));
fields$$1340 = (t$8708(t$8707,fields$1339));
 break; }default: {var fix$8709 = {};
fix$8709.$map = function(v$5577){if (v$5577 == null) {return null;
} else {var v$5578 = v$5577;
var v$5579 = v$5578[1];
return [[1],fix$8709.$map(v$5579)];
};
};
var map$5576 = fix$8709.$map;
fields$$1340 = (map$5576(fields$1339));
} };
 break; }default: {var fix$8710 = {};
fix$8710.$map = function(v$5581){if (v$5581 == null) {return null;
} else {var v$5582 = v$5581;
var v$5583 = v$5582[1];
return [[1],fix$8710.$map(v$5583)];
};
};
var map$5580 = fix$8710.$map;
fields$$1340 = (map$5580(fields$1339));
} };
var field_types$1341;
var l$5585 = basis$ListPair$.zip$46(fields$1339,fields$$1340);
var fix$8711 = {};
fix$8711.$map = function(v$5587){if (v$5587 == null) {return null;
} else {var v$5588 = v$5587;
var v$5589 = v$5588[0];
var v$5590 = v$5588[1];
return [fix$8378.$pretty_string_as_opt(names$1283,1,v$5589),fix$8711.$map(v$5590)];
};
};
var map$5586 = fix$8711.$map;
field_types$1341 = (map$5586(l$5585));
var labels$1342;
var l$5592;
var fix$8712 = {};
fix$8712.$map = function(v$5600){if (v$5600 == null) {return null;
} else {var v$5601 = v$5600;
var v$5602 = v$5601[0];
var v$5603 = v$5601[1];
return [v$5602[0],fix$8712.$map(v$5603)];
};
};
var map$5599 = fix$8712.$map;
l$5592 = (map$5599(v$1352));
var fix$8713 = {};
fix$8713.$map = function(v$5594){if (v$5594 == null) {return null;
} else {var v$5595 = v$5594;
var v$5596 = v$5595[0];
var v$5597 = v$5595[1];
return [syntax_objects$Lab$.pr_Lab$94(v$5596),fix$8713.$map(v$5597)];
};
};
var map$5593 = fix$8713.$map;
labels$1342 = (map$5593(l$5592));
var l$5610 = basis$ListPair$.zip$46(labels$1342,field_types$1341);
var t$8717;
var t$8716 = "{";
var t$8715;
var fix$8714 = {};
fix$8714.$str = function(v$5612,v$5613,v$5614){if (v$5612 == null) {return "";
} else {var v$5615 = v$5612;
var v$5616 = v$5615[0];
var v$5617 = v$5615[1];
var s$5618 = ((v$5616[0] + ": ") + v$5616[1]) + (fix$8714.$str(v$5617,v$5613,true));
return v$5614?(v$5613 + s$5618):s$5618;
};
};
var str$5611 = fix$8714.$str;
t$8715 = (str$5611(l$5610,", ",false));
t$8717 = (t$8716 + t$8715);
return t$8717 + "}";
};
if (v$7758) {switch (v$1353[0]) { case 1: {st_ty$1293 = (fix$8378.$print_tuple(names$1283,precedence$1286,[v$1352,ty$_opt$1292]));
 break; }default: {st_ty$1293 = (rhs1$1333(0));
} };
} else {st_ty$1293 = (rhs1$1333(0));
};
 break; }case 3: {var v$1324 = v$1307[1];
var v$1325 = v$1324[0];
var v$1326 = v$1324[1];
var v$7064;
switch (ty$_opt$1292[0]) { case 0: {var v$1317 = ty$_opt$1292[1];
var v$1318 = v$1317[0];
switch (v$1318[0]) { case 3: {var v$1320 = v$1318[1];
var v$1321 = v$1320[0];
var v$1322 = v$1320[1];
v$7064 = (((fix$8378.$pretty_string_as_opt(names$1283,3,[v$1325,[0,v$1321]])) + "->") + (fix$8378.$pretty_string_as_opt(names$1283,2,[v$1326,[0,v$1322]])));
 break; }default: {v$7064 = (((fix$8378.$pretty_string_as_opt(names$1283,3,[v$1325,[1]])) + "->") + (fix$8378.$pretty_string_as_opt(names$1283,2,[v$1326,[1]])));
} };
 break; }default: {v$7064 = (((fix$8378.$pretty_string_as_opt(names$1283,3,[v$1325,[1]])) + "->") + (fix$8378.$pretty_string_as_opt(names$1283,2,[v$1326,[1]])));
} };
st_ty$1293 = ((2 < precedence$1286)?(SmlPrims.concat(["(",[v$7064,[")",null]]])):v$7064);
 break; }default: {var v$1400 = v$1307[1];
var v$1401 = v$1400[0];
var v$1402 = v$1400[1];
var v$1380;
switch (ty$_opt$1292[0]) { case 0: {var v$1391 = ty$_opt$1292[1];
var v$1392 = v$1391[0];
switch (v$1392[0]) { case 2: {var v$1394 = v$1392[1];
var v$1395 = v$1394[0];
var v$1396 = v$1394[1];
v$1380 = [ziptypes$1187(v$1395,v$1401),[0,v$1396]];
 break; }default: {var t$8729;
var fix$8728 = {};
fix$8728.$map = function(v$5650){if (v$5650 == null) {return null;
} else {var v$5651 = v$5650;
var v$5653 = v$5651[1];
return [[1],fix$8728.$map(v$5653)];
};
};
var map$5649 = fix$8728.$map;
t$8729 = (map$5649(v$1401));
v$1380 = [t$8729,[1]];
} };
 break; }default: {var t$8731;
var fix$8730 = {};
fix$8730.$map = function(v$5660){if (v$5660 == null) {return null;
} else {var v$5661 = v$5660;
var v$5663 = v$5661[1];
return [[1],fix$8730.$map(v$5663)];
};
};
var map$5659 = fix$8730.$map;
t$8731 = (map$5659(v$1401));
v$1380 = [t$8731,[1]];
} };
var v$1381 = v$1380[0];
var v$1382 = v$1380[1];
var rhs2$1364 = function(obj$1379){var t$8738;
var t$8737;
var t$8732;
var l$5670 = basis$ListPair$.zip$46(v$1401,v$1381);
var t$8736;
var t$8735 = "(";
var t$8734;
var fix$8733 = {};
fix$8733.$str = function(v$5672,v$5673,v$5674){if (v$5672 == null) {return "";
} else {var v$5675 = v$5672;
var v$5676 = v$5675[0];
var v$5677 = v$5675[1];
var s$5678 = (fix$8378.$pretty_string_as_opt(names$1283,1,v$5676)) + (fix$8733.$str(v$5677,v$5673,true));
return v$5674?(v$5673 + s$5678):s$5678;
};
};
var str$5671 = fix$8733.$str;
t$8734 = (str$5671(l$5670,", ",false));
t$8736 = (t$8735 + t$8734);
t$8732 = (t$8736 + ") ");
t$8737 = [t$8732,[" ",[TyName_string_as_opt$1257(v$1402,v$1382),null]]];
t$8738 = t$8737;
return SmlPrims.concat(t$8738);
};
if (v$1401 == null) {st_ty$1293 = (TyName_string_as_opt$1257(v$1402,v$1382));
} else {var v$1371 = v$1401;
if (v$1371[1] == null) {if (v$1381 == null) {st_ty$1293 = (rhs2$1364(0));
} else {var v$1375 = v$1381;
if (v$1375[1] == null) {var v$1377 = v$1371[0];
var v$1378 = v$1375[0];
st_ty$1293 = (SmlPrims.concat([fix$8378.$pretty_string_as_opt(names$1283,4,[v$1377,v$1378]),[" ",[TyName_string_as_opt$1257(v$1402,v$1382),null]]]));
} else {st_ty$1293 = (rhs2$1364(0));
};
};
} else {st_ty$1293 = (rhs2$1364(0));
};
};
} };
return print_type_levels$75[0]?(SmlPrims.concat(["[",[st_ty$1293,[",",[basis$Int32$.toString$449(ty$1291[1][0]),["]",null]]]]])):st_ty$1293;
};
fix$8378.$print_tuple = function(names$1419,precedence$1422,v$1426){var v$1488 = v$1426[0];
var v$1489 = v$1426[1];
var fields$1427;
var fix$8693 = {};
fix$8693.$map = function(v$5458){if (v$5458 == null) {return null;
} else {var v$5459 = v$5458;
var v$5460 = v$5459[0];
var v$5461 = v$5459[1];
return [v$5460[1],fix$8693.$map(v$5461)];
};
};
var map$5457 = fix$8693.$map;
fields$1427 = (map$5457(v$1488));
var fields$$1428;
switch (v$1489[0]) { case 0: {var v$1436 = v$1489[1];
var v$1437 = v$1436[0];
switch (v$1437[0]) { case 1: {var v$1463 = v$1437[1];
var r$$1439 = findRecType$231(v$1463);
var v$1460 = sanitiseRecType$251(r$$1439);
var v$1461 = v$1460[0];
var v$1462 = v$1460[1];
if (tools$SortedFinMap$.matches$268(function(v$1457){var v$1458 = v$1457[0];
var v$1459 = v$1457[1];
return syntax_objects$Lab$.is_LabN$74(v$1459,SmlPrims.chk_ovf_i32(v$1458 + 1));
},v$1461)) {switch (v$1462[0]) { case 1: {var t$8697 = ziptypes$1187;
var t$8696;
var fix$8695 = {};
fix$8695.$map = function(v$5478){if (v$5478 == null) {return null;
} else {var v$5479 = v$5478;
var v$5480 = v$5479[0];
var v$5481 = v$5479[1];
return [v$5480[1],fix$8695.$map(v$5481)];
};
};
var map$5477 = fix$8695.$map;
t$8696 = (map$5477(v$1461));
fields$$1428 = (t$8697(t$8696,fields$1427));
 break; }default: {var fix$8698 = {};
fix$8698.$map = function(v$5487){if (v$5487 == null) {return null;
} else {var v$5488 = v$5487;
var v$5490 = v$5488[1];
return [[1],fix$8698.$map(v$5490)];
};
};
var map$5486 = fix$8698.$map;
fields$$1428 = (map$5486(fields$1427));
} };
} else {var fix$8694 = {};
fix$8694.$map = function(v$5497){if (v$5497 == null) {return null;
} else {var v$5498 = v$5497;
var v$5500 = v$5498[1];
return [[1],fix$8694.$map(v$5500)];
};
};
var map$5496 = fix$8694.$map;
fields$$1428 = (map$5496(fields$1427));
};
 break; }default: {var fix$8699 = {};
fix$8699.$map = function(v$5507){if (v$5507 == null) {return null;
} else {var v$5508 = v$5507;
var v$5510 = v$5508[1];
return [[1],fix$8699.$map(v$5510)];
};
};
var map$5506 = fix$8699.$map;
fields$$1428 = (map$5506(fields$1427));
} };
 break; }default: {var fix$8700 = {};
fix$8700.$map = function(v$5517){if (v$5517 == null) {return null;
} else {var v$5518 = v$5517;
var v$5520 = v$5518[1];
return [[1],fix$8700.$map(v$5520)];
};
};
var map$5516 = fix$8700.$map;
fields$$1428 = (map$5516(fields$1427));
} };
var rhs2$1472 = function(obj$1487){var v$7047;
var l$5530 = basis$ListPair$.zip$46(fields$1427,fields$$1428);
var t$8704;
var t$8703 = "";
var t$8702;
var fix$8701 = {};
fix$8701.$str = function(v$5532,v$5533,v$5534){if (v$5532 == null) {return "";
} else {var v$5535 = v$5532;
var v$5536 = v$5535[0];
var v$5537 = v$5535[1];
var s$5538 = (fix$8378.$pretty_string_as_opt(names$1419,4,v$5536)) + (fix$8701.$str(v$5537,v$5533,true));
return v$5534?(v$5533 + s$5538):s$5538;
};
};
var str$5531 = fix$8701.$str;
t$8702 = (str$5531(l$5530," * ",false));
t$8704 = (t$8703 + t$8702);
v$7047 = (t$8704 + "");
return (3 < precedence$1422)?(SmlPrims.concat(["(",[v$7047,[")",null]]])):v$7047;
};
if (fields$1427 == null) {return "unit";
} else {var v$1479 = fields$1427;
if (v$1479[1] == null) {if (fields$$1428 == null) {return rhs2$1472(0);
} else {var v$1483 = fields$$1428;
if (v$1483[1] == null) {var v$1485 = v$1479[0];
var v$1486 = v$1483[0];
return ("{1: " + (fix$8378.$pretty_string_as_opt(names$1419,1,[v$1485,v$1486]))) + "}";
} else {return rhs2$1472(0);
};
};
} else {return rhs2$1472(0);
};
};
};
var pretty_string_as_opt$1280 = fix$8378.$pretty_string_as_opt;
var print_tuple$1279 = fix$8378.$print_tuple;
basics$StatObject$.pretty_string_as_ty$1490 = function(names$1493,v$1497){var v$1498 = v$1497[0];
var v$1499 = v$1497[1];
return pretty_string_as_opt$1280(names$1493,1,[v$1498,[0,v$1499]]);
};
basics$StatObject$.pretty_string$1500 = function(names$1503,ty$1506){return pretty_string_as_opt$1280(names$1503,1,[ty$1506,[1]]);
};
basics$StatObject$.string_as_ty$1507;
var names$5683 = null;
basics$StatObject$.string_as_ty$1507 = (function(v$5684){var v$5685 = v$5684[0];
var v$5686 = v$5684[1];
return pretty_string_as_opt$1280(names$5683,1,[v$5685,[0,v$5686]]);
});
basics$StatObject$.string$1508;
var names$5687 = null;
basics$StatObject$.string$1508 = (function(ty$5688){return pretty_string_as_opt$1280(names$5687,1,[ty$5688,[1]]);
});
basics$StatObject$.from_TyVar$1509 = function(tyvar$1512){return [[0,tyvar$1512],[level_ref$142[0]]];
};
basics$StatObject$.to_TyVar$1513 = function(ty$1516){var v$1521 = (findType$193(ty$1516))[0];
switch (v$1521[0]) { case 0: {var v$1523 = v$1521[1];
return [0,v$1523];
 break; }default: {return [1];
} };
};
basics$StatObject$.fresh_normal$1529 = function(x$5706){var t$8382;
var t$8379;
var v$7483 = [1];
var v$7484 = [1];
var t$8381;
var t$8380;
var v$7485;
(r$588[0] = (SmlPrims.chk_ovf_i32(r$588[0] + 1)),0);
v$7485 = r$588[0];
var v$7486 = special_objects$Name$.baseGet$56(0);
var v$7487 = [special_objects$TyName$$1.current$72(0)];
t$8380 = [v$7486,false,v$7483,v$7485,[[1]],v$7484,v$7487];
t$8381 = [1,t$8380];
t$8379 = [t$8381];
t$8382 = [0,t$8379];
return [t$8382,[level_ref$142[0]]];
};
basics$StatObject$.from_RecType$1530 = function(r$1533){return [[1,r$1533],[0]];
};
basics$StatObject$.to_RecType$1534 = function(ty$1537){var v$1542 = (findType$193(ty$1537))[0];
switch (v$1542[0]) { case 1: {var v$1544 = v$1542[1];
return [0,v$1544];
 break; }default: {return [1];
} };
};
var fix$8383 = {};
fix$8383.$contains_row_variable = function(t$1553){var v$1565 = (findType$193(t$1553))[0];
switch (v$1565[0]) { case 0: {return false;
 break; }case 3: {var v$1573 = v$1565[1];
var v$1574 = v$1573[0];
var v$1575 = v$1573[1];
if (fix$8383.$contains_row_variable(v$1574)) {return true;
} else {return fix$8383.$contains_row_variable(v$1575);
};
 break; }case 1: {var v$1567 = v$1565[1];
return fix$8383.$RecType_contains_row_variable(v$1567);
 break; }default: {var v$1577 = v$1565[1];
var v$1578 = v$1577[0];
var fix$8691 = {};
fix$8691.$exists = function(v$5710){lab$exists: while (true) {if (v$5710 == null) {return false;
} else {var v$5711 = v$5710;
var v$5712 = v$5711[0];
var v$5713 = v$5711[1];
if (fix$8383.$contains_row_variable(v$5712)) {return true;
} else {var t$8692 = v$5713;
var v$5710 = t$8692;
continue lab$exists;
};
};
};
};
var exists$5709 = fix$8691.$exists;
return exists$5709(v$1578);
} };
};
fix$8383.$RecType_contains_row_variable = function(r$1585){var v$1593 = findRecType$231(r$1585);
switch (v$1593[0]) { case 2: {return false;
 break; }case 0: {return true;
 break; }default: {var v$1599 = v$1593[1];
var v$1600 = v$1599[1];
var v$1601 = v$1599[2];
if (fix$8383.$contains_row_variable(v$1600)) {return true;
} else {return fix$8383.$RecType_contains_row_variable(v$1601);
};
} };
};
basics$StatObject$.contains_row_variable$1550 = fix$8383.$contains_row_variable;
var RecType_contains_row_variable$1549 = fix$8383.$RecType_contains_row_variable;
basics$StatObject$.empty$1602 = [2];
basics$StatObject$.dotdotdot$1603 = function(v$5714){var t$8387;
var t$8386;
var t$8385;
var t$8384;
(r$862[0] = (SmlPrims.chk_ovf_i32(r$862[0] + 1)),0);
t$8384 = r$862[0];
t$8385 = [1,t$8384];
t$8386 = [t$8385];
t$8387 = [t$8386,[level_ref$142[0]]];
return [0,t$8387];
};
var fix$8388 = {};
fix$8388.$insertFields = function(v$1684,v$1685){lab$insertFields: while (true) {var v$7084 = findRecType$231(v$1685);
if (v$1684 == null) {return v$1685;
} else {switch (v$7084[0]) { case 2: {var v$1662 = v$1684;
var v$1663 = v$1662[0];
var v$1664 = v$1663[0];
var v$1665 = v$1663[1];
var v$1666 = v$1662[1];
return [1,[v$1664,v$1665,fix$8388.$insertFields(v$1666,[2])]];
 break; }case 0: {var v$1656 = v$1684;
var v$1657 = v$1656[0];
var v$1658 = v$1657[0];
var v$1659 = v$1657[1];
var v$1660 = v$1656[1];
var v$1661 = v$7084[1];
return [1,[v$1658,v$1659,fix$8388.$insertFields(v$1660,[0,v$1661])]];
 break; }default: {var v$1675 = v$1684;
var v$1676 = v$1675[0];
var v$1677 = v$1676[0];
var v$1678 = v$1676[1];
var v$1679 = v$1675[1];
var v$1680 = v$7084[1];
var v$1681 = v$1680[0];
var v$1682 = v$1680[1];
var v$1683 = v$1680[2];
if (syntax_objects$Lab$.eq_lab$138(v$1677,v$1681)) {return tools$Crash$.impossible$50("StatObject.insertFields");
} else {return (syntax_objects$Lab$.s$j$49(v$1677,v$1681))?[1,[v$1677,v$1678,fix$8388.$insertFields(v$1679,v$1685)]]:[1,[v$1681,v$1682,fix$8388.$insertFields([[v$1677,v$1678],v$1679],v$1683)]];
};
} };
};
};
};
var insertFields$1627 = fix$8388.$insertFields;
basics$StatObject$.add_field$1686 = function(v$1694,v$1695){return function(recType$1693){return insertFields$1627([[v$1694,v$1695],null],recType$1693);
};
};
basics$StatObject$.sorted_labs$1745 = function(r$1748){var v$1751 = sanitiseRecType$251(r$1748);
var v$1752 = v$1751[0];
var fix$8389 = {};
fix$8389.$map = function(v$5724){if (v$5724 == null) {return null;
} else {var v$5725 = v$5724;
var v$5726 = v$5725[0];
var v$5727 = v$5725[1];
return [v$5726[0],fix$8389.$map(v$5727)];
};
};
var map$5723 = fix$8389.$map;
return map$5723(v$1752);
};
basics$StatObject$.to_list$1753 = function(r$1756){try {var m$1757 = (sanitiseRecType$251(r$1756))[0];
var t$8395 = tools$BasisCompat$.zipEq$46;
var t$8394;
var fix$8393 = {};
fix$8393.$map = function(v$5730){if (v$5730 == null) {return null;
} else {var v$5731 = v$5730;
var v$5732 = v$5731[0];
var v$5733 = v$5731[1];
return [v$5732[0],fix$8393.$map(v$5733)];
};
};
var map$5729 = fix$8393.$map;
t$8394 = (map$5729(m$1757));
var t$8392;
var fix$8391 = {};
fix$8391.$map = function(v$5736){if (v$5736 == null) {return null;
} else {var v$5737 = v$5736;
var v$5738 = v$5737[0];
var v$5739 = v$5737[1];
return [v$5738[1],fix$8391.$map(v$5739)];
};
};
var map$5735 = fix$8391.$map;
t$8392 = (map$5735(m$1757));
return t$8395(t$8394,t$8392);
} catch(v$8390) {return (function(BasisCompat$ListPair$UnequalLengths$1764){var t$8396 = BasisCompat$ListPair$UnequalLengths$1764;
if (t$8396[0] == tools$BasisCompat$.en$UnequalLengths$45) {return tools$Crash$.impossible$50("StatObject.to_list");
} else {throw BasisCompat$ListPair$UnequalLengths$1764;
};
})(v$8390);
};
};
basics$StatObject$.to_pair$1765 = function(r$1768){var v$1773 = sanitiseRecType$251(r$1768);
switch (v$1773[1][0]) { case 1: {var v$1787 = v$1773[0];
var v$1779 = tools$SortedFinMap$.lookup$61(function(v$8191){return syntax_objects$Lab$.eq_lab$138(v$8191[0],v$8191[1]);
},v$1787,ONE$137);
switch (v$1779[0]) { case 1: {return tools$Crash$.impossible$50("StatObject.Type.to_pair(L=?)");
 break; }default: {var v$1786 = v$1779[1];
var v$1784 = tools$SortedFinMap$.lookup$61(function(v$8192){return syntax_objects$Lab$.eq_lab$138(v$8192[0],v$8192[1]);
},v$1787,TWO$138);
switch (v$1784[0]) { case 1: {return tools$Crash$.impossible$50("StatObject.Type.to_pair(R=?)");
 break; }default: {return [v$1786,v$1784[1]];
} };
} };
 break; }default: {return tools$Crash$.impossible$50("StatObject.Type.to_pair(flexible)");
} };
};
var sort$1788 = function(r$1791){try {var v$1813 = sanitiseRecType$251(r$1791);
var v$1814 = v$1813[0];
var v$1815 = v$1813[1];
var dom$1795;
var fix$8398 = {};
fix$8398.$map = function(v$5750){if (v$5750 == null) {return null;
} else {var v$5751 = v$5750;
var v$5752 = v$5751[0];
var v$5753 = v$5751[1];
return [v$5752[0],fix$8398.$map(v$5753)];
};
};
var map$5749 = fix$8398.$map;
dom$1795 = (map$5749(v$1814));
var range$1796;
var fix$8399 = {};
fix$8399.$map = function(v$5756){if (v$5756 == null) {return null;
} else {var v$5757 = v$5756;
var v$5758 = v$5757[0];
var v$5759 = v$5757[1];
return [v$5758[1],fix$8399.$map(v$5759)];
};
};
var map$5755 = fix$8399.$map;
range$1796 = (map$5755(v$1814));
var b$5761;
switch (v$1815[0]) { case 0: {var v$1812 = v$1815[1];
b$5761 = [0,v$1812];
 break; }default: {b$5761 = [2];
} };
var c$5762 = tools$BasisCompat$.zipEq$46(dom$1795,range$1796);
var fix$8400 = {};
fix$8400.$foldr = function(v$5764){if (v$5764 == null) {return b$5761;
} else {var v$5765 = v$5764;
var v$5766 = v$5765[0];
var v$5767 = v$5765[1];
return [1,[v$5766[0],v$5766[1],fix$8400.$foldr(v$5767)]];
};
};
var foldr$5763 = fix$8400.$foldr;
return foldr$5763(c$5762);
} catch(v$8397) {return (function(BasisCompat$ListPair$UnequalLengths$1818){var t$8401 = BasisCompat$ListPair$UnequalLengths$1818;
if (t$8401[0] == tools$BasisCompat$.en$UnequalLengths$45) {return tools$Crash$.impossible$50("StatObject.RecType.sort");
} else {throw BasisCompat$ListPair$UnequalLengths$1818;
};
})(v$8397);
};
};
var bucket$1821 = [null];
var fix$8402 = {};
fix$8402.$tyvars0 = function(f_b$1836,ty$1839){var ty$1840 = findType$193(ty$1839);
var v$1855 = ty$1840[0];
switch (v$1855[0]) { case 0: {var v$1869 = v$1855[1];
switch (v$1869[0][0]) { case 1: {switch (f_b$1836) { case 0: {if (ty$1840[1][0] == (-1)) {return 0;
} else {var t$8686;
var fix$8684 = {};
fix$8684.$exists = function(v$5785){lab$exists: while (true) {if (v$5785 == null) {return false;
} else {var v$5786 = v$5785;
var v$5787 = v$5786[0];
var v$5788 = v$5786[1];
if (basics$StatObject$.eq$456(v$1869,v$5787)) {return true;
} else {var t$8685 = v$5788;
var v$5785 = t$8685;
continue lab$exists;
};
};
};
};
var exists$5784 = fix$8684.$exists;
t$8686 = (exists$5784(bucket$1821[0]));
return t$8686?0:(bucket$1821[0] = [v$1869,bucket$1821[0]],0);
};
 break; }default: {if (ty$1840[1][0] == (-1)) {var t$8689;
var fix$8687 = {};
fix$8687.$exists = function(v$5794){lab$exists: while (true) {if (v$5794 == null) {return false;
} else {var v$5795 = v$5794;
var v$5796 = v$5795[0];
var v$5797 = v$5795[1];
if (basics$StatObject$.eq$456(v$1869,v$5796)) {return true;
} else {var t$8688 = v$5797;
var v$5794 = t$8688;
continue lab$exists;
};
};
};
};
var exists$5793 = fix$8687.$exists;
t$8689 = (exists$5793(bucket$1821[0]));
return t$8689?0:(bucket$1821[0] = [v$1869,bucket$1821[0]],0);
} else {return 0;
};
} };
 break; }default: {return tools$Crash$.impossible$50("StatObject.tyvars0");
} };
 break; }case 1: {var v$1867 = v$1855[1];
var fix$8681 = {};
fix$8681.$fold = function(x$7494,r$7495){lab$fold: while (true) {var v$7496 = findRecType$231(r$7495);
switch (v$7496[0]) { case 2: {return x$7494;
 break; }case 0: {return x$7494;
 break; }default: {var v$7497 = v$7496[1];
var v$7498 = v$7497[1];
var v$7499 = v$7497[2];
var t$8682 = fix$8402.$tyvars0(f_b$1836,v$7498);
var t$8683 = v$7499;
var x$7494 = t$8682;
var r$7495 = t$8683;
continue lab$fold;
} };
};
};
var fold$7493 = fix$8681.$fold;
var v$8253 = 0;
var v$8254 = findRecType$231(v$1867);
return fold$7493(v$8253,v$8254);
 break; }case 3: {var v$1859 = v$1855[1];
var v$1860 = v$1859[0];
var v$1861 = v$1859[1];
fix$8402.$tyvars0(f_b$1836,v$1861);
return fix$8402.$tyvars0(f_b$1836,v$1860);
 break; }default: {var v$1895 = v$1855[1];
var v$1896 = v$1895[0];
var b$5803 = 0;
var fix$8690 = {};
fix$8690.$foldr = function(v$5806){lab$foldr: while (true) {if (v$5806 == null) {return b$5803;
} else {var v$5807 = v$5806;
var v$5808 = v$5807[0];
var v$5809 = v$5807[1];
fix$8690.$foldr(v$5809);
return fix$8402.$tyvars0(f_b$1836,v$5808);
};
};
};
var foldr$5805 = fix$8690.$foldr;
return foldr$5805(v$1896);
} };
};
var tyvars0$1833 = fix$8402.$tyvars0;
basics$StatObject$.tyvars$1912 = function(ty$1915){var f_b$5812 = 0;
(bucket$1821[0] = null,0);
tyvars0$1833(f_b$5812,ty$1915);
return bucket$1821[0];
};
var fix$8403 = {};
fix$8403.$tynames = function(ty$1923){var ty$1924 = findType$193(ty$1923);
var v$1937 = ty$1924[0];
switch (v$1937[0]) { case 0: {return special_objects$TyName$$3.empty$2399;
 break; }case 1: {var v$1949 = v$1937[1];
var fix$8675 = {};
fix$8675.$fold = function(x$7509,r$7510){lab$fold: while (true) {var v$7511 = findRecType$231(r$7510);
switch (v$7511[0]) { case 2: {return x$7509;
 break; }case 0: {return x$7509;
 break; }default: {var v$7512 = v$7511[1];
var v$7513 = v$7512[1];
var v$7514 = v$7512[2];
var t$8676 = special_objects$TyName$$3.union$2587(fix$8403.$tynames(v$7513),x$7509);
var t$8677 = v$7514;
var x$7509 = t$8676;
var r$7510 = t$8677;
continue lab$fold;
} };
};
};
var fold$7508 = fix$8675.$fold;
return fold$7508(special_objects$TyName$$3.empty$2399,v$1949);
 break; }case 3: {var v$1939 = v$1937[1];
var v$1940 = v$1939[0];
var v$1941 = v$1939[1];
return special_objects$TyName$$3.union$2587(fix$8403.$tynames(v$1940),fix$8403.$tynames(v$1941));
 break; }default: {var v$1957 = v$1937[1];
var v$1958 = v$1957[0];
var v$1959 = v$1957[1];
var b$5819 = special_objects$TyName$$3.singleton$2400(v$1959);
var fix$8678 = {};
fix$8678.$foldl = function(v$5822,v$5823){lab$foldl: while (true) {if (v$5823 == null) {return v$5822;
} else {var v$5824 = v$5823;
var v$5825 = v$5824[0];
var v$5826 = v$5824[1];
var t$8679 = special_objects$TyName$$3.union$2587(fix$8403.$tynames(v$5825),v$5822);
var t$8680 = v$5826;
var v$5822 = t$8679;
var v$5823 = t$8680;
continue lab$foldl;
};
};
};
var foldl$5821 = fix$8678.$foldl;
return foldl$5821(b$5819,v$1958);
} };
};
basics$StatObject$.tynames$1920 = fix$8403.$tynames;
basics$StatObject$.from_pair$1964 = function(v$1969,v$1970){var t$8405;
var t$8404;
var recType$5830 = insertFields$1627([[TWO$138,v$1970],null],basics$StatObject$.empty$1602);
t$8404 = (insertFields$1627([[ONE$137,v$1969],null],recType$5830));
t$8405 = [1,t$8404];
return [t$8405,[0]];
};
basics$StatObject$.from_triple$1971 = function(v$1977,v$1978,v$1979){var t$8407;
var t$8406;
var recType$5838;
var recType$5842 = insertFields$1627([[THREE$139,v$1979],null],basics$StatObject$.empty$1602);
recType$5838 = (insertFields$1627([[TWO$138,v$1978],null],recType$5842));
t$8406 = (insertFields$1627([[ONE$137,v$1977],null],recType$5838));
t$8407 = [1,t$8406];
return [t$8407,[0]];
};
basics$StatObject$.Unit$1980 = [[1,basics$StatObject$.empty$1602],[0]];
basics$StatObject$.from_FunType$1981 = function(fty$1984){return fty$1984;
};
basics$StatObject$.to_FunType$1985 = function(ty$1988){switch ((findType$193(ty$1988))[0][0]) { case 3: {return [0,ty$1988];
 break; }default: {return [1];
} };
};
basics$StatObject$.mk_FunType$2003 = function(v$8193,v$8194){return [[3,[v$8193,v$8194]],[0]];
};
basics$StatObject$.un_FunType$2010 = function(ty$2013){var v$2019 = (findType$193(ty$2013))[0];
switch (v$2019[0]) { case 3: {var v$2021 = v$2019[1];
return [0,[v$2021[0],v$2021[1]]];
 break; }default: {return [1];
} };
};
basics$StatObject$.from_ConsType$2028 = function(cty$2031){return cty$2031;
};
basics$StatObject$.to_ConsType$2032 = function(ty$2035){switch ((findType$193(ty$2035))[0][0]) { case 2: {return [0,ty$2035];
 break; }default: {return [1];
} };
};
basics$StatObject$.mk_ConsType$2050 = function(v$8195,v$8196){return [[2,[v$8195,v$8196]],[0]];
};
basics$StatObject$.un_ConsType$2057 = function(ty$2060){var v$2066 = (findType$193(ty$2060))[0];
switch (v$2066[0]) { case 2: {var v$2068 = v$2066[1];
return [0,[v$2068[0],v$2068[1]]];
 break; }default: {return [1];
} };
};
basics$StatObject$.Exn$2075 = [[2,[null,special_objects$TyName$$1.tyName_EXN$270]],[0]];
basics$StatObject$.is_Exn$2076 = function(ty$2079){var v$2085 = (findType$193(ty$2079))[0];
switch (v$2085[0]) { case 2: {var v$2087 = v$2085[1];
if (v$2087[0] == null) {var v$2089 = v$2087[1];
var v$5851 = v$2089[2];
var v$5852 = special_objects$TyName$$1.tyName_EXN$270[2];
var v$5853 = v$5851[0][1];
var v$5854 = v$5852[0][1];
return (v$5853[0] == v$5854[0])?(v$5853[1] == v$5854[1]):false;
} else {return false;
};
 break; }default: {return false;
} };
};
basics$StatObject$.mk_Arrow$2095 = function(v$8197,v$8198){return [[3,[v$8197,v$8198]],[0]];
};
basics$StatObject$.un_Arrow$2102 = function(ty$2105){var v$2111 = (findType$193(ty$2105))[0];
switch (v$2111[0]) { case 3: {var v$2113 = v$2111[1];
return [0,[v$2113[0],v$2113[1]]];
 break; }default: {return [1];
} };
};
basics$StatObject$.is_Arrow$2120 = function(ty$2123){switch ((findType$193(ty$2123))[0][0]) { case 3: {return true;
 break; }default: {return false;
} };
};
basics$StatObject$.mk_Ref$2133 = function(t$2136){return [[2,[[t$2136,null],special_objects$TyName$$1.tyName_REF$250]],[0]];
};
var tag_values$2137 = tools$Flags$$6.is_on0$5026("tag_values");
basics$StatObject$.Int31$2138 = [[2,[null,special_objects$TyName$$1.tyName_INT31$206]],[0]];
basics$StatObject$.Int32$2139 = [[2,[null,special_objects$TyName$$1.tyName_INT32$210]],[0]];
basics$StatObject$.IntInf$2140 = [[2,[null,special_objects$TyName$$1.tyName_INTINF$214]],[0]];
basics$StatObject$.IntDefault$2141 = function(v$2143){return (tag_values$2137(0))?basics$StatObject$.Int31$2138:basics$StatObject$.Int32$2139;
};
basics$StatObject$.Real$2148 = [[2,[null,special_objects$TyName$$1.tyName_REAL$230]],[0]];
basics$StatObject$.String$2149 = [[2,[null,special_objects$TyName$$1.tyName_STRING$234]],[0]];
basics$StatObject$.Bool$2150 = [[2,[null,special_objects$TyName$$1.tyName_BOOL$202]],[0]];
basics$StatObject$.Char$2151 = [[2,[null,special_objects$TyName$$1.tyName_CHAR$238]],[0]];
basics$StatObject$.Word8$2152 = [[2,[null,special_objects$TyName$$1.tyName_WORD8$218]],[0]];
basics$StatObject$.Word31$2153 = [[2,[null,special_objects$TyName$$1.tyName_WORD31$222]],[0]];
basics$StatObject$.Word32$2154 = [[2,[null,special_objects$TyName$$1.tyName_WORD32$226]],[0]];
basics$StatObject$.WordDefault$2155 = function(v$2157){return (tag_values$2137(0))?basics$StatObject$.Word31$2153:basics$StatObject$.Word32$2154;
};
basics$StatObject$.of_scon$2168 = function(sc$2171){switch (sc$2171[0]) { case 3: {var v$2210 = sc$2171[1];
if ((basis$IntInf$.s$l$2221([v$2210,basis$Int32$.toLarge$78(basis$General$.valOf$123(basis$Int32$.maxInt$95))]))?true:(basis$IntInf$.s$j$2213([v$2210,basis$Int32$.toLarge$78(basis$General$.valOf$123(basis$Int32$.minInt$96))]))) {return [[1],basics$StatObject$.IntInf$2140];
} else {if ((basis$IntInf$.s$l$2221([v$2210,basis$Int31$.toLarge$76(basis$General$.valOf$123(basis$Int31$.maxInt$93))]))?true:(basis$IntInf$.s$j$2213([v$2210,basis$Int31$.toLarge$76(basis$General$.valOf$123(basis$Int31$.minInt$94))]))) {var tv$2196;
var tynames$7521 = [special_objects$TyName$$1.tyName_INT32$210,[special_objects$TyName$$1.tyName_INTINF$214,null]];
var v$7522 = [1];
var v$7523 = [0,special_objects$TyName$$3.fromList$2946(tynames$7521)];
var t$8409;
var t$8408;
var v$7524;
(r$588[0] = (SmlPrims.chk_ovf_i32(r$588[0] + 1)),0);
v$7524 = r$588[0];
var v$7525 = special_objects$Name$.baseGet$56(0);
var v$7526 = [special_objects$TyName$$1.current$72(0)];
t$8408 = [v$7525,false,v$7522,v$7524,[[1]],v$7523,v$7526];
t$8409 = [1,t$8408];
tv$2196 = [t$8409];
return [[0,tv$2196],[[0,tv$2196],[level_ref$142[0]]]];
} else {var tv$2199;
var tynames$7527 = [special_objects$TyName$$1.tyName_INT31$206,[special_objects$TyName$$1.tyName_INT32$210,[special_objects$TyName$$1.tyName_INTINF$214,null]]];
var v$7528 = [1];
var v$7529 = [0,special_objects$TyName$$3.fromList$2946(tynames$7527)];
var t$8411;
var t$8410;
var v$7530;
(r$588[0] = (SmlPrims.chk_ovf_i32(r$588[0] + 1)),0);
v$7530 = r$588[0];
var v$7531 = special_objects$Name$.baseGet$56(0);
var v$7532 = [special_objects$TyName$$1.current$72(0)];
t$8410 = [v$7531,false,v$7528,v$7530,[[1]],v$7529,v$7532];
t$8411 = [1,t$8410];
tv$2199 = [t$8411];
return [[0,tv$2199],[[0,tv$2199],[level_ref$142[0]]]];
};
};
 break; }case 1: {return [[1],basics$StatObject$.String$2149];
 break; }case 2: {return [[1],basics$StatObject$.Real$2148];
 break; }case 4: {return [[1],basics$StatObject$.Char$2151];
 break; }default: {var v$2222 = sc$2171[1];
if (v$2222 > 2147483647) {return [[1],basics$StatObject$.Word32$2154];
} else {var tv$2215;
var tynames$7533 = (v$2222 > 255)?[special_objects$TyName$$1.tyName_WORD31$222,[special_objects$TyName$$1.tyName_WORD32$226,null]]:[special_objects$TyName$$1.tyName_WORD8$218,[special_objects$TyName$$1.tyName_WORD31$222,[special_objects$TyName$$1.tyName_WORD32$226,null]]];
var v$7534 = [1];
var v$7535 = [0,special_objects$TyName$$3.fromList$2946(tynames$7533)];
var t$8413;
var t$8412;
var v$7536;
(r$588[0] = (SmlPrims.chk_ovf_i32(r$588[0] + 1)),0);
v$7536 = r$588[0];
var v$7537 = special_objects$Name$.baseGet$56(0);
var v$7538 = [special_objects$TyName$$1.current$72(0)];
t$8412 = [v$7537,false,v$7534,v$7536,[[1]],v$7535,v$7538];
t$8413 = [1,t$8412];
tv$2215 = [t$8413];
return [[0,tv$2215],[[0,tv$2215],[level_ref$142[0]]]];
};
} };
};
var fix$8414 = {};
fix$8414.$generalise = function(v$2300,v$2299,v$2301){var tau$2230 = findType$193(v$2301);
var v$2297 = tau$2230[0];
var v$2298 = tau$2230[1];
if (v$2298[0] == (-1)) {0;
} else {switch (v$2297[0]) { case 0: {var v$2286 = v$2297[1];
if (v$2298[0] > level_ref$142[0]) {var t$8668;
var t$8667;
if (v$2299) {t$8667 = true;
} else {var t$8666;
var t$8665;
switch (v$2286[0][0]) { case 1: {t$8665 = v$2286[0][1][5];
 break; }default: {t$8665 = (tools$Crash$.impossible$50("StatObject.TyVar.get_overloaded"));
} };
switch (t$8665[0]) { case 0: {t$8666 = true;
 break; }default: {t$8666 = false;
} };
t$8667 = (t$8666?false:true);
};
t$8668 = (t$8667?v$2300:false);
t$8668?(v$2298[0] = (-1),0):(v$2298[0] = level_ref$142[0],0);
} else {0;
};
 break; }case 3: {var v$2266 = v$2297[1];
var v$2267 = v$2266[0];
var v$2268 = v$2266[1];
var t$8664 = v$2298;
var t$8663;
var v$7157 = fix$8414.$generalise(v$2300,v$2299,v$2267);
var v$7158 = fix$8414.$generalise(v$2300,v$2299,v$2268);
t$8663 = ((v$7157 < v$7158)?v$7157:v$7158);
(t$8664[0] = t$8663,0);
 break; }case 1: {var v$2258 = v$2297[1];
(v$2298[0] = (fix$8414.$generaliseRecType(v$2300,v$2299,v$2258)),0);
 break; }default: {var v$2293 = v$2297[1];
var v$2294 = v$2293[0];
var t$8674 = v$2298;
var t$8669;
var c$5910;
var l$5921 = basis$List$.rev$641(v$2294);
var fix$8670 = {};
fix$8670.$map = function(v$5923){if (v$5923 == null) {return null;
} else {var v$5924 = v$5923;
var v$5925 = v$5924[0];
var v$5926 = v$5924[1];
return [fix$8414.$generalise(v$2300,v$2299,v$5925),fix$8670.$map(v$5926)];
};
};
var map$5922 = fix$8670.$map;
c$5910 = (map$5922(l$5921));
var fix$8671 = {};
fix$8671.$foldl = function(v$5912,v$5913){lab$foldl: while (true) {if (v$5913 == null) {return v$5912;
} else {var v$5914 = v$5913;
var v$5915 = v$5914[0];
var v$5916 = v$5914[1];
var t$8672 = (v$5915 < v$5912)?v$5915:v$5912;
var t$8673 = v$5916;
var v$5912 = t$8672;
var v$5913 = t$8673;
continue lab$foldl;
};
};
};
var foldl$5911 = fix$8671.$foldl;
t$8669 = (foldl$5911(0,c$5910));
(t$8674[0] = t$8669,0);
} };
};
return v$2298[0];
};
fix$8414.$generaliseRecType = function(v$2338,v$2337,v$2339){var r$2307 = findRecType$231(v$2339);
switch (r$2307[0]) { case 2: {return 0;
 break; }case 0: {var v$2325 = r$2307[1];
var v$2326 = v$2325[1];
(v$2326[0] > level_ref$142[0])?(v$2326[0] = level_ref$142[0],0):0;
return 0;
 break; }default: {var v$2333 = r$2307[1];
var v$2335 = v$2333[1];
var v$2336 = v$2333[2];
var v$7145 = fix$8414.$generalise(v$2338,v$2337,v$2335);
var v$7146 = fix$8414.$generaliseRecType(v$2338,v$2337,v$2336);
return (v$7145 < v$7146)?v$7145:v$7146;
} };
};
var generalise$2224 = fix$8414.$generalise;
var generaliseRecType$2223 = fix$8414.$generaliseRecType;
var en$NotEquality$2346 = new String("NotEquality");
var exn$NotEquality$2346 = [en$NotEquality$2346];
var fix$8415 = {};
fix$8415.$make_equality0 = function(ty$2350){var v$2374 = (findType$193(ty$2350))[0];
switch (v$2374[0]) { case 0: {var v$2394 = v$2374[1];
switch (v$2394[0][0]) { case 1: {var v$2396 = v$2394[0][1];
var v$2397 = v$2396[2];
switch (v$2397[0]) { case 0: {var v$2403 = v$2397[1];
if (syntax_objects$SyntaxTyVar$.isEquality$59(v$2403)) {return 0;
} else {throw exn$NotEquality$2346;
};
 break; }default: {var v$2415 = v$2396[1];
var v$2416 = v$2396[5];
var v$2417 = v$2396[3];
var v$2418 = v$2396[0];
var v$2419 = v$2396[6];
var v$2420 = v$2396[4];
return v$2415?0:(v$2394[0] = [1,[v$2418,true,[1],v$2417,v$2420,v$2416,v$2419]],0);
} };
 break; }default: {return tools$Crash$.impossible$50("StatObject.make_equality");
} };
 break; }case 1: {var v$2392 = v$2374[1];
var fix$8661 = {};
fix$8661.$apply = function(r$7549){lab$apply: while (true) {var v$7550 = findRecType$231(r$7549);
switch (v$7550[0]) { case 2: {return 0;
 break; }case 0: {return 0;
 break; }default: {var v$7551 = v$7550[1];
var v$7552 = v$7551[1];
var v$7553 = v$7551[2];
fix$8415.$make_equality0(v$7552);
var t$8662 = v$7553;
var r$7549 = t$8662;
continue lab$apply;
} };
};
};
var apply$7548 = fix$8661.$apply;
return apply$7548(v$2392);
 break; }case 2: {var v$2388 = v$2374[1];
var v$2389 = v$2388[0];
var v$2390 = v$2388[1];
var t$8660;
var t$8659;
var v$5934 = v$2390[2];
var v$5935 = special_objects$TyName$$1.tyName_REF$250[2];
var v$5936 = v$5934[0][1];
var v$5937 = v$5935[0][1];
t$8659 = ((v$5936[0] == v$5937[0])?(v$5936[1] == v$5937[1]):false);
if (t$8659) {t$8660 = true;
} else {var v$5941 = v$2390[2];
var v$5942 = special_objects$TyName$$1.tyName_ARRAY$254[2];
var v$5943 = v$5941[0][1];
var v$5944 = v$5942[0][1];
t$8660 = ((v$5943[0] == v$5944[0])?(v$5943[1] == v$5944[1]):false);
};
if (t$8660) {return 0;
} else {if (v$2390[1]) {var fix$8657 = {};
fix$8657.$app = function(v$5948){lab$app: while (true) {if (v$5948 == null) {return 0;
} else {var v$5949 = v$5948;
var v$5950 = v$5949[0];
var v$5951 = v$5949[1];
fix$8415.$make_equality0(v$5950);
var t$8658 = v$5951;
var v$5948 = t$8658;
continue lab$app;
};
};
};
var app$5947 = fix$8657.$app;
return app$5947(v$2389);
} else {throw exn$NotEquality$2346;
};
};
 break; }default: {throw exn$NotEquality$2346;
} };
};
var make_equality0$2347 = fix$8415.$make_equality0;
var restricted_unify$2435 = function(v$3286,v$2442){var v$3284 = v$2442[0];
var v$3285 = v$2442[1];
var en$Unify$2443 = new String("Unify");
var en$Rank$2444 = new String("Rank");
var fix$8416 = {};
fix$8416.$occurs_rv_in_RecType = function(v$2531,v$2532){var v$2520 = findRecType$231(v$2532);
switch (v$2520[0]) { case 2: {return false;
 break; }case 0: {return v$2531 == v$2520[1][0];
 break; }default: {var v$2528 = v$2520[1];
var v$2529 = v$2528[1];
var v$2530 = v$2528[2];
if (fix$8416.$occurs_rv_in_Type(v$2531,v$2529)) {return true;
} else {return fix$8416.$occurs_rv_in_RecType(v$2531,v$2530);
};
} };
};
fix$8416.$occurs_rv_in_Type = function(v$2576,v$2577){var v$2548 = (findType$193(v$2577))[0];
switch (v$2548[0]) { case 0: {return false;
 break; }case 3: {var v$2556 = v$2548[1];
var v$2557 = v$2556[0];
var v$2558 = v$2556[1];
if (fix$8416.$occurs_rv_in_Type(v$2576,v$2557)) {return true;
} else {return fix$8416.$occurs_rv_in_Type(v$2576,v$2558);
};
 break; }case 1: {var v$2550 = v$2548[1];
return fix$8416.$occurs_rv_in_RecType(v$2576,v$2550);
 break; }default: {var v$2570 = v$2548[1];
var v$2571 = v$2570[0];
var fix$8478 = {};
fix$8478.$foldl = function(v$5965,v$5966){lab$foldl: while (true) {if (v$5966 == null) {return v$5965;
} else {var v$5967 = v$5966;
var v$5968 = v$5967[0];
var v$5969 = v$5967[1];
var t$8479 = (fix$8416.$occurs_rv_in_Type(v$2576,v$5968))?true:v$5965;
var t$8480 = v$5969;
var v$5965 = t$8479;
var v$5966 = t$8480;
continue lab$foldl;
};
};
};
var foldl$5964 = fix$8478.$foldl;
return foldl$5964(false,v$2571);
} };
};
var occurs_rv_in_RecType$2507 = fix$8416.$occurs_rv_in_RecType;
var occurs_rv_in_Type$2506 = fix$8416.$occurs_rv_in_Type;
var fix$8417 = {};
fix$8417.$decr_level_Type = function(lev$2582,ty$2585){var ty$2586 = findType$193(ty$2585);
var v$2601 = ty$2586[0];
switch (v$2601[0]) { case 0: {var v$2617 = ty$2586[1];
return (v$2617[0] > lev$2582)?(v$2617[0] = lev$2582,0):0;
 break; }case 3: {var v$2609 = v$2601[1];
var v$2610 = v$2609[0];
var v$2611 = v$2609[1];
fix$8417.$decr_level_Type(lev$2582,v$2610);
return fix$8417.$decr_level_Type(lev$2582,v$2611);
 break; }case 2: {var v$2603 = v$2601[1];
var v$2604 = v$2603[0];
var fix$8476 = {};
fix$8476.$app = function(v$5981){lab$app: while (true) {if (v$5981 == null) {return 0;
} else {var v$5982 = v$5981;
var v$5983 = v$5982[0];
var v$5984 = v$5982[1];
fix$8417.$decr_level_Type(lev$2582,v$5983);
var t$8477 = v$5984;
var v$5981 = t$8477;
continue lab$app;
};
};
};
var app$5980 = fix$8476.$app;
return app$5980(v$2604);
 break; }default: {var v$2618 = v$2601[1];
return fix$8417.$decr_level_RecType(lev$2582,v$2618);
} };
};
fix$8417.$decr_level_RecType = function(lev$2621,r$2624){var r$2625 = findRecType$231(r$2624);
switch (r$2625[0]) { case 2: {return 0;
 break; }case 0: {var v$2640 = r$2625[1];
var v$2641 = v$2640[1];
return (v$2641[0] > lev$2621)?(v$2641[0] = lev$2621,0):0;
 break; }default: {var v$2644 = r$2625[1];
var v$2645 = v$2644[1];
var v$2646 = v$2644[2];
fix$8417.$decr_level_Type(lev$2621,v$2645);
return fix$8417.$decr_level_RecType(lev$2621,v$2646);
} };
};
var decr_level_Type$2579 = fix$8417.$decr_level_Type;
var decr_level_RecType$2578 = fix$8417.$decr_level_RecType;
var fix$8418 = {};
fix$8418.$decr_rank_Type = function(p$2653){var v$2702 = p$2653[0];
var v$2703 = p$2653[1];
return function(ty$2656){var ty$2657 = findType$193(ty$2656);
var v$2673 = ty$2657[0];
switch (v$2673[0]) { case 0: {var v$2689 = v$2673[1];
switch (v$2689[0][0]) { case 1: {var v$2695 = v$2689[0][1];
var v$2696 = v$2695[6];
return (v$2703 <= v$2696[0])?(v$2696[0] = v$2703,0):0;
 break; }default: {return tools$Crash$.impossible$50("StatObject.decr_rank_Type");
} };
 break; }case 3: {var v$2685 = v$2673[1];
var v$2686 = v$2685[0];
var v$2687 = v$2685[1];
(fix$8418.$decr_rank_Type(p$2653))(v$2686);
return (fix$8418.$decr_rank_Type(p$2653))(v$2687);
 break; }case 2: {var v$2679 = v$2673[1];
var v$2680 = v$2679[0];
var v$2681 = v$2679[1];
if (v$2681[3][0] <= v$2703) {var f$5992 = fix$8418.$decr_rank_Type(p$2653);
var fix$8474 = {};
fix$8474.$app = function(v$5995){lab$app: while (true) {if (v$5995 == null) {return 0;
} else {var v$5996 = v$5995;
var v$5997 = v$5996[0];
var v$5998 = v$5996[1];
f$5992(v$5997);
var t$8475 = v$5998;
var v$5995 = t$8475;
continue lab$app;
};
};
};
var app$5994 = fix$8474.$app;
return app$5994(v$2680);
} else {throw [en$Rank$2444,[v$2702,v$2681]];
};
 break; }default: {var v$2697 = v$2673[1];
return fix$8418.$decr_rank_RecType(p$2653,v$2697);
} };
};
};
fix$8418.$decr_rank_RecType = function(p$2708,r$2711){var r$2712 = findRecType$231(r$2711);
switch (r$2712[0]) { case 2: {return 0;
 break; }case 0: {return 0;
 break; }default: {var v$2724 = r$2712[1];
var v$2725 = v$2724[1];
var v$2726 = v$2724[2];
(fix$8418.$decr_rank_Type(p$2708))(v$2725);
return fix$8418.$decr_rank_RecType(p$2708,v$2726);
} };
};
var decr_rank_Type$2648 = fix$8418.$decr_rank_Type;
var decr_rank_RecType$2647 = fix$8418.$decr_rank_RecType;
var unify_with_tyvar$2817 = function(v$2829,v$8199){switch (v$2829[0][0]) { case 1: {var v$2855 = v$2829[0][1];
var v$2856 = v$2855[1];
var v$2857 = v$2855[5];
if (v$2856) {var v$2840;
try {v$2840 = [0,make_equality0$2347(v$8199)];
} catch(v$8419) {v$2840 = ((function(NotEquality$6027){var t$8420 = NotEquality$6027;
if (t$8420[0] == en$NotEquality$2346) {return [1];
} else {throw NotEquality$6027;
};
})(v$8419));
};
switch (v$2840[0]) { case 0: {v$2840[1];
 break; }default: {throw [en$Unify$2443,"unify_with_tyvar.1"];
} };
} else {basics$StatObject$.Id$836;
};
switch (v$2857[0]) { case 0: {var v$2850 = v$2857[1];
var tau$6029 = findType$193(v$8199);
var v$6030 = (findType$193(tau$6029))[0];
switch (v$6030[0]) { case 0: {var v$6031 = v$6030[1];
switch (v$6031[0][0]) { case 1: {var v$6032 = v$6031[0][1];
switch (v$6032[2][0]) { case 0: {throw [en$Unify$2443,"unify_with_overloaded_tyvar: explicit tyvar"];
 break; }default: {var v$6033 = v$6032[5];
switch (v$6033[0]) { case 1: {(v$6031[0] = [1,[v$6032[0],v$6032[1],[1],v$6032[3],v$6032[4],[0,v$2850],v$6032[6]]],0);
 break; }default: {var v$6041 = v$6032[1];
var v$6042 = v$6032[3];
var v$6043 = v$6032[0];
var v$6044 = v$6033[1];
var v$6045 = v$6032[6];
var v$6046 = v$6032[4];
var overloadSet$6047 = special_objects$TyName$$3.intersect$2726(v$2850,v$6044);
if (special_objects$TyName$$3.isEmpty$2409(overloadSet$6047)) {throw [en$Unify$2443,"unify_with_overloaded_tyvar: tyvars overloaded with distinct tynames"];
} else {0;
};
(v$6031[0] = [1,[v$6043,v$6041,[1],v$6042,v$6046,[0,overloadSet$6047],v$6045]],0);
} };
} };
 break; }default: {throw [en$Unify$2443,"unify_with_overloaded_tyvar: only overloaded to tynames"];
} };
 break; }case 2: {var v$6050 = v$6030[1];
var v$6051 = v$6050[1];
var t$8424;
var fix$8421 = {};
fix$8421.$exists = function(v$6053){lab$exists: while (true) {if (v$6053 == null) {return false;
} else {var v$6054 = v$6053;
var v$6055 = v$6054[0];
var v$6056 = v$6054[1];
var t$8422;
var v$6061 = v$6051[2];
var v$6062 = v$6055[2];
var v$6063 = v$6061[0][1];
var v$6064 = v$6062[0][1];
t$8422 = ((v$6063[0] == v$6064[0])?(v$6063[1] == v$6064[1]):false);
if (t$8422) {return true;
} else {var t$8423 = v$6056;
var v$6053 = t$8423;
continue lab$exists;
};
};
};
};
var exists$6052 = fix$8421.$exists;
t$8424 = (exists$6052(special_objects$TyName$$3.list$2937(v$2850)));
if (t$8424) {0;
} else {throw [en$Unify$2443,"unify_with_overloaded_tyvar: not overloaded to this tyname"];
};
 break; }default: {throw [en$Unify$2443,"unify_with_overloaded_tyvar: only overloaded to tynames"];
} };
 break; }default: {basics$StatObject$.Id$836;
} };
var t$8427;
var fix$8425 = {};
fix$8425.$member = function(v$7560){lab$member: while (true) {if (v$7560 == null) {return false;
} else {var v$7561 = v$7560;
var v$7562 = v$7561[0];
var v$7563 = v$7561[1];
if (v$2829 == v$7562) {return true;
} else {var t$8426 = v$7563;
var v$7560 = t$8426;
continue lab$member;
};
};
};
};
var member$7559 = fix$8425.$member;
t$8427 = (member$7559(v$3286));
if (t$8427) {throw [en$Unify$2443,"unify_with_tyvar.2"];
} else {return (v$2829[0] = [0,v$8199],0);
};
 break; }default: {return tools$Crash$.impossible$50("StatObject.unify_with_tyvar");
} };
};
var unifyTyVar$2949 = function(v$8200,v$8201){var rhs2$2972 = function(obj$3047){var v$3041 = v$8200[0];
var v$3042 = v$3041[1];
var v$3043 = v$3042[0][1];
var v$3044 = v$3043[6];
var v$3045 = v$8200[1];
if (v$3045[0] == (-1)) {return tools$Crash$.impossible$50("StatObject.unifyTyVar.GENERIC");
} else {decr_level_Type$2579(v$3045[0],v$8201);
(decr_rank_Type$2648([v$3042,v$3044[0]]))(v$8201);
var t$8438;
var t$8431;
var fix$8430 = {};
fix$8430.$occursType = function(ty$6115){var v$6116 = findType$193(ty$6115);
var v$6117 = v$6116[0];
switch (v$6117[0]) { case 0: {var v$6118 = v$6117[1];
return basics$StatObject$.eq$456(v$3042,v$6118);
 break; }case 3: {var v$6119 = v$6117[1];
var v$6120 = v$6119[0];
var v$6121 = v$6119[1];
if (fix$8430.$occursType(v$6120)) {return true;
} else {return fix$8430.$occursType(v$6121);
};
 break; }case 2: {var v$6122 = v$6117[1];
var v$6123 = v$6122[0];
var fix$8432 = {};
fix$8432.$foldl = function(v$6130,v$6131){lab$foldl: while (true) {if (v$6131 == null) {return v$6130;
} else {var v$6132 = v$6131;
var v$6133 = v$6132[0];
var v$6134 = v$6132[1];
var t$8433 = v$6130?true:(fix$8430.$occursType(v$6133));
var t$8434 = v$6134;
var v$6130 = t$8433;
var v$6131 = t$8434;
continue lab$foldl;
};
};
};
var foldl$6129 = fix$8432.$foldl;
return foldl$6129(false,v$6123);
 break; }default: {var v$6135 = v$6117[1];
var fix$8435 = {};
fix$8435.$fold = function(x$7570,r$7571){lab$fold: while (true) {var v$7572 = findRecType$231(r$7571);
switch (v$7572[0]) { case 2: {return x$7570;
 break; }case 0: {return x$7570;
 break; }default: {var v$7573 = v$7572[1];
var v$7574 = v$7573[1];
var v$7575 = v$7573[2];
var t$8436 = x$7570?true:(fix$8430.$occursType(v$7574));
var t$8437 = v$7575;
var x$7570 = t$8436;
var r$7571 = t$8437;
continue lab$fold;
} };
};
};
var fold$7569 = fix$8435.$fold;
return fold$7569(false,v$6135);
} };
};
var occursType$6114 = fix$8430.$occursType;
t$8431 = (occursType$6114(v$8201));
if (t$8431) {t$8438 = true;
} else {var fix$8428 = {};
fix$8428.$member = function(v$7580){lab$member: while (true) {if (v$7580 == null) {return false;
} else {var v$7581 = v$7580;
var v$7582 = v$7581[0];
var v$7583 = v$7581[1];
if (v$3042 == v$7582) {return true;
} else {var t$8429 = v$7583;
var v$7580 = t$8429;
continue lab$member;
};
};
};
};
var member$7579 = fix$8428.$member;
t$8438 = (member$7579(v$3286));
};
if (t$8438) {throw [en$Unify$2443,"unifyTyVar.2"];
} else {return unify_with_tyvar$2817(v$3042,v$8201);
};
};
};
var v$2981 = v$8200[0];
switch (v$2981[0]) { case 0: {var v$2983 = v$2981[1];
switch (v$2983[0][0]) { case 1: {var v$2985 = v$2983[0][1];
switch (v$2985[2][0]) { case 0: {var v$6153 = v$8200[0];
switch (v$6153[0]) { case 0: {var v$6154 = v$6153[1];
switch (v$6154[0][0]) { case 1: {var v$6155 = v$6154[0][1];
var v$6156 = v$6155[2];
switch (v$6156[0]) { case 0: {var v$6158 = v$8201[0];
switch (v$6158[0]) { case 0: {var v$6159 = v$6158[1];
switch (v$6159[0][0]) { case 1: {var v$6160 = v$6159[0][1];
switch (v$6160[2][0]) { case 0: {var v$6161 = v$8200[1];
var v$6162 = v$8201[1];
if (basics$StatObject$.eq$456(v$6154,v$6159)) {if (v$6161[0] == v$6162[0]) {return 0;
} else {throw [en$Unify$2443,"unifyExplicit.level"];
};
} else {throw [en$Unify$2443,"unifyExplicit.eq"];
};
 break; }default: {var v$6163 = v$6156[1];
var v$6164 = v$8200[1];
var v$6165 = v$8201[1];
var v$6166 = v$6160[1];
var v$7210 = syntax_objects$SyntaxTyVar$.isEquality$59(v$6163);
if (v$6166) {if (v$7210) {0;
} else {throw [en$Unify$2443,"unifyExplicit.2"];
};
} else {0;
};
var t$8443;
var fix$8441 = {};
fix$8441.$member = function(v$6185){lab$member: while (true) {if (v$6185 == null) {return false;
} else {var v$6186 = v$6185;
var v$6187 = v$6186[0];
var v$6188 = v$6186[1];
if (v$6159 == v$6187) {return true;
} else {var t$8442 = v$6188;
var v$6185 = t$8442;
continue lab$member;
};
};
};
};
var member$6184 = fix$8441.$member;
t$8443 = (member$6184(v$3286));
if (t$8443) {throw [en$Unify$2443,"unifyExplicit.3"];
} else {var t$8440;
var t$8439;
switch (v$6159[0][0]) { case 1: {t$8439 = v$6159[0][1][5];
 break; }default: {t$8439 = (tools$Crash$.impossible$50("StatObject.TyVar.get_overloaded"));
} };
switch (t$8439[0]) { case 0: {t$8440 = true;
 break; }default: {t$8440 = false;
} };
if (t$8440) {throw [en$Unify$2443,"unifyExplicit.4"];
} else {if (v$6165[0] < v$6164[0]) {throw [en$Unify$2443,"unifyExplicit.5"];
} else {return (v$6159[0] = [0,v$8200],0);
};
};
};
} };
 break; }default: {throw [en$Unify$2443,"unifyExplicit.7"];
} };
 break; }default: {throw [en$Unify$2443,"unifyExplicit.7"];
} };
 break; }default: {throw [en$Unify$2443,"unifyExplicit.7"];
} };
 break; }default: {throw [en$Unify$2443,"unifyExplicit.7"];
} };
 break; }default: {throw [en$Unify$2443,"unifyExplicit.7"];
} };
 break; }default: {var v$2990 = v$8201[0];
switch (v$2990[0]) { case 0: {var v$2992 = v$2990[1];
switch (v$2992[0][0]) { case 1: {var v$3019 = v$2985[6];
var v$3020 = v$8200[1];
var v$3021 = v$2992[0][1];
var v$3022 = v$3021[6];
var v$3023 = v$8201[1];
var r$$2960 = v$3022[0];
var r$2965 = v$3019[0];
if (basics$StatObject$.eq$456(v$2983,v$2992)) {if (v$3020[0] == v$3023[0]) {return 0;
} else {return tools$Crash$.impossible$50("StatObject.unifyTyVar");
};
} else {var rank$3002 = (r$2965 < r$$2960)?r$2965:r$$2960;
(v$3019[0] = rank$3002,0);
(v$3022[0] = rank$3002,0);
var t$8449;
var fix$8447 = {};
fix$8447.$member = function(v$7592){lab$member: while (true) {if (v$7592 == null) {return false;
} else {var v$7593 = v$7592;
var v$7594 = v$7593[0];
var v$7595 = v$7593[1];
if (v$2983 == v$7594) {return true;
} else {var t$8448 = v$7595;
var v$7592 = t$8448;
continue lab$member;
};
};
};
};
var member$7591 = fix$8447.$member;
t$8449 = (member$7591(v$3286));
if (t$8449) {var t$8446;
var fix$8444 = {};
fix$8444.$member = function(v$7600){lab$member: while (true) {if (v$7600 == null) {return false;
} else {var v$7601 = v$7600;
var v$7602 = v$7601[0];
var v$7603 = v$7601[1];
if (v$2992 == v$7602) {return true;
} else {var t$8445 = v$7603;
var v$7600 = t$8445;
continue lab$member;
};
};
};
};
var member$7599 = fix$8444.$member;
t$8446 = (member$7599(v$3286));
if (t$8446) {throw [en$Unify$2443,"unifyTyVar"];
} else {var t$8451 = v$3020;
var t$8450;
var v$7235 = v$3020[0];
var v$7236 = v$3023[0];
t$8450 = ((v$7235 < v$7236)?v$7235:v$7236);
(t$8451[0] = t$8450,0);
return unify_with_tyvar$2817(v$2992,v$8200);
};
} else {var t$8453 = v$3023;
var t$8452;
var v$7239 = v$3020[0];
var v$7240 = v$3023[0];
t$8452 = ((v$7239 < v$7240)?v$7239:v$7240);
(t$8453[0] = t$8452,0);
return unify_with_tyvar$2817(v$2983,v$8201);
};
};
 break; }default: {return rhs2$2972(0);
} };
 break; }default: {return rhs2$2972(0);
} };
} };
 break; }default: {return tools$Crash$.impossible$50("StatObject.unifyTyVar");
} };
 break; }default: {return tools$Crash$.impossible$50("StatObject.unifyTyVar");
} };
};
var extract$3054 = function(v$3149,v$3150){var row$3123 = findRecType$231(v$3150);
var fix$8454 = {};
fix$8454.$rowVar = function(v$3127){lab$rowVar: while (true) {switch (v$3127[0]) { case 2: {return [1];
 break; }case 0: {var v$3137 = v$3127[1];
return [0,v$3137];
 break; }default: {var v$3138 = v$3127[1];
var v$3139 = v$3138[2];
var t$8455 = findRecType$231(v$3139);
var v$3127 = t$8455;
continue lab$rowVar;
} };
};
};
var rowVar$3124 = fix$8454.$rowVar;
var v$3144 = rowVar$3124(row$3123);
switch (v$3144[0]) { case 1: {throw [en$Unify$2443,"extract"];
 break; }default: {var v$3148 = v$3144[1];
var littleRow$3145;
var t$8467;
var t$8466 = v$3149;
var t$8465;
var t$8464;
var t$8461;
var v$7607 = [1];
var v$7608 = [1];
var t$8463;
var t$8462;
var v$7609;
(r$588[0] = (SmlPrims.chk_ovf_i32(r$588[0] + 1)),0);
v$7609 = r$588[0];
var v$7610 = special_objects$Name$.baseGet$56(0);
var v$7611 = [special_objects$TyName$$1.current$72(0)];
t$8462 = [v$7610,false,v$7607,v$7609,[[1]],v$7608,v$7611];
t$8463 = [1,t$8462];
t$8461 = [t$8463];
t$8464 = [0,t$8461];
t$8465 = [t$8464,[level_ref$142[0]]];
var t$8460;
var t$8459;
var t$8458;
var t$8457;
var t$8456;
(r$862[0] = (SmlPrims.chk_ovf_i32(r$862[0] + 1)),0);
t$8456 = r$862[0];
t$8457 = [1,t$8456];
t$8458 = [t$8457];
t$8459 = [t$8458,[level_ref$142[0]]];
t$8460 = [0,t$8459];
t$8467 = [t$8466,t$8465,t$8460];
littleRow$3145 = [1,t$8467];
var v$6241 = v$3148[0];
var v$6242 = v$3148[1];
decr_level_RecType$2578(v$6242[0],littleRow$3145);
if (occurs_rv_in_RecType$2507(v$6241,littleRow$3145)) {throw [en$Unify$2443,"unifyRowVar"];
} else {(v$6241[0] = [0,littleRow$3145],0);
};
return row$3123;
} };
};
var fix$8468 = {};
fix$8468.$unifyRow$ = function(v$3240,v$3241){if (RecType_eq$1158([v$3240,v$3241])) {return 0;
} else {switch (v$3240[0]) { case 2: {switch (v$3241[0]) { case 2: {return basics$StatObject$.Id$836;
 break; }case 0: {var v$6269 = v$3241[1];
var v$6272 = v$6269[0];
var v$6273 = v$6269[1];
decr_level_RecType$2578(v$6273[0],v$3240);
if (occurs_rv_in_RecType$2507(v$6272,v$3240)) {throw [en$Unify$2443,"unifyRowVar"];
} else {return (v$6272[0] = [0,v$3240],0);
};
 break; }default: {throw [en$Unify$2443,"unifyRow'"];
} };
 break; }default: {switch (v$3241[0]) { case 0: {var v$6279 = v$3241[1];
var v$6282 = v$6279[0];
var v$6283 = v$6279[1];
decr_level_RecType$2578(v$6283[0],v$3240);
if (occurs_rv_in_RecType$2507(v$6282,v$3240)) {throw [en$Unify$2443,"unifyRowVar"];
} else {return (v$6282[0] = [0,v$3240],0);
};
 break; }default: {switch (v$3240[0]) { case 0: {var v$3216 = v$3240[1];
var v$6288 = v$3216[0];
var v$6289 = v$3216[1];
decr_level_RecType$2578(v$6289[0],v$3241);
if (occurs_rv_in_RecType$2507(v$6288,v$3241)) {throw [en$Unify$2443,"unifyRowVar"];
} else {return (v$6288[0] = [0,v$3241],0);
};
 break; }default: {switch (v$3241[0]) { case 1: {var v$3232 = v$3240[1];
var v$3233 = v$3232[0];
var v$3234 = v$3232[1];
var v$3235 = v$3232[2];
var v$3236 = v$3241[1];
var v$3237 = v$3236[0];
var v$3238 = v$3236[1];
var v$3239 = v$3236[2];
if (syntax_objects$Lab$.eq_lab$138(v$3233,v$3237)) {fix$8468.$unifyType(v$3234,v$3238);
return fix$8468.$unifyRow(v$3235,v$3239);
} else {if (syntax_objects$Lab$.s$j$49(v$3233,v$3237)) {extract$3054(v$3233,v$3241);
return fix$8468.$unifyRow(v$3240,v$3241);
} else {extract$3054(v$3237,v$3240);
return fix$8468.$unifyRow(v$3240,v$3241);
};
};
 break; }default: {throw [en$Unify$2443,"unifyRow'"];
} };
} };
} };
} };
};
};
fix$8468.$unifyRow = function(v$3161,v$3162){var v$7257 = sort$1788(v$3161);
var v$7258 = sort$1788(v$3162);
return fix$8468.$unifyRow$(v$7257,v$7258);
};
fix$8468.$unifyRecType = function(v$3117,v$3118){return fix$8468.$unifyRow(v$3117,v$3118);
};
fix$8468.$unifyFunType = function(v$3250,v$8203){var v$3251 = v$3250[0];
var v$3252 = v$3250[1];
var v$3254 = v$8203[0];
var v$3255 = v$8203[1];
fix$8468.$unifyType(v$3251,v$3254);
return fix$8468.$unifyType(v$3252,v$3255);
};
fix$8468.$unifyType = function(v$3111,v$3112){var v$7253 = findType$193(v$3111);
var v$7254 = findType$193(v$3112);
var v$7255 = v$7253[0];
var v$7256 = v$7254[0];
switch (v$7255[0]) { case 0: {return unifyTyVar$2949(v$7253,v$7254);
 break; }default: {switch (v$7256[0]) { case 0: {return unifyTyVar$2949(v$7254,v$7253);
 break; }default: {switch (v$7255[0]) { case 1: {switch (v$7256[0]) { case 1: {var v$3095 = v$7255[1];
var v$3096 = v$7256[1];
return fix$8468.$unifyRecType(v$3095,v$3096);
 break; }default: {throw [en$Unify$2443,"unifyType"];
} };
 break; }case 3: {switch (v$7256[0]) { case 3: {var v$3090 = v$7255[1];
var v$3091 = v$7256[1];
return fix$8468.$unifyFunType(v$3090,v$3091);
 break; }default: {throw [en$Unify$2443,"unifyType"];
} };
 break; }default: {switch (v$7256[0]) { case 2: {var v$3098 = v$7255[1];
var v$3099 = v$7256[1];
return fix$8468.$unifyConsType(v$3098,v$3099);
 break; }default: {throw [en$Unify$2443,"unifyType"];
} };
} };
} };
} };
};
fix$8468.$unifyConsType = function(v$3266,v$8202){var v$3267 = v$3266[0];
var v$3268 = v$3266[1];
var v$3270 = v$8202[0];
var v$3271 = v$8202[1];
var t$8473;
var v$6248 = v$3268[2];
var v$6249 = v$3271[2];
var v$6250 = v$6248[0][1];
var v$6251 = v$6249[0][1];
t$8473 = ((v$6250[0] == v$6251[0])?(v$6250[1] == v$6251[1]):false);
if (t$8473) {var fix$8471 = {};
fix$8471.$app = function(v$6254){lab$app: while (true) {if (v$6254 == null) {return 0;
} else {var v$6255 = v$6254;
var v$6256 = v$6255[0];
var v$6257 = v$6255[1];
fix$8468.$unifyType(v$6256[0],v$6256[1]);
var t$8472 = v$6257;
var v$6254 = t$8472;
continue lab$app;
};
};
};
var app$6253 = fix$8471.$app;
return app$6253(basis$ListPair$.zip$46(v$3267,v$3270));
} else {throw [en$Unify$2443,"unifyConsType"];
};
};
var unifyRow$$3051 = fix$8468.$unifyRow$;
var unifyRow$3053 = fix$8468.$unifyRow;
var unifyRecType$3055 = fix$8468.$unifyRecType;
var unifyFunType$3050 = fix$8468.$unifyFunType;
var unifyType$3056 = fix$8468.$unifyType;
var unifyConsType$3049 = fix$8468.$unifyConsType;
try {unifyType$3056(v$3284,v$3285);
return [1];
} catch(v$8469) {return (function(v$3281){var t$8470 = v$3281;
if (t$8470[0] == en$Unify$2443) {var s$3274 = v$3281[1];
return [2,s$3274];
} else {if (t$8470[0] == en$Rank$2444) {return [0,[v$3281[1][0],v$3281[1][1]]];
} else {throw v$3281;
};
};
})(v$8469);
};
};
basics$StatObject$.unify$3287 = function(v$3292,v$3293){return restricted_unify$2435(null,[v$3292,v$3293]);
};
var fix$8481 = {};
fix$8481.$match_Types = function(v$3380,v$8204){if (v$3380 == null) {return 0;
} else {if (v$8204 == null) {return 0;
} else {var v$3384 = v$3380;
var v$3385 = v$3384[0];
var v$3386 = v$3384[1];
var v$3387 = v$8204;
var v$3388 = v$3387[0];
var v$3389 = v$3387[1];
fix$8481.$match_Type(v$3385,v$3388);
return fix$8481.$match_Types(v$3386,v$3389);
};
};
};
fix$8481.$match_Type = function(v$3365,v$3366){var v$7279 = findType$193(v$3365);
var v$7280 = findType$193(v$3366);
var v$7281 = v$7279[0];
var v$7282 = v$7280[0];
switch (v$7281[0]) { case 3: {switch (v$7282[0]) { case 3: {var v$3348 = v$7281[1];
var v$3349 = v$3348[0];
var v$3350 = v$3348[1];
var v$3351 = v$7282[1];
var v$3352 = v$3351[0];
var v$3353 = v$3351[1];
fix$8481.$match_Type(v$3349,v$3352);
return fix$8481.$match_Type(v$3350,v$3353);
 break; }default: {return 0;
} };
 break; }case 1: {switch (v$7282[0]) { case 1: {var v$3341 = v$7281[1];
var v$3342 = v$7282[1];
return fix$8481.$match_RecType(v$3341,v$3342);
 break; }default: {return 0;
} };
 break; }case 2: {switch (v$7282[0]) { case 2: {var v$3331 = v$7281[1];
var v$3332 = v$3331[0];
var v$3333 = v$3331[1];
var v$3334 = v$7282[1];
var v$3335 = v$3334[0];
var v$3336 = v$3334[1];
fix$8481.$match_Types(v$3332,v$3335);
return special_objects$TyName$$1.match$157(v$3333,v$3336);
 break; }default: {return 0;
} };
 break; }default: {return 0;
} };
};
fix$8481.$match_RecType = function(v$3424,v$3425){var v$7275 = findRecType$231(v$3424);
var v$7276 = findRecType$231(v$3425);
switch (v$7275[0]) { case 1: {switch (v$7276[0]) { case 1: {var v$3415 = v$7275[1];
var v$3416 = v$3415[0];
var v$3417 = v$3415[1];
var v$3418 = v$3415[2];
var v$3419 = v$7276[1];
var v$3420 = v$3419[0];
var v$3421 = v$3419[1];
var v$3422 = v$3419[2];
if ((syntax_objects$Lab$.eq_lab$138(v$3416,v$3420))?false:true) {return 0;
} else {fix$8481.$match_Type(v$3417,v$3421);
return fix$8481.$match_RecType(v$3418,v$3422);
};
 break; }default: {return 0;
} };
 break; }default: {return 0;
} };
};
var match_Types$3295 = fix$8481.$match_Types;
var match_Type$3296 = fix$8481.$match_Type;
var match_RecType$3294 = fix$8481.$match_RecType;
basics$StatObject$.match$3426 = function(v$8205){return match_Type$3296(v$8205[0],v$8205[1]);
};
basics$StatObject$.pu$3427 = pickle$pickle$.convert$2333([function(a$3430){return a$3430;
},function(v$8314){return norm_Type$285(v$8314);
}],pu_Type$440);
basics$StatObject$.pretty_string$3431 = function(tvn$3434,v$3437){var v$3438 = v$3437[1];
return pretty_string_as_opt$1280(tvn$3434,1,[v$3438,[1]]);
};
basics$StatObject$.layout$3439 = function(v$3449,v$3450){var t$8482;
var v$3444 = ("all" + (pr_tyvars$809(v$3449))) + ".";
var v$3447 = [1];
t$8482 = [[basics$StatObject$.layout$870(v$3450),null],v$3447,"",1,v$3444];
return [0,t$8482];
};
basics$StatObject$.string$3451 = function(v$3456,v$3457){return (("all" + (pr_tyvars$809(v$3456))) + ".") + (basics$StatObject$.string$1508(v$3457));
};
var instance_with_types$3465 = function(v$8206,v$8207){var rhs1$3474 = function(obj$3563){var v$3560 = v$8206[0];
var v$3561 = v$8206[1];
var fix$8483 = {};
fix$8483.$instanceType = function(ty$3486){var ty$3487 = findType$193(ty$3486);
var v$3532 = ty$3487[0];
var v$3533 = ty$3487[1];
var t$8490;
var v$7293 = v$3533[0];
t$8490 = ((v$7293 == (-1))?false:true);
if (t$8490) {return ty$3487;
} else {switch (v$3532[0]) { case 0: {var v$3522 = v$3532[1];
switch (v$3522[0][0]) { case 1: {var v$3524 = v$3522[0][1];
var v$3525 = v$3524[4];
switch (v$3525[0][0]) { case 0: {return v$3525[0][1];
 break; }default: {return tools$Crash$.impossible$50("StatObject.instanceType.generic tyvar not instantiated");
} };
 break; }default: {return tools$Crash$.impossible$50("StatObject.instanceType.findType doesn't work");
} };
 break; }case 3: {var v$3518 = v$3532[1];
var v$3519 = v$3518[0];
var v$3520 = v$3518[1];
return [[3,[fix$8483.$instanceType(v$3519),fix$8483.$instanceType(v$3520)]],[0]];
 break; }case 1: {var v$3516 = v$3532[1];
return [[1,fix$8483.$instanceRecType(v$3516)],[0]];
 break; }default: {var v$3528 = v$3532[1];
var v$3529 = v$3528[0];
var v$3530 = v$3528[1];
var t$8494;
var t$8493;
var t$8492;
var fix$8491 = {};
fix$8491.$map = function(v$6329){if (v$6329 == null) {return null;
} else {var v$6330 = v$6329;
var v$6331 = v$6330[0];
var v$6332 = v$6330[1];
return [fix$8483.$instanceType(v$6331),fix$8491.$map(v$6332)];
};
};
var map$6328 = fix$8491.$map;
t$8492 = (map$6328(v$3529));
t$8493 = [t$8492,v$3530];
t$8494 = [2,t$8493];
return [t$8494,[0]];
} };
};
};
fix$8483.$instanceRecType = function(r$3536){var r$3537 = findRecType$231(r$3536);
switch (r$3537[0]) { case 2: {return r$3537;
 break; }case 0: {return r$3537;
 break; }default: {var v$3550 = r$3537[1];
var v$3551 = v$3550[0];
var v$3552 = v$3550[1];
var v$3553 = v$3550[2];
return [1,[v$3551,fix$8483.$instanceType(v$3552),fix$8483.$instanceRecType(v$3553)]];
} };
};
var instanceType$3483 = fix$8483.$instanceType;
var instanceRecType$3482 = fix$8483.$instanceRecType;
var tvs_with_types$3554;
try {tvs_with_types$3554 = (tools$BasisCompat$.zipEq$46(v$3560,v$8207));
} catch(v$8484) {tvs_with_types$3554 = ((function(BasisCompat$ListPair$UnequalLengths$3557){var t$8485 = BasisCompat$ListPair$UnequalLengths$3557;
if (t$8485[0] == tools$BasisCompat$.en$UnequalLengths$45) {return tools$Crash$.impossible$50("StatObject.instance_with_types.wrong number of types");
} else {throw BasisCompat$ListPair$UnequalLengths$3557;
};
})(v$8484));
};
var fix$8486 = {};
fix$8486.$app = function(v$6338){lab$app: while (true) {if (v$6338 == null) {return 0;
} else {var v$6339 = v$6338;
var v$6340 = v$6339[0];
var v$6341 = v$6339[1];
var v$7614 = v$6340[0];
switch (v$7614[0][0]) { case 1: {var v$7615 = v$7614[0][1];
var v$7616 = v$7615[4];
var v$7617 = v$6340[1];
switch (v$7616[0][0]) { case 0: {tools$Crash$.impossible$50("StatObject.set_instance.tyvar already instantiated");
 break; }default: {(v$7616[0] = [0,v$7617],0);
} };
 break; }default: {tools$Crash$.impossible$50("StatObject.set_instance.link");
} };
var t$8487 = v$6341;
var v$6338 = t$8487;
continue lab$app;
};
};
};
var app$6337 = fix$8486.$app;
app$6337(tvs_with_types$3554);
var tau$$3558 = instanceType$3483(v$3561);
var fix$8488 = {};
fix$8488.$app = function(v$6355){lab$app: while (true) {if (v$6355 == null) {return 0;
} else {var v$6356 = v$6355;
var v$6357 = v$6356[0];
var v$6358 = v$6356[1];
switch (v$6357[0][0]) { case 1: {var v$7619 = v$6357[0][1];
var v$7620 = v$7619[4];
switch (v$7620[0][0]) { case 0: {(v$7620[0] = [1],0);
 break; }default: {tools$Crash$.impossible$50("StatObject.unset_instance.tyvar not instantiated");
} };
 break; }default: {tools$Crash$.impossible$50("StatObject.unset_instance.link");
} };
var t$8489 = v$6358;
var v$6355 = t$8489;
continue lab$app;
};
};
};
var app$6354 = fix$8488.$app;
app$6354(v$3560);
return tau$$3558;
};
if (v$8206[0] == null) {if (v$8207 == null) {return v$8206[1];
} else {return rhs1$3474(0);
};
} else {return rhs1$3474(0);
};
};
basics$StatObject$.instance$$3564 = function(sigma$3569){var v$3583 = sigma$3569[0];
var types$3582;
var fix$8495 = {};
fix$8495.$map = function(v$6380){if (v$6380 == null) {return null;
} else {var v$6381 = v$6380;
var v$6382 = v$6381[0];
var v$6383 = v$6381[1];
var t$8503;
var t$8496;
switch (v$6382[0][0]) { case 1: {v$6382[0][1];
var t$8500;
var t$8497;
switch (v$6382[0][0]) { case 1: {var v$7631 = v$6382[0][1];
var v$7632 = v$7631[1];
var v$7633 = v$7631[5];
var v$7634 = [1];
var t$8499;
var t$8498;
var v$7635;
(r$588[0] = (SmlPrims.chk_ovf_i32(r$588[0] + 1)),0);
v$7635 = r$588[0];
var v$7636 = special_objects$Name$.baseGet$56(0);
var v$7637 = [special_objects$TyName$$1.current$72(0)];
t$8498 = [v$7636,v$7632,v$7634,v$7635,[[1]],v$7633,v$7637];
t$8499 = [1,t$8498];
t$8497 = [t$8499];
 break; }default: {t$8497 = (tools$Crash$.impossible$50("StatObject.TyVar.refresh"));
} };
t$8500 = [0,t$8497];
t$8496 = [t$8500,[level_ref$142[0]]];
 break; }default: {var s$7638;
var t$8502 = "instance'.fresh: tysch= ";
var t$8501;
var v$7639 = sigma$3569[0];
var v$7640 = sigma$3569[1];
t$8501 = ((("all" + (pr_tyvars$809(v$7639))) + ".") + (basics$StatObject$.string$1508(v$7640)));
s$7638 = (t$8502 + t$8501);
t$8496 = (tools$Crash$.impossible$50("StatObject." + s$7638));
} };
t$8503 = [t$8496,fix$8495.$map(v$6383)];
return t$8503;
};
};
var map$6379 = fix$8495.$map;
types$3582 = (map$6379(v$3583));
return [instance_with_types$3465(sigma$3569,types$3582),types$3582];
};
basics$StatObject$.instance$3585 = function(sigma$3588){return (basics$StatObject$.instance$$3564(sigma$3588))[0];
};
basics$StatObject$.eq$3593 = function(v$8208,v$8209){var rhs1$3604 = function(obj$3637){var v$3634 = v$8208[0];
var v$3636 = v$8209[0];
var t$8513;
var t$8512;
var fix$8509 = {};
fix$8509.$acc = function(v$6396,v$6397){lab$acc: while (true) {if (v$6396 == null) {return v$6397;
} else {var v$6398 = v$6396;
var v$6399 = v$6398[1];
var t$8510 = v$6399;
var t$8511 = SmlPrims.chk_ovf_i32(v$6397 + 1);
var v$6396 = t$8510;
var v$6397 = t$8511;
continue lab$acc;
};
};
};
var acc$6395 = fix$8509.$acc;
t$8512 = (acc$6395(v$3634,0));
var t$8508;
var fix$8505 = {};
fix$8505.$acc = function(v$6402,v$6403){lab$acc: while (true) {if (v$6402 == null) {return v$6403;
} else {var v$6404 = v$6402;
var v$6405 = v$6404[1];
var t$8506 = v$6405;
var t$8507 = SmlPrims.chk_ovf_i32(v$6403 + 1);
var v$6402 = t$8506;
var v$6403 = t$8507;
continue lab$acc;
};
};
};
var acc$6401 = fix$8505.$acc;
t$8508 = (acc$6401(v$3636,0));
t$8513 = (t$8512 == t$8508);
if (t$8513) {var types$3630;
var fix$8504 = {};
fix$8504.$map = function(v$6419){if (v$6419 == null) {return null;
} else {var v$6420 = v$6419;
var v$6421 = v$6420[0];
var v$6422 = v$6420[1];
var t$8521;
var t$8514;
switch (v$6421[0][0]) { case 1: {v$6421[0][1];
var t$8518;
var t$8515;
switch (v$6421[0][0]) { case 1: {var v$7651 = v$6421[0][1];
var v$7652 = v$7651[1];
var v$7653 = v$7651[5];
var v$7654 = [1];
var t$8517;
var t$8516;
var v$7655;
(r$588[0] = (SmlPrims.chk_ovf_i32(r$588[0] + 1)),0);
v$7655 = r$588[0];
var v$7656 = special_objects$Name$.baseGet$56(0);
var v$7657 = [special_objects$TyName$$1.current$72(0)];
t$8516 = [v$7656,v$7652,v$7654,v$7655,[[1]],v$7653,v$7657];
t$8517 = [1,t$8516];
t$8515 = [t$8517];
 break; }default: {t$8515 = (tools$Crash$.impossible$50("StatObject.TyVar.refresh"));
} };
t$8518 = [0,t$8515];
t$8514 = [t$8518,[level_ref$142[0]]];
 break; }default: {var s$7658;
var t$8520 = "eq.fresh: tysch= ";
var t$8519;
var v$7659 = v$8208[0];
var v$7660 = v$8208[1];
t$8519 = ((("all" + (pr_tyvars$809(v$7659))) + ".") + (basics$StatObject$.string$1508(v$7660)));
s$7658 = (t$8520 + t$8519);
t$8514 = (tools$Crash$.impossible$50("StatObject." + s$7658));
} };
t$8521 = [t$8514,fix$8504.$map(v$6422)];
return t$8521;
};
};
var map$6418 = fix$8504.$map;
types$3630 = (map$6418(v$3634));
var ty1$3631 = instance_with_types$3465(v$8208,types$3630);
var ty2$3632 = instance_with_types$3465(v$8209,types$3630);
return basics$StatObject$.eq$1159([ty1$3631,ty2$3632]);
} else {return false;
};
};
if (v$8208[0] == null) {if (v$8209[0] == null) {var v$3612 = v$8208[1];
var v$3613 = v$8209[1];
return basics$StatObject$.eq$1159([v$3612,v$3613]);
} else {return rhs1$3604(0);
};
} else {return rhs1$3604(0);
};
};
basics$StatObject$.to_TyVars_and_Type$3638 = function(x$3641){return x$3641;
};
basics$StatObject$.from_Type$3642 = function(tau$3645){return [null,tau$3645];
};
basics$StatObject$.tyvars$3646 = function(v$8210,v$3650){var f_b$6434 = 0;
(bucket$1821[0] = null,0);
tyvars0$1833(f_b$6434,v$3650);
return bucket$1821[0];
};
basics$StatObject$.tynames$3651 = function(v$8211,v$3655){return basics$StatObject$.tynames$1920(v$3655);
};
basics$StatObject$.generalises_Type$3656 = function(v$3668,v$3669){var fv_sigma$3661;
var v$6438 = v$3668[1];
var f_b$6440 = 0;
(bucket$1821[0] = null,0);
tyvars0$1833(f_b$6440,v$6438);
fv_sigma$3661 = bucket$1821[0];
var tau$3662 = (basics$StatObject$.instance$$3564(v$3668))[0];
var fv_tau$$3663;
var f_b$6444 = 0;
(bucket$1821[0] = null,0);
tyvars0$1833(f_b$6444,v$3669);
fv_tau$$3663 = bucket$1821[0];
switch ((restricted_unify$2435(basics$StatObject$.unionTyVarSet$779(fv_tau$$3663,fv_sigma$3661),[tau$3662,v$3669]))[0]) { case 1: {return true;
 break; }default: {return false;
} };
};
basics$StatObject$.generalises_TypeScheme$3670 = function(v$3697,v$3698){var v$3699 = v$3698[0];
var v$3700 = v$3698[1];
var t$8525;
var v$7347;
var t$8524 = basics$StatObject$.intersectTyVarSet$799;
var t$8523 = v$3699;
var t$8522;
var v$6462 = v$3697[1];
var f_b$6464 = 0;
(bucket$1821[0] = null,0);
tyvars0$1833(f_b$6464,v$6462);
t$8522 = bucket$1821[0];
v$7347 = (t$8524(t$8523,t$8522));
var v$7348 = null;
var fix$8526 = {};
fix$8526.$eq_list = function(v$8286,v$8287){lab$eq_list: while (true) {if (v$8286 == null) {return (v$8287 == null)?true:false;
} else {if (v$8287 == null) {return false;
} else {var v$8288 = v$8286;
var v$8289 = v$8287;
if (v$8288[0] == v$8289[0]) {var t$8527 = v$8288[1];
var t$8528 = v$8289[1];
var v$8286 = t$8527;
var v$8287 = t$8528;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$8285 = fix$8526.$eq_list;
t$8525 = (eq_list$8285(v$7347,v$7348));
if (t$8525) {var fv_sigma$3690;
var v$6467 = v$3697[1];
var f_b$6469 = 0;
(bucket$1821[0] = null,0);
tyvars0$1833(f_b$6469,v$6467);
fv_sigma$3690 = bucket$1821[0];
var tau$3691 = (basics$StatObject$.instance$$3564(v$3697))[0];
var fv_tau$$3692;
var b$6473;
var f_b$6495 = 0;
(bucket$1821[0] = null,0);
tyvars0$1833(f_b$6495,v$3700);
b$6473 = bucket$1821[0];
var fix$8529 = {};
fix$8529.$foldl = function(v$6476,v$6477){if (v$6477 == null) {return v$6476;
} else {var v$6478 = v$6477;
var v$6479 = v$6478[0];
var v$6480 = v$6478[1];
var t$8534 = fix$8529.$foldl;
var t$8533;
var t$8532;
var fix$8530 = {};
fix$8530.$exists = function(v$7674){lab$exists: while (true) {if (v$7674 == null) {return false;
} else {var v$7675 = v$7674;
var v$7676 = v$7675[0];
var v$7677 = v$7675[1];
if (basics$StatObject$.eq$456(v$6479,v$7676)) {return true;
} else {var t$8531 = v$7677;
var v$7674 = t$8531;
continue lab$exists;
};
};
};
};
var exists$7673 = fix$8530.$exists;
t$8532 = (exists$7673(v$6476));
t$8533 = (t$8532?v$6476:[v$6479,v$6476]);
return t$8534(t$8533,v$6480);
};
};
var foldl$6475 = fix$8529.$foldl;
fv_tau$$3692 = (foldl$6475(b$6473,v$3699));
switch ((restricted_unify$2435(basics$StatObject$.unionTyVarSet$779(fv_tau$$3692,fv_sigma$3690),[tau$3691,v$3700]))[0]) { case 1: {return true;
 break; }default: {return false;
} };
} else {return false;
};
};
basics$StatObject$.close_overload$3701 = function(tau$3704){var t$8535;
generalise$2224(true,true,tau$3704);
0;
var f_b$6500 = 1;
(bucket$1821[0] = null,0);
tyvars0$1833(f_b$6500,tau$3704);
t$8535 = bucket$1821[0];
return [t$8535,tau$3704];
};
basics$StatObject$.close$3711 = function(v$3714,v$3717){if (v$3717[0] == null) {var v$3733 = v$3717[1];
var t$8536;
generalise$2224(v$3714,false,v$3733);
0;
var f_b$6505 = 1;
(bucket$1821[0] = null,0);
tyvars0$1833(f_b$6505,v$3733);
t$8536 = bucket$1821[0];
return [t$8536,v$3733];
} else {return tools$Crash$.impossible$50("StatObject.TypeScheme.close");
};
};
basics$StatObject$.violates_equality$3791 = function(T$3794,sigma$3797){var v$3808 = sigma$3797[1];
var v$3804;
var v$6522 = (findType$193(v$3808))[0];
switch (v$6522[0]) { case 3: {var v$6523 = v$6522[1];
v$3804 = [0,[v$6523[0],v$6523[1]]];
 break; }default: {v$3804 = [1];
} };
switch (v$3804[0]) { case 1: {return false;
 break; }default: {var v$3805 = v$3804[1];
var v$3806 = v$3805[0];
var fix$8537 = {};
fix$8537.$violates_equality0 = function(tau$7694){var v$7695 = (findType$193(tau$7694))[0];
switch (v$7695[0]) { case 0: {return false;
 break; }case 1: {var v$7696 = v$7695[1];
var fix$8541 = {};
fix$8541.$fold = function(x$7717,r$7718){lab$fold: while (true) {var v$7719 = findRecType$231(r$7718);
switch (v$7719[0]) { case 2: {return x$7717;
 break; }case 0: {return x$7717;
 break; }default: {var v$7720 = v$7719[1];
var v$7721 = v$7720[1];
var v$7722 = v$7720[2];
var t$8542 = x$7717?true:(fix$8537.$violates_equality0(v$7721));
var t$8543 = v$7722;
var x$7717 = t$8542;
var r$7718 = t$8543;
continue lab$fold;
} };
};
};
var fold$7716 = fix$8541.$fold;
return fold$7716(false,v$7696);
 break; }case 2: {var v$7699 = v$7695[1];
var v$7700 = v$7699[0];
var v$7701 = v$7699[1];
if (v$7701[1]?true:((special_objects$TyName$$3.member$2542(v$7701[0],v$7701[1],v$7701[2],v$7701[3],v$7701[4],v$7701[5]))(T$3794))) {var fix$8538 = {};
fix$8538.$foldl = function(v$7708,v$7709){lab$foldl: while (true) {if (v$7709 == null) {return v$7708;
} else {var v$7710 = v$7709;
var v$7711 = v$7710[0];
var v$7712 = v$7710[1];
var t$8539 = v$7708?true:(fix$8537.$violates_equality0(v$7711));
var t$8540 = v$7712;
var v$7708 = t$8539;
var v$7709 = t$8540;
continue lab$foldl;
};
};
};
var foldl$7707 = fix$8538.$foldl;
return foldl$7707(false,v$7700);
} else {return true;
};
 break; }default: {return true;
} };
};
var violates_equality0$7693 = fix$8537.$violates_equality0;
return violates_equality0$7693(v$3806);
} };
};
basics$StatObject$.match$3809 = function(v$3814,v$8213){var v$3815 = v$3814[1];
var v$3817 = v$8213[1];
return match_Type$3296(v$3815,v$3817);
};
basics$StatObject$.pu$3818 = pickle$pickle$.pairGen$1044([pickle$pickle$.listGen$2100(pu_TyVar$402),basics$StatObject$.pu$3427]);
basics$StatObject$.layout$3820 = function(v$3823){var v$3834 = v$3823[1];
var v$3835 = v$3834[1];
var v$3836 = v$3834[0];
var tau$3828 = findType$193(v$3836);
var t$8544;
var v$3829 = ("/\\" + (pr_tyvars$809(v$3835))) + ".";
var v$3832 = [1];
t$8544 = [[basics$StatObject$.layout$870(tau$3828),null],v$3832,"",0,v$3829];
return [0,t$8544];
};
basics$StatObject$.eq$3837 = function(v$3847,v$8214){var v$3848 = v$3847[1];
var v$3849 = v$3848[1];
var v$3850 = v$3848[0];
var v$3852 = v$8214[1];
var v$3853 = v$3852[1];
var v$3854 = v$3852[0];
return basics$StatObject$.eq$3593([v$3849,v$3850],[v$3853,v$3854]);
};
basics$StatObject$.from_TyVars_and_Type$3855 = function(v$3867,v$3868){generalise$2224(true,false,v$3868);
0;
return [0,[v$3868,v$3867]];
};
basics$StatObject$.apply$3869 = function(v$3879,v$8215){var v$3880 = v$3879[1];
var v$3881 = v$3880[1];
var v$3882 = v$3880[0];
return instance_with_types$3465([v$3881,v$3882],v$8215);
};
basics$StatObject$.arity$3884 = function(v$3887){var v$3892 = v$3887[1];
var v$3893 = v$3892[1];
var fix$8545 = {};
fix$8545.$acc = function(v$6529,v$6530){lab$acc: while (true) {if (v$6529 == null) {return v$6530;
} else {var v$6531 = v$6529;
var v$6532 = v$6531[1];
var t$8546 = v$6532;
var t$8547 = SmlPrims.chk_ovf_i32(v$6530 + 1);
var v$6529 = t$8546;
var v$6530 = t$8547;
continue lab$acc;
};
};
};
var acc$6528 = fix$8545.$acc;
return acc$6528(v$3893,0);
};
basics$StatObject$.admits_equality$3895 = function(theta$3898){var v$3909 = theta$3898[1];
var v$3910 = v$3909[1];
var v$3911 = v$3909[0];
var t$8548;
var tau$6533;
var sigma$6535 = [v$3910,v$3911];
tau$6533 = (basics$StatObject$.instance$$3564(sigma$6535))[0];
try {t$8548 = [0,make_equality0$2347(tau$6533)];
} catch(v$8549) {t$8548 = ((function(NotEquality$6534){var t$8550 = NotEquality$6534;
if (t$8550[0] == en$NotEquality$2346) {return [1];
} else {throw NotEquality$6534;
};
})(v$8549));
};
switch (t$8548[0]) { case 0: {return true;
 break; }default: {return false;
} };
};
basics$StatObject$.tynames$3912 = function(v$3915){var v$3920 = v$3915[1];
var v$3922 = v$3920[0];
return basics$StatObject$.tynames$1920(v$3922);
};
basics$StatObject$.grounded$3923 = function(v$3928,v$3929){var t$8554 = special_objects$TyName$$3.isEmpty$2409;
var t$8553;
var t$8552 = special_objects$TyName$$3.difference$2679;
var t$8551;
var v$6537 = v$3928[1];
var v$6538 = v$6537[0];
t$8551 = (basics$StatObject$.tynames$1920(v$6538));
t$8553 = (t$8552(t$8551,v$3929));
return t$8554(t$8553);
};
basics$StatObject$.from_TyName$3930 = function(tyname$3933){var fix$8555 = {};
fix$8555.$make_list = function(v$3945,v$8216){lab$make_list: while (true) {switch (v$3945) { case 0: {return v$8216;
 break; }default: {var t$8561 = SmlPrims.chk_ovf_i32(v$3945 - 1);
var t$8560;
var t$8559;
var t$8556;
var v$7728 = [1];
var v$7729 = [1];
var t$8558;
var t$8557;
var v$7730;
(r$588[0] = (SmlPrims.chk_ovf_i32(r$588[0] + 1)),0);
v$7730 = r$588[0];
var v$7731 = special_objects$Name$.baseGet$56(0);
var v$7732 = [special_objects$TyName$$1.current$72(0)];
t$8557 = [v$7731,false,v$7728,v$7730,[[1]],v$7729,v$7732];
t$8558 = [1,t$8557];
t$8556 = [t$8558];
t$8559 = [t$8556,v$8216];
t$8560 = t$8559;
var t$8562 = t$8561;
var t$8563 = t$8560;
var v$3945 = t$8562;
var v$8216 = t$8563;
continue lab$make_list;
} };
};
};
var make_list$3934 = fix$8555.$make_list;
var tyvars$3948 = make_list$3934(tyname$3933[0],null);
(level_ref$142[0] = (SmlPrims.chk_ovf_i32(level_ref$142[0] + 1)),0);
var tau$3949;
var t$8567;
var t$8566;
var t$8565;
var fix$8564 = {};
fix$8564.$map = function(v$6546){if (v$6546 == null) {return null;
} else {var v$6547 = v$6546;
var v$6548 = v$6547[0];
var v$6549 = v$6547[1];
return [[[0,v$6548],[level_ref$142[0]]],fix$8564.$map(v$6549)];
};
};
var map$6545 = fix$8564.$map;
t$8565 = (map$6545(tyvars$3948));
t$8566 = [t$8565,tyname$3933];
t$8567 = [2,t$8566];
tau$3949 = [t$8567,[0]];
(level_ref$142[0] = (SmlPrims.chk_ovf_i32(level_ref$142[0] - 1)),0);
generalise$2224(true,false,tau$3949);
0;
return [0,[tau$3949,tyvars$3948]];
};
basics$StatObject$.to_TyName$3950 = function(v$3953){var v$4009 = v$3953[1];
var v$4010 = v$4009[1];
var v$4011 = v$4009[0];
var v$3963;
var v$6558 = (findType$193(v$4011))[0];
switch (v$6558[0]) { case 2: {var v$6559 = v$6558[1];
v$3963 = [0,[v$6559[0],v$6559[1]]];
 break; }default: {v$3963 = [1];
} };
switch (v$3963[0]) { case 0: {var v$4006 = v$3963[1];
var v$4007 = v$4006[0];
var v$4008 = v$4006[1];
var fix$8568 = {};
fix$8568.$check = function(v$3980,v$8217){lab$check: while (true) {if (v$3980 == null) {return (v$8217 == null)?true:false;
} else {if (v$8217 == null) {return false;
} else {var v$3996 = v$3980;
var v$3997 = v$3996[0];
var v$3998 = v$3996[1];
var v$3999 = v$8217;
var v$4000 = v$3999[0];
var v$4001 = v$3999[1];
var t$8569;
var v$3993;
var v$6562 = (findType$193(v$4000))[0];
switch (v$6562[0]) { case 0: {var v$6563 = v$6562[1];
v$3993 = [0,v$6563];
 break; }default: {v$3993 = [1];
} };
switch (v$3993[0]) { case 0: {var v$3995 = v$3993[1];
t$8569 = (basics$StatObject$.eq$456(v$3997,v$3995));
 break; }default: {t$8569 = false;
} };
if (t$8569) {var t$8570 = v$3998;
var t$8571 = v$4001;
var v$3980 = t$8570;
var v$8217 = t$8571;
continue lab$check;
} else {return false;
};
};
};
};
};
var check$3965 = fix$8568.$check;
return (check$3965(v$4010,v$4007))?[0,v$4008]:[1];
 break; }default: {return [1];
} };
};
basics$StatObject$.is_TyName$4012 = function(x$6568){switch ((basics$StatObject$.to_TyName$3950(x$6568))[0]) { case 1: {return false;
 break; }default: {return true;
} };
};
basics$StatObject$.pretty_string$4013 = function(names$4016,v$4019){var v$4044 = v$4019[1];
var v$4045 = v$4044[1];
var v$4046 = v$4044[0];
if (v$4045 == null) {return [pretty_string_as_opt$1280(names$4016,1,[v$4046,[1]]),""];
} else {var v$4035 = v$4045;
if (v$4035[1] == null) {var v$4039 = v$4035[0];
var v$4037;
var fix$8573 = {};
fix$8573.$pretty_string = function(v$8136){switch (v$8136[0][0]) { case 1: {var v$8137 = v$8136[0][1];
var v$8138 = v$8137[1];
var v$8139 = v$8137[5];
var v$8140 = v$8137[3];
var boring$8141 = "U" + (basis$Int32$.toString$449(v$8140));
var t$8582;
var t$8581;
var t$8580;
switch (v$8139[0]) { case 0: {t$8580 = true;
 break; }default: {t$8580 = false;
} };
t$8581 = (t$8580?"OVERLOADED":"");
t$8582 = (t$8581 + (v$8138?"''":"'"));
var t$8574;
if (names$4016 == null) {t$8574 = boring$8141;
} else {var v$8142 = names$4016;
var L$$8143 = v$8142[0];
try {var v$8144 = edlib$edList$.first$1106(function(v$8145){return v$8145[1] == v$8140;
},L$$8143);
var v$8146 = v$8144[0];
t$8574 = (SmlPrims.implode([basis$General$.chr$187(SmlPrims.chk_ovf_i32(ordA$646 + v$8146)),null]));
} catch(v$8575) {t$8574 = ((function(v$8147){var t$8576 = v$8147;
if (t$8576[0] == edlib$edList$.en$First$1105) {var len$8148;
var fix$8577 = {};
fix$8577.$acc = function(v$8150,v$8151){lab$acc: while (true) {if (v$8150 == null) {return v$8151;
} else {var v$8152 = v$8150;
var v$8153 = v$8152[1];
var t$8578 = v$8153;
var t$8579 = SmlPrims.chk_ovf_i32(v$8151 + 1);
var v$8150 = t$8578;
var v$8151 = t$8579;
continue lab$acc;
};
};
};
var acc$8149 = fix$8577.$acc;
len$8148 = (acc$8149(L$$8143,0));
(v$8142[0] = (basis$List$.s$n$645([L$$8143,[[len$8148,v$8140],null]])),0);
return SmlPrims.implode([basis$General$.chr$187(SmlPrims.chk_ovf_i32(ordA$646 + len$8148)),null]);
} else {throw v$8147;
};
})(v$8575));
};
};
return t$8582 + t$8574;
 break; }default: {var v$8154 = v$8136[0][1];
var ty$8155 = findType$193(v$8154);
var v$8156 = ty$8155[0];
switch (v$8156[0]) { case 0: {var v$8157 = v$8156[1];
return (((fix$8573.$pretty_string(v$8157)) + "{") + (basis$Int32$.toString$449(ty$8155[1][0]))) + "}";
 break; }default: {return ("(ty_link){" + (basis$Int32$.toString$449(ty$8155[1][0]))) + "}";
} };
} };
};
var pretty_string$8135 = fix$8573.$pretty_string;
v$4037 = (pretty_string$8135(v$4039));
return [pretty_string_as_opt$1280(names$4016,1,[v$4046,[1]]),v$4037];
} else {var v$4040;
var p$6579;
var fix$8572 = {};
fix$8572.$pretty_string = function(v$8162){switch (v$8162[0][0]) { case 1: {var v$8163 = v$8162[0][1];
var v$8164 = v$8163[1];
var v$8165 = v$8163[5];
var v$8166 = v$8163[3];
var boring$8167 = "U" + (basis$Int32$.toString$449(v$8166));
var t$8591;
var t$8590;
var t$8589;
switch (v$8165[0]) { case 0: {t$8589 = true;
 break; }default: {t$8589 = false;
} };
t$8590 = (t$8589?"OVERLOADED":"");
t$8591 = (t$8590 + (v$8164?"''":"'"));
var t$8583;
if (names$4016 == null) {t$8583 = boring$8167;
} else {var v$8168 = names$4016;
var L$$8169 = v$8168[0];
try {var v$8170 = edlib$edList$.first$1106(function(v$8171){return v$8171[1] == v$8166;
},L$$8169);
var v$8172 = v$8170[0];
t$8583 = (SmlPrims.implode([basis$General$.chr$187(SmlPrims.chk_ovf_i32(ordA$646 + v$8172)),null]));
} catch(v$8584) {t$8583 = ((function(v$8173){var t$8585 = v$8173;
if (t$8585[0] == edlib$edList$.en$First$1105) {var len$8174;
var fix$8586 = {};
fix$8586.$acc = function(v$8176,v$8177){lab$acc: while (true) {if (v$8176 == null) {return v$8177;
} else {var v$8178 = v$8176;
var v$8179 = v$8178[1];
var t$8587 = v$8179;
var t$8588 = SmlPrims.chk_ovf_i32(v$8177 + 1);
var v$8176 = t$8587;
var v$8177 = t$8588;
continue lab$acc;
};
};
};
var acc$8175 = fix$8586.$acc;
len$8174 = (acc$8175(L$$8169,0));
(v$8168[0] = (basis$List$.s$n$645([L$$8169,[[len$8174,v$8166],null]])),0);
return SmlPrims.implode([basis$General$.chr$187(SmlPrims.chk_ovf_i32(ordA$646 + len$8174)),null]);
} else {throw v$8173;
};
})(v$8584));
};
};
return t$8591 + t$8583;
 break; }default: {var v$8180 = v$8162[0][1];
var ty$8181 = findType$193(v$8180);
var v$8182 = ty$8181[0];
switch (v$8182[0]) { case 0: {var v$8183 = v$8182[1];
return (((fix$8572.$pretty_string(v$8183)) + "{") + (basis$Int32$.toString$449(ty$8181[1][0]))) + "}";
 break; }default: {return ("(ty_link){" + (basis$Int32$.toString$449(ty$8181[1][0]))) + "}";
} };
} };
};
var pretty_string$8161 = fix$8572.$pretty_string;
p$6579 = (function(v$8315){return pretty_string$8161(v$8315);
});
var t$8595;
var t$8594 = "(";
var t$8593;
var fix$8592 = {};
fix$8592.$str = function(v$6582,v$6583,v$6584){if (v$6582 == null) {return "";
} else {var v$6585 = v$6582;
var v$6586 = v$6585[0];
var v$6587 = v$6585[1];
var s$6588 = (p$6579(v$6586)) + (fix$8592.$str(v$6587,v$6583,true));
return v$6584?(v$6583 + s$6588):s$6588;
};
};
var str$6581 = fix$8592.$str;
t$8593 = (str$6581(v$4045,", ",false));
t$8595 = (t$8594 + t$8593);
v$4040 = (t$8595 + ")");
return [pretty_string_as_opt$1280(names$4016,1,[v$4046,[1]]),v$4040];
};
};
};
basics$StatObject$.pretty_string$$4047 = function(names$4050,theta$4053){return (basics$StatObject$.pretty_string$4013(names$4050,theta$4053))[0];
};
basics$StatObject$.match$4058 = function(v$4066,v$8218){var v$4067 = v$4066[1];
var v$4068 = v$4067[0];
var v$4070 = v$8218[1];
var v$4071 = v$4070[0];
return match_Type$3296(v$4068,v$4071);
};
basics$StatObject$.pu$4072 = pickle$pickle$.convert$2333([function(v$6593){return [0,[v$6593[1],v$6593[0]]];
},function(v$6594){var v$6595 = v$6594[1];
return [v$6595[1],v$6595[0]];
}],basics$StatObject$.pu$3818);
basics$StatObject$.tynamesRng$4097 = function(v$4100){switch (v$4100[0]) { case 0: {return special_objects$TyName$$3.empty$2399;
 break; }default: {var v$4129 = v$4100[1];
return special_objects$TyName$$2.Fold$1458(function(v$4115){var v$4116 = v$4115[0];
var v$4117 = v$4116[1];
switch (v$4117[0]) { case 0: {var v$4123 = v$4116[0];
var v$4124 = v$4117[1];
var v$4125 = v$4115[1];
var t$8596;
var v$6599 = v$4123[2];
var v$6600 = v$4124[2];
var v$6601 = v$6599[0][1];
var v$6602 = v$6600[0][1];
t$8596 = ((v$6601[0] == v$6602[0])?(v$6601[1] == v$6602[1]):false);
if (t$8596) {return v$4125;
} else {return special_objects$TyName$$3.insert$2561(v$4124,v$4125);
};
 break; }default: {var v$4126 = v$4116[0];
var v$4127 = v$4117[1];
var v$4128 = v$4115[1];
var t$8600 = special_objects$TyName$$3.union$2587;
var t$8599;
var t$8598 = special_objects$TyName$$3.remove$2621(v$4126[0],v$4126[1],v$4126[2],v$4126[3],v$4126[4],v$4126[5]);
var t$8597;
var v$6604 = v$4127[1];
var v$6605 = v$6604[0];
t$8597 = (basics$StatObject$.tynames$1920(v$6605));
t$8599 = (t$8598(t$8597));
return t$8600(t$8599,v$4128);
} };
},special_objects$TyName$$3.empty$2399,v$4129);
} };
};
basics$StatObject$.dom$4130 = function(v$4133){switch (v$4133[0]) { case 0: {return special_objects$TyName$$3.empty$2399;
 break; }default: {var v$4139 = v$4133[1];
return special_objects$TyName$$3.fromList$2946(special_objects$TyName$$2.dom$1302(v$4139));
} };
};
var fix$8601 = {};
fix$8601.$correct_levels_Type = function(ty$4144){var ty$4145 = findType$193(ty$4144);
if (ty$4145[1][0] == (-1)) {0;
} else {var v$4174 = ty$4145[0];
switch (v$4174[0]) { case 0: {0;
 break; }case 3: {var v$4179 = v$4174[1];
var v$4180 = v$4179[0];
var v$4181 = v$4179[1];
var t$8650 = ty$4145[1];
var t$8649;
var v$7385 = fix$8601.$correct_levels_Type(v$4180);
var v$7386 = fix$8601.$correct_levels_Type(v$4181);
t$8649 = ((v$7385 < v$7386)?v$7385:v$7386);
(t$8650[0] = t$8649,0);
 break; }case 1: {var v$4176 = v$4174[1];
(ty$4145[1][0] = (fix$8601.$correct_levels_RecType(v$4176)),0);
 break; }default: {var v$4186 = v$4174[1];
var v$4187 = v$4186[0];
var t$8656 = ty$4145[1];
var t$8652;
var c$6618;
var fix$8651 = {};
fix$8651.$map = function(v$6631){if (v$6631 == null) {return null;
} else {var v$6632 = v$6631;
var v$6633 = v$6632[0];
var v$6634 = v$6632[1];
return [fix$8601.$correct_levels_Type(v$6633),fix$8651.$map(v$6634)];
};
};
var map$6630 = fix$8651.$map;
c$6618 = (map$6630(v$4187));
var fix$8653 = {};
fix$8653.$foldl = function(v$6620,v$6621){lab$foldl: while (true) {if (v$6621 == null) {return v$6620;
} else {var v$6622 = v$6621;
var v$6623 = v$6622[0];
var v$6624 = v$6622[1];
var t$8654 = (v$6623 < v$6620)?v$6623:v$6620;
var t$8655 = v$6624;
var v$6620 = t$8654;
var v$6621 = t$8655;
continue lab$foldl;
};
};
};
var foldl$6619 = fix$8653.$foldl;
t$8652 = (foldl$6619(0,c$6618));
(t$8656[0] = t$8652,0);
} };
};
return ty$4145[1][0];
};
fix$8601.$correct_levels_RecType = function(r$4196){var r$4197 = findRecType$231(r$4196);
switch (r$4197[0]) { case 2: {return 0;
 break; }case 0: {return 0;
 break; }default: {var v$4208 = r$4197[1];
var v$4210 = v$4208[1];
var v$4211 = v$4208[2];
var v$7381 = fix$8601.$correct_levels_Type(v$4210);
var v$7382 = fix$8601.$correct_levels_RecType(v$4211);
return (v$7381 < v$7382)?v$7381:v$7382;
} };
};
var correct_levels_Type$4141 = fix$8601.$correct_levels_Type;
var correct_levels_RecType$4140 = fix$8601.$correct_levels_RecType;
basics$StatObject$.Id$4212 = [0];
basics$StatObject$.is_Id$4213 = function(v$4216){switch (v$4216[0]) { case 0: {return true;
 break; }default: {return false;
} };
};
basics$StatObject$.singleton$4221 = function(v$4226,v$4227){return [1,special_objects$TyName$$2.singleton$1023(v$4226,[1,v$4227])];
};
basics$StatObject$.from_T_and_tyname$4228 = function(v$4243,v$4244){return (special_objects$TyName$$3.isEmpty$2409(v$4243))?[0]:[1,special_objects$TyName$$3.fold$2870(function(t$4239){return function(acc$4242){return special_objects$TyName$$2.add$1195(t$4239,[0,v$4244],acc$4242);
};
},special_objects$TyName$$2.empty$1022(0),v$4243)];
};
basics$StatObject$.renaming$$4245 = function(T$4248){if (special_objects$TyName$$3.isEmpty$2409(T$4248)) {return [special_objects$TyName$$3.empty$2399,basics$StatObject$.Id$4212];
} else {var v$4256 = special_objects$TyName$$3.fold$2870(function(t$4261){return function(v$4265){var v$4270 = v$4265[0];
var v$4271 = v$4265[1];
var t$$4266 = special_objects$TyName$$1.freshTyName$132(t$4261[0],t$4261[1],t$4261[4]);
return [special_objects$TyName$$3.insert$2561(t$$4266,v$4270),special_objects$TyName$$2.add$1195(t$4261,[0,t$$4266],v$4271)];
};
},[special_objects$TyName$$3.empty$2399,special_objects$TyName$$2.empty$1022(0)],T$4248);
return [v$4256[0],[1,v$4256[1]]];
};
};
basics$StatObject$.renaming$4272 = function(T$4275){return (basics$StatObject$.renaming$$4245(T$4275))[1];
};
basics$StatObject$.restrict$4280 = function(v$4283,v$4286){switch (v$4286[0]) { case 0: {return [0];
 break; }default: {var v$4315 = v$4286[1];
var m$$4296 = special_objects$TyName$$3.fold$2870(function(t$4299){return function(acc$4302){var v$4307 = special_objects$TyName$$2.lookup$1173(v$4315,t$4299);
switch (v$4307[0]) { case 0: {var v$4309 = v$4307[1];
return special_objects$TyName$$2.add$1195(t$4299,v$4309,acc$4302);
 break; }default: {return acc$4302;
} };
};
},special_objects$TyName$$2.empty$1022(0),v$4283);
return (special_objects$TyName$$2.isEmpty$1036(m$$4296))?[0]:[1,m$$4296];
} };
};
basics$StatObject$.restrict_from$4316 = function(v$4319,v$4322){switch (v$4322[0]) { case 0: {return [0];
 break; }default: {var v$4351 = v$4322[1];
var m$$4332 = special_objects$TyName$$2.Fold$1458(function(v$4337){var v$4342 = v$4337[0];
var v$4343 = v$4342[0];
var v$4344 = v$4342[1];
var v$4345 = v$4337[1];
if ((special_objects$TyName$$3.member$2542(v$4343[0],v$4343[1],v$4343[2],v$4343[3],v$4343[4],v$4343[5]))(v$4319)) {return v$4345;
} else {return special_objects$TyName$$2.add$1195(v$4343,v$4344,v$4345);
};
},special_objects$TyName$$2.empty$1022(0),v$4351);
return (special_objects$TyName$$2.isEmpty$1036(m$$4332))?[0]:[1,m$$4332];
} };
};
var en$Inverse$4352 = new String("Inverse");
var exn$Inverse$4352 = [en$Inverse$4352];
basics$StatObject$.inverse$4353 = function(v$4356){switch (v$4356[0]) { case 0: {return [0,[0]];
 break; }default: {var v$4387 = v$4356[1];
try {return [0,[1,special_objects$TyName$$2.Fold$1458(function(v$4366){var v$4380 = v$4366[0];
var v$4381 = v$4380[0];
var v$4382 = v$4380[1];
var v$4383 = v$4366[1];
switch (v$4382[0]) { case 0: {var v$4378 = v$4382[1];
if ((special_objects$TyName$$3.member$2542(v$4378[0],v$4378[1],v$4378[2],v$4378[3],v$4378[4],v$4378[5]))(special_objects$TyName$$3.fromList$2946(special_objects$TyName$$2.dom$1302(v$4383)))) {throw exn$Inverse$4352;
} else {return special_objects$TyName$$2.add$1195(v$4378,[0,v$4381],v$4383);
};
 break; }default: {throw exn$Inverse$4352;
} };
},special_objects$TyName$$2.empty$1022(0),v$4387)]];
} catch(v$8602) {return (function(Inverse$4386){var t$8603 = Inverse$4386;
if (t$8603[0] == en$Inverse$4352) {return [1];
} else {throw Inverse$4386;
};
})(v$8602);
};
} };
};
basics$StatObject$.on_TyName$4388 = function(v$4391,v$4394){switch (v$4391[0]) { case 0: {return basics$StatObject$.from_TyName$3930(v$4394);
 break; }default: {var v$4417 = v$4391[1];
var v$4411 = special_objects$TyName$$2.lookup$1173(v$4417,v$4394);
switch (v$4411[0]) { case 0: {var v$4413 = v$4411[1];
switch (v$4413[0]) { case 0: {var v$4415 = v$4413[1];
return basics$StatObject$.from_TyName$3930(v$4415);
 break; }default: {return v$4413[1];
} };
 break; }default: {return basics$StatObject$.from_TyName$3930(v$4394);
} };
} };
};
basics$StatObject$.on_TyName_set$4419 = function(rea$4422,T$4425){var t$8604;
switch (rea$4422[0]) { case 0: {t$8604 = true;
 break; }default: {t$8604 = false;
} };
if (t$8604) {return T$4425;
} else {return special_objects$TyName$$3.fold$2870(function(t$4432){return function(T$4435){var t$8606 = special_objects$TyName$$3.union$2587;
var t$8605;
var v$6640;
switch (rea$4422[0]) { case 0: {v$6640 = (basics$StatObject$.from_TyName$3930(t$4432));
 break; }default: {var v$6648 = rea$4422[1];
var v$6650 = special_objects$TyName$$2.lookup$1173(v$6648,t$4432);
switch (v$6650[0]) { case 0: {var v$6651 = v$6650[1];
switch (v$6651[0]) { case 0: {var v$6652 = v$6651[1];
v$6640 = (basics$StatObject$.from_TyName$3930(v$6652));
 break; }default: {v$6640 = v$6651[1];
} };
 break; }default: {v$6640 = (basics$StatObject$.from_TyName$3930(t$4432));
} };
} };
var v$6641 = v$6640[1];
var v$6642 = v$6641[0];
t$8605 = (basics$StatObject$.tynames$1920(v$6642));
return t$8606(t$8605,T$4435);
};
},special_objects$TyName$$3.empty$2399,T$4425);
};
};
var fix$8607 = {};
fix$8607.$on_Type = function(v$4464,v$4467){switch (v$4464[0]) { case 0: {return v$4467;
 break; }default: {var v$4493 = findType$193(v$4467);
var v$4494 = v$4493[0];
switch (v$4494[0]) { case 0: {return v$4467;
 break; }case 1: {var v$4501 = v$4494[1];
var v$4502 = v$4493[1];
var t$8647;
var t$8646;
var fix$8645 = {};
fix$8645.$map = function(r$7741){var v$7742 = findRecType$231(r$7741);
switch (v$7742[0]) { case 2: {return [2];
 break; }case 0: {var v$7743 = v$7742[1];
return [0,v$7743];
 break; }default: {var v$7744 = v$7742[1];
var v$7745 = v$7744[0];
var v$7746 = v$7744[1];
var v$7747 = v$7744[2];
return [1,[v$7745,fix$8607.$on_Type(v$4464,v$7746),fix$8645.$map(v$7747)]];
} };
};
var map$7740 = fix$8645.$map;
t$8646 = (map$7740(v$4501));
t$8647 = [1,t$8646];
return [t$8647,[v$4502[0]]];
 break; }case 3: {var v$4496 = v$4494[1];
var v$4497 = v$4496[0];
var v$4498 = v$4496[1];
var v$4499 = v$4493[1];
return [[3,[fix$8607.$on_Type(v$4464,v$4497),fix$8607.$on_Type(v$4464,v$4498)]],[v$4499[0]]];
 break; }default: {var v$4527 = v$4494[1];
var v$4528 = v$4527[0];
var v$4529 = v$4527[1];
var v$4530 = v$4493[1];
var theta$4505;
switch (v$4464[0]) { case 0: {theta$4505 = [0,v$4529];
 break; }default: {var v$6660 = v$4464[1];
var v$6662 = special_objects$TyName$$2.lookup$1173(v$6660,v$4529);
switch (v$6662[0]) { case 0: {theta$4505 = v$6662[1];
 break; }default: {theta$4505 = [0,v$4529];
} };
} };
var v$7404;
var fix$8648 = {};
fix$8648.$map = function(v$6684){if (v$6684 == null) {return null;
} else {var v$6685 = v$6684;
var v$6686 = v$6685[0];
var v$6687 = v$6685[1];
return [fix$8607.$on_Type(v$4464,v$6686),fix$8648.$map(v$6687)];
};
};
var map$6683 = fix$8648.$map;
v$7404 = (map$6683(v$4528));
switch (theta$4505[0]) { case 0: {return [[2,[v$7404,theta$4505[1]]],[v$4530[0]]];
 break; }default: {var v$6672 = theta$4505[1];
var tau$6674;
var v$6677 = v$6672[1];
var v$6678 = v$6677[1];
var v$6679 = v$6677[0];
tau$6674 = (instance_with_types$3465([v$6678,v$6679],v$7404));
correct_levels_Type$4141(tau$6674);
return tau$6674;
} };
} };
} };
};
basics$StatObject$.on_Type$4461 = fix$8607.$on_Type;
basics$StatObject$.on_TypeScheme$4532 = function(v$4535,v$4538){switch (v$4535[0]) { case 0: {return v$4538;
 break; }default: {var v$4556 = v$4538[0];
var v$4557 = v$4538[1];
var t$8619;
var fix$8615 = {};
fix$8615.$exists = function(v$6690){lab$exists: while (true) {if (v$6690 == null) {return false;
} else {var v$6691 = v$6690;
var v$6692 = v$6691[0];
var v$6693 = v$6691[1];
var t$8617;
var t$8616;
switch (v$6692[0][0]) { case 1: {t$8616 = v$6692[0][1][5];
 break; }default: {t$8616 = (tools$Crash$.impossible$50("StatObject.TyVar.get_overloaded"));
} };
switch (t$8616[0]) { case 0: {t$8617 = true;
 break; }default: {t$8617 = false;
} };
if (t$8617) {return true;
} else {var t$8618 = v$6693;
var v$6690 = t$8618;
continue lab$exists;
};
};
};
};
var exists$6689 = fix$8615.$exists;
t$8619 = (exists$6689(v$4556));
if (t$8619) {return v$4538;
} else {var t$8614 = v$4556;
var t$8609;
var fix$8608 = {};
fix$8608.$on_Type = function(v$7940){switch (v$4535[0]) { case 0: {return v$7940;
 break; }default: {var v$7941 = findType$193(v$7940);
var v$7942 = v$7941[0];
switch (v$7942[0]) { case 0: {return v$7940;
 break; }case 1: {var v$7943 = v$7942[1];
var v$7944 = v$7941[1];
var t$8612;
var t$8611;
var fix$8610 = {};
fix$8610.$map = function(r$7947){var v$7948 = findRecType$231(r$7947);
switch (v$7948[0]) { case 2: {return [2];
 break; }case 0: {var v$7949 = v$7948[1];
return [0,v$7949];
 break; }default: {var v$7950 = v$7948[1];
var v$7951 = v$7950[0];
var v$7952 = v$7950[1];
var v$7953 = v$7950[2];
return [1,[v$7951,fix$8608.$on_Type(v$7952),fix$8610.$map(v$7953)]];
} };
};
var map$7946 = fix$8610.$map;
t$8611 = (map$7946(v$7943));
t$8612 = [1,t$8611];
return [t$8612,[v$7944[0]]];
 break; }case 3: {var v$7954 = v$7942[1];
var v$7955 = v$7954[0];
var v$7956 = v$7954[1];
var v$7957 = v$7941[1];
return [[3,[fix$8608.$on_Type(v$7955),fix$8608.$on_Type(v$7956)]],[v$7957[0]]];
 break; }default: {var v$7958 = v$7942[1];
var v$7959 = v$7958[0];
var v$7960 = v$7958[1];
var v$7961 = v$7941[1];
var theta$7962;
switch (v$4535[0]) { case 0: {theta$7962 = [0,v$7960];
 break; }default: {var v$7963 = v$4535[1];
var v$7964 = special_objects$TyName$$2.lookup$1173(v$7963,v$7960);
switch (v$7964[0]) { case 0: {theta$7962 = v$7964[1];
 break; }default: {theta$7962 = [0,v$7960];
} };
} };
var v$7965;
var fix$8613 = {};
fix$8613.$map = function(v$7968){if (v$7968 == null) {return null;
} else {var v$7969 = v$7968;
var v$7970 = v$7969[0];
var v$7971 = v$7969[1];
return [fix$8608.$on_Type(v$7970),fix$8613.$map(v$7971)];
};
};
var map$7967 = fix$8613.$map;
v$7965 = (map$7967(v$7959));
switch (theta$7962[0]) { case 0: {return [[2,[v$7965,theta$7962[1]]],[v$7961[0]]];
 break; }default: {var v$7972 = theta$7962[1];
var tau$7973;
var v$7974 = v$7972[1];
var v$7975 = v$7974[1];
var v$7976 = v$7974[0];
tau$7973 = (instance_with_types$3465([v$7975,v$7976],v$7965));
correct_levels_Type$4141(tau$7973);
return tau$7973;
} };
} };
} };
};
var on_Type$7939 = fix$8608.$on_Type;
t$8609 = (on_Type$7939(v$4557));
return [t$8614,t$8609];
};
} };
};
basics$StatObject$.on_TypeFcn$4558 = function(v$4561,v$4564){switch (v$4561[0]) { case 0: {return v$4564;
 break; }default: {var v$4579 = v$4564[1];
var v$4580 = v$4579[1];
var v$4581 = v$4579[0];
var t$8626;
var t$8621;
var fix$8620 = {};
fix$8620.$on_Type = function(v$7979){switch (v$4561[0]) { case 0: {return v$7979;
 break; }default: {var v$7980 = findType$193(v$7979);
var v$7981 = v$7980[0];
switch (v$7981[0]) { case 0: {return v$7979;
 break; }case 1: {var v$7982 = v$7981[1];
var v$7983 = v$7980[1];
var t$8624;
var t$8623;
var fix$8622 = {};
fix$8622.$map = function(r$7986){var v$7987 = findRecType$231(r$7986);
switch (v$7987[0]) { case 2: {return [2];
 break; }case 0: {var v$7988 = v$7987[1];
return [0,v$7988];
 break; }default: {var v$7989 = v$7987[1];
var v$7990 = v$7989[0];
var v$7991 = v$7989[1];
var v$7992 = v$7989[2];
return [1,[v$7990,fix$8620.$on_Type(v$7991),fix$8622.$map(v$7992)]];
} };
};
var map$7985 = fix$8622.$map;
t$8623 = (map$7985(v$7982));
t$8624 = [1,t$8623];
return [t$8624,[v$7983[0]]];
 break; }case 3: {var v$7993 = v$7981[1];
var v$7994 = v$7993[0];
var v$7995 = v$7993[1];
var v$7996 = v$7980[1];
return [[3,[fix$8620.$on_Type(v$7994),fix$8620.$on_Type(v$7995)]],[v$7996[0]]];
 break; }default: {var v$7997 = v$7981[1];
var v$7998 = v$7997[0];
var v$7999 = v$7997[1];
var v$8000 = v$7980[1];
var theta$8001;
switch (v$4561[0]) { case 0: {theta$8001 = [0,v$7999];
 break; }default: {var v$8002 = v$4561[1];
var v$8003 = special_objects$TyName$$2.lookup$1173(v$8002,v$7999);
switch (v$8003[0]) { case 0: {theta$8001 = v$8003[1];
 break; }default: {theta$8001 = [0,v$7999];
} };
} };
var v$8004;
var fix$8625 = {};
fix$8625.$map = function(v$8007){if (v$8007 == null) {return null;
} else {var v$8008 = v$8007;
var v$8009 = v$8008[0];
var v$8010 = v$8008[1];
return [fix$8620.$on_Type(v$8009),fix$8625.$map(v$8010)];
};
};
var map$8006 = fix$8625.$map;
v$8004 = (map$8006(v$7998));
switch (theta$8001[0]) { case 0: {return [[2,[v$8004,theta$8001[1]]],[v$8000[0]]];
 break; }default: {var v$8011 = theta$8001[1];
var tau$8012;
var v$8013 = v$8011[1];
var v$8014 = v$8013[1];
var v$8015 = v$8013[0];
tau$8012 = (instance_with_types$3465([v$8014,v$8015],v$8004));
correct_levels_Type$4141(tau$8012);
return tau$8012;
} };
} };
} };
};
var on_Type$7978 = fix$8620.$on_Type;
t$8621 = (on_Type$7978(v$4581));
t$8626 = [t$8621,v$4580];
return [0,t$8626];
} };
};
basics$StatObject$.layout$4649 = function(v$4652){switch (v$4652[0]) { case 0: {return [1,"Id"];
 break; }default: {var v$4662 = v$4652[1];
return (((special_objects$TyName$$2.layoutMap$1654(" -> ","}",", ","{"))(function(v$8316){return special_objects$TyName$$4.layout$3528(v$8316);
}))(function(v$6757){switch (v$6757[0]) { case 0: {var v$6758 = v$6757[1];
return special_objects$TyName$$4.layout$3528(v$6758);
 break; }default: {var v$6759 = v$6757[1];
var v$6761 = v$6759[1];
var v$6762 = v$6761[1];
var v$6763 = v$6761[0];
var tau$6764 = findType$193(v$6763);
var t$8627;
var v$6765 = ("/\\" + (pr_tyvars$809(v$6762))) + ".";
var v$6768 = [1];
t$8627 = [[basics$StatObject$.layout$870(tau$6764),null],v$6768,"",0,v$6765];
return [0,t$8627];
} };
}))(v$4662);
} };
};
basics$StatObject$.oo$4663 = function(v$4678,v$8219){switch (v$4678[0]) { case 0: {return v$8219;
 break; }default: {switch (v$8219[0]) { case 0: {return v$4678;
 break; }default: {var v$4687 = v$4678[1];
var v$4685;
switch (v$4678[0]) { case 0: {v$4685 = v$8219;
 break; }default: {switch (v$8219[0]) { case 0: {v$4685 = [0];
 break; }default: {var v$6774 = v$8219[1];
v$4685 = [1,special_objects$TyName$$2.Fold$1458(function(v$6775){var v$6776 = v$6775[0];
var v$6777 = v$6776[0];
var v$6778 = v$6776[1];
var v$6779 = v$6775[1];
var t$8638 = special_objects$TyName$$2.add$1195;
var t$8637 = v$6777;
var t$8628;
switch (v$4678[0]) { case 0: {t$8628 = v$6778;
 break; }default: {switch (v$6778[0]) { case 0: {var v$6785 = v$6778[1];
switch (v$4678[0]) { case 0: {t$8628 = [0,v$6785];
 break; }default: {var v$6789 = v$4678[1];
var v$6791 = special_objects$TyName$$2.lookup$1173(v$6789,v$6785);
switch (v$6791[0]) { case 0: {t$8628 = v$6791[1];
 break; }default: {t$8628 = [0,v$6785];
} };
} };
 break; }default: {var v$6792 = v$6778[1];
var t$8629;
switch (v$4678[0]) { case 0: {t$8629 = v$6792;
 break; }default: {var v$6796 = v$6792[1];
var v$6797 = v$6796[1];
var v$6798 = v$6796[0];
var t$8636;
var t$8631;
var fix$8630 = {};
fix$8630.$on_Type = function(v$8018){switch (v$4678[0]) { case 0: {return v$8018;
 break; }default: {var v$8019 = findType$193(v$8018);
var v$8020 = v$8019[0];
switch (v$8020[0]) { case 0: {return v$8018;
 break; }case 1: {var v$8021 = v$8020[1];
var v$8022 = v$8019[1];
var t$8634;
var t$8633;
var fix$8632 = {};
fix$8632.$map = function(r$8025){var v$8026 = findRecType$231(r$8025);
switch (v$8026[0]) { case 2: {return [2];
 break; }case 0: {var v$8027 = v$8026[1];
return [0,v$8027];
 break; }default: {var v$8028 = v$8026[1];
var v$8029 = v$8028[0];
var v$8030 = v$8028[1];
var v$8031 = v$8028[2];
return [1,[v$8029,fix$8630.$on_Type(v$8030),fix$8632.$map(v$8031)]];
} };
};
var map$8024 = fix$8632.$map;
t$8633 = (map$8024(v$8021));
t$8634 = [1,t$8633];
return [t$8634,[v$8022[0]]];
 break; }case 3: {var v$8032 = v$8020[1];
var v$8033 = v$8032[0];
var v$8034 = v$8032[1];
var v$8035 = v$8019[1];
return [[3,[fix$8630.$on_Type(v$8033),fix$8630.$on_Type(v$8034)]],[v$8035[0]]];
 break; }default: {var v$8036 = v$8020[1];
var v$8037 = v$8036[0];
var v$8038 = v$8036[1];
var v$8039 = v$8019[1];
var theta$8040;
switch (v$4678[0]) { case 0: {theta$8040 = [0,v$8038];
 break; }default: {var v$8041 = v$4678[1];
var v$8042 = special_objects$TyName$$2.lookup$1173(v$8041,v$8038);
switch (v$8042[0]) { case 0: {theta$8040 = v$8042[1];
 break; }default: {theta$8040 = [0,v$8038];
} };
} };
var v$8043;
var fix$8635 = {};
fix$8635.$map = function(v$8046){if (v$8046 == null) {return null;
} else {var v$8047 = v$8046;
var v$8048 = v$8047[0];
var v$8049 = v$8047[1];
return [fix$8630.$on_Type(v$8048),fix$8635.$map(v$8049)];
};
};
var map$8045 = fix$8635.$map;
v$8043 = (map$8045(v$8037));
switch (theta$8040[0]) { case 0: {return [[2,[v$8043,theta$8040[1]]],[v$8039[0]]];
 break; }default: {var v$8050 = theta$8040[1];
var tau$8051;
var v$8052 = v$8050[1];
var v$8053 = v$8052[1];
var v$8054 = v$8052[0];
tau$8051 = (instance_with_types$3465([v$8053,v$8054],v$8043));
correct_levels_Type$4141(tau$8051);
return tau$8051;
} };
} };
} };
};
var on_Type$8017 = fix$8630.$on_Type;
t$8631 = (on_Type$8017(v$6798));
t$8636 = [t$8631,v$6797];
t$8629 = [0,t$8636];
} };
t$8628 = [1,t$8629];
} };
} };
return t$8638(t$8637,t$8628,v$6779);
},special_objects$TyName$$2.empty$1022(0),v$6774)];
} };
} };
switch (v$4685[0]) { case 0: {return v$4678;
 break; }default: {var v$4686 = v$4685[1];
return [1,special_objects$TyName$$2.plus$1223(v$4687,v$4686)];
} };
} };
} };
};
basics$StatObject$.enrich$4688 = function(v$4704,v$4705){var v$4706 = v$4705[0];
var v$4707 = v$4705[1];
return special_objects$TyName$$3.fold$2870(function(t$4696){return function(acc$4699){if (acc$4699) {var v$7427;
switch (v$4704[0]) { case 0: {v$7427 = (basics$StatObject$.from_TyName$3930(t$4696));
 break; }default: {var v$6813 = v$4704[1];
var v$6815 = special_objects$TyName$$2.lookup$1173(v$6813,t$4696);
switch (v$6815[0]) { case 0: {var v$6816 = v$6815[1];
switch (v$6816[0]) { case 0: {var v$6817 = v$6816[1];
v$7427 = (basics$StatObject$.from_TyName$3930(v$6817));
 break; }default: {v$7427 = v$6816[1];
} };
 break; }default: {v$7427 = (basics$StatObject$.from_TyName$3930(t$4696));
} };
} };
var v$7428;
switch (v$4706[0]) { case 0: {v$7428 = (basics$StatObject$.from_TyName$3930(t$4696));
 break; }default: {var v$6823 = v$4706[1];
var v$6825 = special_objects$TyName$$2.lookup$1173(v$6823,t$4696);
switch (v$6825[0]) { case 0: {var v$6826 = v$6825[1];
switch (v$6826[0]) { case 0: {var v$6827 = v$6826[1];
v$7428 = (basics$StatObject$.from_TyName$3930(v$6827));
 break; }default: {v$7428 = v$6826[1];
} };
 break; }default: {v$7428 = (basics$StatObject$.from_TyName$3930(t$4696));
} };
} };
var v$6801 = v$7427[1];
var v$6802 = v$6801[1];
var v$6803 = v$6801[0];
var v$6805 = v$7428[1];
var v$6806 = v$6805[1];
var v$6807 = v$6805[0];
return basics$StatObject$.eq$3593([v$6802,v$6803],[v$6806,v$6807]);
} else {return false;
};
};
},true,v$4707);
};
basics$StatObject$.eq$4708 = function(v$8220,v$8221){switch (v$8220[0]) { case 0: {switch (v$8221[0]) { case 0: {return true;
 break; }default: {var T$6835;
var t$8641 = special_objects$TyName$$3.union$2587;
var t$8640;
switch (v$8220[0]) { case 0: {t$8640 = special_objects$TyName$$3.empty$2399;
 break; }default: {var v$6837 = v$8220[1];
t$8640 = (special_objects$TyName$$3.fromList$2946(special_objects$TyName$$2.dom$1302(v$6837)));
} };
var t$8639;
switch (v$8221[0]) { case 0: {t$8639 = special_objects$TyName$$3.empty$2399;
 break; }default: {var v$6839 = v$8221[1];
t$8639 = (special_objects$TyName$$3.fromList$2946(special_objects$TyName$$2.dom$1302(v$6839)));
} };
T$6835 = (t$8641(t$8640,t$8639));
return basics$StatObject$.enrich$4688(v$8220,[v$8221,T$6835]);
} };
 break; }default: {var T$6843;
var t$8644 = special_objects$TyName$$3.union$2587;
var t$8643;
switch (v$8220[0]) { case 0: {t$8643 = special_objects$TyName$$3.empty$2399;
 break; }default: {var v$6845 = v$8220[1];
t$8643 = (special_objects$TyName$$3.fromList$2946(special_objects$TyName$$2.dom$1302(v$6845)));
} };
var t$8642;
switch (v$8221[0]) { case 0: {t$8642 = special_objects$TyName$$3.empty$2399;
 break; }default: {var v$6847 = v$8221[1];
t$8642 = (special_objects$TyName$$3.fromList$2946(special_objects$TyName$$2.dom$1302(v$6847)));
} };
T$6843 = (t$8644(t$8643,t$8642));
return basics$StatObject$.enrich$4688(v$8220,[v$8221,T$6843]);
} };
};
basics$StatObject$.match$4725 = function(v$4736,v$8222){switch (v$4736[0]) { case 0: {return 0;
 break; }default: {var v$4758 = v$4736[1];
return special_objects$TyName$$2.Fold$1458(function(v$4754){var v$4755 = v$4754[0];
var v$4756 = v$4755[0];
var v$4757 = v$4755[1];
var v$7433;
switch (v$4757[0]) { case 1: {v$7433 = v$4757[1];
 break; }default: {var v$6856 = v$4757[1];
v$7433 = (basics$StatObject$.from_TyName$3930(v$6856));
} };
var v$7434;
switch (v$8222[0]) { case 0: {v$7434 = (basics$StatObject$.from_TyName$3930(v$4756));
 break; }default: {var v$6862 = v$8222[1];
var v$6864 = special_objects$TyName$$2.lookup$1173(v$6862,v$4756);
switch (v$6864[0]) { case 0: {var v$6865 = v$6864[1];
switch (v$6865[0]) { case 0: {var v$6866 = v$6865[1];
v$7434 = (basics$StatObject$.from_TyName$3930(v$6866));
 break; }default: {v$7434 = v$6865[1];
} };
 break; }default: {v$7434 = (basics$StatObject$.from_TyName$3930(v$4756));
} };
} };
var v$6850 = v$7433[1];
var v$6851 = v$6850[0];
var v$6853 = v$7434[1];
var v$6854 = v$6853[0];
return match_Type$3296(v$6851,v$6854);
},0,v$4758);
} };
};
var pu_TypeFcn$$4760 = pickle$pickle$.dataGen$1479(["StatObject.TypeFcn'",function(v$6871){switch (v$6871[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$6872){return pickle$pickle$.con1$2005(function(v$6873){return [0,v$6873];
},function(v$6874){switch (v$6874[0]) { case 0: {return v$6874[1];
 break; }default: {return tools$Crash$.impossible$50("StatObject.pu_TypeFcn'.TYNAME");
} };
},special_objects$TyName$$1.pu$366);
},[function(v$6877){return pickle$pickle$.con1$2005(function(v$6878){return [1,v$6878];
},function(v$6879){switch (v$6879[0]) { case 1: {return v$6879[1];
 break; }default: {return tools$Crash$.impossible$50("StatObject.pu_TypeFcn'.EXPANDED");
} };
},basics$StatObject$.pu$4072);
},null]]]);
basics$StatObject$.pu$4792 = pickle$pickle$.convert$2333([function(v$6882){switch (v$6882[0]) { case 0: {var v$6883 = v$6882[1];
return [1,v$6883];
 break; }default: {return [0];
} };
},function(v$6884){switch (v$6884[0]) { case 1: {var v$6885 = v$6884[1];
return [0,v$6885];
 break; }default: {return [1];
} };
}],pickle$pickle$.optionGen$2125(special_objects$TyName$$2.pu$1755(special_objects$TyName$$1.pu$366,pu_TypeFcn$$4760)));
return 0;
})();
