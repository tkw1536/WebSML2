if ((typeof(basics$ModuleEnvironments$)) == "undefined") {basics$ModuleEnvironments$ = {};
};
(function(){basics$ModuleEnvironments$.empty$72 = [0,tools$FinMap$.empty$52(function(v$1430){return syntax_objects$SigId$.eq_sigid$100(v$1430[0],v$1430[1]);
})];
basics$ModuleEnvironments$.singleton$73 = function(x$975){var v$1394 = tools$FinMap$.singleton$53(function(v$1517){return syntax_objects$SigId$.eq_sigid$100(v$1517[0],v$1517[1]);
},x$975);
return [0,v$1394];
};
basics$ModuleEnvironments$.plus$75 = function(v$83,v$1432){var v$84 = v$83[1];
var v$86 = v$1432[1];
return [0,tools$FinMap$.plus$146(function(v$1433){return syntax_objects$SigId$.eq_sigid$100(v$1433[0],v$1433[1]);
},[v$84,v$86])];
};
basics$ModuleEnvironments$.lookup$87 = function(v$90){var v$94 = v$90[1];
return function(v$1493){return tools$FinMap$.lookup$67(function(v$1518){return syntax_objects$SigId$.eq_sigid$100(v$1518[0],v$1518[1]);
},v$94,v$1493);
};
};
basics$ModuleEnvironments$.tynames$95 = function(v$98){var v$108 = v$98[1];
return tools$FinMap$.fold$453(function(v$1435){return syntax_objects$SigId$.eq_sigid$100(v$1435[0],v$1435[1]);
},function(v$105){var v$106 = v$105[0];
var v$107 = v$105[1];
return special_objects$TyName$$3.union$2587(v$107,basics$ModuleStatObject$.tynames$502(v$106));
},special_objects$TyName$$3.empty$2399,v$108);
};
basics$ModuleEnvironments$.dom$109 = function(v$112){var v$116 = v$112[1];
return tools$FinMap$.dom$394(function(v$1436){return syntax_objects$SigId$.eq_sigid$100(v$1436[0],v$1436[1]);
},v$116);
};
basics$ModuleEnvironments$.layout$117 = function(v$120){var v$151 = v$120[1];
var l$124 = tools$FinMap$.Fold$472(function(v$1437){return syntax_objects$SigId$.eq_sigid$100(v$1437[0],v$1437[1]);
},function(v$125){return v$125;
},null,v$151);
if (l$124 == null) {return [1,""];
} else {var t$1530;
var t$1526;
var fix$1525 = {};
fix$1525.$map = function(v$981){if (v$981 == null) {return null;
} else {var v$982 = v$981;
var v$983 = v$982[0];
var v$984 = v$982[1];
var t$1529;
var t$1527;
var v$1396 = v$983[0];
var v$1397 = v$983[1];
var t$1528;
var v$1398 = SmlPrims.concat(["signature ",[syntax_objects$SigId$.pr_SigId$51(v$1396),[" : ",null]]]);
t$1528 = [[basics$ModuleStatObject$.layout$668(v$1397),null],[1],"",3,v$1398];
t$1527 = [0,t$1528];
t$1529 = [t$1527,fix$1525.$map(v$984)];
return t$1529;
};
};
var map$980 = fix$1525.$map;
t$1526 = (map$980(l$124));
t$1530 = [t$1526,[0," "],"",0,""];
return [0,t$1530];
};
};
basics$ModuleEnvironments$.report$152 = function(v$160,v$161){var v$162 = v$161[1];
return tools$FinMap$.reportMapSORTED$534(function(v$1438){return syntax_objects$SigId$.eq_sigid$100(v$1438[0],v$1438[1]);
},function(v$1439){return syntax_objects$SigId$.s$j$59(v$1439[0],v$1439[1]);
},v$160,v$162);
};
basics$ModuleEnvironments$.pu$185 = pickle$pickle$.convert$2333([function(v$186){return [0,v$186];
},function(v$189){return v$189[1];
}],tools$FinMap$.pu$593(function(v$1440){return syntax_objects$SigId$.eq_sigid$100(v$1440[0],v$1440[1]);
},[syntax_objects$SigId$.pu$68,basics$ModuleStatObject$.pu$688]));
basics$ModuleEnvironments$.lt_absprjid$191 = function(v$1441,v$1442){return v$1441 < v$1442;
};
basics$ModuleEnvironments$.absprjid_to_string$199 = function(absprjid$202){return absprjid$202;
};
basics$ModuleEnvironments$.mk_absprjid$203 = function(x$206){return x$206;
};
basics$ModuleEnvironments$.is_absprjid_basislib$207 = function(absprjid$210){return (basis$Path$.file$537(absprjid$210)) == "basis.pm";
};
basics$ModuleEnvironments$.strip_install_dir$211 = function(absprjid$214){if ((basis$Path$.file$537(absprjid$214)) == "basis.pm") {return basis$Path$.mkRelative$404(absprjid$214,tools$Flags$$1.install_dir$74[0]);
} else {return absprjid$214;
};
};
basics$ModuleEnvironments$.strip_install_dir$$219 = function(p$224){var v$229 = p$224[0];
var v$230 = p$224[1];
return ((basis$Path$.file$537(v$229)) == "basis.pm")?[basis$Path$.mkRelative$404(v$229,tools$Flags$$1.install_dir$74[0]),syntax_objects$FunId$.mk_FunId$49(basis$Path$.mkRelative$404(syntax_objects$FunId$.pr_FunId$51(v$230),tools$Flags$$1.install_dir$74[0]))]:p$224;
};
basics$ModuleEnvironments$.pu_absprjid$231 = pickle$pickle$.string$900;
basics$ModuleEnvironments$.empty$232 = [0,tools$FinMap$.empty$52(function(v$1443){return syntax_objects$FunId$.eq_funid$100(v$1443[0],v$1443[1]);
})];
basics$ModuleEnvironments$.singleton$233 = function(x$1014){var v$1401 = tools$FinMap$.singleton$53(function(v$1521){return syntax_objects$FunId$.eq_funid$100(v$1521[0],v$1521[1]);
},x$1014);
return [0,v$1401];
};
basics$ModuleEnvironments$.plus$235 = function(v$243,v$1445){var v$244 = v$243[1];
var v$246 = v$1445[1];
return [0,tools$FinMap$.plus$146(function(v$1446){return syntax_objects$FunId$.eq_funid$100(v$1446[0],v$1446[1]);
},[v$244,v$246])];
};
basics$ModuleEnvironments$.lookup$247 = function(v$250){var v$254 = v$250[1];
return function(v$1498){return tools$FinMap$.lookup$67(function(v$1522){return syntax_objects$FunId$.eq_funid$100(v$1522[0],v$1522[1]);
},v$254,v$1498);
};
};
basics$ModuleEnvironments$.tynames$255 = function(v$258){var v$269 = v$258[1];
return tools$FinMap$.fold$453(function(v$1448){return syntax_objects$FunId$.eq_funid$100(v$1448[0],v$1448[1]);
},function(v$265){var v$266 = v$265[0];
var v$267 = v$266[1];
var v$268 = v$265[1];
return special_objects$TyName$$3.union$2587(v$268,basics$ModuleStatObject$.tynames$735(v$267));
},special_objects$TyName$$3.empty$2399,v$269);
};
basics$ModuleEnvironments$.tyvars$270 = function(v$273){var v$284 = v$273[1];
return tools$FinMap$.fold$453(function(v$1449){return syntax_objects$FunId$.eq_funid$100(v$1449[0],v$1449[1]);
},function(v$280){var v$281 = v$280[0];
var v$282 = v$281[1];
var v$283 = v$280[1];
return basics$StatObject$.unionTyVarSet$779(basics$ModuleStatObject$.tyvars$748(v$282),v$283);
},null,v$284);
};
basics$ModuleEnvironments$.tyvars$$285 = function(v$288){var v$299 = v$288[1];
return tools$FinMap$.fold$453(function(v$1450){return syntax_objects$FunId$.eq_funid$100(v$1450[0],v$1450[1]);
},function(v$295){var v$296 = v$295[0];
var v$297 = v$296[1];
var v$298 = v$295[1];
return basis$List$.s$n$645([basics$ModuleStatObject$.tyvars$$758(v$297),v$298]);
},null,v$299);
};
basics$ModuleEnvironments$.dom$300 = function(v$303){var v$307 = v$303[1];
return tools$FinMap$.dom$394(function(v$1451){return syntax_objects$FunId$.eq_funid$100(v$1451[0],v$1451[1]);
},v$307);
};
basics$ModuleEnvironments$.layout$308 = function(v$311){var v$343 = v$311[1];
var l$315 = tools$FinMap$.Fold$472(function(v$1452){return syntax_objects$FunId$.eq_funid$100(v$1452[0],v$1452[1]);
},function(v$316){return v$316;
},null,v$343);
if (l$315 == null) {return [1,""];
} else {var t$1536;
var t$1532;
var fix$1531 = {};
fix$1531.$map = function(v$1020){if (v$1020 == null) {return null;
} else {var v$1021 = v$1020;
var v$1022 = v$1021[0];
var v$1023 = v$1021[1];
var t$1535;
var t$1533;
var v$1403 = v$1022[0];
var v$1404 = v$1022[1];
var v$1405 = v$1404[1];
var t$1534;
var v$1406 = SmlPrims.concat(["functor ",[syntax_objects$FunId$.pr_FunId$51(v$1403),[" : ",null]]]);
t$1534 = [[basics$ModuleStatObject$.layout$941(v$1405),null],[1],"",3,v$1406];
t$1533 = [0,t$1534];
t$1535 = [t$1533,fix$1531.$map(v$1023)];
return t$1535;
};
};
var map$1019 = fix$1531.$map;
t$1532 = (map$1019(l$315));
t$1536 = [t$1532,[0," "],"",0,""];
return [0,t$1536];
};
};
basics$ModuleEnvironments$.report$344 = function(v$360,v$361){var v$362 = v$361[1];
return tools$FinMap$.reportMapSORTED$534(function(v$1453){return syntax_objects$FunId$.eq_funid$100(v$1453[0],v$1453[1]);
},function(v$1454){return syntax_objects$FunId$.s$j$59(v$1454[0],v$1454[1]);
},function(v$1030){var v$1031 = v$1030[0];
var v$1032 = v$1030[1];
var v$1033 = v$1032[1];
return v$360([v$1031,v$1033]);
},v$362);
};
basics$ModuleEnvironments$.pu$388 = pickle$pickle$.convert$2333([function(v$389){return [0,v$389];
},function(v$392){return v$392[1];
}],tools$FinMap$.pu$593(function(v$1455){return syntax_objects$FunId$.eq_funid$100(v$1455[0],v$1455[1]);
},[syntax_objects$FunId$.pu$68,pickle$pickle$.pairGen$1044([pickle$pickle$.string$900,basics$ModuleStatObject$.pu$969])]));
basics$ModuleEnvironments$.empty$395 = [0,[basics$Environments$.empty$2527,basics$ModuleEnvironments$.empty$232,basics$ModuleEnvironments$.empty$72]];
basics$ModuleEnvironments$.initial$399 = function(v$401){return [0,[basics$Environments$.initial$2744(0),basics$ModuleEnvironments$.empty$232,basics$ModuleEnvironments$.empty$72]];
};
basics$ModuleEnvironments$.bogus$405 = basics$ModuleEnvironments$.empty$395;
basics$ModuleEnvironments$.plus$406 = function(v$421,v$1456){var v$422 = v$421[1];
var v$423 = v$422[1];
var v$424 = v$422[2];
var v$425 = v$422[0];
var v$427 = v$1456[1];
var v$428 = v$427[1];
var v$429 = v$427[2];
var v$430 = v$427[0];
var t$1537;
var v$418;
var v$1036 = v$423[1];
var v$1038 = v$428[1];
v$418 = [0,tools$FinMap$.plus$146(function(v$1457){return syntax_objects$FunId$.eq_funid$100(v$1457[0],v$1457[1]);
},[v$1036,v$1038])];
var v$419;
var v$1041 = v$424[1];
var v$1043 = v$429[1];
v$419 = [0,tools$FinMap$.plus$146(function(v$1458){return syntax_objects$SigId$.eq_sigid$100(v$1458[0],v$1458[1]);
},[v$1041,v$1043])];
t$1537 = [basics$Environments$.plus$2381(v$425,v$430),v$418,v$419];
return [0,t$1537];
};
basics$ModuleEnvironments$.on$431 = function(phi$434,B$437){var v$454 = B$437[1];
var v$455 = v$454[1];
var v$456 = v$454[2];
var v$457 = v$454[0];
if (basics$StatObject$.is_Id$4213(phi$434)) {return B$437;
} else {var t$1538;
var v$449;
var v$1049 = v$455[1];
v$449 = ((basics$StatObject$.is_Id$4213(phi$434))?v$455:[0,tools$FinMap$.composemap$427(function(v$1459){return syntax_objects$FunId$.eq_funid$100(v$1459[0],v$1459[1]);
},function(v$1050){var v$1051 = v$1050[0];
var v$1052 = v$1050[1];
return [v$1051,basics$ModuleStatObject$.on$768(phi$434,v$1052)];
},v$1049)]);
var v$450;
var v$1058 = v$456[1];
v$450 = ((basics$StatObject$.is_Id$4213(phi$434))?v$456:[0,tools$FinMap$.composemap$427(function(v$1460){return syntax_objects$SigId$.eq_sigid$100(v$1460[0],v$1460[1]);
},function(Sigma$1059){return basics$ModuleStatObject$.on$565(phi$434,Sigma$1059);
},v$1058)]);
t$1538 = [basics$Environments$.on_Env$3631(phi$434,v$457),v$449,v$450];
return [0,t$1538];
};
};
basics$ModuleEnvironments$.tyvars$458 = function(v$461){var v$467 = v$461[1];
var v$468 = v$467[1];
var v$470 = v$467[0];
var t$1540 = basics$StatObject$.unionTyVarSet$779;
var t$1539;
var v$1061 = v$468[1];
t$1539 = (tools$FinMap$.fold$453(function(v$1461){return syntax_objects$FunId$.eq_funid$100(v$1461[0],v$1461[1]);
},function(v$1062){var v$1063 = v$1062[0];
var v$1064 = v$1063[1];
var v$1065 = v$1062[1];
return basics$StatObject$.unionTyVarSet$779(basics$ModuleStatObject$.tyvars$748(v$1064),v$1065);
},null,v$1061));
return t$1540(t$1539,basics$Environments$.tyvars$2529(v$470));
};
basics$ModuleEnvironments$.tyvars$$471 = function(v$474){var v$480 = v$474[1];
var v$481 = v$480[1];
var v$483 = v$480[0];
var t$1543 = basis$List$.s$n$645;
var t$1542;
var t$1541;
var v$1067 = v$481[1];
t$1541 = (tools$FinMap$.fold$453(function(v$1462){return syntax_objects$FunId$.eq_funid$100(v$1462[0],v$1462[1]);
},function(v$1068){var v$1069 = v$1068[0];
var v$1070 = v$1069[1];
var v$1071 = v$1068[1];
return basis$List$.s$n$645([basics$ModuleStatObject$.tyvars$$758(v$1070),v$1071]);
},null,v$1067));
t$1542 = [t$1541,basics$Environments$.tyvars$$2530(v$483)];
return t$1543(t$1542);
};
basics$ModuleEnvironments$.tynames$484 = function(v$487){var v$493 = v$487[1];
var v$494 = v$493[1];
var v$495 = v$493[2];
var v$496 = v$493[0];
var t$1548 = special_objects$TyName$$3.union$2587;
var t$1547;
var v$1073 = v$494[1];
t$1547 = (tools$FinMap$.fold$453(function(v$1463){return syntax_objects$FunId$.eq_funid$100(v$1463[0],v$1463[1]);
},function(v$1074){var v$1075 = v$1074[0];
var v$1076 = v$1075[1];
var v$1077 = v$1074[1];
return special_objects$TyName$$3.union$2587(v$1077,basics$ModuleStatObject$.tynames$735(v$1076));
},special_objects$TyName$$3.empty$2399,v$1073));
var t$1546;
var t$1545 = special_objects$TyName$$3.union$2587;
var t$1544;
var v$1079 = v$495[1];
t$1544 = (tools$FinMap$.fold$453(function(v$1464){return syntax_objects$SigId$.eq_sigid$100(v$1464[0],v$1464[1]);
},function(v$1080){var v$1081 = v$1080[0];
var v$1082 = v$1080[1];
return special_objects$TyName$$3.union$2587(v$1082,basics$ModuleStatObject$.tynames$502(v$1081));
},special_objects$TyName$$3.empty$2399,v$1079));
t$1546 = (t$1545(t$1544,basics$Environments$.tynames$2531(v$496)));
return t$1548(t$1547,t$1546);
};
basics$ModuleEnvironments$.to_C$497 = function(v$500){var v$506 = v$500[1];
var v$509 = v$506[0];
return basics$Environments$.from_E$3231(v$509);
};
basics$ModuleEnvironments$.layout$510 = function(v$513){var v$524 = v$513[1];
var v$525 = v$524[1];
var v$526 = v$524[2];
var v$527 = v$524[0];
return [0,[[basics$ModuleEnvironments$.layout$308(v$525),[basics$ModuleEnvironments$.layout$117(v$526),[basics$Environments$.layout$2532(v$527),null]]],[0," "],"",0,""]];
};
basics$ModuleEnvironments$.plus_E$528 = function(v$541,v$1465){var v$542 = v$541[1];
var v$543 = v$542[1];
var v$544 = v$542[2];
var v$545 = v$542[0];
return [0,[basics$Environments$.plus$2381(v$545,v$1465),v$543,v$544]];
};
basics$ModuleEnvironments$.from_E$547 = function(E$550){return [0,[E$550,basics$ModuleEnvironments$.empty$232,basics$ModuleEnvironments$.empty$72]];
};
basics$ModuleEnvironments$.to_E$554 = function(v$557){return v$557[1][0];
};
basics$ModuleEnvironments$.lookup_strid$563 = function(x$1086){var v$1499 = x$1086[1][0];
return function(v$1500){return basics$Environments$.lookup_strid$2418(v$1499,v$1500);
};
};
basics$ModuleEnvironments$.lookup_longstrid$564 = function(x$1091){var v$1501 = x$1091[1][0];
return function(v$1502){return basics$Environments$.lookup_longstrid$2504(v$1501,v$1502);
};
};
basics$ModuleEnvironments$.lookup_longtycon$565 = function(x$1096){var v$1503 = x$1096[1][0];
return function(v$1504){return basics$Environments$.lookup_longtycon$2497(v$1503,v$1504);
};
};
basics$ModuleEnvironments$.from_G$566 = function(G$569){return [0,[basics$Environments$.empty$2527,basics$ModuleEnvironments$.empty$232,G$569]];
};
basics$ModuleEnvironments$.to_G$573 = function(v$576){return v$576[1][2];
};
basics$ModuleEnvironments$.plus_G$582 = function(v$595,v$1466){var v$596 = v$595[1];
var v$597 = v$596[1];
var v$598 = v$596[2];
var t$1552;
var t$1551 = v$596[0];
var t$1550 = v$597;
var t$1549;
var v$1100 = v$598[1];
var v$1102 = v$1466[1];
t$1549 = [0,tools$FinMap$.plus$146(function(v$1467){return syntax_objects$SigId$.eq_sigid$100(v$1467[0],v$1467[1]);
},[v$1100,v$1102])];
t$1552 = [t$1551,t$1550,t$1549];
return [0,t$1552];
};
basics$ModuleEnvironments$.lookup_sigid$601 = function(x$1106){var v$1416 = x$1106[1][2];
var v$1417 = v$1416[1];
return function(v$1507){return tools$FinMap$.lookup$67(function(v$1523){return syntax_objects$SigId$.eq_sigid$100(v$1523[0],v$1523[1]);
},v$1417,v$1507);
};
};
basics$ModuleEnvironments$.from_F$602 = function(F$605){return [0,[basics$Environments$.empty$2527,F$605,basics$ModuleEnvironments$.empty$72]];
};
basics$ModuleEnvironments$.to_F$609 = function(v$612){return v$612[1][1];
};
basics$ModuleEnvironments$.plus_F$618 = function(v$631,v$1469){var v$632 = v$631[1];
var v$633 = v$632[1];
var v$634 = v$632[2];
var t$1555;
var t$1554 = v$632[0];
var t$1553;
var v$1112 = v$633[1];
var v$1114 = v$1469[1];
t$1553 = [0,tools$FinMap$.plus$146(function(v$1470){return syntax_objects$FunId$.eq_funid$100(v$1470[0],v$1470[1]);
},[v$1112,v$1114])];
t$1555 = [t$1554,t$1553,v$634];
return [0,t$1555];
};
basics$ModuleEnvironments$.lookup_funid$637 = function(x$1118){var v$1422 = x$1118[1][1];
var v$1423 = v$1422[1];
return function(v$1510){return tools$FinMap$.lookup$67(function(v$1524){return syntax_objects$FunId$.eq_funid$100(v$1524[0],v$1524[1]);
},v$1423,v$1510);
};
};
basics$ModuleEnvironments$.enrich$817 = function(v$1186,v$1472){var v$1187 = v$1186[1];
var v$1188 = v$1187[1];
var v$1189 = v$1187[2];
var v$1190 = v$1187[0];
var v$1192 = v$1472[1];
var v$1193 = v$1192[1];
var v$1194 = v$1192[2];
var v$1195 = v$1192[0];
var t$1557;
var v$1198 = v$1188[1];
var v$1200 = v$1193[1];
t$1557 = (tools$FinMap$.Fold$472(function(v$1473){return syntax_objects$FunId$.eq_funid$100(v$1473[0],v$1473[1]);
},function(v$1201){var v$1202 = v$1201[0];
var v$1203 = v$1202[0];
var v$1204 = v$1202[1];
var v$1205 = v$1204[0];
var v$1206 = v$1204[1];
if (v$1201[1]) {var v$1207 = tools$FinMap$.lookup$67(function(v$1474){return syntax_objects$FunId$.eq_funid$100(v$1474[0],v$1474[1]);
},v$1198,v$1203);
switch (v$1207[0]) { case 0: {var v$1208 = v$1207[1];
var v$1209 = v$1208[0];
var v$1210 = v$1208[1];
if (v$1209 == v$1205) {return basics$ModuleStatObject$.eq$895(v$1210,v$1206);
} else {return false;
};
 break; }default: {return false;
} };
} else {return false;
};
},true,v$1200));
if (t$1557) {var t$1556;
var v$1217 = v$1189[1];
var v$1219 = v$1194[1];
t$1556 = (tools$FinMap$.Fold$472(function(v$1475){return syntax_objects$SigId$.eq_sigid$100(v$1475[0],v$1475[1]);
},function(v$1220){var v$1221 = v$1220[0];
var v$1222 = v$1221[0];
var v$1223 = v$1221[1];
if (v$1220[1]) {var v$1224 = tools$FinMap$.lookup$67(function(v$1476){return syntax_objects$SigId$.eq_sigid$100(v$1476[0],v$1476[1]);
},v$1217,v$1222);
switch (v$1224[0]) { case 0: {var v$1225 = v$1224[1];
return basics$ModuleStatObject$.eq$632(v$1225,v$1223);
 break; }default: {return false;
} };
} else {return false;
};
},true,v$1219));
if (t$1556) {var a$1226 = [v$1190,v$1195];
return basics$Environments$.enrich$2979(a$1226);
} else {return false;
};
} else {return false;
};
};
basics$ModuleEnvironments$.restrict$818 = function(v$1232,v$1477){var v$1233 = v$1232[1];
var v$1234 = v$1233[1];
var v$1235 = v$1234[1];
var v$1236 = v$1233[2];
var v$1237 = v$1236[1];
var v$1238 = v$1233[0];
var v$1240 = v$1477[3];
var v$1241 = v$1477[2];
var v$1242 = v$1477[1];
var v$1243 = v$1477[0];
var v$1244 = v$1477[4];
var F$$1245;
var b$1256 = tools$FinMap$.empty$52(function(v$1478){return syntax_objects$FunId$.eq_funid$100(v$1478[0],v$1478[1]);
});
var fix$1558 = {};
fix$1558.$foldl = function(v$1259,v$1260){if (v$1260 == null) {return v$1259;
} else {var v$1261 = v$1260;
var v$1262 = v$1261[0];
var v$1263 = v$1261[1];
var t$1560 = fix$1558.$foldl;
var t$1559;
var FunSig$1286;
var v$1287 = tools$FinMap$.lookup$67(function(v$1479){return syntax_objects$FunId$.eq_funid$100(v$1479[0],v$1479[1]);
},v$1235,v$1262);
switch (v$1287[0]) { case 0: {FunSig$1286 = v$1287[1];
 break; }default: {var s$1288 = ("restrictB.funid " + (syntax_objects$FunId$.pr_FunId$51(v$1262))) + " not in basis.";
FunSig$1286 = (tools$Crash$.impossible$50("ModuleEnvironments." + s$1288));
} };
t$1559 = (tools$FinMap$.add$132(function(v$1480){return syntax_objects$FunId$.eq_funid$100(v$1480[0],v$1480[1]);
},[v$1262,FunSig$1286,v$1259]));
return t$1560(t$1559,v$1263);
};
};
var foldl$1258 = fix$1558.$foldl;
F$$1245 = (foldl$1258(b$1256,v$1243));
var G$$1264;
var b$1275 = tools$FinMap$.empty$52(function(v$1481){return syntax_objects$SigId$.eq_sigid$100(v$1481[0],v$1481[1]);
});
var fix$1561 = {};
fix$1561.$foldl = function(v$1278,v$1279){if (v$1279 == null) {return v$1278;
} else {var v$1280 = v$1279;
var v$1281 = v$1280[0];
var v$1282 = v$1280[1];
var t$1563 = fix$1561.$foldl;
var t$1562;
var Sig$1295;
var v$1296 = tools$FinMap$.lookup$67(function(v$1482){return syntax_objects$SigId$.eq_sigid$100(v$1482[0],v$1482[1]);
},v$1237,v$1281);
switch (v$1296[0]) { case 0: {Sig$1295 = v$1296[1];
 break; }default: {var s$1297 = ("restrictB.sigid " + (syntax_objects$SigId$.pr_SigId$51(v$1281))) + " not in basis.";
Sig$1295 = (tools$Crash$.impossible$50("ModuleEnvironments." + s$1297));
} };
t$1562 = (tools$FinMap$.add$132(function(v$1483){return syntax_objects$SigId$.eq_sigid$100(v$1483[0],v$1483[1]);
},[v$1281,Sig$1295,v$1278]));
return t$1563(t$1562,v$1282);
};
};
var foldl$1277 = fix$1561.$foldl;
G$$1264 = (foldl$1277(b$1275,v$1244));
return [0,[basics$Environments$.restrict$3029(v$1238,[v$1242,v$1241,v$1240]),[0,F$$1245],[0,G$$1264]]];
};
basics$ModuleEnvironments$.domain$822 = function(v$825){var v$853 = v$825[1];
var v$854 = v$853[1];
var v$855 = v$854[1];
var v$856 = v$853[2];
var v$857 = v$856[1];
var v$858 = v$853[0];
var v$849 = basics$Environments$.un$2322(v$858);
var v$850 = v$849[0];
var v$851 = v$849[1];
var v$852 = v$849[2];
var strids$835 = edlib$EqSet$.list$98(basics$Environments$.dom$2141(v$850));
var longstrids$836;
var fix$1564 = {};
fix$1564.$map = function(v$1304){if (v$1304 == null) {return null;
} else {var v$1305 = v$1304;
var v$1306 = v$1305[0];
var v$1307 = v$1305[1];
return [syntax_objects$StrId$.longStrIdOfStrId$121(v$1306),fix$1564.$map(v$1307)];
};
};
var map$1303 = fix$1564.$map;
longstrids$836 = (map$1303(strids$835));
var vids$837 = edlib$EqSet$.list$98(basics$Environments$.dom$1145(v$852));
var longvids$838;
var fix$1565 = {};
fix$1565.$map = function(v$1311){if (v$1311 == null) {return null;
} else {var v$1312 = v$1311;
var v$1313 = v$1312[0];
var v$1314 = v$1312[1];
return [syntax_objects$Ident$.idToLongId$201(v$1313),fix$1565.$map(v$1314)];
};
};
var map$1310 = fix$1565.$map;
longvids$838 = (map$1310(vids$837));
var tycons$839 = edlib$EqSet$.list$98(basics$Environments$.dom$1795(v$851));
var longtycons$840;
var fix$1566 = {};
fix$1566.$map = function(v$1318){if (v$1318 == null) {return null;
} else {var v$1319 = v$1318;
var v$1320 = v$1319[0];
var v$1321 = v$1319[1];
return [syntax_objects$TyCon$.implode_LongTyCon$90(null,v$1320),fix$1566.$map(v$1321)];
};
};
var map$1317 = fix$1566.$map;
longtycons$840 = (map$1317(tycons$839));
return [edlib$EqSet$.list$98(tools$FinMap$.dom$394(function(v$1484){return syntax_objects$FunId$.eq_funid$100(v$1484[0],v$1484[1]);
},v$855)),longstrids$836,longtycons$840,longvids$838,edlib$EqSet$.list$98(tools$FinMap$.dom$394(function(v$1485){return syntax_objects$SigId$.eq_sigid$100(v$1485[0],v$1485[1]);
},v$857))];
};
var fix$1567 = {};
fix$1567.$agree = function(v$871,v$1486,v$1487){lab$agree: while (true) {if (v$871 == null) {return true;
} else {var v$890 = v$871;
var v$891 = v$890[0];
var v$892 = v$890[1];
var v$1391 = basics$Environments$.lookup_longstrid$2504(v$1486[1][0],v$891);
var v$1392 = basics$Environments$.lookup_longstrid$2504(v$1487[1][0],v$891);
switch (v$1391[0]) { case 0: {switch (v$1392[0]) { case 0: {var v$887 = v$1391[1];
var v$888 = v$1392[1];
if (basics$Environments$.eq$2980([v$887,v$888])) {var t$1568 = v$892;
var t$1569 = v$1486;
var t$1570 = v$1487;
var v$871 = t$1568;
var v$1486 = t$1569;
var v$1487 = t$1570;
continue lab$agree;
} else {return false;
};
 break; }default: {return false;
} };
 break; }default: {return false;
} };
};
};
};
basics$ModuleEnvironments$.agree$859 = fix$1567.$agree;
basics$ModuleEnvironments$.match$895 = function(v$907,v$1488){var v$908 = v$907[1];
var v$911 = v$908[0];
var v$913 = v$1488[1];
var v$916 = v$913[0];
return basics$Environments$.match$3037(v$911,v$916);
};
basics$ModuleEnvironments$.pu$917 = pickle$pickle$.convert$2333([function(v$1324){return [0,[v$1324[2],v$1324[0],v$1324[1]]];
},function(v$1325){var v$1326 = v$1325[1];
return [v$1326[1],v$1326[2],v$1326[0]];
}],pickle$pickle$.tup3Gen0$2340(basics$ModuleEnvironments$.pu$388,basics$ModuleEnvironments$.pu$185,basics$Environments$.pu$3085));
return 0;
})();
