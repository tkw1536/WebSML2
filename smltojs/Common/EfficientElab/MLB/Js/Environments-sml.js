if ((typeof(basics$Environments$)) == "undefined") {basics$Environments$ = {};
};
(function(){var fix$7432 = {};
fix$7432.$eq_restricter = function(v$3815,v$3816){if (v$3815 == null) {return (v$3816 == null)?true:false;
} else {if (v$3816 == null) {return false;
} else {var v$3817 = v$3815;
var v$3818 = v$3816;
var t$7698;
var fix$7694 = {};
fix$7694.$eq_list = function(v$3830,v$3831){lab$eq_list: while (true) {if (v$3830 == null) {return (v$3831 == null)?true:false;
} else {if (v$3831 == null) {return false;
} else {var v$3832 = v$3830;
var v$3833 = v$3831;
var t$7695;
var v$5743 = v$3832[0];
var v$5744 = v$3833[0];
t$7695 = ((syntax_objects$StrId$.eq_strid$172(v$5743[0],v$5744[0]))?(fix$7432.$eq_restricter(v$5743[1],v$5744[1])):false);
if (t$7695) {var t$7696 = v$3832[1];
var t$7697 = v$3833[1];
var v$3830 = t$7696;
var v$3831 = t$7697;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$3828 = fix$7694.$eq_list;
t$7698 = (eq_list$3828(v$3817[0],v$3818[0]));
if (t$7698) {var t$7693;
var fix$7690 = {};
fix$7690.$eq_list = function(v$3839,v$3840){lab$eq_list: while (true) {if (v$3839 == null) {return (v$3840 == null)?true:false;
} else {if (v$3840 == null) {return false;
} else {var v$3841 = v$3839;
var v$3842 = v$3840;
if (syntax_objects$TyCon$.eq_tycon$215(v$3841[0],v$3842[0])) {var t$7691 = v$3841[1];
var t$7692 = v$3842[1];
var v$3839 = t$7691;
var v$3840 = t$7692;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$3837 = fix$7690.$eq_list;
t$7693 = (eq_list$3837(v$3817[1],v$3818[1]));
if (t$7693) {var fix$7687 = {};
fix$7687.$eq_list = function(v$3847,v$3848){lab$eq_list: while (true) {if (v$3847 == null) {return (v$3848 == null)?true:false;
} else {if (v$3848 == null) {return false;
} else {var v$3849 = v$3847;
var v$3850 = v$3848;
if (syntax_objects$Ident$.eq_id$237(v$3849[0],v$3850[0])) {var t$7688 = v$3849[1];
var t$7689 = v$3850[1];
var v$3847 = t$7688;
var v$3848 = t$7689;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$3845 = fix$7687.$eq_list;
return eq_list$3845(v$3817[2],v$3818[2]);
} else {return false;
};
} else {return false;
};
};
};
};
basics$Environments$.eq_restricter$3813 = fix$7432.$eq_restricter;
var quotation$82 = tools$Flags$$6.is_on0$5026("quotation");
var unionTyVarSet$168 = function(v$176,v$177){var t$7441 = basis$List$.s$n$645;
var t$7440;
var t$7439 = v$176;
var t$7434;
var fix$7433 = {};
fix$7433.$filter = function(v$3874){if (v$3874 == null) {return null;
} else {var v$3875 = v$3874;
var v$3876 = v$3875[0];
var v$3877 = v$3875[1];
var t$7438;
var t$7437;
var fix$7435 = {};
fix$7435.$exists = function(v$3891){lab$exists: while (true) {if (v$3891 == null) {return false;
} else {var v$3892 = v$3891;
var v$3893 = v$3892[0];
var v$3894 = v$3892[1];
if (basics$StatObject$.eq$456(v$3876,v$3893)) {return true;
} else {var t$7436 = v$3894;
var v$3891 = t$7436;
continue lab$exists;
};
};
};
};
var exists$3890 = fix$7435.$exists;
t$7437 = (exists$3890(v$176));
t$7438 = (t$7437?false:true);
if (t$7438) {return [v$3876,fix$7433.$filter(v$3877)];
} else {return fix$7433.$filter(v$3877);
};
};
};
var filter$3873 = fix$7433.$filter;
t$7434 = (filter$3873(v$177));
t$7440 = [t$7439,t$7434];
return t$7441(t$7440);
};
var fix$7442 = {};
fix$7442.$ExplicitTyVarsTy = function(ty$182){switch (ty$182[0]) { case 0: {var v$213 = ty$182[1];
var v$214 = v$213[1];
return edlib$EqSet$.singleton$94(v$214);
 break; }case 1: {var v$209 = ty$182[1];
var v$210 = v$209[1];
switch (v$210[0]) { case 1: {return edlib$EqSet$.empty$93(0);
 break; }default: {var v$211 = v$210[1];
return fix$7442.$ExplicitTyVarsTyRow(v$211);
} };
 break; }case 4: {var v$206 = ty$182[1];
var v$207 = v$206[1];
var c$3897;
var fix$7685 = {};
fix$7685.$map = function(v$3911){if (v$3911 == null) {return null;
} else {var v$3912 = v$3911;
var v$3913 = v$3912[0];
var v$3914 = v$3912[1];
return [fix$7442.$ExplicitTyVarsTy(v$3913),fix$7685.$map(v$3914)];
};
};
var map$3910 = fix$7685.$map;
c$3897 = (map$3910(v$207));
var fix$7686 = {};
fix$7686.$foldl = function(v$3899,v$3900){if (v$3900 == null) {return v$3899;
} else {var v$3901 = v$3900;
var v$3902 = v$3901[0];
var v$3903 = v$3901[1];
return fix$7686.$foldl(edlib$EqSet$.union$330(function(v$7183){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7183[0],v$7183[1]);
},v$3902,v$3899),v$3903);
};
};
var foldl$3898 = fix$7686.$foldl;
return foldl$3898(edlib$EqSet$.empty$93(0),c$3897);
 break; }case 3: {var v$202 = ty$182[1];
var v$203 = v$202[1];
var v$204 = v$202[2];
return edlib$EqSet$.union$330(function(v$6993){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$6993[0],v$6993[1]);
},fix$7442.$ExplicitTyVarsTy(v$203),fix$7442.$ExplicitTyVarsTy(v$204));
 break; }default: {var v$215 = ty$182[1];
var v$216 = v$215[1];
return fix$7442.$ExplicitTyVarsTy(v$216);
} };
};
fix$7442.$ExplicitTyVarsTyRow = function(v$219){var v$230 = v$219[1];
var v$231 = v$230[2];
var v$232 = v$230[3];
var t$7684 = edlib$EqSet$.union$330;
var t$7683 = function(v$6991){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$6991[0],v$6991[1]);
};
var t$7682 = fix$7442.$ExplicitTyVarsTy(v$231);
var t$7681;
switch (v$232[0]) { case 1: {t$7681 = (edlib$EqSet$.empty$93(0));
 break; }default: {var v$229 = v$232[1];
t$7681 = (fix$7442.$ExplicitTyVarsTyRow(v$229));
} };
return t$7684(t$7683,t$7682,t$7681);
};
basics$Environments$.ExplicitTyVarsTy$179 = fix$7442.$ExplicitTyVarsTy;
var ExplicitTyVarsTyRow$178 = fix$7442.$ExplicitTyVarsTyRow;
var s$ff$233 = function(v$3822,v$237){var v$241 = v$237[0];
var v$242 = v$237[1];
var t$7451 = basis$List$.s$n$645;
var t$7450;
var t$7449 = v$241;
var t$7444;
var fix$7443 = {};
fix$7443.$filter = function(v$3919){if (v$3919 == null) {return null;
} else {var v$3920 = v$3919;
var v$3921 = v$3920[0];
var v$3922 = v$3920[1];
var t$7448;
var t$7447;
var fix$7445 = {};
fix$7445.$member = function(v$6945){lab$member: while (true) {if (v$6945 == null) {return false;
} else {var v$6946 = v$6945;
var v$6947 = v$6946[0];
var v$6948 = v$6946[1];
if (v$3822([v$3921,v$6947])) {return true;
} else {var t$7446 = v$6948;
var v$6945 = t$7446;
continue lab$member;
};
};
};
};
var member$6944 = fix$7445.$member;
t$7447 = (member$6944(v$241));
t$7448 = (t$7447?false:true);
if (t$7448) {return [v$3921,fix$7443.$filter(v$3922)];
} else {return fix$7443.$filter(v$3922);
};
};
};
var filter$3918 = fix$7443.$filter;
t$7444 = (filter$3918(v$242));
t$7450 = [t$7449,t$7444];
return t$7451(t$7450);
};
var fix$7452 = {};
fix$7452.$unguarded_ty = function(v$503){switch (v$503[0]) { case 0: {return [v$503[1][1],null];
 break; }case 1: {var v$534 = v$503[1];
var v$535 = v$534[1];
switch (v$535[0]) { case 0: {var v$3969 = v$535[1];
return fix$7452.$unguarded_tyrow(v$3969);
 break; }default: {return null;
} };
 break; }case 4: {var v$531 = v$503[1];
var v$532 = v$531[1];
var b$3971 = null;
var fix$7680 = {};
fix$7680.$foldl = function(v$3974,v$3975){if (v$3975 == null) {return v$3974;
} else {var v$3976 = v$3975;
var v$3977 = v$3976[0];
var v$3978 = v$3976[1];
return fix$7680.$foldl(s$ff$233(function(v$6995){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$6995[0],v$6995[1]);
},[fix$7452.$unguarded_ty(v$3977),v$3974]),v$3978);
};
};
var foldl$3973 = fix$7680.$foldl;
return foldl$3973(b$3971,v$532);
 break; }case 3: {var v$521 = v$503[1];
var v$522 = v$521[1];
var v$523 = v$521[2];
return s$ff$233(function(v$6996){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$6996[0],v$6996[1]);
},[fix$7452.$unguarded_ty(v$522),fix$7452.$unguarded_ty(v$523)]);
 break; }default: {var v$539 = v$503[1];
var v$540 = v$539[1];
return fix$7452.$unguarded_ty(v$540);
} };
};
fix$7452.$unguarded_tyrow = function(v$543){var v$548 = v$543[1];
var v$549 = v$548[2];
var v$550 = v$548[3];
var t$7679 = s$ff$233;
var t$7678 = function(v$6994){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$6994[0],v$6994[1]);
};
var t$7677;
var t$7676 = fix$7452.$unguarded_ty(v$549);
var t$7675;
switch (v$550[0]) { case 0: {var v$3963 = v$550[1];
t$7675 = (fix$7452.$unguarded_tyrow(v$3963));
 break; }default: {t$7675 = null;
} };
t$7677 = [t$7676,t$7675];
return t$7679(t$7678,t$7677);
};
var unguarded_ty$263 = fix$7452.$unguarded_ty;
var unguarded_tyrow$262 = fix$7452.$unguarded_tyrow;
var fix$7453 = {};
fix$7453.$unguarded_patrow = function(v$457){switch (v$457[0]) { case 1: {return null;
 break; }default: {var v$465 = v$457[1];
var v$466 = v$465[2];
var v$467 = v$465[3];
var t$7674 = s$ff$233;
var t$7673 = function(v$6999){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$6999[0],v$6999[1]);
};
var t$7672;
var t$7671 = fix$7453.$unguarded_pat(v$466);
var t$7670;
switch (v$467[0]) { case 0: {var v$3998 = v$467[1];
t$7670 = (fix$7453.$unguarded_patrow(v$3998));
 break; }default: {t$7670 = null;
} };
t$7672 = [t$7671,t$7670];
return t$7674(t$7673,t$7672);
} };
};
fix$7453.$unguarded_atpat = function(v$440){switch (v$440[0]) { case 2: {var v$453 = v$440[1];
var v$454 = v$453[1];
switch (v$454[0]) { case 0: {var v$3992 = v$454[1];
return fix$7453.$unguarded_patrow(v$3992);
 break; }default: {return null;
} };
 break; }case 3: {var v$450 = v$440[1];
var v$451 = v$450[1];
return fix$7453.$unguarded_pat(v$451);
 break; }default: {return null;
} };
};
fix$7453.$unguarded_pat = function(v$470){switch (v$470[0]) { case 4: {var v$499 = v$470[1];
var v$500 = v$499[1];
return fix$7453.$unguarded_atpat(v$500);
 break; }case 3: {var v$496 = v$470[1];
var v$497 = v$496[2];
return fix$7453.$unguarded_atpat(v$497);
 break; }case 1: {var v$492 = v$470[1];
var v$493 = v$492[1];
var v$494 = v$492[2];
return s$ff$233(function(v$6997){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$6997[0],v$6997[1]);
},[fix$7453.$unguarded_pat(v$493),unguarded_ty$263(v$494)]);
 break; }case 2: {var v$488 = v$470[1];
var v$489 = v$488[2];
var v$490 = v$488[3];
var t$7669 = s$ff$233;
var t$7668 = function(v$6998){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$6998[0],v$6998[1]);
};
var t$7667;
var t$7666;
switch (v$489[0]) { case 0: {var v$3984 = v$489[1];
t$7666 = (unguarded_ty$263(v$3984));
 break; }default: {t$7666 = null;
} };
t$7667 = [t$7666,fix$7453.$unguarded_pat(v$490)];
return t$7669(t$7668,t$7667);
 break; }default: {return tools$Crash$.impossible$50("Environments.unguarded_pat(UNRES_INFIX)");
} };
};
var unguarded_patrow$265 = fix$7453.$unguarded_patrow;
var unguarded_atpat$266 = fix$7453.$unguarded_atpat;
var unguarded_pat$264 = fix$7453.$unguarded_pat;
var fix$7454 = {};
fix$7454.$unguarded_exbind = function(v$424){switch (v$424[0]) { case 1: {var v$433 = v$424[1];
var v$434 = v$433[2];
var v$435 = v$433[3];
var t$7665 = s$ff$233;
var t$7664 = function(v$7000){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7000[0],v$7000[1]);
};
var t$7663;
var t$7662;
switch (v$434[0]) { case 0: {var v$4004 = v$434[1];
t$7662 = (unguarded_ty$263(v$4004));
 break; }default: {t$7662 = null;
} };
var t$7661;
switch (v$435[0]) { case 0: {var v$4010 = v$435[1];
t$7661 = (fix$7454.$unguarded_exbind(v$4010));
 break; }default: {t$7661 = null;
} };
t$7663 = [t$7662,t$7661];
return t$7665(t$7664,t$7663);
 break; }default: {var v$436 = v$424[1];
var v$437 = v$436[3];
switch (v$437[0]) { case 0: {var v$4016 = v$437[1];
return fix$7454.$unguarded_exbind(v$4016);
 break; }default: {return null;
} };
} };
};
var unguarded_exbind$267 = fix$7454.$unguarded_exbind;
var fix$7455 = {};
fix$7455.$unguarded_dec = function(v$379){switch (v$379[0]) { case 9: {var v$402 = v$379[1];
var v$403 = v$402[1];
return unguarded_exbind$267(v$403);
 break; }case 6: {var v$398 = v$379[1];
var v$399 = v$398[1];
var v$400 = v$398[2];
return s$ff$233(function(v$7001){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7001[0],v$7001[1]);
},[fix$7455.$unguarded_dec(v$399),fix$7455.$unguarded_dec(v$400)]);
 break; }case 3: {var v$394 = v$379[1];
var v$395 = v$394[1];
var v$396 = v$394[2];
return s$ff$233(function(v$7002){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7002[0],v$7002[1]);
},[fix$7455.$unguarded_dec(v$395),fix$7455.$unguarded_dec(v$396)]);
 break; }default: {return null;
} };
};
var unguarded_dec$269 = fix$7455.$unguarded_dec;
var fix$7456 = {};
fix$7456.$unguarded_exprow = function(v$302){var v$307 = v$302[1];
var v$308 = v$307[2];
var v$309 = v$307[3];
var t$7660 = s$ff$233;
var t$7659 = function(v$7009){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7009[0],v$7009[1]);
};
var t$7658;
var t$7657 = fix$7456.$unguarded_exp(v$308);
var t$7656;
switch (v$309[0]) { case 0: {var v$4036 = v$309[1];
t$7656 = (fix$7456.$unguarded_exprow(v$4036));
 break; }default: {t$7656 = null;
} };
t$7658 = [t$7657,t$7656];
return t$7660(t$7659,t$7658);
};
fix$7456.$unguarded_atexp = function(v$277){switch (v$277[0]) { case 1: {var v$298 = v$277[1];
var v$299 = v$298[1];
switch (v$299[0]) { case 0: {var v$4030 = v$299[1];
return fix$7456.$unguarded_exprow(v$4030);
 break; }default: {return null;
} };
 break; }case 3: {var v$294 = v$277[1];
var v$295 = v$294[1];
var v$296 = v$294[2];
return s$ff$233(function(v$7008){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7008[0],v$7008[1]);
},[unguarded_dec$269(v$295),fix$7456.$unguarded_exp(v$296)]);
 break; }case 2: {var v$291 = v$277[1];
var v$292 = v$291[1];
return fix$7456.$unguarded_exp(v$292);
 break; }default: {return null;
} };
};
fix$7456.$unguarded_match = function(v$359){var v$364 = v$359[1];
var v$365 = v$364[1];
var v$366 = v$364[2];
var t$7655 = s$ff$233;
var t$7654 = function(v$7007){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7007[0],v$7007[1]);
};
var t$7653;
var t$7652 = fix$7456.$unguarded_mrule(v$365);
var t$7651;
switch (v$366[0]) { case 0: {var v$4024 = v$366[1];
t$7651 = (fix$7456.$unguarded_match(v$4024));
 break; }default: {t$7651 = null;
} };
t$7653 = [t$7652,t$7651];
return t$7655(t$7654,t$7653);
};
fix$7456.$unguarded_exp = function(v$312){switch (v$312[0]) { case 5: {var v$355 = v$312[1];
var v$356 = v$355[1];
return fix$7456.$unguarded_atexp(v$356);
 break; }case 6: {var v$351 = v$312[1];
var v$352 = v$351[1];
var v$353 = v$351[2];
return s$ff$233(function(v$7004){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7004[0],v$7004[1]);
},[fix$7456.$unguarded_exp(v$352),fix$7456.$unguarded_atexp(v$353)]);
 break; }case 1: {var v$347 = v$312[1];
var v$348 = v$347[1];
var v$349 = v$347[2];
return s$ff$233(function(v$7005){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7005[0],v$7005[1]);
},[fix$7456.$unguarded_exp(v$348),unguarded_ty$263(v$349)]);
 break; }case 3: {var v$343 = v$312[1];
var v$344 = v$343[1];
var v$345 = v$343[2];
return s$ff$233(function(v$7006){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7006[0],v$7006[1]);
},[fix$7456.$unguarded_exp(v$344),fix$7456.$unguarded_match(v$345)]);
 break; }case 2: {var v$340 = v$312[1];
var v$341 = v$340[1];
return fix$7456.$unguarded_exp(v$341);
 break; }case 4: {var v$337 = v$312[1];
var v$338 = v$337[1];
return fix$7456.$unguarded_match(v$338);
 break; }default: {return tools$Crash$.impossible$50("Environments.unguarded_exp(UNRES_INFIX)");
} };
};
fix$7456.$unguarded_mrule = function(v$369){var v$374 = v$369[1];
var v$375 = v$374[1];
var v$376 = v$374[2];
return s$ff$233(function(v$7003){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7003[0],v$7003[1]);
},[unguarded_pat$264(v$375),fix$7456.$unguarded_exp(v$376)]);
};
var unguarded_exprow$273 = fix$7456.$unguarded_exprow;
var unguarded_atexp$274 = fix$7456.$unguarded_atexp;
var unguarded_match$271 = fix$7456.$unguarded_match;
var unguarded_exp$272 = fix$7456.$unguarded_exp;
var unguarded_mrule$270 = fix$7456.$unguarded_mrule;
var fix$7457 = {};
fix$7457.$unguarded_valbind = function(v$406){switch (v$406[0]) { case 1: {var v$416 = v$406[1];
var v$417 = v$416[1];
var v$418 = v$416[2];
var v$419 = v$416[3];
var t$7650 = s$ff$233;
var t$7649 = function(v$7010){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7010[0],v$7010[1]);
};
var t$7648;
var t$7647 = s$ff$233(function(v$7011){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7011[0],v$7011[1]);
},[unguarded_pat$264(v$417),unguarded_exp$272(v$418)]);
var t$7646;
switch (v$419[0]) { case 0: {var v$4042 = v$419[1];
t$7646 = (fix$7457.$unguarded_valbind(v$4042));
 break; }default: {t$7646 = null;
} };
t$7648 = [t$7647,t$7646];
return t$7650(t$7649,t$7648);
 break; }default: {var v$420 = v$406[1];
var v$421 = v$420[1];
return fix$7457.$unguarded_valbind(v$421);
} };
};
var unguarded_valbind$268 = fix$7457.$unguarded_valbind;
basics$Environments$.unguarded_valbind$551 = function(v$7417){return unguarded_valbind$268(v$7417);
};
var pu_ConArg$562 = pickle$pickle$.pairGen$1044([basics$StatObject$.pu$3818,pickle$pickle$.listGen$2100(syntax_objects$Ident$.pu$205)]);
var pu_range_private$563 = pickle$pickle$.dataGen$1479(["Environments.range_private",function(v$4049){switch (v$4049[0]) { case 0: {return 0;
 break; }case 2: {return 1;
 break; }default: {return 2;
} };
},[function(v$4050){return pickle$pickle$.con1$2005(function(v$4051){return [0,v$4051];
},function(v$4052){switch (v$4052[0]) { case 0: {return v$4052[1];
 break; }default: {return tools$Crash$.impossible$50("Environments.pu_range_private.LONGVARpriv");
} };
},basics$StatObject$.pu$3818);
},[function(v$4055){return pickle$pickle$.con1$2005(function(v$4056){return [2,v$4056];
},function(v$4057){switch (v$4057[0]) { case 2: {return v$4057[1];
 break; }default: {return tools$Crash$.impossible$50("Environments.pu_range_private.LONGCONpriv");
} };
},pu_ConArg$562);
},[function(v$4060){return pickle$pickle$.con1$2005(function(v$4061){return [1,v$4061];
},function(v$4062){switch (v$4062[0]) { case 1: {return v$4062[1];
 break; }default: {return tools$Crash$.impossible$50("Environments.pu_range_private.LONGEXCONpriv");
} };
},basics$StatObject$.pu$3427);
},null]]]]);
var pu_VarEnv$609 = pickle$pickle$.convert$2333([function(v$610){return [0,v$610];
},function(v$613){return v$613[1];
}],syntax_objects$IdentFinMap$$2.pu$1282(syntax_objects$Ident$.pu$205,pu_range_private$563));
var pu_TyStr$615 = pickle$pickle$.convert$2333([function(v$4065){return [0,[v$4065[1],v$4065[0]]];
},function(v$4066){var v$4067 = v$4066[1];
return [v$4067[1],v$4067[0]];
}],pickle$pickle$.pairGen$1044([basics$StatObject$.pu$4072,pu_VarEnv$609]));
var pu_TyEnv$636 = pickle$pickle$.convert$2333([function(v$637){return [0,v$637];
},function(v$640){return v$640[1];
}],tools$FinMap$.pu$593(function(v$7012){return syntax_objects$TyCon$.eq_tycon$215(v$7012[0],v$7012[1]);
},[syntax_objects$TyCon$.pu$183,pu_TyStr$615]));
var pu_ExplicitTyVarEnv$642 = pickle$pickle$.convert$2333([function(v$643){return [0,v$643];
},function(v$646){return v$646[1];
}],tools$FinMap$.pu$593(function(v$7013){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7013[0],v$7013[1]);
},[syntax_objects$SyntaxTyVar$.pu$84,basics$StatObject$.pu$3427]));
var v$3736 = pickle$pickle$.data2Gen$1483("Environments.Env",function(v$4068){return 0;
},[function(v$4069){var v$4070 = v$4069[1];
return pickle$pickle$.con1$2005(function(v$4071){return [0,[v$4071[0],v$4071[1],v$4071[2]]];
},function(v$4072){var v$4073 = v$4072[1];
return [v$4073[0],v$4073[1],v$4073[2]];
},pickle$pickle$.tup3Gen0$2340(v$4070,pu_TyEnv$636,pu_VarEnv$609));
},null],"Environments.StrEnv",function(v$4074){return 0;
},[function(v$4075){var v$4076 = v$4075[0];
return pickle$pickle$.con1$2005(function(v$4077){return [0,v$4077];
},function(v$4078){return v$4078[1];
},tools$FinMap$.pu$593(function(v$7014){return syntax_objects$StrId$.eq_strid$172(v$7014[0],v$7014[1]);
},[syntax_objects$StrId$.pu$134,v$4076]));
},null]);
var v$3737 = v$3736[0];
var v$3738 = v$3736[1];
var pu_Context$651 = pickle$pickle$.convert$2333([function(v$4079){return [0,[v$4079[1],v$4079[0]]];
},function(v$4080){var v$4081 = v$4080[1];
return [v$4081[1],v$4081[0]];
}],pickle$pickle$.pairGen0$974(pu_ExplicitTyVarEnv$642,v$3737));
var layoutVE$674 = function(v$707){var v$753 = v$707[1];
return (((syntax_objects$IdentFinMap$$2.layoutMap$1237(" : ","",", ",""))(function(id$4085){var t$7459;
var t$7458;
var v$4087 = syntax_objects$IdentFinMap$$2.lookup$132(v$753,id$4085);
switch (v$4087[0]) { case 0: {switch (v$4087[1][0]) { case 0: {t$7458 = "val ";
 break; }case 2: {t$7458 = "con ";
 break; }default: {t$7458 = "excon ";
} };
 break; }default: {t$7458 = (tools$Crash$.impossible$50("Environments.layoutVE.format_id>"));
} };
t$7459 = (t$7458 + (syntax_objects$Ident$.pr_id$53(id$4085)));
return [1,t$7459];
}))(function(v$4091){switch (v$4091[0]) { case 0: {var v$4092 = v$4091[1];
return basics$StatObject$.layout$3439(v$4092[0],v$4092[1]);
 break; }case 2: {var v$4093 = v$4091[1];
var v$4094 = v$4093[0];
return basics$StatObject$.layout$3439(v$4094[0],v$4094[1]);
 break; }default: {var v$4095 = v$4091[1];
return basics$StatObject$.layout$870(v$4095);
} };
}))(v$753);
};
var layoutTE$675 = function(v$693){var v$704 = v$693[1];
return (((tools$FinMap$.layoutMap$552(function(v$7015){return syntax_objects$TyCon$.eq_tycon$215(v$7015[0],v$7015[1]);
},[" : ","",", ",""]))(function(t$703){return [1,"tycon " + (syntax_objects$TyCon$.pr_TyCon$53(t$703))];
}))(function(v$4097){var v$4098 = v$4097[1];
var v$4099 = v$4098[1];
var v$4100 = v$4098[0];
return [0,[[basics$StatObject$.layout$3820(v$4099),[layoutVE$674(v$4100),null]],[0,", "],")",0,"("]];
}))(v$704);
};
var fix$7460 = {};
fix$7460.$layoutSE = function(v$679){var v$690 = v$679[1];
return (((tools$FinMap$.layoutMap$552(function(v$7016){return syntax_objects$StrId$.eq_strid$172(v$7016[0],v$7016[1]);
},[" : ","",", ",""]))(function(s$689){return [1,"structure " + (syntax_objects$StrId$.pr_StrId$52(s$689))];
}))(function(v$7418){return fix$7460.$layoutEnv(v$7418);
}))(v$690);
};
fix$7460.$layoutEnv = function(v$771){var v$782 = v$771[1];
var v$783 = v$782[0];
var v$784 = v$782[1];
var v$785 = v$782[2];
return [0,[[fix$7460.$layoutSE(v$783),[layoutTE$675(v$784),[layoutVE$674(v$785),null]]],[1],"}",1,"{"]];
};
var layoutSE$676 = fix$7460.$layoutSE;
var layoutEnv$672 = fix$7460.$layoutEnv;
var proj0$787 = function(expl$790,impl$793,longids$796,strid$799){var fix$7461 = {};
fix$7461.$loop = function(v$812,v$7017){lab$loop: while (true) {if (v$812 == null) {return v$7017;
} else {var v$830 = v$812;
var v$831 = v$830[0];
var v$832 = v$830[1];
var v$820 = expl$790(v$831);
var v$821 = v$820[0];
if (v$821 == null) {var t$7462 = v$832;
var t$7463 = v$7017;
var v$812 = t$7462;
var v$7017 = t$7463;
continue lab$loop;
} else {var v$826 = v$821;
var v$827 = v$826[0];
var v$828 = v$826[1];
var v$829 = v$820[1];
if (syntax_objects$StrId$.eq_strid$172(strid$799,v$827)) {var t$7464 = v$832;
var t$7465 = [impl$793([v$828,v$829]),v$7017];
var v$812 = t$7464;
var v$7017 = t$7465;
continue lab$loop;
} else {var t$7466 = v$832;
var t$7467 = v$7017;
var v$812 = t$7466;
var v$7017 = t$7467;
continue lab$loop;
};
};
};
};
};
var loop$800 = fix$7461.$loop;
return loop$800(longids$796,null);
};
var qual0$834 = function(expl$837,longids$840,acc$843){var fix$7468 = {};
fix$7468.$loop = function(v$856,v$7018){if (v$856 == null) {return v$7018;
} else {var v$888 = v$856;
var v$889 = v$888[0];
var v$890 = v$888[1];
var v$862 = expl$837(v$889);
var v$863 = v$862[0];
if (v$863 == null) {return fix$7468.$loop(v$890,v$7018);
} else {var v$886 = v$863;
var v$887 = v$886[0];
var fix$7469 = {};
fix$7469.$ins = function(v$867){if (v$867 == null) {return [v$887,null];
} else {var v$883 = v$867;
var v$884 = v$883[0];
var v$885 = v$883[1];
return (syntax_objects$StrId$.eq_strid$172(v$887,v$884))?v$867:((syntax_objects$StrId$.s$j$125(v$887,v$884))?[v$887,v$867]:[v$884,fix$7469.$ins(v$885)]);
};
};
var ins$864 = fix$7469.$ins;
return fix$7468.$loop(v$890,ins$864(v$7018));
};
};
};
var loop$844 = fix$7468.$loop;
return loop$844(longids$840,acc$843);
};
var fix$7470 = {};
fix$7470.$create_restricter = function(v$7019,v$7020,v$7021){var v$1023;
var v$4176;
var v$4181;
var b$6951 = null;
var fix$7618 = {};
fix$7618.$foldl = function(v$6953,v$6954){lab$foldl: while (true) {if (v$6954 == null) {return v$6953;
} else {var v$6955 = v$6954;
var v$6956 = v$6955[0];
var v$6957 = v$6955[1];
var t$7619;
var v$6958 = syntax_objects$Ident$.decompose$87(v$6956);
t$7619 = ((v$6958[0] == null)?[v$6958[1],v$6953]:v$6953);
var t$7620 = t$7619;
var t$7621 = v$6957;
var v$6953 = t$7620;
var v$6954 = t$7621;
continue lab$foldl;
};
};
};
var foldl$6952 = fix$7618.$foldl;
v$4181 = (foldl$6952(b$6951,v$7021));
var v$4182;
var b$6961 = null;
var fix$7622 = {};
fix$7622.$foldl = function(v$6963,v$6964){lab$foldl: while (true) {if (v$6964 == null) {return v$6963;
} else {var v$6965 = v$6964;
var v$6966 = v$6965[0];
var v$6967 = v$6965[1];
var t$7623;
var v$6968 = syntax_objects$TyCon$.explode_LongTyCon$97(v$6966);
t$7623 = ((v$6968[0] == null)?[v$6968[1],v$6963]:v$6963);
var t$7624 = t$7623;
var t$7625 = v$6967;
var v$6963 = t$7624;
var v$6964 = t$7625;
continue lab$foldl;
};
};
};
var foldl$6962 = fix$7622.$foldl;
v$4182 = (foldl$6962(b$6961,v$7020));
var t$7626;
var b$6971 = null;
var fix$7627 = {};
fix$7627.$foldl = function(v$6973,v$6974){lab$foldl: while (true) {if (v$6974 == null) {return v$6973;
} else {var v$6975 = v$6974;
var v$6976 = v$6975[0];
var v$6977 = v$6975[1];
var t$7628;
var v$6978 = syntax_objects$StrId$.explode_longstrid$83(v$6976);
t$7628 = ((v$6978[0] == null)?[v$6978[1],v$6973]:v$6973);
var t$7629 = t$7628;
var t$7630 = v$6977;
var v$6973 = t$7629;
var v$6974 = t$7630;
continue lab$foldl;
};
};
};
var foldl$6972 = fix$7627.$foldl;
t$7626 = (foldl$6972(b$6971,v$7019));
v$4176 = [t$7626,v$4182,v$4181];
var v$4183 = v$4176[2];
var v$4184 = v$4176[0];
var v$4185 = v$4176[1];
var qual$4186;
var fix$7631 = {};
fix$7631.$setminus = function(v$7022,v$4189){if (v$4189 == null) {return v$7022;
} else {var v$4191 = v$4189;
var v$4192 = v$4191[0];
var v$4193 = v$4191[1];
var fix$7632 = {};
fix$7632.$rem = function(v$4195){lab$rem: while (true) {if (v$4195 == null) {return null;
} else {var v$4196 = v$4195;
var v$4197 = v$4196[0];
var v$4198 = v$4196[1];
if (syntax_objects$StrId$.eq_strid$172(v$4197,v$4192)) {var t$7633 = v$4198;
var v$4195 = t$7633;
continue lab$rem;
} else {return [v$4197,fix$7632.$rem(v$4198)];
};
};
};
};
var rem$4194 = fix$7632.$rem;
return fix$7631.$setminus(rem$4194(v$7022),v$4193);
};
};
var setminus$4187 = fix$7631.$setminus;
qual$4186 = (setminus$4187(qual0$834(function(v$7419){return syntax_objects$StrId$.explode_longstrid$83(v$7419);
},v$7019,qual0$834(function(v$7420){return syntax_objects$TyCon$.explode_LongTyCon$97(v$7420);
},v$7020,qual0$834(function(v$7421){return syntax_objects$Ident$.decompose$87(v$7421);
},v$7021,null))),v$4184));
var t$7635;
var fix$7634 = {};
fix$7634.$map = function(v$4217){if (v$4217 == null) {return null;
} else {var v$4218 = v$4217;
var v$4219 = v$4218[0];
var v$4220 = v$4218[1];
return [[v$4219,[proj0$787(function(v$7422){return syntax_objects$StrId$.explode_longstrid$83(v$7422);
},function(v$7023){return syntax_objects$StrId$.implode_longstrid$76(v$7023[0],v$7023[1]);
},v$7019,v$4219),proj0$787(function(v$7423){return syntax_objects$TyCon$.explode_LongTyCon$97(v$7423);
},function(v$7024){return syntax_objects$TyCon$.implode_LongTyCon$90(v$7024[0],v$7024[1]);
},v$7020,v$4219),proj0$787(function(v$7424){return syntax_objects$Ident$.decompose$87(v$7424);
},function(v$7025){return syntax_objects$Ident$.implode_LongId$113(v$7025[0],v$7025[1]);
},v$7021,v$4219)]],fix$7634.$map(v$4220)];
};
};
var map$4216 = fix$7634.$map;
t$7635 = (map$4216(qual$4186));
v$1023 = [t$7635,v$4184,v$4185,v$4183];
var v$1024 = v$1023[3];
var v$1025 = v$1023[2];
var v$1026 = v$1023[1];
var v$1027 = v$1023[0];
var t$7645;
var t$7644;
var t$7643 = basis$List$.s$n$645;
var t$7642;
var t$7641;
var fix$7640 = {};
fix$7640.$map = function(v$4231){if (v$4231 == null) {return null;
} else {var v$4232 = v$4231;
var v$4233 = v$4232[0];
var v$4234 = v$4232[1];
return [[v$4233,null],fix$7640.$map(v$4234)];
};
};
var map$4230 = fix$7640.$map;
t$7641 = (map$4230(v$1026));
var t$7637;
var fix$7636 = {};
fix$7636.$map = function(v$4238){if (v$4238 == null) {return null;
} else {var v$4239 = v$4238;
var v$4240 = v$4239[0];
var v$4241 = v$4239[1];
var t$7639;
var t$7638;
var v$6246 = v$4240[0];
var v$6247 = v$4240[1];
t$7638 = [v$6246,fix$7470.$create_restricter(v$6247[0],v$6247[1],v$6247[2])];
t$7639 = [t$7638,fix$7636.$map(v$4241)];
return t$7639;
};
};
var map$4237 = fix$7636.$map;
t$7637 = (map$4237(v$1027));
t$7642 = [t$7641,t$7637];
t$7644 = (t$7643(t$7642));
t$7645 = [t$7644,v$1025,v$1024];
return t$7645;
};
basics$Environments$.create_restricter$1002 = fix$7470.$create_restricter;
basics$Environments$.empty$1031 = [0,syntax_objects$IdentFinMap$$2.empty$116(0)];
basics$Environments$.bogus$1032 = basics$Environments$.empty$1031;
basics$Environments$.singleton_var$1037 = function(v$1042,v$1043){var v$7344 = [0,v$1043];
return [0,syntax_objects$IdentFinMap$$2.singleton$117(v$1042,v$7344)];
};
basics$Environments$.singleton_con$1044 = function(v$1050,v$1051,v$1052){var v$7346 = [2,[v$1051,v$1052]];
return [0,syntax_objects$IdentFinMap$$2.singleton$117(v$1050,v$7346)];
};
basics$Environments$.singleton_excon$1053 = function(v$1058,v$1059){var v$7348 = [1,v$1059];
return [0,syntax_objects$IdentFinMap$$2.singleton$117(v$1058,v$7348)];
};
basics$Environments$.plus$1080 = function(v$1088,v$7026){var v$1089 = v$1088[1];
var v$1091 = v$7026[1];
return [0,syntax_objects$IdentFinMap$$2.plus$404(v$1089,v$1091)];
};
basics$Environments$.lookup$1111 = function(v$1114,id$1117){var v$1143 = v$1114[1];
try {var v$4246 = syntax_objects$IdentFinMap$$2.lookup$132(v$1143,id$1117);
switch (v$4246[0]) { case 0: {var v$4250 = v$4246[1];
var t$7472;
switch (v$4250[0]) { case 0: {var v$6259 = v$4250[1];
t$7472 = [0,v$6259];
 break; }case 2: {var v$6260 = v$4250[1];
var v$6261 = v$6260[0];
t$7472 = [2,v$6261];
 break; }default: {var v$6262 = v$4250[1];
t$7472 = [1,v$6262];
} };
return [0,t$7472];
 break; }default: {return [1];
} };
} catch(v$7471) {return (function(Crash$CRASH$1124){var t$7473 = Crash$CRASH$1124;
if (t$7473[0] == tools$Crash$.en$CRASH$45) {basis$TextIO$.output$101([0],"Environments.lookup\n");
var st$1129 = (((syntax_objects$IdentFinMap$$2.layoutMap$1237("","}",", ","{"))(function(id$1136){return [1,syntax_objects$Ident$.pr_id$53(id$1136)];
}))(function(v$1138){return [1,""];
}))(v$1143);
var os$1139 = basis$TextIO$.openOut$99("madsdebug");
basis$TextIO$.output$101(os$1139,tools$PrettyPrint$.flatten1$388(st$1129));
basis$TextIO$.closeOut$120(os$1139);
throw tools$Crash$.exn$CRASH$45;
} else {throw Crash$CRASH$1124;
};
})(v$7471);
};
};
basics$Environments$.dom$1145 = function(v$1148){var v$1152 = v$1148[1];
return edlib$EqSet$.fromList$106(function(v$7027){return syntax_objects$Ident$.eq_id$237(v$7027[0],v$7027[1]);
},syntax_objects$IdentFinMap$$2.dom$732(v$1152));
};
basics$Environments$.is_empty$1153 = function(v$1156){var v$1160 = v$1156[1];
return syntax_objects$IdentFinMap$$2.isEmpty$124(v$1160);
};
basics$Environments$.eq$1175 = function(v$1234,v$7028){var v$1235 = v$1234[1];
var v$1237 = v$7028[1];
var alist1$1192;
var v$7194 = syntax_objects$IdentFinMap$$2.list$786(v$1235);
alist1$1192 = (edlib$ListSort$.sort$45(function(v$7195){var v$7196 = v$7195[0];
return function(v$7197){var v$7198 = v$7197[0];
return syntax_objects$Ident$.s$j$121(v$7196,v$7198);
};
},v$7194));
var alist2$1193;
var v$7200 = syntax_objects$IdentFinMap$$2.list$786(v$1237);
alist2$1193 = (edlib$ListSort$.sort$45(function(v$7201){var v$7202 = v$7201[0];
return function(v$7203){var v$7204 = v$7203[0];
return syntax_objects$Ident$.s$j$121(v$7202,v$7204);
};
},v$7200));
try {var c$4262 = tools$BasisCompat$.zipEq$46(alist1$1192,alist2$1193);
var fix$7475 = {};
fix$7475.$foldl = function(v$4264,v$4265){lab$foldl: while (true) {if (v$4265 == null) {return v$4264;
} else {var v$4266 = v$4265;
var v$4267 = v$4266[0];
var v$4268 = v$4266[1];
var t$7476;
var v$6265 = v$4267[0];
var v$6266 = v$6265[1];
switch (v$6266[0]) { case 2: {var v$6267 = v$4267[1];
var v$6268 = v$6267[1];
switch (v$6268[0]) { case 2: {var v$6269 = v$6265[0];
var v$6270 = v$6266[1];
var v$6271 = v$6270[0];
var v$6272 = v$6267[0];
var v$6273 = v$6268[1];
var v$6274 = v$6273[0];
t$7476 = (v$4264?((syntax_objects$Ident$.eq_id$237(v$6269,v$6272))?(basics$StatObject$.eq$3593(v$6271,v$6274)):false):false);
 break; }default: {t$7476 = (tools$Crash$.impossible$50("Environments.VE.eq: VE contains non-constructors"));
} };
 break; }default: {t$7476 = (tools$Crash$.impossible$50("Environments.VE.eq: VE contains non-constructors"));
} };
var t$7477 = t$7476;
var t$7478 = v$4268;
var v$4264 = t$7477;
var v$4265 = t$7478;
continue lab$foldl;
};
};
};
var foldl$4263 = fix$7475.$foldl;
return foldl$4263(true,c$4262);
} catch(v$7474) {return (function(BasisCompat$ListPair$UnequalLengths$1233){var t$7479 = BasisCompat$ListPair$UnequalLengths$1233;
if (t$7479[0] == tools$BasisCompat$.en$UnequalLengths$45) {return false;
} else {throw BasisCompat$ListPair$UnequalLengths$1233;
};
})(v$7474);
};
};
basics$Environments$.fold$1238 = function(f$1241,start$1244,v$1247){var v$1262 = v$1247[1];
return syntax_objects$IdentFinMap$$2.fold$861(function(v$1256){var v$1257 = v$1256[0];
var v$1258 = v$1256[1];
var t$7482;
var t$7481 = f$1241;
var t$7480;
switch (v$1257[0]) { case 0: {var v$4282 = v$1257[1];
t$7480 = [0,v$4282];
 break; }case 2: {var v$4283 = v$1257[1];
var v$4284 = v$4283[0];
t$7480 = [2,v$4284];
 break; }default: {var v$4285 = v$1257[1];
t$7480 = [1,v$4285];
} };
t$7482 = (t$7481(t$7480));
return t$7482(v$1258);
},start$1244,v$1262);
};
basics$Environments$.Fold$1294 = function(f$1297,start$1300,v$1303){var v$1321 = v$1303[1];
return syntax_objects$IdentFinMap$$2.Fold$894(function(v$1313){var v$1314 = v$1313[0];
var v$1315 = v$1314[0];
var v$1316 = v$1314[1];
var v$1317 = v$1313[1];
var t$7487;
var t$7486 = f$1297;
var t$7485;
var t$7484 = v$1315;
var t$7483;
switch (v$1316[0]) { case 0: {var v$4291 = v$1316[1];
t$7483 = [0,v$4291];
 break; }case 2: {var v$4292 = v$1316[1];
var v$4293 = v$4292[0];
t$7483 = [2,v$4293];
 break; }default: {var v$4294 = v$1316[1];
t$7483 = [1,v$4294];
} };
t$7485 = [t$7484,t$7483];
t$7487 = (t$7486(t$7485));
return t$7487(v$1317);
},start$1300,v$1321);
};
basics$Environments$.apply$1322 = function(f$1325,v$1328){var v$1341 = v$1328[1];
var fix$7488 = {};
fix$7488.$app = function(v$4302){lab$app: while (true) {if (v$4302 == null) {return 0;
} else {var v$4303 = v$4302;
var v$4304 = v$4303[0];
var v$4305 = v$4303[1];
var v$4312 = v$4304[0];
var v$4313 = v$4304[1];
var t$7492 = f$1325;
var t$7491;
var t$7490 = v$4312;
var t$7489;
switch (v$4313[0]) { case 0: {var v$4315 = v$4313[1];
t$7489 = [0,v$4315];
 break; }case 2: {var v$4316 = v$4313[1];
var v$4317 = v$4316[0];
t$7489 = [2,v$4317];
 break; }default: {var v$4318 = v$4313[1];
t$7489 = [1,v$4318];
} };
t$7491 = [t$7490,t$7489];
t$7492(t$7491);
var t$7493 = v$4305;
var v$4302 = t$7493;
continue lab$app;
};
};
};
var app$4301 = fix$7488.$app;
return app$4301(syntax_objects$IdentFinMap$$2.list$786(v$1341));
};
basics$Environments$.CEfold$1342 = function(f$1345,start$6276,v$6277){var v$6278 = v$6277[1];
return syntax_objects$IdentFinMap$$2.fold$861(function(v$6279){var v$6280 = v$6279[0];
var v$6281 = v$6279[1];
var range$6979;
switch (v$6280[0]) { case 0: {var v$6282 = v$6280[1];
range$6979 = [0,v$6282];
 break; }case 2: {var v$6283 = v$6280[1];
var v$6284 = v$6283[0];
range$6979 = [2,v$6284];
 break; }default: {var v$6285 = v$6280[1];
range$6979 = [1,v$6285];
} };
switch (range$6979[0]) { case 2: {var v$6981 = range$6979[1];
return (f$1345(v$6981))(v$6281);
 break; }default: {return tools$Crash$.impossible$50("Environments.CEfold: VE contains non-constructors");
} };
},start$6276,v$6278);
};
basics$Environments$.CEFold$1359 = function(f$1362){return function(v$7151){return function(v$7152){return basics$Environments$.Fold$1294(function(v$7205){var v$7206 = v$7205[0];
var v$7207 = v$7205[1];
return function(a$7208){switch (v$7207[0]) { case 2: {var v$7209 = v$7207[1];
return (f$1362([v$7206,v$7209]))(a$7208);
 break; }default: {return tools$Crash$.impossible$50("Environments.CEFold: VE contains non-constructors");
} };
};
},v$7151,v$7152);
};
};
};
basics$Environments$.close$1379 = function(VE$1382){var v$4330 = VE$1382[1];
return syntax_objects$IdentFinMap$$2.Fold$894(function(v$4332){var v$4333 = v$4332[0];
var v$4334 = v$4332[1];
var v$6309 = v$4333[0];
var v$6310 = v$4333[1];
var range_private$6312;
switch (v$6310[0]) { case 0: {var v$6313 = v$6310[1];
range_private$6312 = [0,basics$StatObject$.close$3711(true,v$6313)];
 break; }case 2: {var v$6314 = v$6310[1];
var v$6315 = v$6314[0];
var v$6316 = v$6314[1];
range_private$6312 = [2,[basics$StatObject$.close$3711(true,v$6315),v$6316]];
 break; }default: {var v$6317 = v$6310[1];
range_private$6312 = [1,v$6317];
} };
var v$6318 = v$4334[1];
return [0,syntax_objects$IdentFinMap$$2.add$392(v$6309,range_private$6312,v$6318)];
},basics$Environments$.empty$1031,v$4330);
};
basics$Environments$.on$1442 = function(v$7029,v$7030){return v$7030;
};
basics$Environments$.restrict$1454 = function(v$1481,v$7031){var v$1482 = v$1481[1];
var t$7495;
var fix$7494 = {};
fix$7494.$foldl = function(v$4349,v$4350){if (v$4350 == null) {return v$4349;
} else {var v$4351 = v$4350;
var v$4352 = v$4351[0];
var v$4353 = v$4351[1];
var t$7499 = fix$7494.$foldl;
var t$7496;
var r$6322;
var v$6323 = syntax_objects$IdentFinMap$$2.lookup$132(v$1482,v$4352);
switch (v$6323[0]) { case 0: {r$6322 = v$6323[1];
 break; }default: {try {var s$6324 = "VE.restrict: cannot find id " + (syntax_objects$Ident$.pr_id$53(v$4352));
r$6322 = (tools$Crash$.impossible$50("Environments." + s$6324));
} catch(v$7497) {r$6322 = ((function(Crash$CRASH$6325){var t$7498 = Crash$CRASH$6325;
if (t$7498[0] == tools$Crash$.en$CRASH$45) {basis$TextIO$.output$101([0],"Environments.restrict\n");
throw tools$Crash$.exn$CRASH$45;
} else {throw Crash$CRASH$6325;
};
})(v$7497));
};
} };
t$7496 = (syntax_objects$IdentFinMap$$2.add$392(v$4352,r$6322,v$4349));
return t$7499(t$7496,v$4353);
};
};
var foldl$4348 = fix$7494.$foldl;
t$7495 = (foldl$4348(syntax_objects$IdentFinMap$$2.empty$116(0),v$7031));
return [0,t$7495];
};
var match$1528 = function(v$1548,v$1549){return basics$Environments$.Fold$1294(function(v$1536){var v$1546 = v$1536[0];
var v$1547 = v$1536[1];
return function(v$1538){var v$1543 = basics$Environments$.lookup$1111(v$1549,v$1546);
switch (v$1543[0]) { case 0: {var v$1545 = v$1543[1];
switch (v$1547[0]) { case 0: {switch (v$1545[0]) { case 0: {var v$4366 = v$1547[1];
var v$4367 = v$1545[1];
return basics$StatObject$.match$3809(v$4366,v$4367);
 break; }default: {return 0;
} };
 break; }case 2: {switch (v$1545[0]) { case 2: {var v$4370 = v$1547[1];
var v$4371 = v$1545[1];
return basics$StatObject$.match$3809(v$4370,v$4371);
 break; }default: {return 0;
} };
 break; }default: {switch (v$1545[0]) { case 1: {var v$4374 = v$1547[1];
var v$4375 = v$1545[1];
var a$4376 = [v$4374,v$4375];
return basics$StatObject$.match$3426(a$4376);
 break; }default: {return 0;
} };
} };
 break; }default: {return 0;
} };
};
},0,v$1548);
};
basics$Environments$.report$1550 = function(v$1566,v$1567){var v$1568 = v$1567[1];
var l$1558 = syntax_objects$IdentFinMap$$2.list$786(v$1568);
var m$1559 = tools$FinMap$.fromList$523(function(v$7032){return syntax_objects$Ident$.eq_id$237(v$7032[0],v$7032[1]);
},l$1558);
return tools$FinMap$.reportMapSORTED$534(function(v$7033){return syntax_objects$Ident$.eq_id$237(v$7033[0],v$7033[1]);
},function(v$7034){return syntax_objects$Ident$.s$j$121(v$7034[0],v$7034[1]);
},function(v$1563){var v$1564 = v$1563[0];
var v$1565 = v$1563[1];
var t$7503 = v$1566;
var t$7502;
var t$7501 = v$1564;
var t$7500;
switch (v$1565[0]) { case 0: {var v$4378 = v$1565[1];
t$7500 = [0,v$4378];
 break; }case 2: {var v$4379 = v$1565[1];
var v$4380 = v$4379[0];
t$7500 = [2,v$4380];
 break; }default: {var v$4381 = v$1565[1];
t$7500 = [1,v$4381];
} };
t$7502 = [t$7501,t$7500];
return t$7503(t$7502);
},m$1559);
};
basics$Environments$.layout$1569 = function(v$7425){return layoutVE$674(v$7425);
};
var tyvars$1588;
var start$6327 = null;
tyvars$1588 = (function(v$6328){var v$6329 = v$6328[1];
return syntax_objects$IdentFinMap$$2.fold$861(function(v$6330){var v$6331 = v$6330[0];
var v$6332 = v$6330[1];
var range$6982;
switch (v$6331[0]) { case 0: {var v$6333 = v$6331[1];
range$6982 = [0,v$6333];
 break; }case 2: {var v$6334 = v$6331[1];
var v$6335 = v$6334[0];
range$6982 = [2,v$6335];
 break; }default: {var v$6336 = v$6331[1];
range$6982 = [1,v$6336];
} };
var t$7506 = unionTyVarSet$168;
var t$7505 = v$6332;
var t$7504;
switch (range$6982[0]) { case 0: {var v$6984 = range$6982[1];
t$7504 = (basics$StatObject$.tyvars$3646(v$6984[0],v$6984[1]));
 break; }case 2: {var v$6985 = range$6982[1];
t$7504 = (basics$StatObject$.tyvars$3646(v$6985[0],v$6985[1]));
 break; }default: {var v$6986 = range$6982[1];
t$7504 = (basics$StatObject$.tyvars$1912(v$6986));
} };
return t$7506(t$7505,t$7504);
},start$6327,v$6329);
});
var tyvars$$1595;
var v$7156 = null;
tyvars$$1595 = (function(v$7157){return basics$Environments$.Fold$1294(function(v$7210){var v$7211 = v$7210[0];
var v$7212 = v$7210[1];
return function(criminals$7213){var v$7214;
switch (v$7212[0]) { case 0: {var v$7215 = v$7212[1];
v$7214 = (basics$StatObject$.tyvars$3646(v$7215[0],v$7215[1]));
 break; }case 2: {var v$7216 = v$7212[1];
v$7214 = (basics$StatObject$.tyvars$3646(v$7216[0],v$7216[1]));
 break; }default: {var v$7217 = v$7212[1];
v$7214 = (basics$StatObject$.tyvars$1912(v$7217));
} };
return (v$7214 == null)?criminals$7213:[[v$7211,v$7214],criminals$7213];
};
},v$7156,v$7157);
});
basics$Environments$.tynames$1628 = function(v$6339){var v$6340 = v$6339[1];
return syntax_objects$IdentFinMap$$2.fold$861(function(v$6341){var v$6342 = v$6341[0];
var v$6343 = v$6341[1];
var x$6987;
switch (v$6342[0]) { case 0: {var v$6344 = v$6342[1];
x$6987 = [0,v$6344];
 break; }case 2: {var v$6345 = v$6342[1];
var v$6346 = v$6345[0];
x$6987 = [2,v$6346];
 break; }default: {var v$6347 = v$6342[1];
x$6987 = [1,v$6347];
} };
var v$7158;
switch (x$6987[0]) { case 0: {var v$6988 = x$6987[1];
v$7158 = (basics$StatObject$.tynames$3651(v$6988[0],v$6988[1]));
 break; }case 2: {var v$6989 = x$6987[1];
v$7158 = (basics$StatObject$.tynames$3651(v$6989[0],v$6989[1]));
 break; }default: {var v$6990 = x$6987[1];
v$7158 = (basics$StatObject$.tynames$1920(v$6990));
} };
return special_objects$TyName$$3.union$2587(v$7158,v$6343);
},special_objects$TyName$$3.empty$2399,v$6340);
};
basics$Environments$.ids_with_tyvar_in_type_scheme$1629 = function(VE$1632,tyvar$1635){return basics$Environments$.Fold$1294(function(v$1639){var v$1647 = v$1639[0];
var v$1648 = v$1639[1];
return function(ids$1642){var t$7507;
var set$4399;
switch (v$1648[0]) { case 0: {var v$4407 = v$1648[1];
set$4399 = (basics$StatObject$.tyvars$3646(v$4407[0],v$4407[1]));
 break; }case 2: {var v$4408 = v$1648[1];
set$4399 = (basics$StatObject$.tyvars$3646(v$4408[0],v$4408[1]));
 break; }default: {var v$4409 = v$1648[1];
set$4399 = (basics$StatObject$.tyvars$1912(v$4409));
} };
var fix$7508 = {};
fix$7508.$exists = function(v$4401){lab$exists: while (true) {if (v$4401 == null) {return false;
} else {var v$4402 = v$4401;
var v$4403 = v$4402[0];
var v$4404 = v$4402[1];
if (basics$StatObject$.eq$456(tyvar$1635,v$4403)) {return true;
} else {var t$7509 = v$4404;
var v$4401 = t$7509;
continue lab$exists;
};
};
};
};
var exists$4400 = fix$7508.$exists;
t$7507 = (exists$4400(set$4399));
return t$7507?[v$1647,ids$1642]:ids$1642;
};
},null,VE$1632);
};
basics$Environments$.pu$1649 = pu_VarEnv$609;
basics$Environments$.from_theta_and_VE$1650 = function(v$7035,v$7036){return [0,[v$7036,v$7035]];
};
basics$Environments$.to_theta_and_VE$1659 = function(v$1662){var v$1667 = v$1662[1];
return [v$1667[1],v$1667[0]];
};
basics$Environments$.to_theta$1670 = function(v$1673){return v$1673[1][1];
};
basics$Environments$.to_VE$1681 = function(v$1684){return v$1684[1][0];
};
basics$Environments$.eq$1692 = function(v$1706,v$7037){var v$1707 = v$1706[1];
var v$1708 = v$1707[1];
var v$1709 = v$1707[0];
var v$1711 = v$7037[1];
var v$1712 = v$1711[1];
var v$1713 = v$1711[0];
if (basics$StatObject$.eq$3837(v$1708,v$1712)) {return basics$Environments$.eq$1175(v$1709,v$1713);
} else {return false;
};
};
basics$Environments$.shares$1714 = function(v$1722,v$7038){var v$1723 = v$1722[1];
var v$1724 = v$1723[1];
var v$1726 = v$7038[1];
var v$1727 = v$1726[1];
return basics$StatObject$.eq$3837(v$1724,v$1727);
};
basics$Environments$.tynames$1728 = function(v$1731){var v$1736 = v$1731[1];
var v$1737 = v$1736[1];
var v$1738 = v$1736[0];
return special_objects$TyName$$3.union$2587(basics$StatObject$.tynames$3912(v$1737),basics$Environments$.tynames$1628(v$1738));
};
basics$Environments$.layout$1739 = function(v$4410){var v$4411 = v$4410[1];
var v$4412 = v$4411[1];
var v$4413 = v$4411[0];
return [0,[[basics$StatObject$.layout$3820(v$4412),[layoutVE$674(v$4413),null]],[0,", "],")",0,"("]];
};
basics$Environments$.pu$1764 = pu_TyStr$615;
basics$Environments$.empty$1765 = [0,tools$FinMap$.empty$52(function(v$7039){return syntax_objects$TyCon$.eq_tycon$215(v$7039[0],v$7039[1]);
})];
basics$Environments$.bogus$1766 = basics$Environments$.empty$1765;
basics$Environments$.singleton$1767 = function(x$4418){var v$6357 = tools$FinMap$.singleton$53(function(v$7220){return syntax_objects$TyCon$.eq_tycon$215(v$7220[0],v$7220[1]);
},x$4418);
return [0,v$6357];
};
basics$Environments$.plus$1769 = function(v$1777,v$7041){var v$1778 = v$1777[1];
var v$1780 = v$7041[1];
return [0,tools$FinMap$.plus$146(function(v$7042){return syntax_objects$TyCon$.eq_tycon$215(v$7042[0],v$7042[1]);
},[v$1778,v$1780])];
};
basics$Environments$.lookup$1781 = function(v$1784,tycon$1787){var v$1793 = v$1784[1];
return tools$FinMap$.lookup$67(function(v$7043){return syntax_objects$TyCon$.eq_tycon$215(v$7043[0],v$7043[1]);
},v$1793,tycon$1787);
};
basics$Environments$.dom$1795 = function(v$1798){var v$1802 = v$1798[1];
return tools$FinMap$.dom$394(function(v$7044){return syntax_objects$TyCon$.eq_tycon$215(v$7044[0],v$7044[1]);
},v$1802);
};
basics$Environments$.fold$1817 = function(f$1820,start$1823,v$1826){var v$1835 = v$1826[1];
return tools$FinMap$.fold$453(function(v$7045){return syntax_objects$TyCon$.eq_tycon$215(v$7045[0],v$7045[1]);
},function(v$4420){var v$4421 = v$4420[0];
var v$4422 = v$4420[1];
return (f$1820(v$4421))(v$4422);
},start$1823,v$1835);
};
basics$Environments$.Fold$1836 = function(f$1839,start$1842,v$1845){var v$1854 = v$1845[1];
return tools$FinMap$.Fold$472(function(v$7046){return syntax_objects$TyCon$.eq_tycon$215(v$7046[0],v$7046[1]);
},function(v$4424){var v$4425 = v$4424[0];
var v$4426 = v$4424[1];
return (f$1839(v$4425))(v$4426);
},start$1842,v$1854);
};
basics$Environments$.apply$1855 = function(f$1858,v$1861){var v$1868 = v$1861[1];
var fix$7510 = {};
fix$7510.$app = function(v$4429){lab$app: while (true) {if (v$4429 == null) {return 0;
} else {var v$4430 = v$4429;
var v$4431 = v$4430[0];
var v$4432 = v$4430[1];
f$1858(v$4431);
var t$7511 = v$4432;
var v$4429 = t$7511;
continue lab$app;
};
};
};
var app$4428 = fix$7510.$app;
return app$4428(tools$FinMap$.list$423(function(v$7047){return syntax_objects$TyCon$.eq_tycon$215(v$7047[0],v$7047[1]);
},v$1868));
};
var fix$7512 = {};
fix$7512.$iterate = function(T$1908,TE$1911){var T$$1912;
var v$4477 = TE$1911[1];
T$$1912 = (tools$FinMap$.fold$453(function(v$7048){return syntax_objects$TyCon$.eq_tycon$215(v$7048[0],v$7048[1]);
},function(v$4479){var v$4480 = v$4479[0];
var v$4481 = v$4479[1];
var v$6417 = v$4480[1];
var v$6418 = v$6417[1];
var v$6419 = v$6417[0];
var t$7617;
var v$6420 = v$6419[1];
t$7617 = (syntax_objects$IdentFinMap$$2.isEmpty$124(v$6420));
if (t$7617) {return v$4481;
} else {var violates_equality$6421;
var v$6422 = v$6419[1];
violates_equality$6421 = (syntax_objects$IdentFinMap$$2.fold$861(function(v$6423){var v$6424 = v$6423[0];
var v$6425 = v$6423[1];
var range$6426;
switch (v$6424[0]) { case 0: {var v$6427 = v$6424[1];
range$6426 = [0,v$6427];
 break; }case 2: {var v$6428 = v$6424[1];
var v$6429 = v$6428[0];
range$6426 = [2,v$6429];
 break; }default: {var v$6430 = v$6424[1];
range$6426 = [1,v$6430];
} };
switch (range$6426[0]) { case 2: {var v$6431 = range$6426[1];
return (basics$StatObject$.violates_equality$3791(v$4481,v$6431))?true:v$6425;
 break; }default: {return tools$Crash$.impossible$50("Environments.CEfold: VE contains non-constructors");
} };
},false,v$6422));
var tyname$6432;
var v$6433 = basics$StatObject$.to_TyName$3950(v$6418);
switch (v$6433[0]) { case 1: {tyname$6432 = (tools$Crash$.impossible$50("Environments.remove_a_tyname_maybe"));
 break; }default: {tyname$6432 = v$6433[1];
} };
return violates_equality$6421?((special_objects$TyName$$3.remove$2621(tyname$6432[0],tyname$6432[1],tyname$6432[2],tyname$6432[3],tyname$6432[4],tyname$6432[5]))(v$4481)):v$4481;
};
},T$1908,v$4477));
if (special_objects$TyName$$3.eq$2996(T$1908,T$$1912)) {return T$1908;
} else {return fix$7512.$iterate(T$$1912,TE$1911);
};
};
var iterate$1905 = fix$7512.$iterate;
basics$Environments$.init$$1974 = function(explicittyvars$1977,tycon$1980){var tyname$1981;
var t$7517 = special_objects$TyName$$1.freshTyName$132;
var t$7516;
var fix$7513 = {};
fix$7513.$acc = function(v$4556,v$4557){lab$acc: while (true) {if (v$4556 == null) {return v$4557;
} else {var v$4558 = v$4556;
var v$4559 = v$4558[1];
var t$7514 = v$4559;
var t$7515 = SmlPrims.chk_ovf_i32(v$4557 + 1);
var v$4556 = t$7514;
var v$4557 = t$7515;
continue lab$acc;
};
};
};
var acc$4555 = fix$7513.$acc;
t$7516 = (acc$4555(explicittyvars$1977,0));
tyname$1981 = (t$7517(t$7516,false,tycon$1980));
var t$7519 = tyname$1981;
var t$7518;
var x$7221 = [tycon$1980,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(tyname$1981)]]];
var v$7222 = tools$FinMap$.singleton$53(function(v$7224){return syntax_objects$TyCon$.eq_tycon$215(v$7224[0],v$7224[1]);
},x$7221);
t$7518 = [0,v$7222];
return [t$7519,t$7518];
};
basics$Environments$.init$1986 = function(explicittyvars$1989,tycon$1992){var t$7525;
var tyname$6436;
var t$7524 = special_objects$TyName$$1.freshTyName$132;
var t$7523;
var fix$7520 = {};
fix$7520.$acc = function(v$6438,v$6439){lab$acc: while (true) {if (v$6438 == null) {return v$6439;
} else {var v$6440 = v$6438;
var v$6441 = v$6440[1];
var t$7521 = v$6441;
var t$7522 = SmlPrims.chk_ovf_i32(v$6439 + 1);
var v$6438 = t$7521;
var v$6439 = t$7522;
continue lab$acc;
};
};
};
var acc$6437 = fix$7520.$acc;
t$7523 = (acc$6437(explicittyvars$1989,0));
tyname$6436 = (t$7524(t$7523,false,tycon$1992));
var t$7527 = tyname$6436;
var t$7526;
var x$7225 = [tycon$1992,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(tyname$6436)]]];
var v$7226 = tools$FinMap$.singleton$53(function(v$7228){return syntax_objects$TyCon$.eq_tycon$215(v$7228[0],v$7228[1]);
},x$7225);
t$7526 = [0,v$7226];
t$7525 = [t$7527,t$7526];
return t$7525[1];
};
basics$Environments$.tynames$1997 = function(v$4563){var v$4568 = v$4563[1];
return tools$FinMap$.fold$453(function(v$7049){return syntax_objects$TyCon$.eq_tycon$215(v$7049[0],v$7049[1]);
},function(v$4570){var v$4571 = v$4570[0];
var v$4572 = v$4570[1];
var t$7529 = special_objects$TyName$$3.union$2587;
var t$7528;
var v$6460 = v$4571[1];
var v$6461 = v$6460[1];
var v$6462 = v$6460[0];
t$7528 = (special_objects$TyName$$3.union$2587(basics$StatObject$.tynames$3912(v$6461),basics$Environments$.tynames$1628(v$6462)));
return t$7529(t$7528,v$4572);
},special_objects$TyName$$3.empty$2399,v$4568);
};
basics$Environments$.report$2067 = function(v$7050,v$2107){var v$2108 = v$2107[1];
return tools$FinMap$.reportMapSORTED$534(function(v$7051){return syntax_objects$TyCon$.eq_tycon$215(v$7051[0],v$7051[1]);
},function(v$7052){return syntax_objects$TyCon$.s$j$148(v$7052[0],v$7052[1]);
},function(v$2080){var v$2101 = v$2080[0];
var v$2102 = v$2080[1];
var v$2103 = v$2102[1];
var v$2104 = v$2103[1];
var v$2105 = v$2103[0];
var v$2106 = v$2105[1];
var names$2081 = basics$StatObject$.newTVNames$281(0);
var v$2098 = basics$StatObject$.pretty_string$4013(names$2081,v$2104);
var v$2099 = v$2098[1];
var v$2100 = v$2098[0];
var vars$$2085;
switch (v$2099) { case "": {vars$$2085 = "";
 break; }default: {vars$$2085 = (v$2099 + " ");
} };
var t$7535 = tools$Report$.s$hh$55;
var t$7534 = tools$Report$.line$51((syntax_objects$IdentFinMap$$2.isEmpty$124(v$2106))?((("type " + vars$$2085) + (syntax_objects$TyCon$.pr_TyCon$53(v$2101))) + (v$7050?(" = " + v$2100):"")):(("datatype " + vars$$2085) + (syntax_objects$TyCon$.pr_TyCon$53(v$2101))));
var t$7533;
var t$7532 = tools$Report$.indent$79;
var t$7531 = 2;
var t$7530;
var v$4644 = v$2105[1];
var l$4645 = syntax_objects$IdentFinMap$$2.list$786(v$4644);
var v$4646 = tools$FinMap$.fromList$523(function(v$7053){return syntax_objects$Ident$.eq_id$237(v$7053[0],v$7053[1]);
},l$4645);
t$7530 = (tools$FinMap$.reportMapSORTED$534(function(v$7054){return syntax_objects$Ident$.eq_id$237(v$7054[0],v$7054[1]);
},function(v$7055){return syntax_objects$Ident$.s$j$121(v$7055[0],v$7055[1]);
},function(v$4647){var v$4648 = v$4647[0];
var v$4649 = v$4647[1];
switch (v$4649[0]) { case 2: {var v$4650 = v$4649[1];
var v$4651 = v$4650[0];
return tools$Report$.line$51((("con " + (syntax_objects$Ident$.pr_id$53(v$4648))) + " : ") + (basics$StatObject$.pretty_string$3431(basics$StatObject$.newTVNames$281(0),v$4651)));
 break; }default: {return tools$Crash$.impossible$50("Environments.reportCE");
} };
},v$4646));
t$7533 = (t$7532(t$7531,t$7530));
return t$7535(t$7534,t$7533);
},v$2108);
};
basics$Environments$.layout$2110 = function(v$7426){return layoutTE$675(v$7426);
};
basics$Environments$.pu$2111 = pu_TyEnv$636;
basics$Environments$.empty$2112 = [0,tools$FinMap$.empty$52(function(v$7056){return syntax_objects$StrId$.eq_strid$172(v$7056[0],v$7056[1]);
})];
basics$Environments$.singleton$2113 = function(x$4660){var v$6464 = tools$FinMap$.singleton$53(function(v$7231){return syntax_objects$StrId$.eq_strid$172(v$7231[0],v$7231[1]);
},x$4660);
return [0,v$6464];
};
basics$Environments$.plus$2115 = function(v$2123,v$7058){var v$2124 = v$2123[1];
var v$2126 = v$7058[1];
return [0,tools$FinMap$.plus$146(function(v$7059){return syntax_objects$StrId$.eq_strid$172(v$7059[0],v$7059[1]);
},[v$2124,v$2126])];
};
basics$Environments$.lookup$2127 = function(v$2130,strid$2133){var v$2139 = v$2130[1];
return tools$FinMap$.lookup$67(function(v$7060){return syntax_objects$StrId$.eq_strid$172(v$7060[0],v$7060[1]);
},v$2139,strid$2133);
};
basics$Environments$.dom$2141 = function(v$2144){var v$2148 = v$2144[1];
return tools$FinMap$.dom$394(function(v$7061){return syntax_objects$StrId$.eq_strid$172(v$7061[0],v$7061[1]);
},v$2148);
};
basics$Environments$.fold$2157 = function(f$2160,start$2163,v$2166){var v$2175 = v$2166[1];
return tools$FinMap$.fold$453(function(v$7062){return syntax_objects$StrId$.eq_strid$172(v$7062[0],v$7062[1]);
},function(v$4662){var v$4663 = v$4662[0];
var v$4664 = v$4662[1];
return (f$2160(v$4663))(v$4664);
},start$2163,v$2175);
};
basics$Environments$.Fold$2176 = function(f$2179,start$2182,v$2185){var v$2194 = v$2185[1];
return tools$FinMap$.Fold$472(function(v$7063){return syntax_objects$StrId$.eq_strid$172(v$7063[0],v$7063[1]);
},function(v$4666){var v$4667 = v$4666[0];
var v$4668 = v$4666[1];
return (f$2179(v$4667))(v$4668);
},start$2182,v$2194);
};
basics$Environments$.apply$2195 = function(f$2198,v$2201){var v$2208 = v$2201[1];
var fix$7536 = {};
fix$7536.$app = function(v$4671){lab$app: while (true) {if (v$4671 == null) {return 0;
} else {var v$4672 = v$4671;
var v$4673 = v$4672[0];
var v$4674 = v$4672[1];
f$2198(v$4673);
var t$7537 = v$4674;
var v$4671 = t$7537;
continue lab$app;
};
};
};
var app$4670 = fix$7536.$app;
return app$4670(tools$FinMap$.list$423(function(v$7064){return syntax_objects$StrId$.eq_strid$172(v$7064[0],v$7064[1]);
},v$2208));
};
basics$Environments$.map$2209 = function(f$2212,v$2215){var v$2222 = v$2215[1];
return [0,tools$FinMap$.composemap$427(function(v$7065){return syntax_objects$StrId$.eq_strid$172(v$7065[0],v$7065[1]);
},f$2212,v$2222)];
};
basics$Environments$.report$2223 = function(v$2231,v$2232){var v$2233 = v$2232[1];
return tools$FinMap$.reportMapSORTED$534(function(v$7066){return syntax_objects$StrId$.eq_strid$172(v$7066[0],v$7066[1]);
},function(v$7067){return syntax_objects$StrId$.s$j$125(v$7067[0],v$7067[1]);
},v$2231,v$2233);
};
var fix$7538 = {};
fix$7538.$E_tyvars = function(v$2250){var v$2255 = v$2250[1];
var v$2256 = v$2255[0];
var v$2257 = v$2255[2];
return unionTyVarSet$168(tyvars$1588(v$2257),fix$7538.$tyvars(v$2256));
};
fix$7538.$tyvars = function(SE$2260){var start$4676 = null;
var v$4682 = SE$2260[1];
return tools$FinMap$.fold$453(function(v$7068){return syntax_objects$StrId$.eq_strid$172(v$7068[0],v$7068[1]);
},function(v$4684){var v$4685 = v$4684[0];
var v$4686 = v$4684[1];
return unionTyVarSet$168(v$4686,fix$7538.$E_tyvars(v$4685));
},start$4676,v$4682);
};
var E_tyvars$2247 = fix$7538.$E_tyvars;
var tyvars$2246 = fix$7538.$tyvars;
var fix$7539 = {};
fix$7539.$E_tyvars$ = function(v$2271){var v$2276 = v$2271[1];
var v$2277 = v$2276[0];
var v$2278 = v$2276[2];
return basis$List$.s$n$645([tyvars$$1595(v$2278),fix$7539.$tyvars$(v$2277)]);
};
fix$7539.$tyvars$ = function(SE$2281){var start$4688 = null;
var v$4694 = SE$2281[1];
return tools$FinMap$.fold$453(function(v$7069){return syntax_objects$StrId$.eq_strid$172(v$7069[0],v$7069[1]);
},function(v$4696){var v$4697 = v$4696[0];
var v$4698 = v$4696[1];
return basis$List$.s$n$645([fix$7539.$E_tyvars$(v$4697),v$4698]);
},start$4688,v$4694);
};
var E_tyvars$$2268 = fix$7539.$E_tyvars$;
var tyvars$$2267 = fix$7539.$tyvars$;
var fix$7540 = {};
fix$7540.$tynames = function(SE$2292){var v$4706 = SE$2292[1];
return tools$FinMap$.fold$453(function(v$7071){return syntax_objects$StrId$.eq_strid$172(v$7071[0],v$7071[1]);
},function(v$4708){var v$4709 = v$4708[0];
var v$4710 = v$4708[1];
return special_objects$TyName$$3.union$2587(fix$7540.$E_tynames(v$4709),v$4710);
},special_objects$TyName$$3.empty$2399,v$4706);
};
fix$7540.$E_tynames = function(v$2301){var v$2307 = v$2301[1];
var v$2308 = v$2307[2];
var v$2309 = v$2307[1];
var v$2310 = v$2307[0];
var t$7616 = special_objects$TyName$$3.union$2587;
var t$7615 = fix$7540.$tynames(v$2310);
var t$7614;
var t$7613 = special_objects$TyName$$3.union$2587;
var t$7612 = basics$Environments$.tynames$1628(v$2308);
var t$7609;
var v$6478 = v$2309[1];
t$7609 = (tools$FinMap$.fold$453(function(v$7070){return syntax_objects$TyCon$.eq_tycon$215(v$7070[0],v$7070[1]);
},function(v$6479){var v$6480 = v$6479[0];
var v$6481 = v$6479[1];
var t$7611 = special_objects$TyName$$3.union$2587;
var t$7610;
var v$6483 = v$6480[1];
var v$6484 = v$6483[1];
var v$6485 = v$6483[0];
t$7610 = (special_objects$TyName$$3.union$2587(basics$StatObject$.tynames$3912(v$6484),basics$Environments$.tynames$1628(v$6485)));
return t$7611(t$7610,v$6481);
},special_objects$TyName$$3.empty$2399,v$6478));
t$7614 = (t$7613(t$7612,t$7609));
return t$7616(t$7615,t$7614);
};
var tynames$2289 = fix$7540.$tynames;
var E_tynames$2288 = fix$7540.$E_tynames;
basics$Environments$.layout$2311 = function(v$7427){return layoutSE$676(v$7427);
};
basics$Environments$.pu$2312 = v$3738;
basics$Environments$.mk$2313 = function(v$7072,v$7073,v$7074){return [0,[v$7072,v$7073,v$7074]];
};
basics$Environments$.un$2322 = function(v$2325){var v$2331 = v$2325[1];
return [v$2331[0],v$2331[1],v$2331[2]];
};
basics$Environments$.from_VE_and_TE$2335 = function(v$7075,v$7076){return [0,[basics$Environments$.empty$2112,v$7076,v$7075]];
};
basics$Environments$.from_VE$2342 = function(VE$2345){return [0,[basics$Environments$.empty$2112,basics$Environments$.empty$1765,VE$2345]];
};
basics$Environments$.to_VE$2346 = function(v$2349){return v$2349[1][2];
};
basics$Environments$.from_TE$2355 = function(TE$2358){return [0,[basics$Environments$.empty$2112,TE$2358,basics$Environments$.empty$1031]];
};
basics$Environments$.to_TE$2359 = function(v$2362){return v$2362[1][1];
};
basics$Environments$.from_SE$2368 = function(SE$2371){return [0,[SE$2371,basics$Environments$.empty$1765,basics$Environments$.empty$1031]];
};
basics$Environments$.to_SE$2372 = function(v$2375){return v$2375[1][0];
};
basics$Environments$.plus$2381 = function(v$2393,v$7077){var v$2394 = v$2393[1];
var v$2395 = v$2394[0];
var v$2396 = v$2394[1];
var v$2397 = v$2394[2];
var v$2399 = v$7077[1];
var v$2400 = v$2399[0];
var v$2401 = v$2399[1];
var v$2402 = v$2399[2];
var t$7544;
var t$7543;
var v$4715 = v$2395[1];
var v$4717 = v$2400[1];
t$7543 = [0,tools$FinMap$.plus$146(function(v$7078){return syntax_objects$StrId$.eq_strid$172(v$7078[0],v$7078[1]);
},[v$4715,v$4717])];
var t$7542;
var v$4720 = v$2396[1];
var v$4722 = v$2401[1];
t$7542 = [0,tools$FinMap$.plus$146(function(v$7079){return syntax_objects$TyCon$.eq_tycon$215(v$7079[0],v$7079[1]);
},[v$4720,v$4722])];
var t$7541;
var v$4725 = v$2397[1];
var v$4727 = v$2402[1];
t$7541 = [0,syntax_objects$IdentFinMap$$2.plus$404(v$4725,v$4727)];
t$7544 = [t$7543,t$7542,t$7541];
return [0,t$7544];
};
basics$Environments$.lookup_tycon$2403 = function(v$2406,tycon$2409){var v$2415 = v$2406[1];
var v$2416 = v$2415[1];
var v$4732 = v$2416[1];
return tools$FinMap$.lookup$67(function(v$7080){return syntax_objects$TyCon$.eq_tycon$215(v$7080[0],v$7080[1]);
},v$4732,tycon$2409);
};
basics$Environments$.lookup_strid$2418 = function(v$2421,strid$2424){var v$2430 = v$2421[1];
var v$2431 = v$2430[0];
var v$4738 = v$2431[1];
return tools$FinMap$.lookup$67(function(v$7081){return syntax_objects$StrId$.eq_strid$172(v$7081[0],v$7081[1]);
},v$4738,strid$2424);
};
var fix$7545 = {};
fix$7545.$lookup_strids = function(v$2436,v$2439){if (v$2439 == null) {return [0,v$2436];
} else {var v$2458 = v$2439;
var v$2459 = v$2458[0];
var v$2460 = v$2458[1];
var v$2454;
var v$4744 = v$2436[1];
var v$4745 = v$4744[0];
var v$4751 = v$4745[1];
v$2454 = (tools$FinMap$.lookup$67(function(v$7082){return syntax_objects$StrId$.eq_strid$172(v$7082[0],v$7082[1]);
},v$4751,v$2459));
switch (v$2454[0]) { case 0: {var v$2456 = v$2454[1];
return fix$7545.$lookup_strids(v$2456,v$2460);
 break; }default: {return [1];
} };
};
};
basics$Environments$.lookup_strids$2433 = fix$7545.$lookup_strids;
basics$Environments$.lookup_longid$2483 = function(E$2486,longid$2489){var v$4756 = syntax_objects$Ident$.decompose$87(longid$2489);
var v$4757 = v$4756[0];
var v$4758 = v$4756[1];
var v$4759 = basics$Environments$.lookup_strids$2433(E$2486,v$4757);
switch (v$4759[0]) { case 1: {return [1];
 break; }default: {var v$4760 = v$4759[1];
return basics$Environments$.lookup$1111(v$4760[1][2],v$4758);
} };
};
basics$Environments$.lookup_longtycon$2497 = function(E$2500,longtycon$2503){var v$4792 = syntax_objects$TyCon$.explode_LongTyCon$97(longtycon$2503);
var v$4793 = v$4792[0];
var v$4794 = v$4792[1];
var v$4795 = basics$Environments$.lookup_strids$2433(E$2500,v$4793);
switch (v$4795[0]) { case 1: {return [1];
 break; }default: {var v$4796 = v$4795[1];
var v$6493 = v$4796[1][1];
var v$6495 = v$6493[1];
return tools$FinMap$.lookup$67(function(v$7083){return syntax_objects$TyCon$.eq_tycon$215(v$7083[0],v$7083[1]);
},v$6495,v$4794);
} };
};
basics$Environments$.lookup_longstrid$2504 = function(E$2507,longstrid$2510){var v$4807 = syntax_objects$StrId$.explode_longstrid$83(longstrid$2510);
var v$4808 = v$4807[0];
var v$4809 = v$4807[1];
var v$4810 = basics$Environments$.lookup_strids$2433(E$2507,v$4808);
switch (v$4810[0]) { case 1: {return [1];
 break; }default: {var v$4811 = v$4810[1];
var v$6497 = v$4811[1][0];
var v$6499 = v$6497[1];
return tools$FinMap$.lookup$67(function(v$7084){return syntax_objects$StrId$.eq_strid$172(v$7084[0],v$7084[1]);
},v$6499,v$4809);
} };
};
basics$Environments$.on$2511 = function(v$7085,v$2522){var v$2523 = v$2522[1];
return [0,[v$2523[0],v$2523[1],v$2523[2]]];
};
basics$Environments$.empty$2527 = [0,[basics$Environments$.empty$2112,basics$Environments$.empty$1765,basics$Environments$.empty$1031]];
basics$Environments$.bogus$2528 = basics$Environments$.empty$2527;
basics$Environments$.tyvars$2529 = function(v$7428){return E_tyvars$2247(v$7428);
};
basics$Environments$.tyvars$$2530 = function(v$7429){return E_tyvars$$2268(v$7429);
};
basics$Environments$.tynames$2531 = function(v$7430){return E_tynames$2288(v$7430);
};
basics$Environments$.layout$2532 = function(v$7431){return layoutEnv$672(v$7431);
};
var fix$7546 = {};
fix$7546.$joinTE = function(v$2550){if (v$2550 == null) {return basics$Environments$.empty$1765;
} else {var v$2557 = v$2550;
var v$2558 = v$2557[0];
var v$2559 = v$2557[1];
var v$5941 = fix$7546.$joinTE(v$2559);
var v$4827 = v$2558[1];
var v$4829 = v$5941[1];
return [0,tools$FinMap$.plus$146(function(v$7086){return syntax_objects$TyCon$.eq_tycon$215(v$7086[0],v$7086[1]);
},[v$4827,v$4829])];
};
};
var joinTE$2547 = fix$7546.$joinTE;
var TE_int31$2560;
var x$7232 = [syntax_objects$TyCon$.tycon_INT31$109,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_INT31$206)]]];
var v$7233 = tools$FinMap$.singleton$53(function(v$7235){return syntax_objects$TyCon$.eq_tycon$215(v$7235[0],v$7235[1]);
},x$7232);
TE_int31$2560 = [0,v$7233];
var TE_int32$2561;
var x$7236 = [syntax_objects$TyCon$.tycon_INT32$110,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_INT32$210)]]];
var v$7237 = tools$FinMap$.singleton$53(function(v$7239){return syntax_objects$TyCon$.eq_tycon$215(v$7239[0],v$7239[1]);
},x$7236);
TE_int32$2561 = [0,v$7237];
var TE_char$2562;
var x$7240 = [syntax_objects$TyCon$.tycon_CHAR$118,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_CHAR$238)]]];
var v$7241 = tools$FinMap$.singleton$53(function(v$7243){return syntax_objects$TyCon$.eq_tycon$215(v$7243[0],v$7243[1]);
},x$7240);
TE_char$2562 = [0,v$7241];
var TE_word8$2563;
var x$7244 = [syntax_objects$TyCon$.tycon_WORD8$113,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_WORD8$218)]]];
var v$7245 = tools$FinMap$.singleton$53(function(v$7247){return syntax_objects$TyCon$.eq_tycon$215(v$7247[0],v$7247[1]);
},x$7244);
TE_word8$2563 = [0,v$7245];
var TE_word31$2564;
var x$7248 = [syntax_objects$TyCon$.tycon_WORD31$114,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_WORD31$222)]]];
var v$7249 = tools$FinMap$.singleton$53(function(v$7251){return syntax_objects$TyCon$.eq_tycon$215(v$7251[0],v$7251[1]);
},x$7248);
TE_word31$2564 = [0,v$7249];
var TE_word32$2565;
var x$7252 = [syntax_objects$TyCon$.tycon_WORD32$115,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_WORD32$226)]]];
var v$7253 = tools$FinMap$.singleton$53(function(v$7255){return syntax_objects$TyCon$.eq_tycon$215(v$7255[0],v$7255[1]);
},x$7252);
TE_word32$2565 = [0,v$7253];
var TE_real$2566;
var x$7256 = [syntax_objects$TyCon$.tycon_REAL$116,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_REAL$230)]]];
var v$7257 = tools$FinMap$.singleton$53(function(v$7259){return syntax_objects$TyCon$.eq_tycon$215(v$7259[0],v$7259[1]);
},x$7256);
TE_real$2566 = [0,v$7257];
var TE_string$2567;
var x$7260 = [syntax_objects$TyCon$.tycon_STRING$117,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_STRING$234)]]];
var v$7261 = tools$FinMap$.singleton$53(function(v$7263){return syntax_objects$TyCon$.eq_tycon$215(v$7263[0],v$7263[1]);
},x$7260);
TE_string$2567 = [0,v$7261];
var TE_chararray$2568;
var x$7264 = [syntax_objects$TyCon$.tycon_CHARARRAY$126,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_CHARARRAY$262)]]];
var v$7265 = tools$FinMap$.singleton$53(function(v$7267){return syntax_objects$TyCon$.eq_tycon$215(v$7267[0],v$7267[1]);
},x$7264);
TE_chararray$2568 = [0,v$7265];
var TE_foreignptr$2569;
var x$7268 = [syntax_objects$TyCon$.tycon_FOREIGNPTR$127,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_FOREIGNPTR$266)]]];
var v$7269 = tools$FinMap$.singleton$53(function(v$7271){return syntax_objects$TyCon$.eq_tycon$215(v$7271[0],v$7271[1]);
},x$7268);
TE_foreignptr$2569 = [0,v$7269];
var TE_array$2570;
var x$7272 = [syntax_objects$TyCon$.tycon_ARRAY$124,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_ARRAY$254)]]];
var v$7273 = tools$FinMap$.singleton$53(function(v$7275){return syntax_objects$TyCon$.eq_tycon$215(v$7275[0],v$7275[1]);
},x$7272);
TE_array$2570 = [0,v$7273];
var TE_vector$2571;
var x$7276 = [syntax_objects$TyCon$.tycon_VECTOR$125,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_VECTOR$258)]]];
var v$7277 = tools$FinMap$.singleton$53(function(v$7279){return syntax_objects$TyCon$.eq_tycon$215(v$7279[0],v$7279[1]);
},x$7276);
TE_vector$2571 = [0,v$7277];
var TE_exn$2572;
var x$7280 = [syntax_objects$TyCon$.tycon_EXN$119,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_EXN$270)]]];
var v$7281 = tools$FinMap$.singleton$53(function(v$7283){return syntax_objects$TyCon$.eq_tycon$215(v$7283[0],v$7283[1]);
},x$7280);
TE_exn$2572 = [0,v$7281];
var boolVE$2573;
var v$6020;
var v$6023 = [null,basics$StatObject$.Bool$2150];
var v$6024 = [syntax_objects$Ident$.id_FALSE$133,[syntax_objects$Ident$.id_TRUE$132,null]];
var v$7354 = [2,[v$6023,v$6024]];
v$6020 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_TRUE$132,v$7354)];
var v$6021;
var v$6026 = [null,basics$StatObject$.Bool$2150];
var v$6027 = [syntax_objects$Ident$.id_FALSE$133,[syntax_objects$Ident$.id_TRUE$132,null]];
var v$7356 = [2,[v$6026,v$6027]];
v$6021 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_FALSE$133,v$7356)];
var v$4923 = v$6020[1];
var v$4925 = v$6021[1];
boolVE$2573 = [0,syntax_objects$IdentFinMap$$2.plus$404(v$4923,v$4925)];
var TE_bool$2574;
var x$7284 = [syntax_objects$TyCon$.tycon_BOOL$121,[0,[basics$Environments$.close$1379(boolVE$2573),basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_BOOL$202)]]];
var v$7285 = tools$FinMap$.singleton$53(function(v$7287){return syntax_objects$TyCon$.eq_tycon$215(v$7287[0],v$7287[1]);
},x$7284);
TE_bool$2574 = [0,v$7285];
basics$StatObject$.push$143(0);
var alpha$2575 = basics$StatObject$.fresh_normal$607(0);
var alphaTy$2576 = basics$StatObject$.from_TyVar$1509(alpha$2575);
var refTy$2577 = basics$StatObject$.mk_Arrow$2095(alphaTy$2576,basics$StatObject$.mk_Ref$2133(alphaTy$2576));
var beta$2578 = basics$StatObject$.fresh_normal$607(0);
var betaTy$2579 = basics$StatObject$.from_TyVar$1509(beta$2578);
var refTy_to_TE$2580 = basics$StatObject$.mk_Arrow$2095(betaTy$2579,basics$StatObject$.mk_Ref$2133(betaTy$2579));
basics$StatObject$.pop$146(0);
var refVE$2581;
var v$6033 = [null,refTy$2577];
var v$6034 = [syntax_objects$Ident$.id_REF$134,null];
var v$7358 = [2,[v$6033,v$6034]];
refVE$2581 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_REF$134,v$7358)];
var refVE_to_TE$2582;
var v$6036 = [null,refTy_to_TE$2580];
var v$6037 = [syntax_objects$Ident$.id_REF$134,null];
var v$7360 = [2,[v$6036,v$6037]];
refVE_to_TE$2582 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_REF$134,v$7360)];
basics$StatObject$.push$143(0);
var alpha1$2583 = basics$StatObject$.fresh_normal$607(0);
var alphaTy$2584 = basics$StatObject$.from_TyVar$1509(alpha1$2583);
var listTy$2585 = basics$StatObject$.mk_ConsType$2050([alphaTy$2584,null],special_objects$TyName$$1.tyName_LIST$242);
var nilVE$2586;
var v$6039 = [null,listTy$2585];
var v$6040 = [syntax_objects$Ident$.id_CONS$131,[syntax_objects$Ident$.id_NIL$130,null]];
var v$7362 = [2,[v$6039,v$6040]];
nilVE$2586 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_NIL$130,v$7362)];
var alpha1$2587 = basics$StatObject$.fresh_normal$607(0);
var alphaTy$2588 = basics$StatObject$.from_TyVar$1509(alpha1$2587);
var listTy$2589 = basics$StatObject$.mk_ConsType$2050([alphaTy$2588,null],special_objects$TyName$$1.tyName_LIST$242);
var consTy$2590 = basics$StatObject$.mk_Arrow$2095(basics$StatObject$.from_pair$1964(alphaTy$2588,listTy$2589),listTy$2589);
var consVE$2591;
var v$6042 = [null,consTy$2590];
var v$6043 = [syntax_objects$Ident$.id_CONS$131,[syntax_objects$Ident$.id_NIL$130,null]];
var v$7364 = [2,[v$6042,v$6043]];
consVE$2591 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_CONS$131,v$7364)];
var listVE$2592;
var v$4970 = consVE$2591[1];
var v$4972 = nilVE$2586[1];
listVE$2592 = [0,syntax_objects$IdentFinMap$$2.plus$404(v$4970,v$4972)];
var alpha1$2593 = basics$StatObject$.fresh_normal$607(0);
var alphaTy$2594 = basics$StatObject$.from_TyVar$1509(alpha1$2593);
var listTy$2595 = basics$StatObject$.mk_ConsType$2050([alphaTy$2594,null],special_objects$TyName$$1.tyName_LIST$242);
var nilVE$2596;
var v$6047 = [null,listTy$2595];
var v$6048 = [syntax_objects$Ident$.id_CONS$131,[syntax_objects$Ident$.id_NIL$130,null]];
var v$7366 = [2,[v$6047,v$6048]];
nilVE$2596 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_NIL$130,v$7366)];
var alpha1$2597 = basics$StatObject$.fresh_normal$607(0);
var alphaTy$2598 = basics$StatObject$.from_TyVar$1509(alpha1$2597);
var listTy$2599 = basics$StatObject$.mk_ConsType$2050([alphaTy$2598,null],special_objects$TyName$$1.tyName_LIST$242);
var consTy$2600 = basics$StatObject$.mk_Arrow$2095(basics$StatObject$.from_pair$1964(alphaTy$2598,listTy$2599),listTy$2599);
var consVE$2601;
var v$6050 = [null,consTy$2600];
var v$6051 = [syntax_objects$Ident$.id_CONS$131,[syntax_objects$Ident$.id_NIL$130,null]];
var v$7368 = [2,[v$6050,v$6051]];
consVE$2601 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_CONS$131,v$7368)];
var listVE_for_TE$2602;
var v$4989 = consVE$2601[1];
var v$4991 = nilVE$2596[1];
listVE_for_TE$2602 = [0,syntax_objects$IdentFinMap$$2.plus$404(v$4989,v$4991)];
basics$StatObject$.pop$146(0);
var TE_list$2603;
var x$7288 = [syntax_objects$TyCon$.tycon_LIST$122,[0,[basics$Environments$.close$1379(listVE_for_TE$2602),basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_LIST$242)]]];
var v$7289 = tools$FinMap$.singleton$53(function(v$7291){return syntax_objects$TyCon$.eq_tycon$215(v$7291[0],v$7291[1]);
},x$7288);
TE_list$2603 = [0,v$7289];
var int31Ty$2605 = basics$StatObject$.mk_ConsType$2050(null,special_objects$TyName$$1.tyName_INT31$206);
var int31listTy$2606 = basics$StatObject$.mk_ConsType$2050([int31Ty$2605,null],special_objects$TyName$$1.tyName_LIST$242);
var boolTy$2607 = basics$StatObject$.mk_ConsType$2050(null,special_objects$TyName$$1.tyName_BOOL$202);
var recordTy$2608;
var negative$2609 = syntax_objects$Lab$.mk_IdentLab$102("negative");
var digits$2610 = syntax_objects$Lab$.mk_IdentLab$102("digits");
var rt$2612 = (basics$StatObject$.add_field$1686(negative$2609,boolTy$2607))(basics$StatObject$.empty$1602);
var rt$2613 = (basics$StatObject$.add_field$1686(digits$2610,int31listTy$2606))(rt$2612);
recordTy$2608 = (basics$StatObject$.from_RecType$1530(rt$2613));
var intinfTy$2614 = basics$StatObject$.mk_ConsType$2050(null,special_objects$TyName$$1.tyName_INTINF$214);
var ve$2615;
var v$6059 = [null,basics$StatObject$.mk_Arrow$2095(recordTy$2608,intinfTy$2614)];
var v$6060 = [syntax_objects$Ident$.id_INTINF$140,null];
var v$7370 = [2,[v$6059,v$6060]];
ve$2615 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_INTINF$140,v$7370)];
var TE_intinf$2616;
var x$7292 = [syntax_objects$TyCon$.tycon_INTINF$111,[0,[basics$Environments$.close$1379(ve$2615),basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_INTINF$214)]]];
var v$7293 = tools$FinMap$.singleton$53(function(v$7295){return syntax_objects$TyCon$.eq_tycon$215(v$7295[0],v$7295[1]);
},x$7292);
TE_intinf$2616 = [0,v$7293];
basics$StatObject$.push$143(0);
var ve$2632 = function(v$2634){var aTy1$2635 = basics$StatObject$.from_TyVar$1509(basics$StatObject$.fresh_normal$607(0));
var aTy2$2636 = basics$StatObject$.from_TyVar$1509(basics$StatObject$.fresh_normal$607(0));
var v$6065;
var v$6068 = [null,basics$StatObject$.mk_Arrow$2095(aTy1$2635,basics$StatObject$.mk_ConsType$2050([aTy1$2635,null],special_objects$TyName$$1.tyName_FRAG$246))];
var v$6069 = [syntax_objects$Ident$.id_QUOTE$138,[syntax_objects$Ident$.id_ANTIQUOTE$139,null]];
var v$7372 = [2,[v$6068,v$6069]];
v$6065 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_ANTIQUOTE$139,v$7372)];
var v$6066;
var v$6071 = [null,basics$StatObject$.mk_Arrow$2095(basics$StatObject$.String$2149,basics$StatObject$.mk_ConsType$2050([aTy2$2636,null],special_objects$TyName$$1.tyName_FRAG$246))];
var v$6072 = [syntax_objects$Ident$.id_QUOTE$138,[syntax_objects$Ident$.id_ANTIQUOTE$139,null]];
var v$7374 = [2,[v$6071,v$6072]];
v$6066 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_QUOTE$138,v$7374)];
var v$5020 = v$6065[1];
var v$5022 = v$6066[1];
return [0,syntax_objects$IdentFinMap$$2.plus$404(v$5020,v$5022)];
};
var fragVE$2637 = ve$2632(0);
var fragVE_for_TE$2638 = ve$2632(0);
basics$StatObject$.pop$146(0);
var TE_frag$2639;
var x$7296 = [syntax_objects$TyCon$.tycon_FRAG$123,[0,[basics$Environments$.close$1379(fragVE_for_TE$2638),basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_FRAG$246)]]];
var v$7297 = tools$FinMap$.singleton$53(function(v$7299){return syntax_objects$TyCon$.eq_tycon$215(v$7299[0],v$7299[1]);
},x$7296);
TE_frag$2639 = [0,v$7297];
basics$StatObject$.push$143(0);
var sigma_prim$2641;
var alpha$2642 = basics$StatObject$.fresh_normal$607(0);
var alphaTy$2643 = basics$StatObject$.from_TyVar$1509(alpha$2642);
var beta$2644 = basics$StatObject$.fresh_normal$607(0);
var betaTy$2645 = basics$StatObject$.from_TyVar$1509(beta$2644);
sigma_prim$2641 = [null,basics$StatObject$.mk_Arrow$2095(basics$StatObject$.from_pair$1964(basics$StatObject$.String$2149,alphaTy$2643),betaTy$2645)];
var sigma_export$2647;
var exportArrowTy$2648 = basics$StatObject$.mk_Arrow$2095(basics$StatObject$.from_TyVar$1509(basics$StatObject$.fresh_normal$607(0)),basics$StatObject$.from_TyVar$1509(basics$StatObject$.fresh_normal$607(0)));
sigma_export$2647 = [null,basics$StatObject$.mk_Arrow$2095(basics$StatObject$.from_pair$1964(basics$StatObject$.String$2149,exportArrowTy$2648),basics$StatObject$.Unit$1980)];
var tyvar_num$2650 = basics$StatObject$.fresh_overloaded$613([special_objects$TyName$$1.tyName_INT31$206,[special_objects$TyName$$1.tyName_INT32$210,[special_objects$TyName$$1.tyName_INTINF$214,[special_objects$TyName$$1.tyName_WORD8$218,[special_objects$TyName$$1.tyName_WORD31$222,[special_objects$TyName$$1.tyName_WORD32$226,[special_objects$TyName$$1.tyName_REAL$230,null]]]]]]]);
var tau_num$2651 = basics$StatObject$.from_TyVar$1509(tyvar_num$2650);
var tau_num_X_num_to_num$2652 = basics$StatObject$.mk_Arrow$2095(basics$StatObject$.from_pair$1964(tau_num$2651,tau_num$2651),tau_num$2651);
var tyvar_realint$2653 = basics$StatObject$.fresh_overloaded$613([special_objects$TyName$$1.tyName_REAL$230,[special_objects$TyName$$1.tyName_INT31$206,[special_objects$TyName$$1.tyName_INT32$210,[special_objects$TyName$$1.tyName_INTINF$214,null]]]]);
var tau_realint$2654 = basics$StatObject$.from_TyVar$1509(tyvar_realint$2653);
var tau_realint_to_realint$2655 = basics$StatObject$.mk_Arrow$2095(tau_realint$2654,tau_realint$2654);
var tyvar_numtxt$2656 = basics$StatObject$.fresh_overloaded$613([special_objects$TyName$$1.tyName_INT31$206,[special_objects$TyName$$1.tyName_INT32$210,[special_objects$TyName$$1.tyName_INTINF$214,[special_objects$TyName$$1.tyName_WORD8$218,[special_objects$TyName$$1.tyName_WORD31$222,[special_objects$TyName$$1.tyName_WORD32$226,[special_objects$TyName$$1.tyName_REAL$230,[special_objects$TyName$$1.tyName_CHAR$238,[special_objects$TyName$$1.tyName_STRING$234,null]]]]]]]]]);
var tau_numtxt$2657 = basics$StatObject$.from_TyVar$1509(tyvar_numtxt$2656);
var tau_numtxt_X_numtxt_to_bool$2658 = basics$StatObject$.mk_Arrow$2095(basics$StatObject$.from_pair$1964(tau_numtxt$2657,tau_numtxt$2657),basics$StatObject$.Bool$2150);
var tyvar_wordint$2659 = basics$StatObject$.fresh_overloaded$613([special_objects$TyName$$1.tyName_INT31$206,[special_objects$TyName$$1.tyName_INT32$210,[special_objects$TyName$$1.tyName_INTINF$214,[special_objects$TyName$$1.tyName_WORD8$218,[special_objects$TyName$$1.tyName_WORD31$222,[special_objects$TyName$$1.tyName_WORD32$226,null]]]]]]);
var tau_wordint$2660 = basics$StatObject$.from_TyVar$1509(tyvar_wordint$2659);
var tau_wordint_X_wordint_to_wordint$2661 = basics$StatObject$.mk_Arrow$2095(basics$StatObject$.from_pair$1964(tau_wordint$2660,tau_wordint$2660),tau_wordint$2660);
basics$StatObject$.pop$146(0);
var sigma_num_X_num_to_num$2662 = basics$StatObject$.close_overload$3701(tau_num_X_num_to_num$2652);
var sigma_realint_to_realint$2663 = basics$StatObject$.close_overload$3701(tau_realint_to_realint$2655);
var sigma_numtxt_X_numtxt_to_bool$2664 = basics$StatObject$.close_overload$3701(tau_numtxt_X_numtxt_to_bool$2658);
var sigma_wordint_X_wordint_to_wordint$2665 = basics$StatObject$.close_overload$3701(tau_wordint_X_wordint_to_wordint$2661);
var primVE$2666;
var v$7376 = [0,sigma_prim$2641];
primVE$2666 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_PRIM$135,v$7376)];
var exportVE$2667;
var v$7378 = [0,sigma_export$2647];
exportVE$2667 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_EXPORT$136,v$7378)];
var absVE$2668;
var v$7380 = [0,sigma_realint_to_realint$2663];
absVE$2668 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_ABS$141,v$7380)];
var negVE$2669;
var v$7382 = [0,sigma_realint_to_realint$2663];
negVE$2669 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_NEG$142,v$7382)];
var divVE$2670;
var v$7384 = [0,sigma_wordint_X_wordint_to_wordint$2665];
divVE$2670 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_DIV$143,v$7384)];
var modVE$2671;
var v$7386 = [0,sigma_wordint_X_wordint_to_wordint$2665];
modVE$2671 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_MOD$144,v$7386)];
var plusVE$2672;
var v$7388 = [0,sigma_num_X_num_to_num$2662];
plusVE$2672 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_PLUS$145,v$7388)];
var minusVE$2673;
var v$7390 = [0,sigma_num_X_num_to_num$2662];
minusVE$2673 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_MINUS$146,v$7390)];
var mulVE$2674;
var v$7392 = [0,sigma_num_X_num_to_num$2662];
mulVE$2674 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_MUL$147,v$7392)];
var lessVE$2675;
var v$7394 = [0,sigma_numtxt_X_numtxt_to_bool$2664];
lessVE$2675 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_LESS$148,v$7394)];
var greaterVE$2676;
var v$7396 = [0,sigma_numtxt_X_numtxt_to_bool$2664];
greaterVE$2676 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_GREATER$149,v$7396)];
var lesseqVE$2677;
var v$7398 = [0,sigma_numtxt_X_numtxt_to_bool$2664];
lesseqVE$2677 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_LESSEQ$150,v$7398)];
var greatereqVE$2678;
var v$7400 = [0,sigma_numtxt_X_numtxt_to_bool$2664];
greatereqVE$2678 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_GREATEREQ$151,v$7400)];
var DivVE$2679;
var v$7402 = [1,basics$StatObject$.Exn$2075];
DivVE$2679 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_Div$152,v$7402)];
var BindVE$2680;
var v$7404 = [1,basics$StatObject$.Exn$2075];
BindVE$2680 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_Bind$154,v$7404)];
var MatchVE$2681;
var v$7406 = [1,basics$StatObject$.Exn$2075];
MatchVE$2681 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_Match$153,v$7406)];
var OverflowVE$2682;
var v$7408 = [1,basics$StatObject$.Exn$2075];
OverflowVE$2682 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_Overflow$155,v$7408)];
var InterruptVE$2683;
var v$7410 = [1,basics$StatObject$.Exn$2075];
InterruptVE$2683 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.id_Interrupt$156,v$7410)];
var fix$7547 = {};
fix$7547.$joinVE = function(v$2687){if (v$2687 == null) {return basics$Environments$.empty$1031;
} else {var v$2694 = v$2687;
var v$2695 = v$2694[0];
var v$2696 = v$2694[1];
var v$6078 = fix$7547.$joinVE(v$2696);
var v$5067 = v$2695[1];
var v$5069 = v$6078[1];
return [0,syntax_objects$IdentFinMap$$2.plus$404(v$5067,v$5069)];
};
};
var joinVE$2684 = fix$7547.$joinVE;
var TE_ref$2697;
var x$7300 = [syntax_objects$TyCon$.tycon_REF$120,[0,[basics$Environments$.close$1379(refVE_to_TE$2582),basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.tyName_REF$250)]]];
var v$7301 = tools$FinMap$.singleton$53(function(v$7303){return syntax_objects$TyCon$.eq_tycon$215(v$7303[0],v$7303[1]);
},x$7300);
TE_ref$2697 = [0,v$7301];
var theta_unit$2698 = basics$StatObject$.from_TyVars_and_Type$3855(null,basics$StatObject$.Unit$1980);
var TE_unit$2700;
var x$7304 = [syntax_objects$TyCon$.tycon_UNIT$130,[0,[basics$Environments$.empty$1031,theta_unit$2698]]];
var v$7305 = tools$FinMap$.singleton$53(function(v$7307){return syntax_objects$TyCon$.eq_tycon$215(v$7307[0],v$7307[1]);
},x$7304);
TE_unit$2700 = [0,v$7305];
var TE_initial0$2701 = joinTE$2547([TE_unit$2700,[TE_char$2562,[TE_real$2566,[TE_int31$2560,[TE_int32$2561,[TE_intinf$2616,[TE_word8$2563,[TE_word31$2564,[TE_word32$2565,[TE_string$2567,[TE_exn$2572,[TE_ref$2697,[TE_bool$2574,[TE_list$2603,[TE_array$2570,[TE_vector$2571,[TE_chararray$2568,[TE_foreignptr$2569,null]]]]]]]]]]]]]]]]]]);
var tag_values$2702 = tools$Flags$$6.is_on0$5026("tag_values");
var resetRegionsVE$2730;
var v$7412;
var t$7548;
basics$StatObject$.push$143(0);
var alpha$5091 = basics$StatObject$.fresh_normal$607(0);
var alphaTy$5092 = basics$StatObject$.from_TyVar$1509(alpha$5091);
var arrowType$5093 = basics$StatObject$.mk_Arrow$2095(alphaTy$5092,basics$StatObject$.Unit$1980);
basics$StatObject$.pop$146(0);
t$7548 = (basics$StatObject$.close_overload$3701(arrowType$5093));
v$7412 = [0,t$7548];
resetRegionsVE$2730 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.resetRegions$158,v$7412)];
var forceResettingVE$2731;
var v$7414;
var t$7549;
basics$StatObject$.push$143(0);
var alpha$5096 = basics$StatObject$.fresh_normal$607(0);
var alphaTy$5097 = basics$StatObject$.from_TyVar$1509(alpha$5096);
var arrowType$5098 = basics$StatObject$.mk_Arrow$2095(alphaTy$5097,basics$StatObject$.Unit$1980);
basics$StatObject$.pop$146(0);
t$7549 = (basics$StatObject$.close_overload$3701(arrowType$5098));
v$7414 = [0,t$7549];
forceResettingVE$2731 = [0,syntax_objects$IdentFinMap$$2.singleton$117(syntax_objects$Ident$.forceResetting$159,v$7414)];
var VEs$2732 = [basics$Environments$.close$1379(refVE$2581),[basics$Environments$.close$1379(boolVE$2573),[basics$Environments$.close$1379(listVE$2592),[basics$Environments$.close$1379(primVE$2666),[basics$Environments$.close$1379(exportVE$2667),[ve$2615,[absVE$2668,[negVE$2669,[divVE$2670,[modVE$2671,[plusVE$2672,[minusVE$2673,[mulVE$2674,[lessVE$2675,[greaterVE$2676,[lesseqVE$2677,[greatereqVE$2678,[resetRegionsVE$2730,[forceResettingVE$2731,[DivVE$2679,[BindVE$2680,[MatchVE$2681,[OverflowVE$2682,[InterruptVE$2683,null]]]]]]]]]]]]]]]]]]]]]]]];
var fragVE$2733 = basics$Environments$.close$1379(fragVE$2637);
basics$Environments$.initial$2744 = function(v$2746){var t$7552;
var t$7551;
var x$7308 = [syntax_objects$StrId$.mk_StrId$94("IntInfRep"),basics$Environments$.empty$2527];
var v$7309 = tools$FinMap$.singleton$53(function(v$7311){return syntax_objects$StrId$.eq_strid$172(v$7311[0],v$7311[1]);
},x$7308);
t$7551 = [0,v$7309];
var t$7550;
var v$5101 = (tag_values$2702(0))?[special_objects$TyName$$1.tyName_INT31$206,special_objects$TyName$$1.tyName_WORD31$222]:[special_objects$TyName$$1.tyName_INT32$210,special_objects$TyName$$1.tyName_WORD32$226];
var v$5102 = v$5101[0];
var v$5103 = v$5101[1];
var TE_int$5104;
var x$7312 = [syntax_objects$TyCon$.tycon_INT$108,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(v$5102)]]];
var v$7313 = tools$FinMap$.singleton$53(function(v$7315){return syntax_objects$TyCon$.eq_tycon$215(v$7315[0],v$7315[1]);
},x$7312);
TE_int$5104 = [0,v$7313];
var TE_word$5112;
var x$7316 = [syntax_objects$TyCon$.tycon_WORD$112,[0,[basics$Environments$.empty$1031,basics$StatObject$.from_TyName$3930(v$5103)]]];
var v$7317 = tools$FinMap$.singleton$53(function(v$7319){return syntax_objects$TyCon$.eq_tycon$215(v$7319[0],v$7319[1]);
},x$7316);
TE_word$5112 = [0,v$7317];
var TEs$5120 = [TE_initial0$2701,[TE_word$5112,[TE_int$5104,null]]];
var TEs$5121 = (quotation$82(0))?[TE_frag$2639,TEs$5120]:TEs$5120;
t$7550 = (joinTE$2547(TEs$5121));
t$7552 = [t$7551,t$7550,joinVE$2684((quotation$82(0))?[fragVE$2733,VEs$2732]:VEs$2732)];
return [0,t$7552];
};
var enrich_TyEnv$2783 = function(v$2808,v$2809){var v$5133 = v$2809[1];
return tools$FinMap$.Fold$472(function(v$7087){return syntax_objects$TyCon$.eq_tycon$215(v$7087[0],v$7087[1]);
},function(v$5135){var v$5136 = v$5135[0];
var v$5137 = v$5135[1];
var v$6528 = v$5136[0];
var v$6529 = v$5136[1];
if (v$5137) {var v$6531;
var v$6532 = v$2808[1];
v$6531 = (tools$FinMap$.lookup$67(function(v$7088){return syntax_objects$TyCon$.eq_tycon$215(v$7088[0],v$7088[1]);
},v$6532,v$6528));
switch (v$6531[0]) { case 0: {var v$6533 = v$6531[1];
var v$6534 = v$6533[1];
var v$6535 = v$6534[1];
var v$6536 = v$6534[0];
var v$6537 = v$6529[1];
var v$6538 = v$6537[1];
var v$6539 = v$6537[0];
if (basics$StatObject$.eq$3837(v$6535,v$6538)) {return basics$Environments$.eq$1175(v$6536,v$6539);
} else {return false;
};
 break; }default: {return false;
} };
} else {return false;
};
},true,v$5133);
};
var enrich_VarEnv$2810 = function(v$2835,v$2836){return basics$Environments$.Fold$1294(function(v$2818){var v$2833 = v$2818[0];
var v$2834 = v$2818[1];
return function(b$2821){if (b$2821) {var v$2830 = basics$Environments$.lookup$1111(v$2835,v$2833);
switch (v$2830[0]) { case 0: {var v$2832 = v$2830[1];
switch (v$2832[0]) { case 0: {switch (v$2834[0]) { case 0: {var v$5156 = v$2832[1];
var v$5157 = v$2834[1];
return basics$StatObject$.eq$3593(v$5156,v$5157);
 break; }default: {return false;
} };
 break; }case 2: {switch (v$2834[0]) { case 2: {var v$5159 = v$2832[1];
var v$5160 = v$2834[1];
return basics$StatObject$.eq$3593(v$5159,v$5160);
 break; }default: {return false;
} };
 break; }default: {switch (v$2834[0]) { case 1: {var v$5162 = v$2832[1];
var v$5163 = v$2834[1];
return basics$StatObject$.eq$1159([v$5162,v$5163]);
 break; }default: {return false;
} };
} };
 break; }default: {return false;
} };
} else {return false;
};
};
},true,v$2836);
};
var fix$7553 = {};
fix$7553.$enrich_Env = function(v$2867,v$2868){var v$6111;
var v$5183 = v$2867[1];
v$6111 = [v$5183[0],v$5183[1],v$5183[2]];
var v$6112;
var v$5185 = v$2868[1];
v$6112 = [v$5185[0],v$5185[1],v$5185[2]];
var v$2860 = v$6111[0];
var v$2861 = v$6111[1];
var v$2862 = v$6111[2];
var v$2864 = v$6112[0];
var v$2865 = v$6112[1];
var v$2866 = v$6112[2];
if (fix$7553.$enrich_StrEnv(v$2860,v$2864)) {if (enrich_TyEnv$2783(v$2861,v$2865)) {return enrich_VarEnv$2810(v$2862,v$2866);
} else {return false;
};
} else {return false;
};
};
fix$7553.$enrich_StrEnv = function(v$2893,v$2894){var v$5171 = v$2894[1];
return tools$FinMap$.Fold$472(function(v$7089){return syntax_objects$StrId$.eq_strid$172(v$7089[0],v$7089[1]);
},function(v$5173){var v$5174 = v$5173[0];
var v$5175 = v$5173[1];
var v$6555 = v$5174[0];
var v$6556 = v$5174[1];
if (v$5175) {var v$6558;
var v$6559 = v$2893[1];
v$6558 = (tools$FinMap$.lookup$67(function(v$7090){return syntax_objects$StrId$.eq_strid$172(v$7090[0],v$7090[1]);
},v$6559,v$6555));
switch (v$6558[0]) { case 0: {var v$6560 = v$6558[1];
return fix$7553.$enrich_Env(v$6560,v$6556);
 break; }default: {return false;
} };
} else {return false;
};
},true,v$5171);
};
var enrich_Env$2838 = fix$7553.$enrich_Env;
var enrich_StrEnv$2837 = fix$7553.$enrich_StrEnv;
var fix$7554 = {};
fix$7554.$equal_Env = function(v$2947,v$2948){var v$6118;
var v$5223 = v$2947[1];
v$6118 = [v$5223[0],v$5223[1],v$5223[2]];
var v$6119;
var v$5225 = v$2948[1];
v$6119 = [v$5225[0],v$5225[1],v$5225[2]];
var v$2940 = v$6118[0];
var v$2941 = v$6118[1];
var v$2942 = v$6118[2];
var v$2944 = v$6119[0];
var v$2945 = v$6119[1];
var v$2946 = v$6119[2];
if (fix$7554.$equal_StrEnv(v$2940,v$2944)) {var t$7608;
var t$7607;
var t$7606;
var v$5230 = v$2941[1];
t$7606 = (tools$FinMap$.fold$453(function(v$7095){return syntax_objects$TyCon$.eq_tycon$215(v$7095[0],v$7095[1]);
},function(v$5231){return SmlPrims.chk_ovf_i32(v$5231[1] + 1);
},0,v$5230));
var t$7605;
var v$5233 = v$2945[1];
t$7605 = (tools$FinMap$.fold$453(function(v$7096){return syntax_objects$TyCon$.eq_tycon$215(v$7096[0],v$7096[1]);
},function(v$5234){return SmlPrims.chk_ovf_i32(v$5234[1] + 1);
},0,v$5233));
t$7607 = (t$7606 == t$7605);
t$7608 = (t$7607?(enrich_TyEnv$2783(v$2941,v$2945)):false);
if (t$7608) {var t$7604;
var t$7603;
var v$5239 = v$2942[1];
t$7603 = (syntax_objects$IdentFinMap$$2.fold$861(function(v$5240){return SmlPrims.chk_ovf_i32(v$5240[1] + 1);
},0,v$5239));
var t$7602;
var v$5242 = v$2946[1];
t$7602 = (syntax_objects$IdentFinMap$$2.fold$861(function(v$5243){return SmlPrims.chk_ovf_i32(v$5243[1] + 1);
},0,v$5242));
t$7604 = (t$7603 == t$7602);
if (t$7604) {return enrich_VarEnv$2810(v$2942,v$2946);
} else {return false;
};
} else {return false;
};
} else {return false;
};
};
fix$7554.$equal_StrEnv = function(v$2977,v$2978){var t$7601;
var t$7600;
var v$5199 = v$2977[1];
t$7600 = (tools$FinMap$.fold$453(function(v$7091){return syntax_objects$StrId$.eq_strid$172(v$7091[0],v$7091[1]);
},function(v$5200){return SmlPrims.chk_ovf_i32(v$5200[1] + 1);
},0,v$5199));
var t$7599;
var v$5202 = v$2978[1];
t$7599 = (tools$FinMap$.fold$453(function(v$7092){return syntax_objects$StrId$.eq_strid$172(v$7092[0],v$7092[1]);
},function(v$5203){return SmlPrims.chk_ovf_i32(v$5203[1] + 1);
},0,v$5202));
t$7601 = (t$7600 == t$7599);
if (t$7601) {var v$5211 = v$2978[1];
return tools$FinMap$.Fold$472(function(v$7093){return syntax_objects$StrId$.eq_strid$172(v$7093[0],v$7093[1]);
},function(v$5213){var v$5214 = v$5213[0];
var v$5215 = v$5213[1];
var v$6576 = v$5214[0];
var v$6577 = v$5214[1];
if (v$5215) {var v$6579;
var v$6580 = v$2977[1];
v$6579 = (tools$FinMap$.lookup$67(function(v$7094){return syntax_objects$StrId$.eq_strid$172(v$7094[0],v$7094[1]);
},v$6580,v$6576));
switch (v$6579[0]) { case 0: {var v$6581 = v$6579[1];
return fix$7554.$equal_Env(v$6581,v$6577);
 break; }default: {return false;
} };
} else {return false;
};
},true,v$5211);
} else {return false;
};
};
var equal_Env$2918 = fix$7554.$equal_Env;
var equal_StrEnv$2917 = fix$7554.$equal_StrEnv;
basics$Environments$.enrich$2979 = function(v$7097){return enrich_Env$2838(v$7097[0],v$7097[1]);
};
basics$Environments$.eq$2980 = function(v$7098){return equal_Env$2918(v$7098[0],v$7098[1]);
};
var fix$7555 = {};
fix$7555.$restr_E = function(v$7099,v$2994){if (v$2994 == null) {return v$7099;
} else {var v$3025 = v$2994;
var v$3026 = v$3025[0];
var v$3027 = v$3025[2];
var v$3028 = v$3025[1];
var v$3020;
var v$5245 = v$7099[1];
v$3020 = [v$5245[0],v$5245[1],v$5245[2]];
var v$3021 = v$3020[0];
var v$3022 = v$3020[1];
var v$3023 = v$3020[2];
var t$7598;
var t$7595;
var fix$7594 = {};
fix$7594.$foldl = function(v$5250,v$5251){if (v$5251 == null) {return v$5250;
} else {var v$5252 = v$5251;
var v$5253 = v$5252[0];
var v$5254 = v$5252[1];
var t$7597 = fix$7594.$foldl;
var t$7596;
var v$6584 = v$5253[0];
var v$6585 = v$5253[1];
var E$6587;
var v$6588;
var v$6589 = v$3021[1];
v$6588 = (tools$FinMap$.lookup$67(function(v$7100){return syntax_objects$StrId$.eq_strid$172(v$7100[0],v$7100[1]);
},v$6589,v$6584));
switch (v$6588[0]) { case 0: {var v$6590 = v$6588[1];
E$6587 = (fix$7555.$restr_E(v$6590,v$6585));
 break; }default: {E$6587 = (tools$Crash$.impossible$50("Environments.restrictE: strid not in env."));
} };
var v$6591;
var x$7320 = [v$6584,E$6587];
var v$7321 = tools$FinMap$.singleton$53(function(v$7323){return syntax_objects$StrId$.eq_strid$172(v$7323[0],v$7323[1]);
},x$7320);
v$6591 = [0,v$7321];
var v$6592 = v$5250[1];
var v$6593 = v$6591[1];
t$7596 = [0,tools$FinMap$.plus$146(function(v$7101){return syntax_objects$StrId$.eq_strid$172(v$7101[0],v$7101[1]);
},[v$6592,v$6593])];
return t$7597(t$7596,v$5254);
};
};
var foldl$5249 = fix$7594.$foldl;
t$7595 = (foldl$5249(basics$Environments$.empty$2112,v$3026));
var t$7591;
var fix$7590 = {};
fix$7590.$foldl = function(v$5293,v$5294){if (v$5294 == null) {return v$5293;
} else {var v$5295 = v$5294;
var v$5296 = v$5295[0];
var v$5297 = v$5295[1];
var t$7593 = fix$7590.$foldl;
var t$7592;
var TyStr$5301;
var v$5302;
var v$5305 = v$3022[1];
v$5302 = (tools$FinMap$.lookup$67(function(v$7102){return syntax_objects$TyCon$.eq_tycon$215(v$7102[0],v$7102[1]);
},v$5305,v$5296));
switch (v$5302[0]) { case 0: {TyStr$5301 = v$5302[1];
 break; }default: {TyStr$5301 = (tools$Crash$.impossible$50("Environments.TE.restrict: tycon not in env."));
} };
var v$6139;
var x$7324 = [v$5296,TyStr$5301];
var v$7325 = tools$FinMap$.singleton$53(function(v$7327){return syntax_objects$TyCon$.eq_tycon$215(v$7327[0],v$7327[1]);
},x$7324);
v$6139 = [0,v$7325];
var v$5310 = v$5293[1];
var v$5312 = v$6139[1];
t$7592 = [0,tools$FinMap$.plus$146(function(v$7103){return syntax_objects$TyCon$.eq_tycon$215(v$7103[0],v$7103[1]);
},[v$5310,v$5312])];
return t$7593(t$7592,v$5297);
};
};
var foldl$5292 = fix$7590.$foldl;
t$7591 = (foldl$5292(basics$Environments$.empty$1765,v$3028));
t$7598 = [t$7595,t$7591,basics$Environments$.restrict$1454(v$3023,v$3027)];
return [0,t$7598];
};
};
var restr_E$2981 = fix$7555.$restr_E;
basics$Environments$.restrict$3029 = function(v$3034,v$3035){return restr_E$2981(v$3034,basics$Environments$.create_restricter$1002(v$3035[0],v$3035[1],v$3035[2]));
};
var fix$7556 = {};
fix$7556.$match = function(v$3062,v$3063){var v$3058;
var v$5333 = v$3062[1];
v$3058 = [v$5333[0],v$5333[1],v$5333[2]];
var v$3059 = v$3058[0];
var v$3060 = v$3058[1];
var v$3061 = v$3058[2];
var v$3054;
var v$5335 = v$3063[1];
v$3054 = [v$5335[0],v$5335[1],v$5335[2]];
var v$3055 = v$3054[0];
var v$3056 = v$3054[1];
var v$3057 = v$3054[2];
fix$7556.$matchSE(v$3059,v$3055);
var start$5362 = 0;
var v$5368 = v$3060[1];
tools$FinMap$.Fold$472(function(v$7106){return syntax_objects$TyCon$.eq_tycon$215(v$7106[0],v$7106[1]);
},function(v$5369){var v$5370 = v$5369[0];
var v$6630 = v$5370[0];
var v$6631 = v$5370[1];
var v$6633;
var v$6634 = v$3056[1];
v$6633 = (tools$FinMap$.lookup$67(function(v$7107){return syntax_objects$TyCon$.eq_tycon$215(v$7107[0],v$7107[1]);
},v$6634,v$6630));
switch (v$6633[0]) { case 0: {var v$6635 = v$6633[1];
var v$6636 = v$6631[1];
var v$6637 = v$6636[1];
var v$6638 = v$6636[0];
var v$6639 = v$6635[1];
var v$6640 = v$6639[1];
var v$6641 = v$6639[0];
basics$StatObject$.match$4058(v$6637,v$6640);
return match$1528(v$6638,v$6641);
 break; }default: {return 0;
} };
},start$5362,v$5368);
return match$1528(v$3061,v$3057);
};
fix$7556.$matchSE = function(v$3083,v$3084){var start$5315 = 0;
var v$5321 = v$3083[1];
return tools$FinMap$.Fold$472(function(v$7104){return syntax_objects$StrId$.eq_strid$172(v$7104[0],v$7104[1]);
},function(v$5323){var v$5324 = v$5323[0];
var v$6609 = v$5324[0];
var v$6610 = v$5324[1];
var v$6612;
var v$6613 = v$3084[1];
v$6612 = (tools$FinMap$.lookup$67(function(v$7105){return syntax_objects$StrId$.eq_strid$172(v$7105[0],v$7105[1]);
},v$6613,v$6609));
switch (v$6612[0]) { case 0: {var v$6614 = v$6612[1];
return fix$7556.$match(v$6610,v$6614);
 break; }default: {return 0;
} };
},start$5315,v$5321);
};
basics$Environments$.match$3037 = fix$7556.$match;
var matchSE$3036 = fix$7556.$matchSE;
basics$Environments$.pu$3085 = v$3737;
var U_empty$3086 = [0,tools$FinMap$.empty$52(function(v$7108){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7108[0],v$7108[1]);
})];
basics$Environments$.plus_U$$3087 = function(v$3115,v$7109){var v$3116 = v$3115[1];
var v$3117 = v$3116[1];
var v$3118 = v$3117[1];
var v$3119 = v$3116[0];
var v$3101;
var b$5395 = [null,v$3118];
var fix$7557 = {};
fix$7557.$foldr = function(v$5398){if (v$5398 == null) {return b$5395;
} else {var v$5399 = v$5398;
var v$5400 = v$5399[0];
var v$5401 = v$5399[1];
var v$6940 = fix$7557.$foldr(v$5401);
var v$6646 = v$6940[0];
var v$6647 = v$6940[1];
var tv$6648 = basics$StatObject$.from_ExplicitTyVar$620(v$5400);
var ty$6649 = basics$StatObject$.from_TyVar$1509(tv$6648);
return [[tv$6648,v$6646],tools$FinMap$.add$132(function(v$7110){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7110[0],v$7110[1]);
},[v$5400,ty$6649,v$6647])];
};
};
var foldr$5397 = fix$7557.$foldr;
v$3101 = (foldr$5397(v$7109));
return [v$3101[0],[0,[v$3119,[0,v$3101[1]]]]];
};
basics$Environments$.plus_U$3121 = function(a$3124){return (basics$Environments$.plus_U$$3087(a$3124[0],a$3124[1]))[1];
};
basics$Environments$.to_U$3129 = function(v$3132){var v$3137 = v$3132[1];
var v$3138 = v$3137[1];
var v$3139 = v$3138[1];
return edlib$EqSet$.list$98(tools$FinMap$.dom$394(function(v$7111){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7111[0],v$7111[1]);
},v$3139));
};
basics$Environments$.ExplicitTyVar_lookup$3141 = function(v$3144,ExplicitTyVar$3147){var v$3159 = v$3144[1];
var v$3160 = v$3159[1];
var v$3161 = v$3160[1];
try {return tools$FinMap$.lookup$67(function(v$7112){return syntax_objects$SyntaxTyVar$.eq_SyntaxTyVar$116(v$7112[0],v$7112[1]);
},v$3161,ExplicitTyVar$3147);
} catch(v$7558) {return (function(Crash$CRASH$3155){var t$7559 = Crash$CRASH$3155;
if (t$7559[0] == tools$Crash$.en$CRASH$45) {basis$TextIO$.output$101([0],"Environments.ExplicitTyVar_lookup\n");
throw tools$Crash$.exn$CRASH$45;
} else {throw Crash$CRASH$3155;
};
})(v$7558);
};
};
basics$Environments$.plus_E$3175 = function(v$3186,v$7113){var v$3187 = v$3186[1];
var v$3188 = v$3187[1];
var v$3189 = v$3187[0];
return [0,[basics$Environments$.plus$2381(v$3189,v$7113),v$3188]];
};
basics$Environments$.plus_TE$3191 = function(v$3196,v$3197){var v$6160 = [0,[basics$Environments$.empty$2112,v$3197,basics$Environments$.empty$1031]];
var v$5404 = v$3196[1];
var v$5405 = v$5404[1];
var v$5406 = v$5404[0];
return [0,[basics$Environments$.plus$2381(v$5406,v$6160),v$5405]];
};
basics$Environments$.plus_VE_and_TE$3198 = function(v$3204,v$3205){var v$3206 = v$3205[0];
var v$3207 = v$3205[1];
var v$6162 = [0,[basics$Environments$.empty$2112,v$3207,v$3206]];
var v$5411 = v$3204[1];
var v$5412 = v$5411[1];
var v$5413 = v$5411[0];
return [0,[basics$Environments$.plus$2381(v$5413,v$6162),v$5412]];
};
basics$Environments$.plus_VE$3208 = function(v$3222,v$7114){var v$3223 = v$3222[1];
var v$3224 = v$3223[1];
var v$3225 = v$3223[0];
var v$3226 = v$3225[1];
var v$3227 = v$3226[0];
var v$3228 = v$3226[1];
var v$3229 = v$3226[2];
var t$7565;
var t$7564;
var t$7563;
var t$7562 = v$3227;
var t$7561 = v$3228;
var t$7560;
var v$5418 = v$3229[1];
var v$5420 = v$7114[1];
t$7560 = [0,syntax_objects$IdentFinMap$$2.plus$404(v$5418,v$5420)];
t$7563 = [t$7562,t$7561,t$7560];
t$7564 = [0,t$7563];
t$7565 = [t$7564,v$3224];
return [0,t$7565];
};
basics$Environments$.from_E$3231 = function(E$3234){return [0,[E$3234,U_empty$3086]];
};
basics$Environments$.on$3237 = function(v$7115,v$7116){return v$7116;
};
basics$Environments$.lookup_longid$3252 = function(x$5424){var E$6658 = x$5424[1][0];
return function(longid$6659){var v$6660 = syntax_objects$Ident$.decompose$87(longid$6659);
var v$6661 = v$6660[0];
var v$6662 = v$6660[1];
var v$6663 = basics$Environments$.lookup_strids$2433(E$6658,v$6661);
switch (v$6663[0]) { case 1: {return [1];
 break; }default: {var v$6664 = v$6663[1];
return basics$Environments$.lookup$1111(v$6664[1][2],v$6662);
} };
};
};
basics$Environments$.lookup_fellow_constructors$3253 = function(x$5441){var E$6682 = x$5441[1][0];
return function(longid$6683){var v$6684;
var v$6685 = syntax_objects$Ident$.decompose$87(longid$6683);
var v$6686 = v$6685[0];
var v$6687 = v$6685[1];
var v$6688 = basics$Environments$.lookup_strids$2433(E$6682,v$6686);
switch (v$6688[0]) { case 1: {v$6684 = [1];
 break; }default: {var v$6689 = v$6688[1];
var v$6690 = v$6689[1][2];
var v$6691 = v$6690[1];
try {var v$6692 = syntax_objects$IdentFinMap$$2.lookup$132(v$6691,v$6687);
switch (v$6692[0]) { case 0: {var v$6693 = v$6692[1];
switch (v$6693[0]) { case 2: {var v$6694 = v$6693[1];
var v$6695 = v$6694[1];
v$6684 = [0,v$6695];
 break; }default: {v$6684 = [1];
} };
 break; }default: {v$6684 = [1];
} };
} catch(v$7566) {v$6684 = ((function(Crash$CRASH$6696){var t$7567 = Crash$CRASH$6696;
if (t$7567[0] == tools$Crash$.en$CRASH$45) {basis$TextIO$.output$101([0],"Environments.lookup_fellow_constructors\n");
throw tools$Crash$.exn$CRASH$45;
} else {throw Crash$CRASH$6696;
};
})(v$7566));
};
} };
switch (v$6684[0]) { case 1: {return tools$Crash$.impossible$50("Environments.lookup_fellow_constructors");
 break; }default: {return v$6684[1];
} };
};
};
basics$Environments$.lookup_longtycon$3254 = function(x$5486){var E$6718 = x$5486[1][0];
return function(longtycon$6719){var v$6720 = syntax_objects$TyCon$.explode_LongTyCon$97(longtycon$6719);
var v$6721 = v$6720[0];
var v$6722 = v$6720[1];
var v$6723 = basics$Environments$.lookup_strids$2433(E$6718,v$6721);
switch (v$6723[0]) { case 1: {return [1];
 break; }default: {var v$6724 = v$6723[1];
var v$6725 = v$6724[1][1];
var v$6726 = v$6725[1];
return tools$FinMap$.lookup$67(function(v$7117){return syntax_objects$TyCon$.eq_tycon$215(v$7117[0],v$7117[1]);
},v$6726,v$6722);
} };
};
};
basics$Environments$.lookup_longstrid$3255 = function(x$5491){var E$6748 = x$5491[1][0];
return function(longstrid$6749){var v$6750 = syntax_objects$StrId$.explode_longstrid$83(longstrid$6749);
var v$6751 = v$6750[0];
var v$6752 = v$6750[1];
var v$6753 = basics$Environments$.lookup_strids$2433(E$6748,v$6751);
switch (v$6753[0]) { case 1: {return [1];
 break; }default: {var v$6754 = v$6753[1];
var v$6755 = v$6754[1][0];
var v$6756 = v$6755[1];
return tools$FinMap$.lookup$67(function(v$7118){return syntax_objects$StrId$.eq_strid$172(v$7118[0],v$7118[1]);
},v$6756,v$6752);
} };
};
};
basics$Environments$.lookup_tycon$3256 = function(x$5496){var v$6764 = x$5496[1][0];
return function(tycon$6765){var v$6766 = v$6764[1];
var v$6767 = v$6766[1];
var v$6768 = v$6767[1];
return tools$FinMap$.lookup$67(function(v$7119){return syntax_objects$TyCon$.eq_tycon$215(v$7119[0],v$7119[1]);
},v$6768,tycon$6765);
};
};
basics$Environments$.dom_pat$3257 = function(v$3380,v$3381,v$3382){var fix$7568 = {};
fix$7568.$dom_patrow = function(patrow$3268){switch (patrow$3268[0]) { case 1: {return null;
 break; }default: {var v$3279 = patrow$3268[1];
var v$3280 = v$3279[3];
switch (v$3280[0]) { case 1: {var v$3281 = v$3279[2];
return fix$7568.$dom_pat$(v$3281);
 break; }default: {var v$3282 = v$3279[2];
var v$3283 = v$3280[1];
return basis$List$.s$n$645([fix$7568.$dom_pat$(v$3282),fix$7568.$dom_patrow(v$3283)]);
} };
} };
};
fix$7568.$dom_atpat = function(atpat$3286){switch (atpat$3286[0]) { case 0: {return null;
 break; }case 1: {return null;
 break; }case 2: {var v$3307 = atpat$3286[1];
var v$3308 = v$3307[1];
switch (v$3308[0]) { case 1: {return null;
 break; }default: {var v$3309 = v$3308[1];
return fix$7568.$dom_patrow(v$3309);
} };
 break; }case 3: {var v$3304 = atpat$3286[1];
var v$3305 = v$3304[1];
return fix$7568.$dom_pat$(v$3305);
 break; }default: {var v$3342 = atpat$3286[1];
var v$3344 = v$3342[1];
var v$3345 = v$3344[1];
var v$3346 = v$3345[0];
var v$3328;
var E$6771 = v$3380[1][0];
var v$6773 = syntax_objects$Ident$.decompose$87(v$3346);
var v$6774 = v$6773[0];
var v$6775 = v$6773[1];
var v$6776 = basics$Environments$.lookup_strids$2433(E$6771,v$6774);
switch (v$6776[0]) { case 1: {v$3328 = [1];
 break; }default: {var v$6777 = v$6776[1];
v$3328 = (basics$Environments$.lookup$1111(v$6777[1][2],v$6775));
} };
switch (v$3328[0]) { case 0: {switch (v$3328[1][0]) { case 2: {if (v$3382) {var v$5520 = syntax_objects$Ident$.decompose$87(v$3346);
if (v$5520[0] == null) {return [v$5520[1],null];
} else {return tools$Crash$.impossible$50("Environments.dom_atpat");
};
} else {return null;
};
 break; }case 1: {if (v$3382) {var v$5524 = syntax_objects$Ident$.decompose$87(v$3346);
if (v$5524[0] == null) {return [v$5524[1],null];
} else {return tools$Crash$.impossible$50("Environments.dom_atpat");
};
} else {return null;
};
 break; }default: {var v$5528 = syntax_objects$Ident$.decompose$87(v$3346);
if (v$5528[0] == null) {return [v$5528[1],null];
} else {return tools$Crash$.impossible$50("Environments.dom_atpat");
};
} };
 break; }default: {var v$5531 = syntax_objects$Ident$.decompose$87(v$3346);
if (v$5531[0] == null) {return [v$5531[1],null];
} else {return tools$Crash$.impossible$50("Environments.dom_atpat");
};
} };
} };
};
fix$7568.$dom_pat$ = function(pat$3349){switch (pat$3349[0]) { case 4: {var v$3378 = pat$3349[1];
var v$3379 = v$3378[1];
return fix$7568.$dom_atpat(v$3379);
 break; }case 3: {var v$3375 = pat$3349[1];
var v$3376 = v$3375[2];
return fix$7568.$dom_atpat(v$3376);
 break; }case 1: {var v$3372 = pat$3349[1];
var v$3373 = v$3372[1];
return fix$7568.$dom_pat$(v$3373);
 break; }case 2: {var v$3366 = pat$3349[1];
var v$3367 = v$3366[1];
var v$3368 = v$3367[1];
var v$3369 = v$3368[0];
var v$3370 = v$3366[3];
return [v$3369,fix$7568.$dom_pat$(v$3370)];
 break; }default: {return tools$Crash$.impossible$50("Environments.dom_pat'(UNRES_INFIX)");
} };
};
var dom_patrow$3265 = fix$7568.$dom_patrow;
var dom_atpat$3264 = fix$7568.$dom_atpat;
var dom_pat$$3263 = fix$7568.$dom_pat$;
return dom_pat$$3263(v$3381);
};
basics$Environments$.layout$3383 = function(x$5536){return layoutEnv$672(x$5536[1][0]);
};
var en$BoundTwice$3384 = new String("BoundTwice");
basics$Environments$.close$3385 = function(v$3538,v$3539,v$3540){try {var fix$7570 = {};
fix$7570.$isExpansiveId = function(valbind$3398){var makemap$3399 = function(pat$3402,exp$3405){var b$3426 = basics$PreElabDecGrammar$$2.expansive$1505(function(longid$5542){var v$5543;
var E$6781 = v$3538[1][0];
var v$6783 = syntax_objects$Ident$.decompose$87(longid$5542);
var v$6784 = v$6783[0];
var v$6785 = v$6783[1];
var v$6786 = basics$Environments$.lookup_strids$2433(E$6781,v$6784);
switch (v$6786[0]) { case 1: {v$5543 = [1];
 break; }default: {var v$6787 = v$6786[1];
v$5543 = (basics$Environments$.lookup$1111(v$6787[1][2],v$6785));
} };
switch (v$5543[0]) { case 0: {switch (v$5543[1][0]) { case 0: {return false;
 break; }case 2: {var v$6199 = (syntax_objects$Ident$.decompose$87(longid$5542))[1];
return (syntax_objects$Ident$.eq_id$237(v$6199,syntax_objects$Ident$.id_REF$134))?false:true;
 break; }default: {return true;
} };
 break; }default: {return true;
} };
},exp$3405);
var b$5549 = tools$FinMap$.empty$52(function(v$7120){return syntax_objects$Ident$.eq_id$237(v$7120[0],v$7120[1]);
});
var c$5550 = basics$Environments$.dom_pat$3257(v$3538,pat$3402,false);
var fix$7575 = {};
fix$7575.$foldr = function(v$5552){if (v$5552 == null) {return b$5549;
} else {var v$5553 = v$5552;
var v$5554 = v$5553[0];
var v$5555 = v$5553[1];
var v$6942 = fix$7575.$foldr(v$5555);
return tools$FinMap$.add$132(function(v$7121){return syntax_objects$Ident$.eq_id$237(v$7121[0],v$7121[1]);
},[v$5554,b$3426,v$6942]);
};
};
var foldr$5551 = fix$7575.$foldr;
return foldr$5551(c$5550);
};
switch (valbind$3398[0]) { case 1: {var v$3447 = valbind$3398[1];
var v$3448 = v$3447[3];
switch (v$3448[0]) { case 1: {var v$3449 = v$3447[1];
var v$3450 = v$3447[2];
return makemap$3399(v$3449,v$3450);
 break; }default: {var v$3459 = v$3447[1];
var v$3460 = v$3447[2];
var v$3461 = v$3448[1];
var m1$3451 = makemap$3399(v$3459,v$3460);
var m2$3452 = fix$7570.$isExpansiveId(v$3461);
return tools$FinMap$.mergeMap$231(function(v$7122){return syntax_objects$Ident$.eq_id$237(v$7122[0],v$7122[1]);
},function(v$3456){throw [en$BoundTwice$3384,v$3540];
},m1$3451,m2$3452);
} };
 break; }default: {var v$3462 = valbind$3398[1];
var v$3464 = v$3462[1];
return fix$7570.$isExpansiveId(v$3464);
} };
};
var isExpansiveId$3395 = fix$7570.$isExpansiveId;
var isExpansiveId_map$3465 = isExpansiveId$3395(v$3539);
var v$3524 = v$3540[1];
var m$3494 = syntax_objects$IdentFinMap$$2.Fold$894(function(v$3499){var v$3519 = v$3499[0];
var v$3520 = v$3519[0];
var v$3521 = v$3519[1];
var v$3522 = v$3499[1];
switch (v$3521[0]) { case 0: {var v$3517 = v$3521[1];
var sigma$3516;
var isExp$5560;
try {var v$5561 = tools$FinMap$.lookup$67(function(v$7123){return syntax_objects$Ident$.eq_id$237(v$7123[0],v$7123[1]);
},isExpansiveId_map$3465,v$3520);
switch (v$5561[0]) { case 1: {isExp$5560 = false;
 break; }default: {isExp$5560 = v$5561[1];
} };
} catch(v$7573) {isExp$5560 = ((function(Crash$CRASH$5562){var t$7574 = Crash$CRASH$5562;
if (t$7574[0] == tools$Crash$.en$CRASH$45) {basis$TextIO$.output$101([0],"Environments.remake\n");
throw tools$Crash$.exn$CRASH$45;
} else {throw Crash$CRASH$5562;
};
})(v$7573));
};
sigma$3516 = (basics$StatObject$.close$3711((isExp$5560?true:false)?false:true,v$3517));
return syntax_objects$IdentFinMap$$2.add$392(v$3520,[0,sigma$3516],v$3522);
 break; }case 2: {var v$3512 = v$3521[1];
var v$3513 = v$3512[0];
var v$3514 = v$3512[1];
var sigma$3511;
try {var v$5567 = tools$FinMap$.lookup$67(function(v$7124){return syntax_objects$Ident$.eq_id$237(v$7124[0],v$7124[1]);
},isExpansiveId_map$3465,v$3520);
switch (v$5567[0]) { case 1: {false;
 break; }default: {v$5567[1];
} };
} catch(v$7571) {(function(Crash$CRASH$5568){var t$7572 = Crash$CRASH$5568;
if (t$7572[0] == tools$Crash$.en$CRASH$45) {basis$TextIO$.output$101([0],"Environments.remake\n");
throw tools$Crash$.exn$CRASH$45;
} else {throw Crash$CRASH$5568;
};
})(v$7571);
};
sigma$3511 = (basics$StatObject$.close$3711(true,v$3513));
return syntax_objects$IdentFinMap$$2.add$392(v$3520,[2,[sigma$3511,v$3514]],v$3522);
 break; }default: {var v$3518 = v$3521[1];
return syntax_objects$IdentFinMap$$2.add$392(v$3520,[1,v$3518],v$3522);
} };
},syntax_objects$IdentFinMap$$2.empty$116(0),v$3524);
return [0,m$3494];
} catch(v$7569) {return (function(v$3537){var t$7576 = v$3537;
if (t$7576[0] == en$BoundTwice$3384) {return v$3537[1];
} else {throw v$3537;
};
})(v$7569);
};
};
basics$Environments$.pu$3541 = pu_Context$651;
basics$Environments$.empty$3542 = tools$FinMap$.empty$52(function(v$7125){return syntax_objects$Ident$.eq_id$237(v$7125[0],v$7125[1]);
});
basics$Environments$.add$3543 = function(v$3824,id$3546,sigma$3549,constructor_map$3552){return tools$FinMap$.add$132(v$3824,[id$3546,sigma$3549,constructor_map$3552]);
};
basics$Environments$.in_dom$3553 = function(v$3825,id$3556,constructor_map$3559){return edlib$EqSet$.member$119(v$3825,id$3556,tools$FinMap$.dom$394(v$3825,constructor_map$3559));
};
basics$Environments$.to_VE$3560 = function(constructor_map$3563){var fellow_constructors$3564;
var x$7334 = tools$FinMap$.dom$394(function(v$7339){return syntax_objects$Ident$.eq_id$237(v$7339[0],v$7339[1]);
},constructor_map$3563);
var v$7335 = edlib$EqSet$.list$98(x$7334);
fellow_constructors$3564 = (edlib$ListSort$.sort$45(function(x$7336){return function(y$7337){return syntax_objects$Ident$.s$j$121(x$7336,y$7337);
};
},v$7335));
return tools$FinMap$.Fold$472(function(v$7127){return syntax_objects$Ident$.eq_id$237(v$7127[0],v$7127[1]);
},function(v$3575){var v$3576 = v$3575[0];
var v$3577 = v$3576[0];
var v$3578 = v$3576[1];
var v$3579 = v$3575[1];
var range_private$5581 = [2,[v$3578,fellow_constructors$3564]];
var v$5584 = v$3579[1];
return [0,syntax_objects$IdentFinMap$$2.add$392(v$3577,range_private$5581,v$5584)];
},basics$Environments$.empty$1031,constructor_map$3563);
};
basics$Environments$.on_VarEnv$3580 = function(phi$3583,VE$3586){var v$5592 = VE$3586[1];
return [0,syntax_objects$IdentFinMap$$2.composemap$815(function(v$6803){switch (v$6803[0]) { case 0: {var v$6804 = v$6803[1];
return [0,basics$StatObject$.on_TypeScheme$4532(phi$3583,v$6804)];
 break; }case 2: {var v$6805 = v$6803[1];
var v$6806 = v$6805[0];
var v$6807 = v$6805[1];
return [2,[basics$StatObject$.on_TypeScheme$4532(phi$3583,v$6806),v$6807]];
 break; }default: {var v$6808 = v$6803[1];
return [1,basics$StatObject$.on_Type$4461(phi$3583,v$6808)];
} };
},v$5592)];
};
basics$Environments$.on_TyStr$3604 = function(phi$3607,v$3610){var v$3620 = v$3610[1];
var v$3621 = v$3620[1];
var v$3622 = v$3620[0];
var t$7577;
var v$3616 = basics$StatObject$.on_TypeFcn$4558(phi$3607,v$3621);
var t$7578;
var v$6811 = v$3622[1];
t$7578 = [0,syntax_objects$IdentFinMap$$2.composemap$815(function(v$6812){switch (v$6812[0]) { case 0: {var v$6813 = v$6812[1];
return [0,basics$StatObject$.on_TypeScheme$4532(phi$3607,v$6813)];
 break; }case 2: {var v$6814 = v$6812[1];
var v$6815 = v$6814[0];
var v$6816 = v$6814[1];
return [2,[basics$StatObject$.on_TypeScheme$4532(phi$3607,v$6815),v$6816]];
 break; }default: {var v$6817 = v$6812[1];
return [1,basics$StatObject$.on_Type$4461(phi$3607,v$6817)];
} };
},v$6811)];
t$7577 = [t$7578,v$3616];
return [0,t$7577];
};
basics$Environments$.on_TyEnv$3623 = function(phi$3626,TE$3629){var v$5598 = TE$3629[1];
return [0,tools$FinMap$.composemap$427(function(v$7128){return syntax_objects$TyCon$.eq_tycon$215(v$7128[0],v$7128[1]);
},function(v$6853){var v$6854 = v$6853[1];
var v$6855 = v$6854[1];
var v$6856 = v$6854[0];
var t$7579;
var v$6857 = basics$StatObject$.on_TypeFcn$4558(phi$3626,v$6855);
var t$7580;
var v$6858 = v$6856[1];
t$7580 = [0,syntax_objects$IdentFinMap$$2.composemap$815(function(v$6859){switch (v$6859[0]) { case 0: {var v$6860 = v$6859[1];
return [0,basics$StatObject$.on_TypeScheme$4532(phi$3626,v$6860)];
 break; }case 2: {var v$6861 = v$6859[1];
var v$6862 = v$6861[0];
var v$6863 = v$6861[1];
return [2,[basics$StatObject$.on_TypeScheme$4532(phi$3626,v$6862),v$6863]];
 break; }default: {var v$6864 = v$6859[1];
return [1,basics$StatObject$.on_Type$4461(phi$3626,v$6864)];
} };
},v$6858)];
t$7579 = [t$7580,v$6857];
return [0,t$7579];
},v$5598)];
};
var fix$7581 = {};
fix$7581.$on_Env = function(phi$3634,E$3637){if (basics$StatObject$.is_Id$4213(phi$3634)) {return E$3637;
} else {var v$3646;
var v$5615 = E$3637[1];
v$3646 = [v$5615[0],v$5615[1],v$5615[2]];
var v$3647 = v$3646[0];
var v$3648 = v$3646[1];
var v$3649 = v$3646[2];
var t$7589;
var t$7588 = fix$7581.$on_StrEnv(phi$3634,v$3647);
var t$7587 = basics$Environments$.on_TyEnv$3623(phi$3634,v$3648);
var t$7586;
var v$6867 = v$3649[1];
t$7586 = [0,syntax_objects$IdentFinMap$$2.composemap$815(function(v$6868){switch (v$6868[0]) { case 0: {var v$6869 = v$6868[1];
return [0,basics$StatObject$.on_TypeScheme$4532(phi$3634,v$6869)];
 break; }case 2: {var v$6870 = v$6868[1];
var v$6871 = v$6870[0];
var v$6872 = v$6870[1];
return [2,[basics$StatObject$.on_TypeScheme$4532(phi$3634,v$6871),v$6872]];
 break; }default: {var v$6873 = v$6868[1];
return [1,basics$StatObject$.on_Type$4461(phi$3634,v$6873)];
} };
},v$6867)];
t$7589 = [t$7588,t$7587,t$7586];
return [0,t$7589];
};
};
fix$7581.$on_StrEnv = function(phi$3652,SE$3655){if (basics$StatObject$.is_Id$4213(phi$3652)) {return SE$3655;
} else {var v$5613 = SE$3655[1];
return [0,tools$FinMap$.composemap$427(function(v$7129){return syntax_objects$StrId$.eq_strid$172(v$7129[0],v$7129[1]);
},function(v$7340){return fix$7581.$on_Env(phi$3652,v$7340);
},v$5613)];
};
};
basics$Environments$.on_Env$3631 = fix$7581.$on_Env;
basics$Environments$.on_StrEnv$3630 = fix$7581.$on_StrEnv;
basics$Environments$.ABS$3710 = function(v$3726,v$3727){var TE$$3715;
var v$5662 = v$3726[1];
TE$$3715 = [0,tools$FinMap$.composemap$427(function(v$7130){return syntax_objects$TyCon$.eq_tycon$215(v$7130[0],v$7130[1]);
},function(v$6875){return [0,[basics$Environments$.empty$1031,v$6875[1][1]]];
},v$5662)];
var v$3722;
var start$5685 = [null,basics$StatObject$.Id$4212,basics$StatObject$.Id$4212];
var v$5691 = TE$$3715[1];
v$3722 = (tools$FinMap$.fold$453(function(v$7131){return syntax_objects$TyCon$.eq_tycon$215(v$7131[0],v$7131[1]);
},function(v$5692){var v$5693 = v$5692[0];
var v$5694 = v$5692[1];
var v$6892 = v$5694[0];
var v$6893 = v$5694[1];
var v$6894 = v$5694[2];
var v$6895;
var v$6896 = v$5693[1];
var v$6897 = v$6896[1];
var tyname$6898;
var v$6899 = basics$StatObject$.to_TyName$3950(v$6897);
switch (v$6899[0]) { case 1: {tyname$6898 = (tools$Crash$.impossible$50("Environments.modifyTyStr"));
 break; }default: {tyname$6898 = v$6899[1];
} };
var tyname_abs$6900 = special_objects$TyName$$1.freshTyName$132(tyname$6898[0],false,tyname$6898[4]);
v$6895 = [tyname_abs$6900,basics$StatObject$.singleton$4221(tyname_abs$6900,basics$StatObject$.from_TyName$3930(tyname$6898)),basics$StatObject$.singleton$4221(tyname$6898,basics$StatObject$.from_TyName$3930(tyname_abs$6900))];
var v$6901 = v$6895[0];
var v$6902 = v$6895[1];
var v$6903 = v$6895[2];
return [[v$6901,v$6892],basics$StatObject$.oo$4663(v$6893,v$6902),basics$StatObject$.oo$4663(v$6894,v$6903)];
},start$5685,v$5691));
var v$3723 = v$3722[0];
var v$3724 = v$3722[1];
var v$3725 = v$3722[2];
var E$$3720 = basics$Environments$.plus$2381([0,[basics$Environments$.empty$2112,TE$$3715,basics$Environments$.empty$1031]],v$3727);
return [v$3723,basics$Environments$.on_Env$3631(v$3725,E$$3720),v$3724];
};
basics$Environments$.maximise_equality_in_VE_and_TE$3728 = function(v$3734,v$3735){var phi$3733;
var T$5715;
var t$7584 = iterate$1905;
var t$7582;
var v$5733 = v$3735[1];
t$7582 = (tools$FinMap$.fold$453(function(v$7132){return syntax_objects$TyCon$.eq_tycon$215(v$7132[0],v$7132[1]);
},function(v$5734){var v$5735 = v$5734[0];
var v$5736 = v$5734[1];
var v$6913 = v$5735[1];
var v$6914 = v$6913[1];
var v$6915 = v$6913[0];
var t$7583;
var v$6917 = v$6915[1];
t$7583 = (syntax_objects$IdentFinMap$$2.isEmpty$124(v$6917));
if (t$7583) {return v$5736;
} else {var tyname$6918;
var v$6919 = basics$StatObject$.to_TyName$3950(v$6914);
switch (v$6919[0]) { case 1: {tyname$6918 = (tools$Crash$.impossible$50("Environments.tynames_of_nonequality_datatypes"));
 break; }default: {tyname$6918 = v$6919[1];
} };
if (tyname$6918[1]) {return v$5736;
} else {return special_objects$TyName$$3.insert$2561(tyname$6918,v$5736);
};
};
},special_objects$TyName$$3.empty$2399,v$5733));
T$5715 = (t$7584(t$7582,v$3735));
phi$3733 = (special_objects$TyName$$3.fold$2870(function(tyname$5737){return function(phi$5738){return basics$StatObject$.oo$4663(phi$5738,basics$StatObject$.singleton$4221(tyname$5737,basics$StatObject$.from_TyName$3930(special_objects$TyName$$1.freshTyName$132(tyname$5737[0],true,tyname$5737[4]))));
};
},basics$StatObject$.Id$4212,T$5715));
var t$7585;
var v$6922 = v$3734[1];
t$7585 = [0,syntax_objects$IdentFinMap$$2.composemap$815(function(v$6923){switch (v$6923[0]) { case 0: {var v$6924 = v$6923[1];
return [0,basics$StatObject$.on_TypeScheme$4532(phi$3733,v$6924)];
 break; }case 2: {var v$6925 = v$6923[1];
var v$6926 = v$6925[0];
var v$6927 = v$6925[1];
return [2,[basics$StatObject$.on_TypeScheme$4532(phi$3733,v$6926),v$6927]];
 break; }default: {var v$6928 = v$6923[1];
return [1,basics$StatObject$.on_Type$4461(phi$3733,v$6928)];
} };
},v$6922)];
return [t$7585,basics$Environments$.on_TyEnv$3623(phi$3733,v$3735)];
};
return 0;
})();
