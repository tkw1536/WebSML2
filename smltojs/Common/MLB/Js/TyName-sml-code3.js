if ((typeof(special_objects$TyName$$3)) == "undefined") {special_objects$TyName$$3 = {};
};
(function(){special_objects$TyName$$3.die$2383 = function(s$2386){return tools$Crash$.impossible$50("QuasiSet." + s$2386);
};
special_objects$TyName$$3.key$2387 = function(v$3471,v$3472,v$3473,v$3474,v$3475,v$3476){return v$3473[0][1];
};
special_objects$TyName$$3.rigid$2391 = function(v$3477,v$3478,v$3479,v$3480,v$3481,v$3482){return v$3479[0][2];
};
special_objects$TyName$$3.empty$2399 = null;
special_objects$TyName$$3.singleton$2400 = function(d$2403){var nd$2404 = d$2403[2];
return nd$2404[0][2]?[[0,tools$IntStringFinMap$.singleton$109(nd$2404[0][1],d$2403)]]:[[1,[tools$IntStringFinMap$.singleton$109(nd$2404[0][1],d$2403),special_objects$Name$.current_matchcount$60(0)]]];
};
special_objects$TyName$$3.isEmpty$2409 = function(v$2412){return (v$2412 == null)?true:false;
};
special_objects$TyName$$3.imap$2417 = function(v$2420){if (v$2420 == null) {return [1];
} else {var v$2429 = v$2420;
switch (v$2429[0][0]) { case 0: {var v$2431 = v$2429[0][1];
return [0,v$2431];
 break; }default: {var v$2432 = v$2429[0][1];
var v$2433 = v$2432[0];
return [0,v$2433];
} };
};
};
special_objects$TyName$$3.imap$$2434 = function(v$2437){if (v$2437 == null) {return tools$Crash$.impossible$50("QuasiSet.imap': impossible");
} else {var v$2447 = v$2437;
switch (v$2447[0][0]) { case 0: {return v$2447[0][1];
 break; }default: {return v$2447[0][1][0];
} };
};
};
special_objects$TyName$$3.ensure_consistent_imap$2452 = function(imap$2455){var v$2472 = tools$IntStringFinMap$.Fold$69(function(v$2480){var v$2489 = v$2480[0];
var v$2490 = v$2489[0];
var v$2491 = v$2489[1];
var v$2492 = v$2480[1];
var v$2493 = v$2492[0];
var v$2494 = v$2492[1];
var t$3497;
if (v$2493) {var v$3361 = v$2491[2][0][1];
t$3497 = ((v$3361[0] == v$2490[0])?(v$3361[1] == v$2490[1]):false);
} else {t$3497 = false;
};
return [t$3497,v$2494?v$2491[2][0][2]:false];
},[true,true],imap$2455);
var v$2473 = v$2472[0];
var v$2474 = v$2472[1];
return [v$2473?imap$2455:(tools$IntStringFinMap$.fold$53(function(v$2467){var v$2468 = v$2467[0];
var v$2469 = v$2467[1];
return tools$IntStringFinMap$.add$228(v$2468[2][0][1],v$2468,v$2469);
},tools$IntStringFinMap$.empty$108(0),imap$2455)),v$2474];
};
special_objects$TyName$$3.ensure_consistent$2495 = function(v$2498){if (v$2498 == null) {return v$2498;
} else {var v$2511 = v$2498;
switch (v$2511[0][0]) { case 0: {return v$2498;
 break; }default: {var v$2531 = v$2511[0][1];
var v$2532 = v$2531[0];
var v$2533 = v$2531[1];
if (v$2533 < (special_objects$Name$.current_matchcount$60(0))) {var v$2528 = special_objects$TyName$$3.ensure_consistent_imap$2452(v$2532);
var v$2529 = v$2528[1];
var v$2530 = v$2528[0];
if (v$2529) {(v$2511[0] = [0,v$2530],0);
return v$2498;
} else {(v$2511[0] = [1,[v$2530,special_objects$Name$.current_matchcount$60(0)]],0);
return v$2498;
};
} else {return v$2498;
};
} };
};
};
special_objects$TyName$$3.mk_flex$2534 = function(imap$2537){return [[1,[imap$2537,special_objects$Name$.current_matchcount$60(0)]]];
};
special_objects$TyName$$3.mk_rigid$2538 = function(imap$2541){return [[0,imap$2541]];
};
special_objects$TyName$$3.member$2542 = function(v$3483,v$3484,v$3485,v$3486,v$3487,v$3488){return function(m$2548){var v$2553;
var v$3166 = special_objects$TyName$$3.ensure_consistent$2495(m$2548);
if (v$3166 == null) {v$2553 = [1];
} else {var v$3167 = v$3166;
switch (v$3167[0][0]) { case 0: {var v$3168 = v$3167[0][1];
v$2553 = [0,v$3168];
 break; }default: {var v$3169 = v$3167[0][1];
var v$3170 = v$3169[0];
v$2553 = [0,v$3170];
} };
};
switch (v$2553[0]) { case 0: {var v$2560 = v$2553[1];
switch ((tools$IntStringFinMap$.lookup$120(v$2560,v$3485[0][1]))[0]) { case 0: {return true;
 break; }default: {return false;
} };
 break; }default: {return false;
} };
};
};
special_objects$TyName$$3.insert$2561 = function(d$2564,m$2567){var v$2575 = special_objects$TyName$$3.ensure_consistent$2495(m$2567);
if (v$2575 == null) {var nd$3173 = d$2564[2];
return nd$3173[0][2]?[[0,tools$IntStringFinMap$.singleton$109(nd$3173[0][1],d$2564)]]:[[1,[tools$IntStringFinMap$.singleton$109(nd$3173[0][1],d$2564),special_objects$Name$.current_matchcount$60(0)]]];
} else {var v$2576 = v$2575;
switch (v$2576[0][0]) { case 0: {var v$2584 = v$2576[0][1];
var nd$2578 = d$2564[2];
var i$2579 = nd$2578[0][1];
return nd$2578[0][2]?[[0,tools$IntStringFinMap$.add$228(i$2579,d$2564,v$2584)]]:[[1,[tools$IntStringFinMap$.add$228(i$2579,d$2564,v$2584),special_objects$Name$.current_matchcount$60(0)]]];
 break; }default: {var v$2585 = v$2576[0][1];
var v$2586 = v$2585[0];
return [[1,[tools$IntStringFinMap$.add$228(d$2564[2][0][1],d$2564,v$2586),special_objects$Name$.current_matchcount$60(0)]]];
} };
};
};
special_objects$TyName$$3.union$2587 = function(m1$2590,m2$2593){var v$3369 = special_objects$TyName$$3.ensure_consistent$2495(m1$2590);
var v$3370 = special_objects$TyName$$3.ensure_consistent$2495(m2$2593);
if (v$3369 == null) {return v$3370;
} else {if (v$3370 == null) {return v$3369;
} else {var v$2612 = v$3369;
switch (v$2612[0][0]) { case 0: {var v$2614 = v$3370;
switch (v$2614[0][0]) { case 0: {var v$2616 = v$2612[0][1];
var v$2617 = v$2614[0][1];
return [[0,tools$IntStringFinMap$.plus$246(v$2616,v$2617)]];
 break; }default: {var t$3504;
var t$3503;
var t$3502;
var t$3501;
var t$3500 = tools$IntStringFinMap$.plus$246;
var t$3499;
if (v$3369 == null) {t$3499 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3425 = v$3369;
switch (v$3425[0][0]) { case 0: {t$3499 = v$3425[0][1];
 break; }default: {t$3499 = v$3425[0][1][0];
} };
};
var t$3498;
if (v$3370 == null) {t$3498 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3426 = v$3370;
switch (v$3426[0][0]) { case 0: {t$3498 = v$3426[0][1];
 break; }default: {t$3498 = v$3426[0][1][0];
} };
};
t$3501 = (t$3500(t$3499,t$3498));
t$3502 = [t$3501,special_objects$Name$.current_matchcount$60(0)];
t$3503 = [1,t$3502];
t$3504 = [t$3503];
return t$3504;
} };
 break; }default: {var t$3511;
var t$3510;
var t$3509;
var t$3508;
var t$3507 = tools$IntStringFinMap$.plus$246;
var t$3506;
if (v$3369 == null) {t$3506 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3428 = v$3369;
switch (v$3428[0][0]) { case 0: {t$3506 = v$3428[0][1];
 break; }default: {t$3506 = v$3428[0][1][0];
} };
};
var t$3505;
if (v$3370 == null) {t$3505 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3429 = v$3370;
switch (v$3429[0][0]) { case 0: {t$3505 = v$3429[0][1];
 break; }default: {t$3505 = v$3429[0][1][0];
} };
};
t$3508 = (t$3507(t$3506,t$3505));
t$3509 = [t$3508,special_objects$Name$.current_matchcount$60(0)];
t$3510 = [1,t$3509];
t$3511 = [t$3510];
return t$3511;
} };
};
};
};
special_objects$TyName$$3.remove$2621 = function(v$3489,v$3490,v$3491,v$3492,v$3493,v$3494){return function(m$2627){var m$2628 = special_objects$TyName$$3.ensure_consistent$2495(m$2627);
if (m$2628 == null) {return m$2628;
} else {var v$2637 = m$2628;
switch (v$2637[0][0]) { case 0: {var v$2650 = v$2637[0][1];
var v$2643 = tools$IntStringFinMap$.remove$253(v$3491[0][1],v$2650);
switch (v$2643[0]) { case 0: {var v$2649 = v$2643[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$2649))?null:[[0,v$2649]];
 break; }default: {return m$2628;
} };
 break; }default: {var v$2662 = v$2637[0][1];
var v$2663 = v$2662[0];
var v$2655 = tools$IntStringFinMap$.remove$253(v$3491[0][1],v$2663);
switch (v$2655[0]) { case 0: {var v$2661 = v$2655[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$2661))?null:[[1,[v$2661,special_objects$Name$.current_matchcount$60(0)]]];
 break; }default: {return m$2628;
} };
} };
};
};
};
special_objects$TyName$$3.mk$2664 = function(v$2677,v$2678){return ((tools$IntStringFinMap$.isEmpty$119(0))(v$2677))?null:(v$2678?[[0,v$2677]]:[[1,[v$2677,special_objects$Name$.current_matchcount$60(0)]]]);
};
special_objects$TyName$$3.difference$2679 = function(m1$2682,m2$2685){var v$3375 = special_objects$TyName$$3.ensure_consistent$2495(m1$2682);
var v$3376 = special_objects$TyName$$3.ensure_consistent$2495(m2$2685);
if (v$3375 == null) {return null;
} else {if (v$3376 == null) {return v$3375;
} else {var im1$2697;
if (v$3375 == null) {im1$2697 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3198 = v$3375;
switch (v$3198[0][0]) { case 0: {im1$2697 = v$3198[0][1];
 break; }default: {im1$2697 = v$3198[0][1][0];
} };
};
var im2$2698;
if (v$3376 == null) {im2$2698 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3202 = v$3376;
switch (v$3202[0][0]) { case 0: {im2$2698 = v$3202[0][1];
 break; }default: {im2$2698 = v$3202[0][1][0];
} };
};
var v$2702 = tools$IntStringFinMap$.Fold$69(function(v$2710){var v$2720 = v$2710[0];
var v$2721 = v$2720[0];
var v$2722 = v$2720[1];
var v$2723 = v$2710[1];
var v$2724 = v$2723[0];
var v$2725 = v$2723[1];
switch ((tools$IntStringFinMap$.lookup$120(im2$2698,v$2721))[0]) { case 0: {return [v$2724,v$2725];
 break; }default: {return [tools$IntStringFinMap$.add$228(v$2721,v$2722,v$2724),v$2725?v$2722[2][0][2]:false];
} };
},[tools$IntStringFinMap$.empty$108(0),true],im1$2697);
var v$2703 = v$2702[0];
var v$2704 = v$2702[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$2703))?null:(v$2704?[[0,v$2703]]:[[1,[v$2703,special_objects$Name$.current_matchcount$60(0)]]]);
};
};
};
special_objects$TyName$$3.intersect$2726 = function(m1$2729,m2$2732){var v$3383 = special_objects$TyName$$3.ensure_consistent$2495(m1$2729);
var v$3384 = special_objects$TyName$$3.ensure_consistent$2495(m2$2732);
if (v$3383 == null) {return null;
} else {if (v$3384 == null) {return null;
} else {var im1$2743;
if (v$3383 == null) {im1$2743 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3210 = v$3383;
switch (v$3210[0][0]) { case 0: {im1$2743 = v$3210[0][1];
 break; }default: {im1$2743 = v$3210[0][1][0];
} };
};
var im2$2744;
if (v$3384 == null) {im2$2744 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3214 = v$3384;
switch (v$3214[0][0]) { case 0: {im2$2744 = v$3214[0][1];
 break; }default: {im2$2744 = v$3214[0][1][0];
} };
};
var v$2748 = tools$IntStringFinMap$.Fold$69(function(v$2756){var v$2766 = v$2756[0];
var v$2767 = v$2766[0];
var v$2768 = v$2766[1];
var v$2769 = v$2756[1];
var v$2770 = v$2769[0];
var v$2771 = v$2769[1];
switch ((tools$IntStringFinMap$.lookup$120(im2$2744,v$2767))[0]) { case 0: {return [tools$IntStringFinMap$.add$228(v$2767,v$2768,v$2770),v$2771?v$2768[2][0][2]:false];
 break; }default: {return [v$2770,v$2771];
} };
},[tools$IntStringFinMap$.empty$108(0),true],im1$2743);
var v$2749 = v$2748[0];
var v$2750 = v$2748[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$2749))?null:(v$2750?[[0,v$2749]]:[[1,[v$2749,special_objects$Name$.current_matchcount$60(0)]]]);
};
};
};
special_objects$TyName$$3.partition$2772 = function(f$2775,m$2778){var v$2783 = special_objects$TyName$$3.ensure_consistent$2495(m$2778);
if (v$2783 == null) {return [null,null];
} else {var im$2784;
if (v$2783 == null) {im$2784 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3222 = v$2783;
switch (v$3222[0][0]) { case 0: {im$2784 = v$3222[0][1];
 break; }default: {im$2784 = v$3222[0][1][0];
} };
};
var v$2790 = tools$IntStringFinMap$.Fold$69(function(v$2802){var v$2815 = v$2802[0];
var v$2816 = v$2815[0];
var v$2817 = v$2815[1];
var v$2818 = v$2802[1];
var v$2819 = v$2818[0];
var v$2820 = v$2818[1];
var v$2821 = v$2818[2];
var v$2822 = v$2818[3];
return (f$2775(v$2817))?[tools$IntStringFinMap$.add$228(v$2816,v$2817,v$2819),v$2820?v$2817[2][0][2]:false,v$2821,v$2822]:[v$2819,v$2820,tools$IntStringFinMap$.add$228(v$2816,v$2817,v$2821),v$2822?v$2817[2][0][2]:false];
},[tools$IntStringFinMap$.empty$108(0),true,tools$IntStringFinMap$.empty$108(0),true],im$2784);
var v$2791 = v$2790[0];
var v$2792 = v$2790[1];
var v$2793 = v$2790[2];
var v$2794 = v$2790[3];
return [((tools$IntStringFinMap$.isEmpty$119(0))(v$2791))?null:(v$2792?[[0,v$2791]]:[[1,[v$2791,special_objects$Name$.current_matchcount$60(0)]]]),((tools$IntStringFinMap$.isEmpty$119(0))(v$2793))?null:(v$2794?[[0,v$2793]]:[[1,[v$2793,special_objects$Name$.current_matchcount$60(0)]]])];
};
};
special_objects$TyName$$3.subst$2823 = function(v$2868,v$2869){return function(m$2830){var v$2835 = special_objects$TyName$$3.ensure_consistent$2495(m$2830);
if (v$2835 == null) {return null;
} else {var im$2836;
if (v$2835 == null) {im$2836 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3234 = v$2835;
switch (v$3234[0][0]) { case 0: {im$2836 = v$3234[0][1];
 break; }default: {im$2836 = v$3234[0][1][0];
} };
};
var keya$2837 = v$2868[2][0][1];
var v$2841 = tools$IntStringFinMap$.Fold$69(function(v$2849){var v$2862 = v$2849[0];
var v$2863 = v$2862[0];
var v$2864 = v$2862[1];
var v$2865 = v$2849[1];
var v$2866 = v$2865[0];
var v$2867 = v$2865[1];
return ((keya$2837[0] == v$2863[0])?(keya$2837[1] == v$2863[1]):false)?[tools$IntStringFinMap$.add$228(v$2869[2][0][1],v$2869,v$2866),v$2867?v$2869[2][0][2]:false]:[tools$IntStringFinMap$.add$228(v$2863,v$2864,v$2866),v$2867?v$2864[2][0][2]:false];
},[tools$IntStringFinMap$.empty$108(0),true],im$2836);
var v$2842 = v$2841[0];
var v$2843 = v$2841[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$2842))?null:(v$2843?[[0,v$2842]]:[[1,[v$2842,special_objects$Name$.current_matchcount$60(0)]]]);
};
};
};
special_objects$TyName$$3.fold$2870 = function(f$2873,b$2876,m$2879){var v$2884 = special_objects$TyName$$3.ensure_consistent$2495(m$2879);
if (v$2884 == null) {return b$2876;
} else {var im$2885;
if (v$2884 == null) {im$2885 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3249 = v$2884;
switch (v$3249[0][0]) { case 0: {im$2885 = v$3249[0][1];
 break; }default: {im$2885 = v$3249[0][1][0];
} };
};
return tools$IntStringFinMap$.fold$53(function(v$2889){var v$2890 = v$2889[0];
var v$2891 = v$2889[1];
return (f$2873(v$2890))(v$2891);
},b$2876,im$2885);
};
};
special_objects$TyName$$3.map$2892 = function(f$2895,m$2898){var v$2903 = special_objects$TyName$$3.ensure_consistent$2495(m$2898);
if (v$2903 == null) {return m$2898;
} else {var im$2904;
if (v$2903 == null) {im$2904 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3253 = v$2903;
switch (v$3253[0][0]) { case 0: {im$2904 = v$3253[0][1];
 break; }default: {im$2904 = v$3253[0][1][0];
} };
};
var v$2908 = tools$IntStringFinMap$.fold$53(function(v$2915){var v$2921 = v$2915[0];
var v$2922 = v$2915[1];
var v$2923 = v$2922[0];
var v$2924 = v$2922[1];
var d$$2916 = f$2895(v$2921);
return [tools$IntStringFinMap$.add$228(d$$2916[2][0][1],d$$2916,v$2923),v$2924?d$$2916[2][0][2]:false];
},[tools$IntStringFinMap$.empty$108(0),true],im$2904);
var v$2909 = v$2908[0];
var v$2910 = v$2908[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$2909))?null:(v$2910?[[0,v$2909]]:[[1,[v$2909,special_objects$Name$.current_matchcount$60(0)]]]);
};
};
special_objects$TyName$$3.apply$2925 = function(f$2928,m$2931){var b$3432 = 0;
var v$3434 = special_objects$TyName$$3.ensure_consistent$2495(m$2931);
if (v$3434 == null) {return b$3432;
} else {var im$3435;
if (v$3434 == null) {im$3435 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3436 = v$3434;
switch (v$3436[0][0]) { case 0: {im$3435 = v$3436[0][1];
 break; }default: {im$3435 = v$3436[0][1][0];
} };
};
return tools$IntStringFinMap$.fold$53(function(v$3437){var v$3438 = v$3437[0];
return f$2928(v$3438);
},b$3432,im$3435);
};
};
special_objects$TyName$$3.list$2937 = function(v$2940){if (v$2940 == null) {return null;
} else {var t$3513 = tools$IntStringFinMap$.range$275;
var t$3512;
var v$3261 = special_objects$TyName$$3.ensure_consistent$2495(v$2940);
if (v$3261 == null) {t$3512 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3262 = v$3261;
switch (v$3262[0][0]) { case 0: {t$3512 = v$3262[0][1];
 break; }default: {t$3512 = v$3262[0][1][0];
} };
};
return t$3513(t$3512);
};
};
special_objects$TyName$$3.fromList$2946 = function(v$2949){if (v$2949 == null) {return null;
} else {var v$2958;
var b$3266 = [tools$IntStringFinMap$.empty$108(0),true];
var fix$3514 = {};
fix$3514.$foldl = function(v$3269,v$3270){lab$foldl: while (true) {if (v$3270 == null) {return v$3269;
} else {var v$3271 = v$3270;
var v$3272 = v$3271[0];
var v$3273 = v$3271[1];
var t$3515;
var v$3443 = v$3269[0];
var v$3444 = v$3269[1];
t$3515 = [tools$IntStringFinMap$.add$228(v$3272[2][0][1],v$3272,v$3443),v$3444?v$3272[2][0][2]:false];
var t$3516 = t$3515;
var t$3517 = v$3273;
var v$3269 = t$3516;
var v$3270 = t$3517;
continue lab$foldl;
};
};
};
var foldl$3268 = fix$3514.$foldl;
v$2958 = (foldl$3268(b$3266,v$2949));
var v$2959 = v$2958[0];
var v$2960 = v$2958[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$2959))?null:(v$2960?[[0,v$2959]]:[[1,[v$2959,special_objects$Name$.current_matchcount$60(0)]]]);
};
};
special_objects$TyName$$3.addList$2974 = function(l$2977,m1$2980){var m2$2981 = special_objects$TyName$$3.fromList$2946(l$2977);
return special_objects$TyName$$3.union$2587(m1$2980,m2$2981);
};
special_objects$TyName$$3.size$2982 = function(m$2985){var v$2990;
var v$3279 = special_objects$TyName$$3.ensure_consistent$2495(m$2985);
if (v$3279 == null) {v$2990 = [1];
} else {var v$3280 = v$3279;
switch (v$3280[0][0]) { case 0: {var v$3281 = v$3280[0][1];
v$2990 = [0,v$3281];
 break; }default: {var v$3282 = v$3280[0][1];
var v$3283 = v$3282[0];
v$2990 = [0,v$3283];
} };
};
switch (v$2990[0]) { case 1: {return 0;
 break; }default: {var v$2995 = v$2990[1];
return tools$IntStringFinMap$.fold$53(function(v$2993){return SmlPrims.chk_ovf_i32(v$2993[1] + 1);
},0,v$2995);
} };
};
special_objects$TyName$$3.eq$2996 = function(s1$2999,s2$3002){var t$3520;
var t$3519;
var v$3294;
var v$3295 = special_objects$TyName$$3.ensure_consistent$2495(s1$2999);
if (v$3295 == null) {v$3294 = [1];
} else {var v$3296 = v$3295;
switch (v$3296[0][0]) { case 0: {var v$3297 = v$3296[0][1];
v$3294 = [0,v$3297];
 break; }default: {var v$3298 = v$3296[0][1];
var v$3299 = v$3298[0];
v$3294 = [0,v$3299];
} };
};
switch (v$3294[0]) { case 1: {t$3519 = 0;
 break; }default: {var v$3300 = v$3294[1];
t$3519 = (tools$IntStringFinMap$.fold$53(function(v$3301){return SmlPrims.chk_ovf_i32(v$3301[1] + 1);
},0,v$3300));
} };
var t$3518;
var v$3303;
var v$3304 = special_objects$TyName$$3.ensure_consistent$2495(s2$3002);
if (v$3304 == null) {v$3303 = [1];
} else {var v$3305 = v$3304;
switch (v$3305[0][0]) { case 0: {var v$3306 = v$3305[0][1];
v$3303 = [0,v$3306];
 break; }default: {var v$3307 = v$3305[0][1];
var v$3308 = v$3307[0];
v$3303 = [0,v$3308];
} };
};
switch (v$3303[0]) { case 1: {t$3518 = 0;
 break; }default: {var v$3309 = v$3303[1];
t$3518 = (tools$IntStringFinMap$.fold$53(function(v$3310){return SmlPrims.chk_ovf_i32(v$3310[1] + 1);
},0,v$3309));
} };
t$3520 = (t$3519 == t$3518);
if (t$3520) {var v$3448 = special_objects$TyName$$3.ensure_consistent$2495(s1$2999);
if (v$3448 == null) {return true;
} else {var im$3449;
if (v$3448 == null) {im$3449 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3450 = v$3448;
switch (v$3450[0][0]) { case 0: {im$3449 = v$3450[0][1];
 break; }default: {im$3449 = v$3450[0][1][0];
} };
};
return tools$IntStringFinMap$.fold$53(function(v$3451){var v$3452 = v$3451[0];
if (v$3451[1]) {var v$3464;
var v$3465 = special_objects$TyName$$3.ensure_consistent$2495(s2$3002);
if (v$3465 == null) {v$3464 = [1];
} else {var v$3466 = v$3465;
switch (v$3466[0][0]) { case 0: {var v$3467 = v$3466[0][1];
v$3464 = [0,v$3467];
 break; }default: {var v$3468 = v$3466[0][1];
var v$3469 = v$3468[0];
v$3464 = [0,v$3469];
} };
};
switch (v$3464[0]) { case 0: {var v$3470 = v$3464[1];
switch ((tools$IntStringFinMap$.lookup$120(v$3470,v$3452[2][0][1]))[0]) { case 0: {return true;
 break; }default: {return false;
} };
 break; }default: {return false;
} };
} else {return false;
};
},true,im$3449);
};
} else {return false;
};
};
special_objects$TyName$$3.layoutSet$3021 = function(v$3040,v$3039,v$3038){return function(pp_elt$3029){return function(m$3032){var t$3521;
var v$3036 = [0,v$3039];
var t$3523;
var fix$3522 = {};
fix$3522.$map = function(v$3325){if (v$3325 == null) {return null;
} else {var v$3326 = v$3325;
var v$3327 = v$3326[0];
var v$3328 = v$3326[1];
return [pp_elt$3029(v$3327),fix$3522.$map(v$3328)];
};
};
var map$3324 = fix$3522.$map;
var t$3527 = map$3324;
var t$3526;
if (m$3032 == null) {t$3526 = null;
} else {var t$3525 = tools$IntStringFinMap$.range$275;
var t$3524;
var v$3330 = special_objects$TyName$$3.ensure_consistent$2495(m$3032);
if (v$3330 == null) {t$3524 = (tools$Crash$.impossible$50("QuasiSet.imap': impossible"));
} else {var v$3331 = v$3330;
switch (v$3331[0][0]) { case 0: {t$3524 = v$3331[0][1];
 break; }default: {t$3524 = v$3331[0][1][0];
} };
};
t$3526 = (t$3525(t$3524));
};
t$3523 = (t$3527(t$3526));
t$3521 = [t$3523,v$3036,v$3040,1,v$3038];
return [0,t$3521];
};
};
};
special_objects$TyName$$3.pu_map0$3041 = function(pu_e$3044){var pu_m$3045 = tools$IntStringFinMap$.pu$479(pickle$pickle$.pairGen$1044([pickle$pickle$.int$720,pickle$pickle$.string$900]),pu_e$3044);
return pickle$pickle$.dataGen$1479(["QuasiSet.map0",function(v$3337){switch (v$3337[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$3338){return pickle$pickle$.con1$2005(function(v$3339){return [0,v$3339];
},function(v$3340){switch (v$3340[0]) { case 0: {return v$3340[1];
 break; }default: {return tools$Crash$.impossible$50("QuasiSet.pu_map0.Rigid");
} };
},pu_m$3045);
},[function(v$3343){return pickle$pickle$.con1$2005(function(v$3344){return [1,[v$3344[1],-1]];
},function(v$3345){switch (v$3345[0]) { case 1: {var v$3346 = v$3345[1];
return [v$3346[1],v$3346[0]];
 break; }default: {return tools$Crash$.impossible$50("QuasiSet.pu_map0.Flexible");
} };
},pickle$pickle$.pairGen$1044([special_objects$Name$.pu_matchcount$287,pu_m$3045]));
},null]]]);
};
special_objects$TyName$$3.pu$3087 = function(pu_e$3090){return pickle$pickle$.convert$2333([function(v$3349){switch (v$3349[0]) { case 0: {var v$3350 = v$3349[1];
return v$3350;
 break; }default: {return null;
} };
},function(v$3351){if (v$3351 == null) {return [1];
} else {var v$3352 = v$3351;
return [0,v$3352];
};
}],pickle$pickle$.optionGen$2125(pickle$pickle$.ref0Gen$1255(special_objects$TyName$$3.pu_map0$3041(pu_e$3090))));
};
return 0;
})();
