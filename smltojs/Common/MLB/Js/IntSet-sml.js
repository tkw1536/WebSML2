if ((typeof(tools$IntSet$)) == "undefined") {tools$IntSet$ = {};
};
(function(){tools$IntSet$.eq_bal$977 = function(v$979,v$980){switch (v$979) { case 0: {switch (v$980) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$980) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$980) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
var fix$1269 = {};
fix$1269.$eq_Set = function(v$983,v$984){if (v$983 == null) {return (v$984 == null)?true:false;
} else {if (v$984 == null) {return false;
} else {var v$985 = v$983;
var v$986 = v$984;
if (v$985[0] == v$986[0]) {if (fix$1269.$eq_Set(v$985[1],v$986[1])) {if (fix$1269.$eq_Set(v$985[2],v$986[2])) {var v$1164 = v$985[3];
var v$1165 = v$986[3];
switch (v$1164) { case 0: {switch (v$1165) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1165) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1165) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
} else {return false;
};
} else {return false;
};
} else {return false;
};
};
};
};
tools$IntSet$.eq_Set$981 = fix$1269.$eq_Set;
var en$Impossible$66 = new String("Impossible");
tools$IntSet$.empty$76 = null;
tools$IntSet$.singleton$77 = function(i$80){return [i$80,null,null,2];
};
var fix$1270 = {};
fix$1270.$size = function(v$84){if (v$84 == null) {return 0;
} else {var v$91 = v$84;
var v$92 = v$91[1];
var v$93 = v$91[2];
return SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(1 + (fix$1270.$size(v$92)))) + (fix$1270.$size(v$93)));
};
};
tools$IntSet$.size$81 = fix$1270.$size;
tools$IntSet$.isEmpty$94 = function(v$97){return (v$97 == null)?true:false;
};
tools$IntSet$.member$102 = function(i$105,s$108){var fix$1271 = {};
fix$1271.$search = function(v$112){lab$search: while (true) {if (v$112 == null) {return false;
} else {var v$128 = v$112;
var v$129 = v$128[0];
var v$130 = v$128[1];
var v$131 = v$128[2];
if (i$105 == v$129) {return true;
} else {if (i$105 < v$129) {var t$1272 = v$130;
var v$112 = t$1272;
continue lab$search;
} else {var t$1273 = v$131;
var v$112 = t$1273;
continue lab$search;
};
};
};
};
};
var search$109 = fix$1271.$search;
return search$109(s$108);
};
tools$IntSet$.eq$132 = function(s1$135,s2$138){if ((tools$IntSet$.size$81(s1$135)) == (tools$IntSet$.size$81(s2$138))) {var fix$1274 = {};
fix$1274.$eq$ = function(v$146){if (v$146 == null) {return true;
} else {var v$162 = v$146;
var v$163 = v$162[0];
var v$164 = v$162[1];
var v$165 = v$162[2];
var t$1278;
var fix$1275 = {};
fix$1275.$search = function(v$996){lab$search: while (true) {if (v$996 == null) {return false;
} else {var v$997 = v$996;
var v$998 = v$997[0];
var v$999 = v$997[1];
var v$1000 = v$997[2];
if (v$163 == v$998) {return true;
} else {if (v$163 < v$998) {var t$1276 = v$999;
var v$996 = t$1276;
continue lab$search;
} else {var t$1277 = v$1000;
var v$996 = t$1277;
continue lab$search;
};
};
};
};
};
var search$995 = fix$1275.$search;
t$1278 = (search$995(s2$138));
if (t$1278) {if (fix$1274.$eq$(v$164)) {return fix$1274.$eq$(v$165);
} else {return false;
};
} else {return false;
};
};
};
var eq$$143 = fix$1274.$eq$;
return eq$$143(s1$135);
} else {return false;
};
};
var en$ALREADYTHERE$166 = new String("ALREADYTHERE");
var exn$ALREADYTHERE$166 = [en$ALREADYTHERE$166];
tools$IntSet$.insert$167 = function(k0$170,t$173){var fix$1279 = {};
fix$1279.$ins = function(v$177){if (v$177 == null) {return [true,[k0$170,null,null,2]];
} else {var v$330 = v$177;
var v$331 = v$330[0];
var v$332 = v$330[1];
var v$333 = v$330[2];
var v$334 = v$330[3];
if (k0$170 == v$331) {throw exn$ALREADYTHERE$166;
} else {if (k0$170 < v$331) {var v$259 = fix$1279.$ins(v$332);
var v$260 = v$259[0];
var v$261 = v$259[1];
switch (v$334) { case 2: {return v$260?[true,[v$331,v$261,v$333,1]]:[false,[v$331,v$261,v$333,2]];
 break; }case 0: {return v$260?[false,[v$331,v$261,v$333,2]]:[false,[v$331,v$261,v$333,0]];
 break; }default: {if (v$260) {var v$247;
if (v$261 == null) {throw [en$Impossible$66,"empty tree01!"];
} else {v$247 = v$261;
};
var v$248 = v$247[0];
var v$249 = v$247[1];
var v$250 = v$247[2];
var v$251 = v$247[3];
var t$1282;
var v$1175 = 1;
switch (v$251) { case 0: {switch (v$1175) { case 0: {t$1282 = true;
 break; }default: {t$1282 = false;
} };
 break; }case 1: {switch (v$1175) { case 1: {t$1282 = true;
 break; }default: {t$1282 = false;
} };
 break; }case 2: {switch (v$1175) { case 2: {t$1282 = true;
 break; }default: {t$1282 = false;
} };
 break; } };
if (t$1282) {return [false,[v$248,v$249,[v$331,v$250,v$333,2],2]];
} else {var v$235;
if (v$250 == null) {throw [en$Impossible$66,"empty tree02!"];
} else {v$235 = v$250;
};
var v$236 = v$235[0];
var v$237 = v$235[1];
var v$238 = v$235[2];
var v$239 = v$235[3];
var t$1300 = false;
var t$1299;
var t$1298;
var t$1297 = v$236;
var t$1296;
var t$1295;
var t$1294 = v$248;
var t$1293 = v$249;
var t$1292 = v$237;
var t$1291;
var t$1290;
var v$1177 = 0;
switch (v$239) { case 0: {switch (v$1177) { case 0: {t$1290 = true;
 break; }default: {t$1290 = false;
} };
 break; }case 1: {switch (v$1177) { case 1: {t$1290 = true;
 break; }default: {t$1290 = false;
} };
 break; }case 2: {switch (v$1177) { case 2: {t$1290 = true;
 break; }default: {t$1290 = false;
} };
 break; } };
t$1291 = (t$1290?1:2);
t$1295 = [t$1294,t$1293,t$1292,t$1291];
t$1296 = t$1295;
var t$1289;
var t$1288;
var t$1287 = v$331;
var t$1286 = v$238;
var t$1285 = v$333;
var t$1284;
var t$1283;
var v$1179 = 1;
switch (v$239) { case 0: {switch (v$1179) { case 0: {t$1283 = true;
 break; }default: {t$1283 = false;
} };
 break; }case 1: {switch (v$1179) { case 1: {t$1283 = true;
 break; }default: {t$1283 = false;
} };
 break; }case 2: {switch (v$1179) { case 2: {t$1283 = true;
 break; }default: {t$1283 = false;
} };
 break; } };
t$1284 = (t$1283?0:2);
t$1288 = [t$1287,t$1286,t$1285,t$1284];
t$1289 = t$1288;
t$1298 = [t$1297,t$1296,t$1289,2];
t$1299 = t$1298;
return [t$1300,t$1299];
};
} else {return [false,[v$331,v$261,v$333,1]];
};
} };
} else {var v$327 = fix$1279.$ins(v$333);
var v$328 = v$327[0];
var v$329 = v$327[1];
switch (v$334) { case 2: {return v$328?[true,[v$331,v$332,v$329,0]]:[false,[v$331,v$332,v$329,2]];
 break; }case 1: {return v$328?[false,[v$331,v$332,v$329,2]]:[false,[v$331,v$332,v$329,1]];
 break; }default: {if (v$328) {var v$315;
if (v$329 == null) {throw [en$Impossible$66,"empty tree03!"];
} else {v$315 = v$329;
};
var v$316 = v$315[0];
var v$317 = v$315[1];
var v$318 = v$315[2];
var v$319 = v$315[3];
var t$1301;
var v$1183 = 0;
switch (v$319) { case 0: {switch (v$1183) { case 0: {t$1301 = true;
 break; }default: {t$1301 = false;
} };
 break; }case 1: {switch (v$1183) { case 1: {t$1301 = true;
 break; }default: {t$1301 = false;
} };
 break; }case 2: {switch (v$1183) { case 2: {t$1301 = true;
 break; }default: {t$1301 = false;
} };
 break; } };
if (t$1301) {return [false,[v$316,[v$331,v$332,v$317,2],v$318,2]];
} else {var v$303;
if (v$317 == null) {throw [en$Impossible$66,"empty tree04!"];
} else {v$303 = v$317;
};
var v$304 = v$303[0];
var v$305 = v$303[1];
var v$306 = v$303[2];
var v$307 = v$303[3];
var t$1319 = false;
var t$1318;
var t$1317;
var t$1316 = v$304;
var t$1315;
var t$1314;
var t$1313 = v$331;
var t$1312 = v$332;
var t$1311 = v$305;
var t$1310;
var t$1309;
var v$1185 = 0;
switch (v$307) { case 0: {switch (v$1185) { case 0: {t$1309 = true;
 break; }default: {t$1309 = false;
} };
 break; }case 1: {switch (v$1185) { case 1: {t$1309 = true;
 break; }default: {t$1309 = false;
} };
 break; }case 2: {switch (v$1185) { case 2: {t$1309 = true;
 break; }default: {t$1309 = false;
} };
 break; } };
t$1310 = (t$1309?1:2);
t$1314 = [t$1313,t$1312,t$1311,t$1310];
t$1315 = t$1314;
var t$1308;
var t$1307;
var t$1306 = v$316;
var t$1305 = v$306;
var t$1304 = v$318;
var t$1303;
var t$1302;
var v$1187 = 1;
switch (v$307) { case 0: {switch (v$1187) { case 0: {t$1302 = true;
 break; }default: {t$1302 = false;
} };
 break; }case 1: {switch (v$1187) { case 1: {t$1302 = true;
 break; }default: {t$1302 = false;
} };
 break; }case 2: {switch (v$1187) { case 2: {t$1302 = true;
 break; }default: {t$1302 = false;
} };
 break; } };
t$1303 = (t$1302?0:2);
t$1307 = [t$1306,t$1305,t$1304,t$1303];
t$1308 = t$1307;
t$1317 = [t$1316,t$1315,t$1308,2];
t$1318 = t$1317;
return [t$1319,t$1318];
};
} else {return [false,[v$331,v$332,v$329,0]];
};
} };
};
};
};
};
var ins$174 = fix$1279.$ins;
try {return (ins$174(t$173))[1];
} catch(v$1280) {return (function(ALREADYTHERE$341){var t$1281 = ALREADYTHERE$341;
if (t$1281[0] == en$ALREADYTHERE$166) {return t$173;
} else {throw ALREADYTHERE$341;
};
})(v$1280);
};
};
tools$IntSet$.list$342 = function(s$345){var fix$1320 = {};
fix$1320.$f = function(v$349,v$352){lab$f: while (true) {if (v$349 == null) {return v$352;
} else {var v$364 = v$349;
var v$365 = v$364[0];
var v$366 = v$364[1];
var v$367 = v$364[2];
var t$1321 = v$366;
var t$1322 = [v$365,fix$1320.$f(v$367,v$352)];
var v$349 = t$1321;
var v$352 = t$1322;
continue lab$f;
};
};
};
var f$346 = fix$1320.$f;
return f$346(s$345,null);
};
var fix$1323 = {};
fix$1323.$fromList = function(l$372){lab$fromList: while (true) {if (l$372 == null) {return tools$IntSet$.empty$76;
} else {var v$379 = l$372;
var v$380 = v$379[0];
var v$381 = v$379[1];
return tools$IntSet$.insert$167(v$380,fix$1323.$fromList(v$381));
};
};
};
tools$IntSet$.fromList$369 = fix$1323.$fromList;
var fix$1324 = {};
fix$1324.$union = function(s1$385,s2$388){lab$union: while (true) {if (s2$388 == null) {return s1$385;
} else {var v$396 = s2$388;
var v$397 = v$396[0];
var v$398 = v$396[1];
var v$399 = v$396[2];
var t$1325 = fix$1324.$union(tools$IntSet$.insert$167(v$397,s1$385),v$398);
var t$1326 = v$399;
var s1$385 = t$1325;
var s2$388 = t$1326;
continue lab$union;
};
};
};
tools$IntSet$.union$382 = fix$1324.$union;
var fix$1327 = {};
fix$1327.$addList = function(v$403,v$406){lab$addList: while (true) {if (v$403 == null) {return v$406;
} else {var v$417 = v$403;
var v$418 = v$417[0];
var v$419 = v$417[1];
var t$1328 = v$419;
var t$1329 = tools$IntSet$.insert$167(v$418,v$406);
var v$403 = t$1328;
var v$406 = t$1329;
continue lab$addList;
};
};
};
tools$IntSet$.addList$400 = fix$1327.$addList;
var en$NOTFOUND$421 = new String("NOTFOUND");
var exn$NOTFOUND$421 = [en$NOTFOUND$421];
tools$IntSet$.remove$422 = function(k0$425,t$428){var balance1$429 = function(v$432){if (v$432 == null) {throw [en$Impossible$66,"(balance1 on an empty tree)"];
} else {var v$497 = v$432;
var v$498 = v$497[0];
var v$499 = v$497[1];
var v$500 = v$497[2];
switch (v$497[3]) { case 1: {return [[v$498,v$499,v$500,2],true];
 break; }case 2: {return [[v$498,v$499,v$500,0],false];
 break; }default: {var v$485;
if (v$500 == null) {throw [en$Impossible$66,"empty tree11!"];
} else {v$485 = v$500;
};
var v$486 = v$485[0];
var v$487 = v$485[1];
var v$488 = v$485[2];
switch (v$485[3]) { case 1: {var v$473;
if (v$487 == null) {throw [en$Impossible$66,"empty tree12!"];
} else {v$473 = v$487;
};
var v$474 = v$473[0];
var v$475 = v$473[1];
var v$476 = v$473[2];
var v$477 = v$473[3];
var t$1346;
var t$1345;
var t$1344 = v$474;
var t$1343;
var t$1342;
var t$1341 = v$498;
var t$1340 = v$499;
var t$1339 = v$475;
var t$1338;
var t$1337;
var v$1193 = 0;
switch (v$477) { case 0: {switch (v$1193) { case 0: {t$1337 = true;
 break; }default: {t$1337 = false;
} };
 break; }case 1: {switch (v$1193) { case 1: {t$1337 = true;
 break; }default: {t$1337 = false;
} };
 break; }case 2: {switch (v$1193) { case 2: {t$1337 = true;
 break; }default: {t$1337 = false;
} };
 break; } };
t$1338 = (t$1337?1:2);
t$1342 = [t$1341,t$1340,t$1339,t$1338];
t$1343 = t$1342;
var t$1336;
var t$1335;
var t$1334 = v$486;
var t$1333 = v$476;
var t$1332 = v$488;
var t$1331;
var t$1330;
var v$1195 = 1;
switch (v$477) { case 0: {switch (v$1195) { case 0: {t$1330 = true;
 break; }default: {t$1330 = false;
} };
 break; }case 1: {switch (v$1195) { case 1: {t$1330 = true;
 break; }default: {t$1330 = false;
} };
 break; }case 2: {switch (v$1195) { case 2: {t$1330 = true;
 break; }default: {t$1330 = false;
} };
 break; } };
t$1331 = (t$1330?0:2);
t$1335 = [t$1334,t$1333,t$1332,t$1331];
t$1336 = t$1335;
t$1345 = [t$1344,t$1343,t$1336,2];
t$1346 = t$1345;
return [t$1346,true];
 break; }case 2: {return [[v$486,[v$498,v$499,v$487,0],v$488,1],false];
 break; }default: {return [[v$486,[v$498,v$499,v$487,2],v$488,2],true];
} };
} };
};
};
var balance2$502 = function(v$505){if (v$505 == null) {throw [en$Impossible$66,"(balance2 on an empty tree)"];
} else {var v$570 = v$505;
var v$571 = v$570[0];
var v$572 = v$570[1];
var v$573 = v$570[2];
switch (v$570[3]) { case 0: {return [[v$571,v$572,v$573,2],true];
 break; }case 2: {return [[v$571,v$572,v$573,1],false];
 break; }default: {var v$558;
if (v$572 == null) {throw [en$Impossible$66,"empty tree21!"];
} else {v$558 = v$572;
};
var v$559 = v$558[0];
var v$560 = v$558[1];
var v$561 = v$558[2];
switch (v$558[3]) { case 0: {var v$546;
if (v$561 == null) {throw [en$Impossible$66,"empty tree22!"];
} else {v$546 = v$561;
};
var v$547 = v$546[0];
var v$548 = v$546[1];
var v$549 = v$546[2];
var v$550 = v$546[3];
var t$1363;
var t$1362;
var t$1361 = v$547;
var t$1360;
var t$1359;
var t$1358 = v$559;
var t$1357 = v$560;
var t$1356 = v$548;
var t$1355;
var t$1354;
var v$1199 = 0;
switch (v$550) { case 0: {switch (v$1199) { case 0: {t$1354 = true;
 break; }default: {t$1354 = false;
} };
 break; }case 1: {switch (v$1199) { case 1: {t$1354 = true;
 break; }default: {t$1354 = false;
} };
 break; }case 2: {switch (v$1199) { case 2: {t$1354 = true;
 break; }default: {t$1354 = false;
} };
 break; } };
t$1355 = (t$1354?1:2);
t$1359 = [t$1358,t$1357,t$1356,t$1355];
t$1360 = t$1359;
var t$1353;
var t$1352;
var t$1351 = v$571;
var t$1350 = v$549;
var t$1349 = v$573;
var t$1348;
var t$1347;
var v$1197 = 1;
switch (v$550) { case 0: {switch (v$1197) { case 0: {t$1347 = true;
 break; }default: {t$1347 = false;
} };
 break; }case 1: {switch (v$1197) { case 1: {t$1347 = true;
 break; }default: {t$1347 = false;
} };
 break; }case 2: {switch (v$1197) { case 2: {t$1347 = true;
 break; }default: {t$1347 = false;
} };
 break; } };
t$1348 = (t$1347?0:2);
t$1352 = [t$1351,t$1350,t$1349,t$1348];
t$1353 = t$1352;
t$1362 = [t$1361,t$1360,t$1353,2];
t$1363 = t$1362;
return [t$1363,true];
 break; }case 2: {return [[v$559,v$560,[v$571,v$561,v$573,1],0],false];
 break; }default: {return [[v$559,v$560,[v$571,v$561,v$573,2],2],true];
} };
} };
};
};
var fix$1364 = {};
fix$1364.$remove_rightmost = function(v$578){if (v$578 == null) {throw [en$Impossible$66,"(remove_rightmost on empty tree)"];
} else {var v$592 = v$578;
var v$593 = v$592[2];
if (v$593 == null) {return [v$592[1],v$592[0],true];
} else {var v$615 = v$592[0];
var v$616 = v$592[1];
var v$617 = v$592[3];
var v$611 = fix$1364.$remove_rightmost(v$593);
var v$612 = v$611[0];
var v$613 = v$611[1];
if (v$611[2]) {var v$608 = balance2$502([v$615,v$616,v$612,v$617]);
return [v$608[0],v$613,v$608[1]];
} else {return [[v$615,v$616,v$612,v$617],v$613,false];
};
};
};
};
var remove_rightmost$575 = fix$1364.$remove_rightmost;
var fix$1365 = {};
fix$1365.$del = function(v$621){lab$del: while (true) {if (v$621 == null) {throw exn$NOTFOUND$421;
} else {var v$678 = v$621;
var v$679 = v$678[0];
var v$680 = v$678[1];
var v$681 = v$678[2];
var v$682 = v$678[3];
if (k0$425 < v$679) {var v$641 = fix$1365.$del(v$680);
var v$642 = v$641[0];
if (v$641[1]) {return balance1$429([v$679,v$642,v$681,v$682]);
} else {return [[v$679,v$642,v$681,v$682],false];
};
} else {if (v$679 < k0$425) {var v$655 = fix$1365.$del(v$681);
var v$656 = v$655[0];
if (v$655[1]) {return balance2$502([v$679,v$680,v$656,v$682]);
} else {return [[v$679,v$680,v$656,v$682],false];
};
} else {if (v$681 == null) {return [v$680,true];
} else {if (v$680 == null) {return [v$681,true];
} else {var v$674 = remove_rightmost$575(v$680);
var v$675 = v$674[0];
var v$676 = v$674[1];
if (v$674[2]) {return balance1$429([v$676,v$675,v$681,v$682]);
} else {return [[v$676,v$675,v$681,v$682],false];
};
};
};
};
};
};
};
};
var del$618 = fix$1365.$del;
try {return (del$618(t$428))[0];
} catch(v$1366) {return (function(NOTFOUND$689){var t$1367 = NOTFOUND$689;
if (t$1367[0] == en$NOTFOUND$421) {return t$428;
} else {throw NOTFOUND$689;
};
})(v$1366);
};
};
var fix$1368 = {};
fix$1368.$difference = function(s1$693,s2$696){lab$difference: while (true) {if (s1$693 == null) {return null;
} else {if (s2$696 == null) {return s1$693;
} else {var v$708 = s2$696;
var v$709 = v$708[0];
var v$710 = v$708[1];
var v$711 = v$708[2];
var t$1369 = fix$1368.$difference(tools$IntSet$.remove$422(v$709,s1$693),v$710);
var t$1370 = v$711;
var s1$693 = t$1369;
var s2$696 = t$1370;
continue lab$difference;
};
};
};
};
tools$IntSet$.difference$690 = fix$1368.$difference;
tools$IntSet$.intersect$712 = function(s1$715,s2$718){var fix$1371 = {};
fix$1371.$inters = function(v$722,v$725){if (v$722 == null) {return v$725;
} else {var v$741 = v$722;
var v$742 = v$741[0];
var v$743 = v$741[1];
var v$744 = v$741[2];
var t$1381 = fix$1371.$inters;
var t$1380 = v$743;
var t$1379;
var t$1378 = fix$1371.$inters;
var t$1377 = v$744;
var t$1376;
var t$1375;
var fix$1372 = {};
fix$1372.$search = function(v$1087){lab$search: while (true) {if (v$1087 == null) {return false;
} else {var v$1088 = v$1087;
var v$1089 = v$1088[0];
var v$1090 = v$1088[1];
var v$1091 = v$1088[2];
if (v$742 == v$1089) {return true;
} else {if (v$742 < v$1089) {var t$1373 = v$1090;
var v$1087 = t$1373;
continue lab$search;
} else {var t$1374 = v$1091;
var v$1087 = t$1374;
continue lab$search;
};
};
};
};
};
var search$1086 = fix$1372.$search;
t$1375 = (search$1086(s2$718));
t$1376 = (t$1375?(tools$IntSet$.insert$167(v$742,v$725)):v$725);
t$1379 = (t$1378(t$1377,t$1376));
return t$1381(t$1380,t$1379);
};
};
var inters$719 = fix$1371.$inters;
return inters$719(s1$715,tools$IntSet$.empty$76);
};
tools$IntSet$.partition$746 = function(f$749,s$752){var fix$1382 = {};
fix$1382.$g = function(v$756,v$759){lab$g: while (true) {if (v$756 == null) {return v$759;
} else {var v$777 = v$756;
var v$778 = v$777[0];
var v$779 = v$777[1];
var v$780 = v$777[2];
var v$782 = v$759[0];
var v$783 = v$759[1];
var b$772 = (f$749(v$778))?[tools$IntSet$.insert$167(v$778,v$782),v$783]:[v$782,tools$IntSet$.insert$167(v$778,v$783)];
var t$1383 = v$780;
var t$1384 = fix$1382.$g(v$779,b$772);
var v$756 = t$1383;
var v$759 = t$1384;
continue lab$g;
};
};
};
var g$753 = fix$1382.$g;
return g$753(s$752,[tools$IntSet$.empty$76,tools$IntSet$.empty$76]);
};
tools$IntSet$.fold$784 = function(f$787,e$790,t$793){var fix$1385 = {};
fix$1385.$fold$ = function(v$821,v$1266){lab$fold$: while (true) {if (v$821 == null) {return v$1266;
} else {var v$823 = v$821;
var v$824 = v$823[1];
if (v$824 == null) {var v$825 = v$823[2];
if (v$825 == null) {var v$826 = v$823[0];
return (f$787(v$826))(v$1266);
} else {var v$828 = v$823[0];
var t$1386 = v$825;
var t$1387 = (f$787(v$828))(v$1266);
var v$821 = t$1386;
var v$1266 = t$1387;
continue lab$fold$;
};
} else {var v$830 = v$823[2];
if (v$830 == null) {var v$831 = v$823[0];
return (f$787(v$831))(fix$1385.$fold$(v$824,v$1266));
} else {var v$833 = v$823[0];
var t$1388 = v$830;
var t$1389 = (f$787(v$833))(fix$1385.$fold$(v$824,v$1266));
var v$821 = t$1388;
var v$1266 = t$1389;
continue lab$fold$;
};
};
};
};
};
var fold$$794 = fix$1385.$fold$;
return fold$$794(t$793,e$790);
};
tools$IntSet$.map$836 = function(f$839,t$842){var t$1395 = tools$IntSet$.fromList$369;
var t$1393;
var l$1101;
var fix$1390 = {};
fix$1390.$f = function(v$1109,v$1110){lab$f: while (true) {if (v$1109 == null) {return v$1110;
} else {var v$1113 = v$1109;
var v$1114 = v$1113[0];
var v$1115 = v$1113[1];
var v$1116 = v$1113[2];
var t$1391 = v$1115;
var t$1392 = [v$1114,fix$1390.$f(v$1116,v$1110)];
var v$1109 = t$1391;
var v$1110 = t$1392;
continue lab$f;
};
};
};
var f$1108 = fix$1390.$f;
l$1101 = (f$1108(t$842,null));
var fix$1394 = {};
fix$1394.$map = function(v$1103){if (v$1103 == null) {return null;
} else {var v$1104 = v$1103;
var v$1105 = v$1104[0];
var v$1106 = v$1104[1];
return [f$839(v$1105),fix$1394.$map(v$1106)];
};
};
var map$1102 = fix$1394.$map;
t$1393 = (map$1102(l$1101));
return t$1395(t$1393);
};
tools$IntSet$.subst$843 = function(v$855,v$856){return function(s$850){var t$1399;
var fix$1396 = {};
fix$1396.$search = function(v$1121){lab$search: while (true) {if (v$1121 == null) {return false;
} else {var v$1122 = v$1121;
var v$1123 = v$1122[0];
var v$1124 = v$1122[1];
var v$1125 = v$1122[2];
if (v$856 == v$1123) {return true;
} else {if (v$856 < v$1123) {var t$1397 = v$1124;
var v$1121 = t$1397;
continue lab$search;
} else {var t$1398 = v$1125;
var v$1121 = t$1398;
continue lab$search;
};
};
};
};
};
var search$1120 = fix$1396.$search;
t$1399 = (search$1120(s$850));
if (t$1399) {return tools$IntSet$.insert$167(v$855,tools$IntSet$.remove$422(v$856,s$850));
} else {return s$850;
};
};
};
tools$IntSet$.apply$857 = function(f$860,s$863){var fix$1400 = {};
fix$1400.$appl = function(v$867){lab$appl: while (true) {if (v$867 == null) {return 0;
} else {var v$879 = v$867;
var v$880 = v$879[0];
var v$881 = v$879[1];
var v$882 = v$879[2];
fix$1400.$appl(v$881);
f$860(v$880);
var t$1401 = v$882;
var v$867 = t$1401;
continue lab$appl;
};
};
};
var appl$864 = fix$1400.$appl;
return appl$864(s$863);
};
tools$IntSet$.layoutSet$883 = function(v$902,v$901,v$900){return function(layoutItem$891){return function(s$894){var t$1402;
var v$898 = [0,v$901];
var t$1406;
var l$1128;
var fix$1403 = {};
fix$1403.$f = function(v$1136,v$1137){lab$f: while (true) {if (v$1136 == null) {return v$1137;
} else {var v$1140 = v$1136;
var v$1141 = v$1140[0];
var v$1142 = v$1140[1];
var v$1143 = v$1140[2];
var t$1404 = v$1142;
var t$1405 = [v$1141,fix$1403.$f(v$1143,v$1137)];
var v$1136 = t$1404;
var v$1137 = t$1405;
continue lab$f;
};
};
};
var f$1135 = fix$1403.$f;
l$1128 = (f$1135(s$894,null));
var fix$1407 = {};
fix$1407.$map = function(v$1130){if (v$1130 == null) {return null;
} else {var v$1131 = v$1130;
var v$1132 = v$1131[0];
var v$1133 = v$1131[1];
return [layoutItem$891(v$1132),fix$1407.$map(v$1133)];
};
};
var map$1129 = fix$1407.$map;
t$1406 = (map$1129(l$1128));
t$1402 = [t$1406,v$898,v$902,3,v$900];
return [0,t$1402];
};
};
};
var pu_bal$903 = pickle$pickle$.enumGen$2149(function(v$1145){var v$1146 = v$1145[0];
var v$1147 = v$1145[1];
switch (v$1146) { case 0: {switch (v$1147) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1147) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1147) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
},["IntSet.bal",[1,[2,[0,null]]]]);
tools$IntSet$.pu$911 = function(v$913){var funE$922;
var v$1267 = null;
funE$922 = (function(v$1268){return pickle$pickle$.con0$1979(v$1267,v$1268);
});
return pickle$pickle$.dataGen$1479(["IntSet.Set",function(v$1152){return (v$1152 == null)?0:1;
},[funE$922,[function(pu$1153){return pickle$pickle$.con1$2005(function(v$1154){return [v$1154[0],v$1154[3],v$1154[2],v$1154[1]];
},function(v$1155){if (v$1155 == null) {basis$General$.print$156("Impossible: OrderSet.pu.funN");
throw [basis$Initial$.en$Fail$45,"Impossible: OrderSet.pu.funN"];
} else {var v$1156 = v$1155;
return [v$1156[0],v$1156[3],v$1156[2],v$1156[1]];
};
},pickle$pickle$.tup4Gen0$2368(pickle$pickle$.int$720,pu_bal$903,pu$1153,pu$1153));
},null]]]);
};
return 0;
})();
