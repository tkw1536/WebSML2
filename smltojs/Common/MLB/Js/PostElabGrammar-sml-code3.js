if ((typeof(basics$PostElabGrammar$$3)) == "undefined") {basics$PostElabGrammar$$3 = {};
};
(function(){basics$PostElabGrammar$$3.empty_topdec$3778 = [0,[basics$PostElabGrammar$$2.bogus_info$153,[3,basics$PostElabGrammar$$2.bogus_info$153],[1]]];
basics$PostElabGrammar$$3.info_on_strexp$3779 = function(v$3782){switch (v$3782[0]) { case 1: {return v$3782[1][0];
 break; }case 3: {return v$3782[1][0];
 break; }case 0: {return v$3782[1][0];
 break; }case 2: {return v$3782[1][0];
 break; }case 5: {return v$3782[1][0];
 break; }default: {return v$3782[1][0];
} };
};
basics$PostElabGrammar$$3.info_on_strdec$3838 = function(v$3841){switch (v$3841[0]) { case 4: {return v$3841[1][0];
 break; }case 0: {return v$3841[1][0];
 break; }case 2: {return v$3841[1][0];
 break; }case 3: {return v$3841[1];
 break; }default: {return v$3841[1][0];
} };
};
basics$PostElabGrammar$$3.info_on_strbind$3882 = function(v$3885){return v$3885[1][0];
};
basics$PostElabGrammar$$3.info_on_sigexp$3897 = function(v$3900){switch (v$3900[0]) { case 1: {return v$3900[1][0];
 break; }case 2: {return v$3900[1][0];
 break; }default: {return v$3900[1][0];
} };
};
basics$PostElabGrammar$$3.info_on_sigdec$3930 = function(v$3933){return v$3933[1][0];
};
basics$PostElabGrammar$$3.info_on_sigbind$3941 = function(v$3944){return v$3944[1][0];
};
basics$PostElabGrammar$$3.info_on_spec$3956 = function(v$3959){switch (v$3959[0]) { case 0: {return v$3959[1][0];
 break; }case 1: {return v$3959[1][0];
 break; }case 8: {return v$3959[1][0];
 break; }case 10: {return v$3959[1][0];
 break; }case 11: {return v$3959[1][0];
 break; }case 7: {return v$3959[1][0];
 break; }case 2: {return v$3959[1][0];
 break; }case 6: {return v$3959[1][0];
 break; }case 4: {return v$3959[1][0];
 break; }case 3: {return v$3959[1][0];
 break; }case 9: {return v$3959[1];
 break; }default: {return v$3959[1][0];
} };
};
basics$PostElabGrammar$$3.info_on_valdesc$4060 = function(v$4063){return v$4063[1][0];
};
basics$PostElabGrammar$$3.info_on_typdesc$4075 = function(v$4078){return v$4078[1][0];
};
basics$PostElabGrammar$$3.info_on_datdesc$4090 = function(v$4093){return v$4093[1][0];
};
basics$PostElabGrammar$$3.info_on_condesc$4107 = function(v$4110){return v$4110[1][0];
};
basics$PostElabGrammar$$3.info_on_exdesc$4122 = function(v$4125){return v$4125[1][0];
};
basics$PostElabGrammar$$3.info_on_strdesc$4137 = function(v$4140){return v$4140[1][0];
};
basics$PostElabGrammar$$3.info_on_fundec$4152 = function(v$4155){return v$4155[1][0];
};
basics$PostElabGrammar$$3.info_on_funbind$4163 = function(v$4166){return v$4166[1][0];
};
basics$PostElabGrammar$$3.info_on_topdec$4182 = function(v$4185){switch (v$4185[0]) { case 0: {return v$4185[1][0];
 break; }case 1: {return v$4185[1][0];
 break; }default: {return v$4185[1][0];
} };
};
var fix$5494 = {};
fix$5494.$map_strdec_info = function(f$4281,strdec$4284){switch (strdec$4284[0]) { case 4: {var v$4318 = strdec$4284[1];
var v$4319 = v$4318[0];
var v$4320 = v$4318[1];
return [4,[f$4281(v$4319),basics$PostElabGrammar$$2.map_dec_info$815(f$4281,v$4320)]];
 break; }case 0: {var v$4314 = strdec$4284[1];
var v$4315 = v$4314[0];
var v$4316 = v$4314[1];
return [0,[f$4281(v$4315),fix$5494.$map_strbind_info(f$4281,v$4316)]];
 break; }case 2: {var v$4309 = strdec$4284[1];
var v$4310 = v$4309[0];
var v$4311 = v$4309[1];
var v$4312 = v$4309[2];
return [2,[f$4281(v$4310),fix$5494.$map_strdec_info(f$4281,v$4311),fix$5494.$map_strdec_info(f$4281,v$4312)]];
 break; }case 3: {var v$4307 = strdec$4284[1];
return [3,f$4281(v$4307)];
 break; }default: {var v$4321 = strdec$4284[1];
var v$4322 = v$4321[0];
var v$4323 = v$4321[1];
var v$4324 = v$4321[2];
return [1,[f$4281(v$4322),fix$5494.$map_strdec_info(f$4281,v$4323),fix$5494.$map_strdec_info(f$4281,v$4324)]];
} };
};
fix$5494.$map_strexp_info = function(f$4220,strexp$4223){switch (strexp$4223[0]) { case 1: {var v$4272 = strexp$4223[1];
var v$4273 = v$4272[0];
var v$4274 = v$4272[1];
return [1,[f$4220(v$4273),fix$5494.$map_strdec_info(f$4220,v$4274)]];
 break; }case 3: {var v$4268 = strexp$4223[1];
var v$4269 = v$4268[0];
var v$4270 = v$4268[1];
return [3,[f$4220(v$4269),v$4270]];
 break; }case 0: {var v$4263 = strexp$4223[1];
var v$4264 = v$4263[0];
var v$4265 = v$4263[1];
var v$4266 = v$4263[2];
return [0,[f$4220(v$4264),fix$5494.$map_strexp_info(f$4220,v$4265),v$4266]];
 break; }case 2: {var v$4258 = strexp$4223[1];
var v$4259 = v$4258[0];
var v$4260 = v$4258[1];
var v$4261 = v$4258[2];
return [2,[f$4220(v$4259),fix$5494.$map_strexp_info(f$4220,v$4260),v$4261]];
 break; }case 5: {var v$4253 = strexp$4223[1];
var v$4254 = v$4253[0];
var v$4255 = v$4253[1];
var v$4256 = v$4253[2];
return [5,[f$4220(v$4254),v$4255,fix$5494.$map_strexp_info(f$4220,v$4256)]];
 break; }default: {var v$4275 = strexp$4223[1];
var v$4276 = v$4275[0];
var v$4277 = v$4275[1];
var v$4278 = v$4275[2];
return [4,[f$4220(v$4276),fix$5494.$map_strdec_info(f$4220,v$4277),fix$5494.$map_strexp_info(f$4220,v$4278)]];
} };
};
fix$5494.$map_strbind_info = function(f$4327,strbind$4330){var v$4344 = strbind$4330[1];
var v$4345 = v$4344[0];
var v$4346 = v$4344[1];
var v$4347 = v$4344[2];
var v$4348 = v$4344[3];
var t$5657;
var t$5656 = f$4327(v$4345);
var t$5655 = v$4346;
var t$5654 = fix$5494.$map_strexp_info(f$4327,v$4347);
var t$5653;
switch (v$4348[0]) { case 0: {var v$4343 = v$4348[1];
t$5653 = [0,fix$5494.$map_strbind_info(f$4327,v$4343)];
 break; }default: {t$5653 = [1];
} };
t$5657 = [t$5656,t$5655,t$5654,t$5653];
return [0,t$5657];
};
basics$PostElabGrammar$$3.map_strdec_info$4216 = fix$5494.$map_strdec_info;
basics$PostElabGrammar$$3.map_strexp_info$4217 = fix$5494.$map_strexp_info;
basics$PostElabGrammar$$3.map_strbind_info$4215 = fix$5494.$map_strbind_info;
var fix$5495 = {};
fix$5495.$f = function(res$4352,v$4355){lab$f: while (true) {var v$4376 = v$4355[1];
var v$4377 = v$4376[2];
var v$4378 = v$4376[3];
var res$$4361;
switch (v$4377[0]) { case 1: {res$$4361 = res$4352;
 break; }default: {var v$4367 = v$4377[1];
res$$4361 = (basis$List$.s$n$645([basics$PostElabGrammar$$2.getExplicitTyVarsTy$1785(v$4367),res$4352]));
} };
switch (v$4378[0]) { case 1: {return res$$4361;
 break; }default: {var v$4373 = v$4378[1];
var t$5496 = res$$4361;
var t$5497 = v$4373;
var res$4352 = t$5496;
var v$4355 = t$5497;
continue lab$f;
} };
};
};
var f$4349 = fix$5495.$f;
basics$PostElabGrammar$$3.getExplicitTyVarsCondesc$4379;
var v$5482 = null;
basics$PostElabGrammar$$3.getExplicitTyVarsCondesc$4379 = (function(v$5483){return f$4349(v$5482,v$5483);
});
basics$PostElabGrammar$$3.INDENT$4380 = 3;
var fix$5498 = {};
fix$5498.$makeList = function(f$4384,x$4387){var t$5652;
var t$5651 = x$4387;
var t$5650;
var v$4392 = f$4384(x$4387);
switch (v$4392[0]) { case 0: {var v$4394 = v$4392[1];
t$5650 = (fix$5498.$makeList(f$4384,v$4394));
 break; }default: {t$5650 = null;
} };
t$5652 = [t$5651,t$5650];
return t$5652;
};
basics$PostElabGrammar$$3.makeList$4381 = fix$5498.$makeList;
basics$PostElabGrammar$$3.layoutExdesc$4398 = function(exdesc$4933){var exdescs$4934;
var fix$5499 = {};
fix$5499.$makeList = function(x$5333){var t$5502;
var t$5501 = x$5333;
var t$5500;
var v$5334 = x$5333[1][3];
switch (v$5334[0]) { case 0: {var v$5335 = v$5334[1];
t$5500 = (fix$5499.$makeList(v$5335));
 break; }default: {t$5500 = null;
} };
t$5502 = [t$5501,t$5500];
return t$5502;
};
var makeList$5332 = fix$5499.$makeList;
exdescs$4934 = (makeList$5332(exdesc$4933));
var t$5512;
var t$5504;
var fix$5503 = {};
fix$5503.$map = function(v$5124){if (v$5124 == null) {return null;
} else {var v$5125 = v$5124;
var v$5126 = v$5125[0];
var v$5127 = v$5125[1];
var t$5511;
var t$5505;
var v$5338 = v$5126[1];
var v$5339 = v$5338[1];
var v$5340 = v$5338[2];
var t$5510;
var t$5509;
var t$5508;
var t$5507 = tools$PrettyPrint$.layoutAtom$176(function(v$5484){return syntax_objects$Ident$.pr_id$53(v$5484);
},v$5339);
var t$5506;
switch (v$5340[0]) { case 0: {var v$5341 = v$5340[1];
t$5506 = [basics$PostElabGrammar$$2.layoutTy$1876(v$5341),null];
 break; }default: {t$5506 = null;
} };
t$5508 = [t$5507,t$5506];
t$5509 = t$5508;
t$5510 = [t$5509,[2," of "],"",0,""];
t$5505 = [0,t$5510];
t$5511 = [t$5505,fix$5503.$map(v$5127)];
return t$5511;
};
};
var map$5123 = fix$5503.$map;
t$5504 = (map$5123(exdescs$4934));
t$5512 = [t$5504,[2," and "],"",0,""];
return [0,t$5512];
};
basics$PostElabGrammar$$3.layoutDatdesc$4399 = function(datdesc$4844){var datdescs$4845;
var fix$5513 = {};
fix$5513.$makeList = function(x$5345){var t$5516;
var t$5515 = x$5345;
var t$5514;
var v$5346 = x$5345[1][4];
switch (v$5346[0]) { case 0: {var v$5347 = v$5346[1];
t$5514 = (fix$5513.$makeList(v$5347));
 break; }default: {t$5514 = null;
} };
t$5516 = [t$5515,t$5514];
return t$5516;
};
var makeList$5344 = fix$5513.$makeList;
datdescs$4845 = (makeList$5344(datdesc$4844));
var t$5547;
var t$5518;
var fix$5517 = {};
fix$5517.$map = function(v$5172){if (v$5172 == null) {return null;
} else {var v$5173 = v$5172;
var v$5174 = v$5173[0];
var v$5175 = v$5173[1];
var t$5546;
var t$5519;
var v$5357 = v$5174[1];
var v$5358 = v$5357[1];
var v$5359 = v$5357[2];
var v$5360 = v$5357[3];
var t$5545;
var t$5544;
var t$5543;
var t$5542;
var t$5541;
var t$5540;
var t$5539 = basis$List$.s$n$645;
var t$5538;
var t$5537;
var v$5361 = basics$PostElabGrammar$$2.layoutTyvarseq$1884(v$5358);
switch (v$5361[0]) { case 0: {t$5537 = [v$5361[1],null];
 break; }default: {t$5537 = null;
} };
t$5538 = [t$5537,[tools$PrettyPrint$.layoutAtom$176(function(v$5485){return syntax_objects$TyCon$.pr_TyCon$53(v$5485);
},v$5359),null]];
t$5540 = (t$5539(t$5538));
t$5541 = [t$5540,[0," "],"",0,""];
t$5542 = [0,t$5541];
var t$5536;
var t$5535;
var t$5521;
var condescs$5362;
var fix$5520 = {};
fix$5520.$makeList = function(x$5364){var t$5524;
var t$5523 = x$5364;
var t$5522;
var v$5365 = x$5364[1][3];
switch (v$5365[0]) { case 0: {var v$5366 = v$5365[1];
t$5522 = (fix$5520.$makeList(v$5366));
 break; }default: {t$5522 = null;
} };
t$5524 = [t$5523,t$5522];
return t$5524;
};
var makeList$5363 = fix$5520.$makeList;
condescs$5362 = (makeList$5363(v$5360));
var t$5534;
var t$5526;
var fix$5525 = {};
fix$5525.$map = function(v$5368){if (v$5368 == null) {return null;
} else {var v$5369 = v$5368;
var v$5370 = v$5369[0];
var v$5371 = v$5369[1];
var t$5533;
var t$5527;
var v$5372 = v$5370[1];
var v$5373 = v$5372[1];
var v$5374 = v$5372[2];
var t$5532;
var t$5531;
var t$5530;
var t$5529 = tools$PrettyPrint$.layoutAtom$176(function(v$5486){return syntax_objects$Ident$.pr_id$53(v$5486);
},v$5373);
var t$5528;
switch (v$5374[0]) { case 0: {var v$5375 = v$5374[1];
t$5528 = [basics$PostElabGrammar$$2.layoutTy$1876(v$5375),null];
 break; }default: {t$5528 = null;
} };
t$5530 = [t$5529,t$5528];
t$5531 = t$5530;
t$5532 = [t$5531,[2," of "],"",0,""];
t$5527 = [0,t$5532];
t$5533 = [t$5527,fix$5525.$map(v$5371)];
return t$5533;
};
};
var map$5367 = fix$5525.$map;
t$5526 = (map$5367(condescs$5362));
t$5534 = [t$5526,[2," | "],"",0,""];
t$5521 = [0,t$5534];
t$5535 = [t$5521,null];
t$5536 = t$5535;
t$5543 = [t$5542,t$5536];
t$5544 = t$5543;
t$5545 = [t$5544,[0," = "],"",0,""];
t$5519 = [0,t$5545];
t$5546 = [t$5519,fix$5517.$map(v$5175)];
return t$5546;
};
};
var map$5171 = fix$5517.$map;
t$5518 = (map$5171(datdescs$4845));
t$5547 = [t$5518,[2," and "],"",0,""];
return [0,t$5547];
};
basics$PostElabGrammar$$3.layoutTypdesc$4400 = function(typdesc$4807){var typdescs$4808;
var fix$5548 = {};
fix$5548.$makeList = function(x$5379){var t$5551;
var t$5550 = x$5379;
var t$5549;
var v$5380 = x$5379[1][3];
switch (v$5380[0]) { case 0: {var v$5381 = v$5380[1];
t$5549 = (fix$5548.$makeList(v$5381));
 break; }default: {t$5549 = null;
} };
t$5551 = [t$5550,t$5549];
return t$5551;
};
var makeList$5378 = fix$5548.$makeList;
typdescs$4808 = (makeList$5378(typdesc$4807));
var t$5561;
var t$5553;
var fix$5552 = {};
fix$5552.$map = function(v$5201){if (v$5201 == null) {return null;
} else {var v$5202 = v$5201;
var v$5203 = v$5202[0];
var v$5204 = v$5202[1];
var t$5560;
var t$5554;
var v$5384 = v$5203[1];
var v$5385 = v$5384[1];
var v$5386 = v$5384[2];
var t$5559;
var t$5558;
var t$5557 = basis$List$.s$n$645;
var t$5556;
var t$5555;
var v$5387 = basics$PostElabGrammar$$2.layoutTyvarseq$1884(v$5385);
switch (v$5387[0]) { case 0: {t$5555 = [v$5387[1],null];
 break; }default: {t$5555 = null;
} };
t$5556 = [t$5555,[tools$PrettyPrint$.layoutAtom$176(function(v$5487){return syntax_objects$TyCon$.pr_TyCon$53(v$5487);
},v$5386),null]];
t$5558 = (t$5557(t$5556));
t$5559 = [t$5558,[0," "],"",0,""];
t$5554 = [0,t$5559];
t$5560 = [t$5554,fix$5552.$map(v$5204)];
return t$5560;
};
};
var map$5200 = fix$5552.$map;
t$5553 = (map$5200(typdescs$4808));
t$5561 = [t$5553,[2," and "],"",0,""];
return [0,t$5561];
};
basics$PostElabGrammar$$3.layoutValdesc$4401 = function(valdesc$4777){var valdescs$4778;
var fix$5562 = {};
fix$5562.$makeList = function(x$5391){var t$5565;
var t$5564 = x$5391;
var t$5563;
var v$5392 = x$5391[1][3];
switch (v$5392[0]) { case 0: {var v$5393 = v$5392[1];
t$5563 = (fix$5562.$makeList(v$5393));
 break; }default: {t$5563 = null;
} };
t$5565 = [t$5564,t$5563];
return t$5565;
};
var makeList$5390 = fix$5562.$makeList;
valdescs$4778 = (makeList$5390(valdesc$4777));
var t$5570;
var t$5567;
var fix$5566 = {};
fix$5566.$map = function(v$5213){if (v$5213 == null) {return null;
} else {var v$5214 = v$5213;
var v$5215 = v$5214[0];
var v$5216 = v$5214[1];
var t$5569;
var t$5568;
var v$5396 = v$5215[1];
var v$5397 = v$5396[1];
var v$5398 = v$5396[2];
t$5568 = [0,[[tools$PrettyPrint$.layoutAtom$176(function(v$5488){return syntax_objects$Ident$.pr_id$53(v$5488);
},v$5397),[basics$PostElabGrammar$$2.layoutTy$1876(v$5398),null]],[2," : "],"",0,""]];
t$5569 = [t$5568,fix$5566.$map(v$5216)];
return t$5569;
};
};
var map$5212 = fix$5566.$map;
t$5567 = (map$5212(valdescs$4778));
t$5570 = [t$5567,[2," and "],"",0,""];
return [0,t$5570];
};
var fix$5571 = {};
fix$5571.$layoutSpec = function(spec$4638){switch (spec$4638[0]) { case 0: {var v$4765 = spec$4638[1];
var v$4766 = v$4765[1];
return [0,[[basics$PostElabGrammar$$3.layoutValdesc$4401(v$4766),null],[1],"",3,"val "]];
 break; }case 1: {var v$4757 = spec$4638[1];
var v$4758 = v$4757[1];
return [0,[[basics$PostElabGrammar$$3.layoutTypdesc$4400(v$4758),null],[1],"",3,"type "]];
 break; }case 8: {var v$4749 = spec$4638[1];
var v$4750 = v$4749[1];
return [0,[[basics$PostElabGrammar$$3.layoutTypdesc$4400(v$4750),null],[1],"",3,"eqtype "]];
 break; }case 10: {var v$4741 = spec$4638[1];
var v$4742 = v$4741[1];
return [0,[[basics$PostElabGrammar$$3.layoutDatdesc$4399(v$4742),null],[1],"",3,"datatype "]];
 break; }case 11: {var v$4731 = spec$4638[1];
var v$4732 = v$4731[0];
var v$4733 = v$4731[1];
var v$4734 = v$4731[2];
return basics$PostElabGrammar$$2.layout_datatype_replication$1886(v$4732,v$4733,v$4734);
 break; }case 7: {var v$4728 = spec$4638[1];
var v$4729 = v$4728[1];
return [0,[[basics$PostElabGrammar$$3.layoutExdesc$4398(v$4729),null],[1],"",3,"exception "]];
 break; }case 2: {var v$4720 = spec$4638[1];
var v$4721 = v$4720[1];
return [0,[[fix$5571.$layoutStrdesc(v$4721),null],[1],"",3,"structure "]];
 break; }case 6: {var v$4712 = spec$4638[1];
var v$4713 = v$4712[1];
return [0,[[fix$5571.$layoutSigexp(v$4713),null],[1],"",8,"include "]];
 break; }case 4: {var v$4702 = spec$4638[1];
var v$4704 = v$4702[1];
var v$4705 = v$4702[2];
var st_longtycon_withinfo_list$4695;
var t$5645;
var v$4700 = [2," = "];
var t$5647;
var fix$5646 = {};
fix$5646.$map = function(v$5235){if (v$5235 == null) {return null;
} else {var v$5236 = v$5235;
var v$5237 = v$5236[0];
var v$5238 = v$5236[1];
var t$5649;
var t$5648;
var x$5417 = basics$PostElabGrammar$$2.strip_info$156(v$5237);
var v$5418 = syntax_objects$TyCon$.pr_LongTyCon$62(x$5417);
t$5648 = [1,v$5418];
t$5649 = [t$5648,fix$5646.$map(v$5238)];
return t$5649;
};
};
var map$5234 = fix$5646.$map;
t$5647 = (map$5234(v$4705));
t$5645 = [t$5647,v$4700,"",3," sharing type "];
st_longtycon_withinfo_list$4695 = [0,t$5645];
return tools$PrettyPrint$.layout_together$244([fix$5571.$layoutSpec(v$4704),[st_longtycon_withinfo_list$4695,null]],3);
 break; }case 3: {var v$4690 = spec$4638[1];
var v$4692 = v$4690[1];
var v$4693 = v$4690[2];
var st_longstrid_withinfo_list$4683;
var t$5640;
var v$4688 = [2," = "];
var t$5642;
var fix$5641 = {};
fix$5641.$map = function(v$5250){if (v$5250 == null) {return null;
} else {var v$5251 = v$5250;
var v$5252 = v$5251[0];
var v$5253 = v$5251[1];
var t$5644;
var t$5643;
var x$5426 = basics$PostElabGrammar$$2.strip_info$156(v$5252);
var v$5427 = syntax_objects$StrId$.pr_LongStrId$61(x$5426);
t$5643 = [1,v$5427];
t$5644 = [t$5643,fix$5641.$map(v$5253)];
return t$5644;
};
};
var map$5249 = fix$5641.$map;
t$5642 = (map$5249(v$4693));
t$5640 = [t$5642,v$4688,"",3," sharing "];
st_longstrid_withinfo_list$4683 = [0,t$5640];
return tools$PrettyPrint$.layout_together$244([fix$5571.$layoutSpec(v$4692),[st_longstrid_withinfo_list$4683,null]],3);
 break; }case 9: {return [1,""];
 break; }default: {var v$4772 = spec$4638[1];
var v$4773 = v$4772[1];
var v$4774 = v$4772[2];
return [0,[[fix$5571.$layoutSpec(v$4773),[fix$5571.$layoutSpec(v$4774),null]],[0,"; "],"",0,""]];
} };
};
fix$5571.$layoutSigexp = function(sigexp$4550){switch (sigexp$4550[0]) { case 1: {var v$4573 = sigexp$4550[1];
var v$4574 = v$4573[1];
return [0,[[fix$5571.$layoutSpec(v$4574),null],[1]," end",3,"sig "]];
 break; }case 2: {var v$4565 = sigexp$4550[1];
var v$4566 = v$4565[1];
return tools$PrettyPrint$.layoutAtom$176(function(v$5490){return syntax_objects$SigId$.pr_SigId$51(v$5490);
},v$4566);
 break; }default: {var v$4587 = sigexp$4550[1];
var v$4589 = v$4587[1];
var v$4590 = v$4587[2];
var v$4591 = v$4587[3];
var v$4592 = v$4587[4];
var t$5639 = tools$PrettyPrint$.layout_together$244;
var t$5638;
var t$5637;
var t$5636 = fix$5571.$layoutSigexp(v$4589);
var t$5635;
var t$5634;
var t$5633;
var t$5632;
var t$5631;
var t$5630;
var t$5629;
var t$5628 = tools$PrettyPrint$.layout_together$244;
var t$5627;
var t$5626 = basis$List$.s$n$645;
var t$5625;
var t$5624;
var v$4579 = basics$PostElabGrammar$$2.layoutTyvarseq$1884(v$4590);
switch (v$4579[0]) { case 0: {t$5624 = [v$4579[1],null];
 break; }default: {t$5624 = null;
} };
t$5625 = [t$5624,[[1,syntax_objects$TyCon$.pr_LongTyCon$62(v$4591)],null]];
t$5627 = (t$5626(t$5625));
t$5629 = (t$5628(t$5627,3));
t$5630 = [t$5629,[basics$PostElabGrammar$$2.layoutTy$1876(v$4592),null]];
t$5631 = t$5630;
t$5632 = [t$5631,[0," = "],"",0,"where type "];
t$5633 = [0,t$5632];
t$5634 = [t$5633,null];
t$5635 = t$5634;
t$5637 = [t$5636,t$5635];
t$5638 = t$5637;
return t$5639(t$5638,3);
} };
};
fix$5571.$layoutStrdesc = function(strdesc$4970){var strdescs$4971;
var fix$5615 = {};
fix$5615.$makeList = function(x$5402){var t$5618;
var t$5617 = x$5402;
var t$5616;
var v$5403 = x$5402[1][3];
switch (v$5403[0]) { case 0: {var v$5404 = v$5403[1];
t$5616 = (fix$5615.$makeList(v$5404));
 break; }default: {t$5616 = null;
} };
t$5618 = [t$5617,t$5616];
return t$5618;
};
var makeList$5401 = fix$5615.$makeList;
strdescs$4971 = (makeList$5401(strdesc$4970));
var t$5623;
var t$5620;
var fix$5619 = {};
fix$5619.$map = function(v$5224){if (v$5224 == null) {return null;
} else {var v$5225 = v$5224;
var v$5226 = v$5225[0];
var v$5227 = v$5225[1];
var t$5622;
var t$5621;
var v$5407 = v$5226[1];
var v$5408 = v$5407[1];
var v$5409 = v$5407[2];
t$5621 = [0,[[tools$PrettyPrint$.layoutAtom$176(function(v$5489){return syntax_objects$StrId$.pr_StrId$52(v$5489);
},v$5408),[fix$5571.$layoutSigexp(v$5409),null]],[2," : "],"",0,""]];
t$5622 = [t$5621,fix$5619.$map(v$5227)];
return t$5622;
};
};
var map$5223 = fix$5619.$map;
t$5620 = (map$5223(strdescs$4971));
t$5623 = [t$5620,[2," and "],"",0,""];
return [0,t$5623];
};
basics$PostElabGrammar$$3.layoutSpec$4402 = fix$5571.$layoutSpec;
basics$PostElabGrammar$$3.layoutSigexp$4405 = fix$5571.$layoutSigexp;
basics$PostElabGrammar$$3.layoutStrdesc$4397 = fix$5571.$layoutStrdesc;
var fix$5572 = {};
fix$5572.$layoutStrdec = function(strdec$4472){switch (strdec$4472[0]) { case 4: {var v$4508 = strdec$4472[1];
var v$4509 = v$4508[1];
return basics$PostElabGrammar$$2.layoutDec$1887(v$4509);
 break; }case 0: {var v$4505 = strdec$4472[1];
var v$4506 = v$4505[1];
return [0,[[fix$5572.$layoutStrbind(v$4506),null],[1],"",3,"structure "]];
 break; }case 2: {var v$4496 = strdec$4472[1];
var v$4497 = v$4496[1];
var v$4498 = v$4496[2];
return [0,[[fix$5572.$layoutStrdec(v$4497),[fix$5572.$layoutStrdec(v$4498),null]],[2," in "]," end",3,"local "]];
 break; }case 3: {return [1,""];
 break; }default: {var v$4515 = strdec$4472[1];
var v$4516 = v$4515[1];
var v$4517 = v$4515[2];
return [0,[[fix$5572.$layoutStrdec(v$4516),[fix$5572.$layoutStrdec(v$4517),null]],[0,"; "],")",0,"("]];
} };
};
fix$5572.$layoutStrexp = function(strexp$4411){switch (strexp$4411[0]) { case 1: {var v$4460 = strexp$4411[1];
var v$4461 = v$4460[1];
return [0,[[fix$5572.$layoutStrdec(v$4461),null],[1]," end",3,"struct "]];
 break; }case 3: {var v$4452 = strexp$4411[1];
var v$4453 = v$4452[1];
return tools$PrettyPrint$.layoutAtom$176(function(v$5491){return syntax_objects$StrId$.pr_LongStrId$61(v$5491);
},v$4453);
 break; }case 0: {var v$4448 = strexp$4411[1];
var v$4449 = v$4448[1];
var v$4450 = v$4448[2];
return tools$PrettyPrint$.layout_together$244([fix$5572.$layoutStrexp(v$4449),[[1,":"],[basics$PostElabGrammar$$3.layoutSigexp$4405(v$4450),null]]],3);
 break; }case 2: {var v$4444 = strexp$4411[1];
var v$4445 = v$4444[1];
var v$4446 = v$4444[2];
return tools$PrettyPrint$.layout_together$244([fix$5572.$layoutStrexp(v$4445),[[1,":>"],[basics$PostElabGrammar$$3.layoutSigexp$4405(v$4446),null]]],3);
 break; }case 5: {var v$4440 = strexp$4411[1];
var v$4441 = v$4440[1];
var v$4442 = v$4440[2];
var t$5614;
var v$4435 = (syntax_objects$FunId$.pr_FunId$51(v$4441)) + "(";
t$5614 = [[fix$5572.$layoutStrexp(v$4442),null],[1],")",3,v$4435];
return [0,t$5614];
 break; }default: {var v$4467 = strexp$4411[1];
var v$4468 = v$4467[1];
var v$4469 = v$4467[2];
return [0,[[fix$5572.$layoutStrdec(v$4468),[fix$5572.$layoutStrexp(v$4469),null]],[2," in "]," end",3,"let "]];
} };
};
fix$5572.$layoutStrbind = function(strbind$4520){var strbinds$4521;
var fix$5605 = {};
fix$5605.$makeList = function(x$5431){var t$5608;
var t$5607 = x$5431;
var t$5606;
var v$5432 = x$5431[1][3];
switch (v$5432[0]) { case 0: {var v$5433 = v$5432[1];
t$5606 = (fix$5605.$makeList(v$5433));
 break; }default: {t$5606 = null;
} };
t$5608 = [t$5607,t$5606];
return t$5608;
};
var makeList$5430 = fix$5605.$makeList;
strbinds$4521 = (makeList$5430(strbind$4520));
var t$5613;
var t$5610;
var fix$5609 = {};
fix$5609.$map = function(v$5265){if (v$5265 == null) {return null;
} else {var v$5266 = v$5265;
var v$5267 = v$5266[0];
var v$5268 = v$5266[1];
var t$5612;
var t$5611;
var v$5436 = v$5267[1];
var v$5437 = v$5436[1];
var v$5438 = v$5436[2];
t$5611 = [0,[[[1,syntax_objects$StrId$.pr_StrId$52(v$5437)],[fix$5572.$layoutStrexp(v$5438),null]],[0," = "],"",0,""]];
t$5612 = [t$5611,fix$5609.$map(v$5268)];
return t$5612;
};
};
var map$5264 = fix$5609.$map;
t$5610 = (map$5264(strbinds$4521));
t$5613 = [t$5610,[2," and "],"",0,""];
return [0,t$5613];
};
basics$PostElabGrammar$$3.layoutStrdec$4407 = fix$5572.$layoutStrdec;
basics$PostElabGrammar$$3.layoutStrexp$4408 = fix$5572.$layoutStrexp;
basics$PostElabGrammar$$3.layoutStrbind$4406 = fix$5572.$layoutStrbind;
basics$PostElabGrammar$$3.layoutFunbind$4395 = function(funbind$5013){var funbinds$5014;
var fix$5573 = {};
fix$5573.$makeList = function(x$5442){var t$5576;
var t$5575 = x$5442;
var t$5574;
var v$5443 = x$5442[1][5];
switch (v$5443[0]) { case 0: {var v$5444 = v$5443[1];
t$5574 = (fix$5573.$makeList(v$5444));
 break; }default: {t$5574 = null;
} };
t$5576 = [t$5575,t$5574];
return t$5576;
};
var makeList$5441 = fix$5573.$makeList;
funbinds$5014 = (makeList$5441(funbind$5013));
var t$5586;
var t$5578;
var fix$5577 = {};
fix$5577.$map = function(v$5278){if (v$5278 == null) {return null;
} else {var v$5279 = v$5278;
var v$5280 = v$5279[0];
var v$5281 = v$5279[1];
var t$5585;
var t$5579;
var v$5447 = v$5280[1];
var v$5448 = v$5447[1];
var v$5449 = v$5447[2];
var v$5450 = v$5447[3];
var v$5451 = v$5447[4];
var t$5584;
var t$5583;
var t$5582;
var t$5581;
var t$5580;
var v$5452 = (syntax_objects$FunId$.pr_FunId$51(v$5448)) + "(";
t$5580 = [[tools$PrettyPrint$.layoutAtom$176(function(v$5492){return syntax_objects$StrId$.pr_StrId$52(v$5492);
},v$5449),[basics$PostElabGrammar$$3.layoutSigexp$4405(v$5450),null]],[2," : "],")",3,v$5452];
t$5581 = [0,t$5580];
t$5582 = [t$5581,[basics$PostElabGrammar$$3.layoutStrexp$4408(v$5451),null]];
t$5583 = t$5582;
t$5584 = [t$5583,[0," = "],"",0,""];
t$5579 = [0,t$5584];
t$5585 = [t$5579,fix$5577.$map(v$5281)];
return t$5585;
};
};
var map$5277 = fix$5577.$map;
t$5578 = (map$5277(funbinds$5014));
t$5586 = [t$5578,[2," and "],"",0,""];
return [0,t$5586];
};
basics$PostElabGrammar$$3.layoutFundec$4396 = function(v$5000){var v$5009 = v$5000[1];
var v$5010 = v$5009[1];
return [0,[[basics$PostElabGrammar$$3.layoutFunbind$4395(v$5010),null],[1],"",3,"functor "]];
};
basics$PostElabGrammar$$3.layoutSigbind$4403 = function(sigbind$4608){var sigbinds$4609;
var fix$5587 = {};
fix$5587.$makeList = function(x$5456){var t$5590;
var t$5589 = x$5456;
var t$5588;
var v$5457 = x$5456[1][3];
switch (v$5457[0]) { case 0: {var v$5458 = v$5457[1];
t$5588 = (fix$5587.$makeList(v$5458));
 break; }default: {t$5588 = null;
} };
t$5590 = [t$5589,t$5588];
return t$5590;
};
var makeList$5455 = fix$5587.$makeList;
sigbinds$4609 = (makeList$5455(sigbind$4608));
var t$5595;
var t$5592;
var fix$5591 = {};
fix$5591.$map = function(v$5293){if (v$5293 == null) {return null;
} else {var v$5294 = v$5293;
var v$5295 = v$5294[0];
var v$5296 = v$5294[1];
var t$5594;
var t$5593;
var v$5461 = v$5295[1];
var v$5462 = v$5461[1];
var v$5463 = v$5461[2];
t$5593 = [0,[[tools$PrettyPrint$.layoutAtom$176(function(v$5493){return syntax_objects$SigId$.pr_SigId$51(v$5493);
},v$5462),[basics$PostElabGrammar$$3.layoutSigexp$4405(v$5463),null]],[0," = "],"",0,""]];
t$5594 = [t$5593,fix$5591.$map(v$5296)];
return t$5594;
};
};
var map$5292 = fix$5591.$map;
t$5592 = (map$5292(sigbinds$4609));
t$5595 = [t$5592,[2," and "],"",0,""];
return [0,t$5595];
};
basics$PostElabGrammar$$3.layoutSigdec$4404 = function(v$4595){var v$4604 = v$4595[1];
var v$4605 = v$4604[1];
return [0,[[basics$PostElabGrammar$$3.layoutSigbind$4403(v$4605),null],[1],"",3,"signature "]];
};
basics$PostElabGrammar$$3.layoutTopdec$5051 = function(topdec$5054){var topdecs$5055;
var fix$5596 = {};
fix$5596.$makeList = function(x$5467){var t$5599;
var t$5598 = x$5467;
var t$5597;
var v$5468;
switch (x$5467[0]) { case 0: {v$5468 = x$5467[1][2];
 break; }case 1: {v$5468 = x$5467[1][2];
 break; }default: {v$5468 = x$5467[1][2];
} };
switch (v$5468[0]) { case 0: {var v$5469 = v$5468[1];
t$5597 = (fix$5596.$makeList(v$5469));
 break; }default: {t$5597 = null;
} };
t$5599 = [t$5598,t$5597];
return t$5599;
};
var makeList$5466 = fix$5596.$makeList;
topdecs$5055 = (makeList$5466(topdec$5054));
var t$5600;
var v$5093 = [0,"; "];
var t$5602;
var fix$5601 = {};
fix$5601.$map = function(v$5304){if (v$5304 == null) {return null;
} else {var v$5305 = v$5304;
var v$5306 = v$5305[0];
var v$5307 = v$5305[1];
var t$5604;
var t$5603;
switch (v$5306[0]) { case 0: {var v$5472 = v$5306[1];
var v$5473 = v$5472[1];
t$5603 = (basics$PostElabGrammar$$3.layoutStrdec$4407(v$5473));
 break; }case 1: {var v$5474 = v$5306[1];
var v$5475 = v$5474[1];
var v$5476 = v$5475[1];
var v$5477 = v$5476[1];
t$5603 = [0,[[basics$PostElabGrammar$$3.layoutSigbind$4403(v$5477),null],[1],"",3,"signature "]];
 break; }default: {var v$5478 = v$5306[1];
var v$5479 = v$5478[1];
var v$5480 = v$5479[1];
var v$5481 = v$5480[1];
t$5603 = [0,[[basics$PostElabGrammar$$3.layoutFunbind$4395(v$5481),null],[1],"",3,"functor "]];
} };
t$5604 = [t$5603,fix$5601.$map(v$5307)];
return t$5604;
};
};
var map$5303 = fix$5601.$map;
t$5602 = (map$5303(topdecs$5055));
t$5600 = [t$5602,v$5093,"",0,""];
return [0,t$5600];
};
return 0;
})();
