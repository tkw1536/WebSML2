if ((typeof(basics$PreElabTopdecGrammar$$1)) == "undefined") {basics$PreElabTopdecGrammar$$1 = {};
};
(function(){basics$PreElabTopdecGrammar$$1.empty_topdec$193 = [0,[basics$PreElabDecGrammar$$2.bogus_info$137,[3,basics$PreElabDecGrammar$$2.bogus_info$137],[1]]];
basics$PreElabTopdecGrammar$$1.info_on_strexp$194 = function(v$197){switch (v$197[0]) { case 1: {return v$197[1][0];
 break; }case 3: {return v$197[1][0];
 break; }case 0: {return v$197[1][0];
 break; }case 2: {return v$197[1][0];
 break; }case 5: {return v$197[1][0];
 break; }default: {return v$197[1][0];
} };
};
basics$PreElabTopdecGrammar$$1.info_on_strdec$253 = function(v$256){switch (v$256[0]) { case 4: {return v$256[1][0];
 break; }case 0: {return v$256[1][0];
 break; }case 2: {return v$256[1][0];
 break; }case 3: {return v$256[1];
 break; }default: {return v$256[1][0];
} };
};
basics$PreElabTopdecGrammar$$1.info_on_strbind$297 = function(v$300){return v$300[1][0];
};
basics$PreElabTopdecGrammar$$1.info_on_sigexp$312 = function(v$315){switch (v$315[0]) { case 1: {return v$315[1][0];
 break; }case 2: {return v$315[1][0];
 break; }default: {return v$315[1][0];
} };
};
basics$PreElabTopdecGrammar$$1.info_on_sigdec$345 = function(v$348){return v$348[1][0];
};
basics$PreElabTopdecGrammar$$1.info_on_sigbind$356 = function(v$359){return v$359[1][0];
};
basics$PreElabTopdecGrammar$$1.info_on_spec$371 = function(v$374){switch (v$374[0]) { case 0: {return v$374[1][0];
 break; }case 1: {return v$374[1][0];
 break; }case 8: {return v$374[1][0];
 break; }case 10: {return v$374[1][0];
 break; }case 11: {return v$374[1][0];
 break; }case 7: {return v$374[1][0];
 break; }case 2: {return v$374[1][0];
 break; }case 6: {return v$374[1][0];
 break; }case 4: {return v$374[1][0];
 break; }case 3: {return v$374[1][0];
 break; }case 9: {return v$374[1];
 break; }default: {return v$374[1][0];
} };
};
basics$PreElabTopdecGrammar$$1.info_on_valdesc$475 = function(v$478){return v$478[1][0];
};
basics$PreElabTopdecGrammar$$1.info_on_typdesc$490 = function(v$493){return v$493[1][0];
};
basics$PreElabTopdecGrammar$$1.info_on_datdesc$505 = function(v$508){return v$508[1][0];
};
basics$PreElabTopdecGrammar$$1.info_on_condesc$522 = function(v$525){return v$525[1][0];
};
basics$PreElabTopdecGrammar$$1.info_on_exdesc$537 = function(v$540){return v$540[1][0];
};
basics$PreElabTopdecGrammar$$1.info_on_strdesc$552 = function(v$555){return v$555[1][0];
};
basics$PreElabTopdecGrammar$$1.info_on_fundec$567 = function(v$570){return v$570[1][0];
};
basics$PreElabTopdecGrammar$$1.info_on_funbind$578 = function(v$581){return v$581[1][0];
};
basics$PreElabTopdecGrammar$$1.info_on_topdec$597 = function(v$600){switch (v$600[0]) { case 0: {return v$600[1][0];
 break; }case 1: {return v$600[1][0];
 break; }default: {return v$600[1][0];
} };
};
var fix$1909 = {};
fix$1909.$map_strdec_info = function(f$696,strdec$699){switch (strdec$699[0]) { case 4: {var v$733 = strdec$699[1];
var v$734 = v$733[0];
var v$735 = v$733[1];
return [4,[f$696(v$734),basics$PreElabDecGrammar$$2.map_dec_info$799(f$696,v$735)]];
 break; }case 0: {var v$729 = strdec$699[1];
var v$730 = v$729[0];
var v$731 = v$729[1];
return [0,[f$696(v$730),fix$1909.$map_strbind_info(f$696,v$731)]];
 break; }case 2: {var v$724 = strdec$699[1];
var v$725 = v$724[0];
var v$726 = v$724[1];
var v$727 = v$724[2];
return [2,[f$696(v$725),fix$1909.$map_strdec_info(f$696,v$726),fix$1909.$map_strdec_info(f$696,v$727)]];
 break; }case 3: {var v$722 = strdec$699[1];
return [3,f$696(v$722)];
 break; }default: {var v$736 = strdec$699[1];
var v$737 = v$736[0];
var v$738 = v$736[1];
var v$739 = v$736[2];
return [1,[f$696(v$737),fix$1909.$map_strdec_info(f$696,v$738),fix$1909.$map_strdec_info(f$696,v$739)]];
} };
};
fix$1909.$map_strexp_info = function(f$635,strexp$638){switch (strexp$638[0]) { case 1: {var v$687 = strexp$638[1];
var v$688 = v$687[0];
var v$689 = v$687[1];
return [1,[f$635(v$688),fix$1909.$map_strdec_info(f$635,v$689)]];
 break; }case 3: {var v$683 = strexp$638[1];
var v$684 = v$683[0];
var v$685 = v$683[1];
return [3,[f$635(v$684),v$685]];
 break; }case 0: {var v$678 = strexp$638[1];
var v$679 = v$678[0];
var v$680 = v$678[1];
var v$681 = v$678[2];
return [0,[f$635(v$679),fix$1909.$map_strexp_info(f$635,v$680),v$681]];
 break; }case 2: {var v$673 = strexp$638[1];
var v$674 = v$673[0];
var v$675 = v$673[1];
var v$676 = v$673[2];
return [2,[f$635(v$674),fix$1909.$map_strexp_info(f$635,v$675),v$676]];
 break; }case 5: {var v$668 = strexp$638[1];
var v$669 = v$668[0];
var v$670 = v$668[1];
var v$671 = v$668[2];
return [5,[f$635(v$669),v$670,fix$1909.$map_strexp_info(f$635,v$671)]];
 break; }default: {var v$690 = strexp$638[1];
var v$691 = v$690[0];
var v$692 = v$690[1];
var v$693 = v$690[2];
return [4,[f$635(v$691),fix$1909.$map_strdec_info(f$635,v$692),fix$1909.$map_strexp_info(f$635,v$693)]];
} };
};
fix$1909.$map_strbind_info = function(f$742,strbind$745){var v$759 = strbind$745[1];
var v$760 = v$759[0];
var v$761 = v$759[1];
var v$762 = v$759[2];
var v$763 = v$759[3];
var t$2072;
var t$2071 = f$742(v$760);
var t$2070 = v$761;
var t$2069 = fix$1909.$map_strexp_info(f$742,v$762);
var t$2068;
switch (v$763[0]) { case 0: {var v$758 = v$763[1];
t$2068 = [0,fix$1909.$map_strbind_info(f$742,v$758)];
 break; }default: {t$2068 = [1];
} };
t$2072 = [t$2071,t$2070,t$2069,t$2068];
return [0,t$2072];
};
basics$PreElabTopdecGrammar$$1.map_strdec_info$631 = fix$1909.$map_strdec_info;
basics$PreElabTopdecGrammar$$1.map_strexp_info$632 = fix$1909.$map_strexp_info;
basics$PreElabTopdecGrammar$$1.map_strbind_info$630 = fix$1909.$map_strbind_info;
var fix$1910 = {};
fix$1910.$f = function(res$767,v$770){lab$f: while (true) {var v$791 = v$770[1];
var v$792 = v$791[2];
var v$793 = v$791[3];
var res$$776;
switch (v$792[0]) { case 1: {res$$776 = res$767;
 break; }default: {var v$782 = v$792[1];
res$$776 = (basis$List$.s$n$645([basics$PreElabDecGrammar$$2.getExplicitTyVarsTy$1769(v$782),res$767]));
} };
switch (v$793[0]) { case 1: {return res$$776;
 break; }default: {var v$788 = v$793[1];
var t$1911 = res$$776;
var t$1912 = v$788;
var res$767 = t$1911;
var v$770 = t$1912;
continue lab$f;
} };
};
};
var f$764 = fix$1910.$f;
basics$PreElabTopdecGrammar$$1.getExplicitTyVarsCondesc$794;
var v$1897 = null;
basics$PreElabTopdecGrammar$$1.getExplicitTyVarsCondesc$794 = (function(v$1898){return f$764(v$1897,v$1898);
});
basics$PreElabTopdecGrammar$$1.INDENT$795 = 3;
var fix$1913 = {};
fix$1913.$makeList = function(f$799,x$802){var t$2067;
var t$2066 = x$802;
var t$2065;
var v$807 = f$799(x$802);
switch (v$807[0]) { case 0: {var v$809 = v$807[1];
t$2065 = (fix$1913.$makeList(f$799,v$809));
 break; }default: {t$2065 = null;
} };
t$2067 = [t$2066,t$2065];
return t$2067;
};
basics$PreElabTopdecGrammar$$1.makeList$796 = fix$1913.$makeList;
basics$PreElabTopdecGrammar$$1.layoutExdesc$813 = function(exdesc$1348){var exdescs$1349;
var fix$1914 = {};
fix$1914.$makeList = function(x$1748){var t$1917;
var t$1916 = x$1748;
var t$1915;
var v$1749 = x$1748[1][3];
switch (v$1749[0]) { case 0: {var v$1750 = v$1749[1];
t$1915 = (fix$1914.$makeList(v$1750));
 break; }default: {t$1915 = null;
} };
t$1917 = [t$1916,t$1915];
return t$1917;
};
var makeList$1747 = fix$1914.$makeList;
exdescs$1349 = (makeList$1747(exdesc$1348));
var t$1927;
var t$1919;
var fix$1918 = {};
fix$1918.$map = function(v$1539){if (v$1539 == null) {return null;
} else {var v$1540 = v$1539;
var v$1541 = v$1540[0];
var v$1542 = v$1540[1];
var t$1926;
var t$1920;
var v$1753 = v$1541[1];
var v$1754 = v$1753[1];
var v$1755 = v$1753[2];
var t$1925;
var t$1924;
var t$1923;
var t$1922 = tools$PrettyPrint$.layoutAtom$176(function(v$1899){return syntax_objects$Ident$.pr_id$53(v$1899);
},v$1754);
var t$1921;
switch (v$1755[0]) { case 0: {var v$1756 = v$1755[1];
t$1921 = [basics$PreElabDecGrammar$$2.layoutTy$1860(v$1756),null];
 break; }default: {t$1921 = null;
} };
t$1923 = [t$1922,t$1921];
t$1924 = t$1923;
t$1925 = [t$1924,[2," of "],"",0,""];
t$1920 = [0,t$1925];
t$1926 = [t$1920,fix$1918.$map(v$1542)];
return t$1926;
};
};
var map$1538 = fix$1918.$map;
t$1919 = (map$1538(exdescs$1349));
t$1927 = [t$1919,[2," and "],"",0,""];
return [0,t$1927];
};
basics$PreElabTopdecGrammar$$1.layoutDatdesc$814 = function(datdesc$1259){var datdescs$1260;
var fix$1928 = {};
fix$1928.$makeList = function(x$1760){var t$1931;
var t$1930 = x$1760;
var t$1929;
var v$1761 = x$1760[1][4];
switch (v$1761[0]) { case 0: {var v$1762 = v$1761[1];
t$1929 = (fix$1928.$makeList(v$1762));
 break; }default: {t$1929 = null;
} };
t$1931 = [t$1930,t$1929];
return t$1931;
};
var makeList$1759 = fix$1928.$makeList;
datdescs$1260 = (makeList$1759(datdesc$1259));
var t$1962;
var t$1933;
var fix$1932 = {};
fix$1932.$map = function(v$1587){if (v$1587 == null) {return null;
} else {var v$1588 = v$1587;
var v$1589 = v$1588[0];
var v$1590 = v$1588[1];
var t$1961;
var t$1934;
var v$1772 = v$1589[1];
var v$1773 = v$1772[1];
var v$1774 = v$1772[2];
var v$1775 = v$1772[3];
var t$1960;
var t$1959;
var t$1958;
var t$1957;
var t$1956;
var t$1955;
var t$1954 = basis$List$.s$n$645;
var t$1953;
var t$1952;
var v$1776 = basics$PreElabDecGrammar$$2.layoutTyvarseq$1868(v$1773);
switch (v$1776[0]) { case 0: {t$1952 = [v$1776[1],null];
 break; }default: {t$1952 = null;
} };
t$1953 = [t$1952,[tools$PrettyPrint$.layoutAtom$176(function(v$1900){return syntax_objects$TyCon$.pr_TyCon$53(v$1900);
},v$1774),null]];
t$1955 = (t$1954(t$1953));
t$1956 = [t$1955,[0," "],"",0,""];
t$1957 = [0,t$1956];
var t$1951;
var t$1950;
var t$1936;
var condescs$1777;
var fix$1935 = {};
fix$1935.$makeList = function(x$1779){var t$1939;
var t$1938 = x$1779;
var t$1937;
var v$1780 = x$1779[1][3];
switch (v$1780[0]) { case 0: {var v$1781 = v$1780[1];
t$1937 = (fix$1935.$makeList(v$1781));
 break; }default: {t$1937 = null;
} };
t$1939 = [t$1938,t$1937];
return t$1939;
};
var makeList$1778 = fix$1935.$makeList;
condescs$1777 = (makeList$1778(v$1775));
var t$1949;
var t$1941;
var fix$1940 = {};
fix$1940.$map = function(v$1783){if (v$1783 == null) {return null;
} else {var v$1784 = v$1783;
var v$1785 = v$1784[0];
var v$1786 = v$1784[1];
var t$1948;
var t$1942;
var v$1787 = v$1785[1];
var v$1788 = v$1787[1];
var v$1789 = v$1787[2];
var t$1947;
var t$1946;
var t$1945;
var t$1944 = tools$PrettyPrint$.layoutAtom$176(function(v$1901){return syntax_objects$Ident$.pr_id$53(v$1901);
},v$1788);
var t$1943;
switch (v$1789[0]) { case 0: {var v$1790 = v$1789[1];
t$1943 = [basics$PreElabDecGrammar$$2.layoutTy$1860(v$1790),null];
 break; }default: {t$1943 = null;
} };
t$1945 = [t$1944,t$1943];
t$1946 = t$1945;
t$1947 = [t$1946,[2," of "],"",0,""];
t$1942 = [0,t$1947];
t$1948 = [t$1942,fix$1940.$map(v$1786)];
return t$1948;
};
};
var map$1782 = fix$1940.$map;
t$1941 = (map$1782(condescs$1777));
t$1949 = [t$1941,[2," | "],"",0,""];
t$1936 = [0,t$1949];
t$1950 = [t$1936,null];
t$1951 = t$1950;
t$1958 = [t$1957,t$1951];
t$1959 = t$1958;
t$1960 = [t$1959,[0," = "],"",0,""];
t$1934 = [0,t$1960];
t$1961 = [t$1934,fix$1932.$map(v$1590)];
return t$1961;
};
};
var map$1586 = fix$1932.$map;
t$1933 = (map$1586(datdescs$1260));
t$1962 = [t$1933,[2," and "],"",0,""];
return [0,t$1962];
};
basics$PreElabTopdecGrammar$$1.layoutTypdesc$815 = function(typdesc$1222){var typdescs$1223;
var fix$1963 = {};
fix$1963.$makeList = function(x$1794){var t$1966;
var t$1965 = x$1794;
var t$1964;
var v$1795 = x$1794[1][3];
switch (v$1795[0]) { case 0: {var v$1796 = v$1795[1];
t$1964 = (fix$1963.$makeList(v$1796));
 break; }default: {t$1964 = null;
} };
t$1966 = [t$1965,t$1964];
return t$1966;
};
var makeList$1793 = fix$1963.$makeList;
typdescs$1223 = (makeList$1793(typdesc$1222));
var t$1976;
var t$1968;
var fix$1967 = {};
fix$1967.$map = function(v$1616){if (v$1616 == null) {return null;
} else {var v$1617 = v$1616;
var v$1618 = v$1617[0];
var v$1619 = v$1617[1];
var t$1975;
var t$1969;
var v$1799 = v$1618[1];
var v$1800 = v$1799[1];
var v$1801 = v$1799[2];
var t$1974;
var t$1973;
var t$1972 = basis$List$.s$n$645;
var t$1971;
var t$1970;
var v$1802 = basics$PreElabDecGrammar$$2.layoutTyvarseq$1868(v$1800);
switch (v$1802[0]) { case 0: {t$1970 = [v$1802[1],null];
 break; }default: {t$1970 = null;
} };
t$1971 = [t$1970,[tools$PrettyPrint$.layoutAtom$176(function(v$1902){return syntax_objects$TyCon$.pr_TyCon$53(v$1902);
},v$1801),null]];
t$1973 = (t$1972(t$1971));
t$1974 = [t$1973,[0," "],"",0,""];
t$1969 = [0,t$1974];
t$1975 = [t$1969,fix$1967.$map(v$1619)];
return t$1975;
};
};
var map$1615 = fix$1967.$map;
t$1968 = (map$1615(typdescs$1223));
t$1976 = [t$1968,[2," and "],"",0,""];
return [0,t$1976];
};
basics$PreElabTopdecGrammar$$1.layoutValdesc$816 = function(valdesc$1192){var valdescs$1193;
var fix$1977 = {};
fix$1977.$makeList = function(x$1806){var t$1980;
var t$1979 = x$1806;
var t$1978;
var v$1807 = x$1806[1][3];
switch (v$1807[0]) { case 0: {var v$1808 = v$1807[1];
t$1978 = (fix$1977.$makeList(v$1808));
 break; }default: {t$1978 = null;
} };
t$1980 = [t$1979,t$1978];
return t$1980;
};
var makeList$1805 = fix$1977.$makeList;
valdescs$1193 = (makeList$1805(valdesc$1192));
var t$1985;
var t$1982;
var fix$1981 = {};
fix$1981.$map = function(v$1628){if (v$1628 == null) {return null;
} else {var v$1629 = v$1628;
var v$1630 = v$1629[0];
var v$1631 = v$1629[1];
var t$1984;
var t$1983;
var v$1811 = v$1630[1];
var v$1812 = v$1811[1];
var v$1813 = v$1811[2];
t$1983 = [0,[[tools$PrettyPrint$.layoutAtom$176(function(v$1903){return syntax_objects$Ident$.pr_id$53(v$1903);
},v$1812),[basics$PreElabDecGrammar$$2.layoutTy$1860(v$1813),null]],[2," : "],"",0,""]];
t$1984 = [t$1983,fix$1981.$map(v$1631)];
return t$1984;
};
};
var map$1627 = fix$1981.$map;
t$1982 = (map$1627(valdescs$1193));
t$1985 = [t$1982,[2," and "],"",0,""];
return [0,t$1985];
};
var fix$1986 = {};
fix$1986.$layoutSpec = function(spec$1053){switch (spec$1053[0]) { case 0: {var v$1180 = spec$1053[1];
var v$1181 = v$1180[1];
return [0,[[basics$PreElabTopdecGrammar$$1.layoutValdesc$816(v$1181),null],[1],"",3,"val "]];
 break; }case 1: {var v$1172 = spec$1053[1];
var v$1173 = v$1172[1];
return [0,[[basics$PreElabTopdecGrammar$$1.layoutTypdesc$815(v$1173),null],[1],"",3,"type "]];
 break; }case 8: {var v$1164 = spec$1053[1];
var v$1165 = v$1164[1];
return [0,[[basics$PreElabTopdecGrammar$$1.layoutTypdesc$815(v$1165),null],[1],"",3,"eqtype "]];
 break; }case 10: {var v$1156 = spec$1053[1];
var v$1157 = v$1156[1];
return [0,[[basics$PreElabTopdecGrammar$$1.layoutDatdesc$814(v$1157),null],[1],"",3,"datatype "]];
 break; }case 11: {var v$1146 = spec$1053[1];
var v$1147 = v$1146[0];
var v$1148 = v$1146[1];
var v$1149 = v$1146[2];
return basics$PreElabDecGrammar$$2.layout_datatype_replication$1870(v$1147,v$1148,v$1149);
 break; }case 7: {var v$1143 = spec$1053[1];
var v$1144 = v$1143[1];
return [0,[[basics$PreElabTopdecGrammar$$1.layoutExdesc$813(v$1144),null],[1],"",3,"exception "]];
 break; }case 2: {var v$1135 = spec$1053[1];
var v$1136 = v$1135[1];
return [0,[[fix$1986.$layoutStrdesc(v$1136),null],[1],"",3,"structure "]];
 break; }case 6: {var v$1127 = spec$1053[1];
var v$1128 = v$1127[1];
return [0,[[fix$1986.$layoutSigexp(v$1128),null],[1],"",8,"include "]];
 break; }case 4: {var v$1117 = spec$1053[1];
var v$1119 = v$1117[1];
var v$1120 = v$1117[2];
var st_longtycon_withinfo_list$1110;
var t$2060;
var v$1115 = [2," = "];
var t$2062;
var fix$2061 = {};
fix$2061.$map = function(v$1650){if (v$1650 == null) {return null;
} else {var v$1651 = v$1650;
var v$1652 = v$1651[0];
var v$1653 = v$1651[1];
var t$2064;
var t$2063;
var x$1832 = basics$PreElabDecGrammar$$2.strip_info$140(v$1652);
var v$1833 = syntax_objects$TyCon$.pr_LongTyCon$62(x$1832);
t$2063 = [1,v$1833];
t$2064 = [t$2063,fix$2061.$map(v$1653)];
return t$2064;
};
};
var map$1649 = fix$2061.$map;
t$2062 = (map$1649(v$1120));
t$2060 = [t$2062,v$1115,"",3," sharing type "];
st_longtycon_withinfo_list$1110 = [0,t$2060];
return tools$PrettyPrint$.layout_together$244([fix$1986.$layoutSpec(v$1119),[st_longtycon_withinfo_list$1110,null]],3);
 break; }case 3: {var v$1105 = spec$1053[1];
var v$1107 = v$1105[1];
var v$1108 = v$1105[2];
var st_longstrid_withinfo_list$1098;
var t$2055;
var v$1103 = [2," = "];
var t$2057;
var fix$2056 = {};
fix$2056.$map = function(v$1665){if (v$1665 == null) {return null;
} else {var v$1666 = v$1665;
var v$1667 = v$1666[0];
var v$1668 = v$1666[1];
var t$2059;
var t$2058;
var x$1841 = basics$PreElabDecGrammar$$2.strip_info$140(v$1667);
var v$1842 = syntax_objects$StrId$.pr_LongStrId$61(x$1841);
t$2058 = [1,v$1842];
t$2059 = [t$2058,fix$2056.$map(v$1668)];
return t$2059;
};
};
var map$1664 = fix$2056.$map;
t$2057 = (map$1664(v$1108));
t$2055 = [t$2057,v$1103,"",3," sharing "];
st_longstrid_withinfo_list$1098 = [0,t$2055];
return tools$PrettyPrint$.layout_together$244([fix$1986.$layoutSpec(v$1107),[st_longstrid_withinfo_list$1098,null]],3);
 break; }case 9: {return [1,""];
 break; }default: {var v$1187 = spec$1053[1];
var v$1188 = v$1187[1];
var v$1189 = v$1187[2];
return [0,[[fix$1986.$layoutSpec(v$1188),[fix$1986.$layoutSpec(v$1189),null]],[0,"; "],"",0,""]];
} };
};
fix$1986.$layoutSigexp = function(sigexp$965){switch (sigexp$965[0]) { case 1: {var v$988 = sigexp$965[1];
var v$989 = v$988[1];
return [0,[[fix$1986.$layoutSpec(v$989),null],[1]," end",3,"sig "]];
 break; }case 2: {var v$980 = sigexp$965[1];
var v$981 = v$980[1];
return tools$PrettyPrint$.layoutAtom$176(function(v$1905){return syntax_objects$SigId$.pr_SigId$51(v$1905);
},v$981);
 break; }default: {var v$1002 = sigexp$965[1];
var v$1004 = v$1002[1];
var v$1005 = v$1002[2];
var v$1006 = v$1002[3];
var v$1007 = v$1002[4];
var t$2054 = tools$PrettyPrint$.layout_together$244;
var t$2053;
var t$2052;
var t$2051 = fix$1986.$layoutSigexp(v$1004);
var t$2050;
var t$2049;
var t$2048;
var t$2047;
var t$2046;
var t$2045;
var t$2044;
var t$2043 = tools$PrettyPrint$.layout_together$244;
var t$2042;
var t$2041 = basis$List$.s$n$645;
var t$2040;
var t$2039;
var v$994 = basics$PreElabDecGrammar$$2.layoutTyvarseq$1868(v$1005);
switch (v$994[0]) { case 0: {t$2039 = [v$994[1],null];
 break; }default: {t$2039 = null;
} };
t$2040 = [t$2039,[[1,syntax_objects$TyCon$.pr_LongTyCon$62(v$1006)],null]];
t$2042 = (t$2041(t$2040));
t$2044 = (t$2043(t$2042,3));
t$2045 = [t$2044,[basics$PreElabDecGrammar$$2.layoutTy$1860(v$1007),null]];
t$2046 = t$2045;
t$2047 = [t$2046,[0," = "],"",0,"where type "];
t$2048 = [0,t$2047];
t$2049 = [t$2048,null];
t$2050 = t$2049;
t$2052 = [t$2051,t$2050];
t$2053 = t$2052;
return t$2054(t$2053,3);
} };
};
fix$1986.$layoutStrdesc = function(strdesc$1385){var strdescs$1386;
var fix$2030 = {};
fix$2030.$makeList = function(x$1817){var t$2033;
var t$2032 = x$1817;
var t$2031;
var v$1818 = x$1817[1][3];
switch (v$1818[0]) { case 0: {var v$1819 = v$1818[1];
t$2031 = (fix$2030.$makeList(v$1819));
 break; }default: {t$2031 = null;
} };
t$2033 = [t$2032,t$2031];
return t$2033;
};
var makeList$1816 = fix$2030.$makeList;
strdescs$1386 = (makeList$1816(strdesc$1385));
var t$2038;
var t$2035;
var fix$2034 = {};
fix$2034.$map = function(v$1639){if (v$1639 == null) {return null;
} else {var v$1640 = v$1639;
var v$1641 = v$1640[0];
var v$1642 = v$1640[1];
var t$2037;
var t$2036;
var v$1822 = v$1641[1];
var v$1823 = v$1822[1];
var v$1824 = v$1822[2];
t$2036 = [0,[[tools$PrettyPrint$.layoutAtom$176(function(v$1904){return syntax_objects$StrId$.pr_StrId$52(v$1904);
},v$1823),[fix$1986.$layoutSigexp(v$1824),null]],[2," : "],"",0,""]];
t$2037 = [t$2036,fix$2034.$map(v$1642)];
return t$2037;
};
};
var map$1638 = fix$2034.$map;
t$2035 = (map$1638(strdescs$1386));
t$2038 = [t$2035,[2," and "],"",0,""];
return [0,t$2038];
};
basics$PreElabTopdecGrammar$$1.layoutSpec$817 = fix$1986.$layoutSpec;
basics$PreElabTopdecGrammar$$1.layoutSigexp$820 = fix$1986.$layoutSigexp;
basics$PreElabTopdecGrammar$$1.layoutStrdesc$812 = fix$1986.$layoutStrdesc;
var fix$1987 = {};
fix$1987.$layoutStrdec = function(strdec$887){switch (strdec$887[0]) { case 4: {var v$923 = strdec$887[1];
var v$924 = v$923[1];
return basics$PreElabDecGrammar$$2.layoutDec$1871(v$924);
 break; }case 0: {var v$920 = strdec$887[1];
var v$921 = v$920[1];
return [0,[[fix$1987.$layoutStrbind(v$921),null],[1],"",3,"structure "]];
 break; }case 2: {var v$911 = strdec$887[1];
var v$912 = v$911[1];
var v$913 = v$911[2];
return [0,[[fix$1987.$layoutStrdec(v$912),[fix$1987.$layoutStrdec(v$913),null]],[2," in "]," end",3,"local "]];
 break; }case 3: {return [1,""];
 break; }default: {var v$930 = strdec$887[1];
var v$931 = v$930[1];
var v$932 = v$930[2];
return [0,[[fix$1987.$layoutStrdec(v$931),[fix$1987.$layoutStrdec(v$932),null]],[0,"; "],")",0,"("]];
} };
};
fix$1987.$layoutStrexp = function(strexp$826){switch (strexp$826[0]) { case 1: {var v$875 = strexp$826[1];
var v$876 = v$875[1];
return [0,[[fix$1987.$layoutStrdec(v$876),null],[1]," end",3,"struct "]];
 break; }case 3: {var v$867 = strexp$826[1];
var v$868 = v$867[1];
return tools$PrettyPrint$.layoutAtom$176(function(v$1906){return syntax_objects$StrId$.pr_LongStrId$61(v$1906);
},v$868);
 break; }case 0: {var v$863 = strexp$826[1];
var v$864 = v$863[1];
var v$865 = v$863[2];
return tools$PrettyPrint$.layout_together$244([fix$1987.$layoutStrexp(v$864),[[1,":"],[basics$PreElabTopdecGrammar$$1.layoutSigexp$820(v$865),null]]],3);
 break; }case 2: {var v$859 = strexp$826[1];
var v$860 = v$859[1];
var v$861 = v$859[2];
return tools$PrettyPrint$.layout_together$244([fix$1987.$layoutStrexp(v$860),[[1,":>"],[basics$PreElabTopdecGrammar$$1.layoutSigexp$820(v$861),null]]],3);
 break; }case 5: {var v$855 = strexp$826[1];
var v$856 = v$855[1];
var v$857 = v$855[2];
var t$2029;
var v$850 = (syntax_objects$FunId$.pr_FunId$51(v$856)) + "(";
t$2029 = [[fix$1987.$layoutStrexp(v$857),null],[1],")",3,v$850];
return [0,t$2029];
 break; }default: {var v$882 = strexp$826[1];
var v$883 = v$882[1];
var v$884 = v$882[2];
return [0,[[fix$1987.$layoutStrdec(v$883),[fix$1987.$layoutStrexp(v$884),null]],[2," in "]," end",3,"let "]];
} };
};
fix$1987.$layoutStrbind = function(strbind$935){var strbinds$936;
var fix$2020 = {};
fix$2020.$makeList = function(x$1846){var t$2023;
var t$2022 = x$1846;
var t$2021;
var v$1847 = x$1846[1][3];
switch (v$1847[0]) { case 0: {var v$1848 = v$1847[1];
t$2021 = (fix$2020.$makeList(v$1848));
 break; }default: {t$2021 = null;
} };
t$2023 = [t$2022,t$2021];
return t$2023;
};
var makeList$1845 = fix$2020.$makeList;
strbinds$936 = (makeList$1845(strbind$935));
var t$2028;
var t$2025;
var fix$2024 = {};
fix$2024.$map = function(v$1680){if (v$1680 == null) {return null;
} else {var v$1681 = v$1680;
var v$1682 = v$1681[0];
var v$1683 = v$1681[1];
var t$2027;
var t$2026;
var v$1851 = v$1682[1];
var v$1852 = v$1851[1];
var v$1853 = v$1851[2];
t$2026 = [0,[[[1,syntax_objects$StrId$.pr_StrId$52(v$1852)],[fix$1987.$layoutStrexp(v$1853),null]],[0," = "],"",0,""]];
t$2027 = [t$2026,fix$2024.$map(v$1683)];
return t$2027;
};
};
var map$1679 = fix$2024.$map;
t$2025 = (map$1679(strbinds$936));
t$2028 = [t$2025,[2," and "],"",0,""];
return [0,t$2028];
};
basics$PreElabTopdecGrammar$$1.layoutStrdec$822 = fix$1987.$layoutStrdec;
basics$PreElabTopdecGrammar$$1.layoutStrexp$823 = fix$1987.$layoutStrexp;
basics$PreElabTopdecGrammar$$1.layoutStrbind$821 = fix$1987.$layoutStrbind;
basics$PreElabTopdecGrammar$$1.layoutFunbind$810 = function(funbind$1428){var funbinds$1429;
var fix$1988 = {};
fix$1988.$makeList = function(x$1857){var t$1991;
var t$1990 = x$1857;
var t$1989;
var v$1858 = x$1857[1][5];
switch (v$1858[0]) { case 0: {var v$1859 = v$1858[1];
t$1989 = (fix$1988.$makeList(v$1859));
 break; }default: {t$1989 = null;
} };
t$1991 = [t$1990,t$1989];
return t$1991;
};
var makeList$1856 = fix$1988.$makeList;
funbinds$1429 = (makeList$1856(funbind$1428));
var t$2001;
var t$1993;
var fix$1992 = {};
fix$1992.$map = function(v$1693){if (v$1693 == null) {return null;
} else {var v$1694 = v$1693;
var v$1695 = v$1694[0];
var v$1696 = v$1694[1];
var t$2000;
var t$1994;
var v$1862 = v$1695[1];
var v$1863 = v$1862[1];
var v$1864 = v$1862[2];
var v$1865 = v$1862[3];
var v$1866 = v$1862[4];
var t$1999;
var t$1998;
var t$1997;
var t$1996;
var t$1995;
var v$1867 = (syntax_objects$FunId$.pr_FunId$51(v$1863)) + "(";
t$1995 = [[tools$PrettyPrint$.layoutAtom$176(function(v$1907){return syntax_objects$StrId$.pr_StrId$52(v$1907);
},v$1864),[basics$PreElabTopdecGrammar$$1.layoutSigexp$820(v$1865),null]],[2," : "],")",3,v$1867];
t$1996 = [0,t$1995];
t$1997 = [t$1996,[basics$PreElabTopdecGrammar$$1.layoutStrexp$823(v$1866),null]];
t$1998 = t$1997;
t$1999 = [t$1998,[0," = "],"",0,""];
t$1994 = [0,t$1999];
t$2000 = [t$1994,fix$1992.$map(v$1696)];
return t$2000;
};
};
var map$1692 = fix$1992.$map;
t$1993 = (map$1692(funbinds$1429));
t$2001 = [t$1993,[2," and "],"",0,""];
return [0,t$2001];
};
basics$PreElabTopdecGrammar$$1.layoutFundec$811 = function(v$1415){var v$1424 = v$1415[1];
var v$1425 = v$1424[1];
return [0,[[basics$PreElabTopdecGrammar$$1.layoutFunbind$810(v$1425),null],[1],"",3,"functor "]];
};
basics$PreElabTopdecGrammar$$1.layoutSigbind$818 = function(sigbind$1023){var sigbinds$1024;
var fix$2002 = {};
fix$2002.$makeList = function(x$1871){var t$2005;
var t$2004 = x$1871;
var t$2003;
var v$1872 = x$1871[1][3];
switch (v$1872[0]) { case 0: {var v$1873 = v$1872[1];
t$2003 = (fix$2002.$makeList(v$1873));
 break; }default: {t$2003 = null;
} };
t$2005 = [t$2004,t$2003];
return t$2005;
};
var makeList$1870 = fix$2002.$makeList;
sigbinds$1024 = (makeList$1870(sigbind$1023));
var t$2010;
var t$2007;
var fix$2006 = {};
fix$2006.$map = function(v$1708){if (v$1708 == null) {return null;
} else {var v$1709 = v$1708;
var v$1710 = v$1709[0];
var v$1711 = v$1709[1];
var t$2009;
var t$2008;
var v$1876 = v$1710[1];
var v$1877 = v$1876[1];
var v$1878 = v$1876[2];
t$2008 = [0,[[tools$PrettyPrint$.layoutAtom$176(function(v$1908){return syntax_objects$SigId$.pr_SigId$51(v$1908);
},v$1877),[basics$PreElabTopdecGrammar$$1.layoutSigexp$820(v$1878),null]],[0," = "],"",0,""]];
t$2009 = [t$2008,fix$2006.$map(v$1711)];
return t$2009;
};
};
var map$1707 = fix$2006.$map;
t$2007 = (map$1707(sigbinds$1024));
t$2010 = [t$2007,[2," and "],"",0,""];
return [0,t$2010];
};
basics$PreElabTopdecGrammar$$1.layoutSigdec$819 = function(v$1010){var v$1019 = v$1010[1];
var v$1020 = v$1019[1];
return [0,[[basics$PreElabTopdecGrammar$$1.layoutSigbind$818(v$1020),null],[1],"",3,"signature "]];
};
basics$PreElabTopdecGrammar$$1.layoutTopdec$1466 = function(topdec$1469){var topdecs$1470;
var fix$2011 = {};
fix$2011.$makeList = function(x$1882){var t$2014;
var t$2013 = x$1882;
var t$2012;
var v$1883;
switch (x$1882[0]) { case 0: {v$1883 = x$1882[1][2];
 break; }case 1: {v$1883 = x$1882[1][2];
 break; }default: {v$1883 = x$1882[1][2];
} };
switch (v$1883[0]) { case 0: {var v$1884 = v$1883[1];
t$2012 = (fix$2011.$makeList(v$1884));
 break; }default: {t$2012 = null;
} };
t$2014 = [t$2013,t$2012];
return t$2014;
};
var makeList$1881 = fix$2011.$makeList;
topdecs$1470 = (makeList$1881(topdec$1469));
var t$2015;
var v$1508 = [0,"; "];
var t$2017;
var fix$2016 = {};
fix$2016.$map = function(v$1719){if (v$1719 == null) {return null;
} else {var v$1720 = v$1719;
var v$1721 = v$1720[0];
var v$1722 = v$1720[1];
var t$2019;
var t$2018;
switch (v$1721[0]) { case 0: {var v$1887 = v$1721[1];
var v$1888 = v$1887[1];
t$2018 = (basics$PreElabTopdecGrammar$$1.layoutStrdec$822(v$1888));
 break; }case 1: {var v$1889 = v$1721[1];
var v$1890 = v$1889[1];
var v$1891 = v$1890[1];
var v$1892 = v$1891[1];
t$2018 = [0,[[basics$PreElabTopdecGrammar$$1.layoutSigbind$818(v$1892),null],[1],"",3,"signature "]];
 break; }default: {var v$1893 = v$1721[1];
var v$1894 = v$1893[1];
var v$1895 = v$1894[1];
var v$1896 = v$1895[1];
t$2018 = [0,[[basics$PreElabTopdecGrammar$$1.layoutFunbind$810(v$1896),null],[1],"",3,"functor "]];
} };
t$2019 = [t$2018,fix$2016.$map(v$1722)];
return t$2019;
};
};
var map$1718 = fix$2016.$map;
t$2017 = (map$1718(topdecs$1470));
t$2015 = [t$2017,v$1508,"",0,""];
return [0,t$2015];
};
return 0;
})();
