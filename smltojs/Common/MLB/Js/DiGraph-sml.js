if ((typeof(tools$DiGraph$)) == "undefined") {tools$DiGraph$ = {};
};
(function(){tools$DiGraph$.eq_graphnode$1154 = function(v$1158,v$1155){var v$1156 = v$1155[0];
var v$1157 = v$1155[1];
switch (v$1157[0]) { case 0: {var v$1159 = v$1156[1];
var v$1160 = v$1157[1];
if (v$1159[0] == v$1160[0]) {if (v$1158([v$1159[1],v$1160[1]])) {var t$1992;
var fix$1989 = {};
fix$1989.$eq_list = function(v$1169,v$1170){lab$eq_list: while (true) {if (v$1169 == null) {return (v$1170 == null)?true:false;
} else {if (v$1170 == null) {return false;
} else {var v$1171 = v$1169;
var v$1172 = v$1170;
if (v$1171[0] == v$1172[0]) {var t$1990 = v$1171[1];
var t$1991 = v$1172[1];
var v$1169 = t$1990;
var v$1170 = t$1991;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$1167 = fix$1989.$eq_list;
t$1992 = (eq_list$1167(v$1159[2],v$1160[2]));
return t$1992?(v$1159[3] == v$1160[3]):false;
} else {return false;
};
} else {return false;
};
 break; }default: {return false;
} };
};
tools$DiGraph$.mk_graph$74 = function(v$76){return null;
};
tools$DiGraph$.add_node_to_graph$77 = function(v$78){return v$78;
};
tools$DiGraph$.mk_node$79 = function(info$82){var t$1995 = tools$UnionFindPoly$.mkElement$126;
var t$1994;
var t$1993;
var v$84 = [false];
t$1993 = [[0],info$82,null,v$84];
t$1994 = [0,t$1993];
return t$1995(t$1994);
};
tools$DiGraph$.mk_edge$87 = function(v$107,v$108){var v$97 = tools$UnionFindPoly$.find_info$77(v$107);
var v$102 = v$97[1];
var v$103 = v$102[1];
var v$104 = v$102[2];
var v$105 = v$102[3];
var v$106 = v$102[0];
return tools$UnionFindPoly$.set_info$103(v$107,[0,[v$106,v$103,[v$108,v$104],v$105]]);
};
tools$DiGraph$.add_edges$109 = function(v$129,v$130){var v$119 = tools$UnionFindPoly$.find_info$77(v$129);
var v$124 = v$119[1];
var v$125 = v$124[1];
var v$126 = v$124[2];
var v$127 = v$124[3];
var v$128 = v$124[0];
return tools$UnionFindPoly$.set_info$103(v$129,[0,[v$128,v$125,basis$List$.s$n$645([v$130,v$126]),v$127]]);
};
tools$DiGraph$.eq_nodes$131 = function(v$136,v$137){return tools$UnionFindPoly$.eq_Elements$119(v$136,v$137);
};
tools$DiGraph$.union$138 = function(info_combine$141,v$145){var v$172 = v$145[0];
var v$173 = v$145[1];
return tools$UnionFindPoly$.union$130(function(v$1176){var v$1177 = v$1176[0];
var v$1178 = v$1177[1];
var v$1179 = v$1178[1];
var v$1180 = v$1178[2];
var v$1181 = v$1176[1];
var v$1182 = v$1181[1];
var v$1183 = v$1182[1];
var v$1184 = v$1182[2];
var v$1185 = v$1182[0];
var v$1186 = v$1182[3];
return [0,[v$1185,info_combine$141([v$1179,v$1183]),basis$List$.s$n$645([v$1180,v$1184]),v$1186]];
},[v$172,v$173]);
};
tools$DiGraph$.union_left$174 = function(info_combine$177,v$181){var v$208 = v$181[0];
var v$209 = v$181[1];
return tools$UnionFindPoly$.union$130(function(v$1187){var v$1188 = v$1187[0];
var v$1189 = v$1188[1];
var v$1190 = v$1189[1];
var v$1191 = v$1189[2];
var v$1192 = v$1189[3];
var v$1193 = v$1189[0];
var v$1194 = v$1187[1];
var v$1195 = v$1194[1];
var v$1196 = v$1195[1];
return [0,[v$1193,info_combine$177([v$1190,v$1196]),v$1191,v$1192]];
},[v$208,v$209]);
};
tools$DiGraph$.find$210 = function(n$213){return tools$UnionFindPoly$.find$57(n$213);
};
tools$DiGraph$.find_info$214 = function(n$217){return (tools$UnionFindPoly$.find_info$77(n$217))[1][1];
};
tools$DiGraph$.find_rep_and_info$223 = function(n$226){var v$230 = tools$UnionFindPoly$.find_rep_and_info$90(n$226);
return [v$230[0],v$230[1][1][1]];
};
tools$DiGraph$.union_graph$235 = function(v$238,v$241){if (v$241 == null) {return tools$Crash$.impossible$50("DiGraph.union_graph");
} else {var v$254 = v$241;
var v$255 = v$254[0];
var v$256 = v$254[1];
var n$1197;
var fix$1996 = {};
fix$1996.$foldl = function(v$1200,v$1201){lab$foldl: while (true) {if (v$1201 == null) {return v$1200;
} else {var v$1202 = v$1201;
var v$1203 = v$1202[0];
var v$1204 = v$1202[1];
var t$1997;
var v$1980 = [v$1203,v$1200];
t$1997 = (tools$DiGraph$.union$138(v$238,v$1980));
var t$1998 = t$1997;
var t$1999 = v$1204;
var v$1200 = t$1998;
var v$1201 = t$1999;
continue lab$foldl;
};
};
};
var foldl$1199 = fix$1996.$foldl;
n$1197 = (foldl$1199(v$255,v$256));
return tools$UnionFindPoly$.find$57(n$1197);
};
};
tools$DiGraph$.set_info$258 = function(n$261,info$$264){var v$270 = tools$UnionFindPoly$.find_info$77(n$261);
var v$275 = v$270[1];
var v$277 = v$275[2];
var v$278 = v$275[3];
var v$279 = v$275[0];
return tools$UnionFindPoly$.set_info$103(n$261,[0,[v$279,info$$264,v$277,v$278]]);
};
tools$DiGraph$.out_of_node$280 = function(n$283){return (tools$UnionFindPoly$.find_info$77(n$283))[1][2];
};
tools$DiGraph$.find_visited$311 = function(n$314){return (tools$UnionFindPoly$.find_info$77(n$314))[1][3];
};
tools$DiGraph$.unvisit$377 = function(g$380){var fix$2000 = {};
fix$2000.$app = function(v$1213){lab$app: while (true) {if (v$1213 == null) {return 0;
} else {var v$1214 = v$1213;
var v$1215 = v$1214[0];
var v$1216 = v$1214[1];
((tools$UnionFindPoly$.find_info$77(v$1215))[1][3][0] = false,0);
var t$2001 = v$1216;
var v$1213 = t$2001;
continue lab$app;
};
};
};
var app$1212 = fix$2000.$app;
return app$1212(g$380);
};
tools$DiGraph$.union_without_edge_duplication$391 = function(info_combine$394,visit_children$397,v$401){var v$464 = v$401[0];
var v$465 = v$401[1];
var visited_nodes$402 = [null];
var fix$2002 = {};
fix$2002.$onto = function(v$415,v$1959){lab$onto: while (true) {if (v$415 == null) {return v$1959;
} else {var v$431 = v$415;
var v$432 = v$431[0];
var v$433 = v$431[1];
var t$2004 = v$433;
var t$2003;
var n$417 = tools$UnionFindPoly$.find$57(v$432);
var r$418 = (tools$UnionFindPoly$.find_info$77(n$417))[1][3];
if (r$418[0]) {t$2003 = v$1959;
} else {(r$418[0] = true,0);
(visited_nodes$402[0] = [n$417,visited_nodes$402[0]],0);
t$2003 = ((visit_children$397((tools$UnionFindPoly$.find_info$77(n$417))[1][1]))?(fix$2002.$onto((tools$UnionFindPoly$.find_info$77(n$417))[1][2],v$1959)):[n$417,v$1959]);
};
var t$2005 = t$2004;
var t$2006 = t$2003;
var v$415 = t$2005;
var v$1959 = t$2006;
continue lab$onto;
};
};
};
var onto$403 = fix$2002.$onto;
return tools$UnionFindPoly$.union$130(function(v$1271){var v$1272 = v$1271[0];
var v$1273 = v$1272[1];
var v$1274 = v$1273[1];
var v$1275 = v$1273[2];
var v$1276 = v$1271[1];
var v$1277 = v$1276[1];
var v$1278 = v$1277[1];
var v$1279 = v$1277[2];
var v$1280 = v$1277[0];
var v$1281 = v$1277[3];
var t$2012;
var t$2011 = v$1280;
var t$2010 = info_combine$394([v$1274,v$1278]);
var t$2007;
var result$1282 = onto$403(v$1275,onto$403(v$1279,null));
var g$1283 = visited_nodes$402[0];
var fix$2008 = {};
fix$2008.$app = function(v$1285){lab$app: while (true) {if (v$1285 == null) {return 0;
} else {var v$1286 = v$1285;
var v$1287 = v$1286[0];
var v$1288 = v$1286[1];
((tools$UnionFindPoly$.find_info$77(v$1287))[1][3][0] = false,0);
var t$2009 = v$1288;
var v$1285 = t$2009;
continue lab$app;
};
};
};
var app$1284 = fix$2008.$app;
app$1284(g$1283);
t$2007 = result$1282;
t$2012 = [t$2011,t$2010,t$2007,v$1281];
return [0,t$2012];
},[v$464,v$465]);
};
tools$DiGraph$.layout_node$466 = function(layout_info$469,n$472){var v$475 = tools$UnionFindPoly$.find_info$77(n$472);
var v$476 = v$475[1];
var v$477 = v$476[1];
return layout_info$469(v$477);
};
var pu_boolref$500 = pickle$pickle$.refOneGen$1273(pickle$pickle$.bool$723);
var pu_intref$501 = pickle$pickle$.refOneGen$1273(pickle$pickle$.int$720);
tools$DiGraph$.pu$502 = function(v$564,v$563,v$565){return function(pu_info$510){var dummy$511;
var t$2013;
var v$513 = [false];
t$2013 = [[0],v$564,null,v$513];
dummy$511 = [0,t$2013];
var pu_node$522 = (pickle$pickle$.cache$2475("DiGraph.node"))(function(x$1319){var x$1982 = tools$UnionFindPoly$.pu$185(dummy$511,x$1319);
return v$565(pickle$pickle$.nameGen$2615("DiGraph.node",x$1982));
});
var pu_graph$523 = (pickle$pickle$.cache$2475("DiGraph.graph"))(function(x$1327){var x$1986 = pu_node$522(x$1327);
var v$1987 = pickle$pickle$.listGen$2100(x$1986);
return pickle$pickle$.nameGen$2615("DiGraph.graph",v$1987);
});
var pu_graphnode$524 = pickle$pickle$.dataGen$1479(["DiGraph.graphnode",function(v$1335){return 0;
},[function(pu$1336){return pickle$pickle$.maybeNewHash$2056(function(v$1337){var v$1338 = v$1337[1];
var v$1339 = v$1338[1];
return v$563(v$1339);
},pickle$pickle$.con1$2005(function(v$1340){return [0,[v$1340[2],v$1340[0],v$1340[3],v$1340[1]]];
},function(v$1341){var v$1342 = v$1341[1];
return [v$1342[1],v$1342[3],v$1342[0],v$1342[2]];
},pickle$pickle$.tup4Gen0$2368(pu_info$510,pu_boolref$500,pu_intref$501,pu_graph$523(pu$1336))));
},null]]);
return [pu_node$522(pu_graphnode$524),pu_graph$523(pu_graphnode$524)];
};
};
tools$DiGraph$.nodes$566 = function(g$569){return g$569;
};
var fix$2014 = {};
fix$2014.$visit_all = function(n$574){var n$575 = tools$UnionFindPoly$.find$57(n$574);
var r$576 = (tools$UnionFindPoly$.find_info$77(n$575))[1][3];
if (r$576[0]) {return 0;
} else {(r$576[0] = true,0);
return fix$2014.$visit_all$((tools$UnionFindPoly$.find_info$77(n$575))[1][2]);
};
};
fix$2014.$visit_all$ = function(v$585){if (v$585 == null) {return 0;
} else {var v$594 = v$585;
var v$595 = v$594[0];
var v$596 = v$594[1];
fix$2014.$visit_all(v$595);
return fix$2014.$visit_all$(v$596);
};
};
tools$DiGraph$.visit_all$571 = fix$2014.$visit_all;
var visit_all$$570 = fix$2014.$visit_all$;
var fix$2015 = {};
fix$2015.$unvisit_all = function(n$601){var n$602 = tools$UnionFindPoly$.find$57(n$601);
var r$603 = (tools$UnionFindPoly$.find_info$77(n$602))[1][3];
if (r$603[0]) {(r$603[0] = false,0);
return fix$2015.$unvisit_all$((tools$UnionFindPoly$.find_info$77(n$602))[1][2]);
} else {return 0;
};
};
fix$2015.$unvisit_all$ = function(v$612){if (v$612 == null) {return 0;
} else {var v$621 = v$612;
var v$622 = v$621[0];
var v$623 = v$621[1];
fix$2015.$unvisit_all(v$622);
return fix$2015.$unvisit_all$(v$623);
};
};
tools$DiGraph$.unvisit_all$598 = fix$2015.$unvisit_all;
var unvisit_all$$597 = fix$2015.$unvisit_all$;
tools$DiGraph$.bottom_up_dfs$624 = function(g$627){var fix$2016 = {};
fix$2016.$search = function(v$642,v$643){var n$634 = tools$UnionFindPoly$.find$57(v$642);
var r$635 = (tools$UnionFindPoly$.find_info$77(n$634))[1][3];
if (r$635[0]) {return v$643;
} else {(r$635[0] = true,0);
return fix$2016.$search$((tools$UnionFindPoly$.find_info$77(n$634))[1][2],[n$634,v$643]);
};
};
fix$2016.$search$ = function(v$655,v$1960){if (v$655 == null) {return v$1960;
} else {var v$657 = v$655;
var v$658 = v$657[0];
var v$659 = v$657[1];
return fix$2016.$search$(v$659,fix$2016.$search(v$658,v$1960));
};
};
var search$629 = fix$2016.$search;
var search$$628 = fix$2016.$search$;
var result$661 = search$$628(g$627,null);
var fix$2017 = {};
fix$2017.$app = function(v$1360){lab$app: while (true) {if (v$1360 == null) {return 0;
} else {var v$1361 = v$1360;
var v$1362 = v$1361[0];
var v$1363 = v$1361[1];
((tools$UnionFindPoly$.find_info$77(v$1362))[1][3][0] = false,0);
var t$2018 = v$1363;
var v$1360 = t$2018;
continue lab$app;
};
};
};
var app$1359 = fix$2017.$app;
app$1359(result$661);
return result$661;
};
tools$DiGraph$.dfs$664 = function(g$667){return basis$List$.rev$248(tools$DiGraph$.bottom_up_dfs$624(g$667));
};
tools$DiGraph$.subgraph$668 = function(l$671){return basis$List$.rev$248(tools$DiGraph$.bottom_up_dfs$624(l$671));
};
tools$DiGraph$.topsort$672 = function(l$675){var fix$2019 = {};
fix$2019.$search$ = function(v$1961,v$689){if (v$689 == null) {return v$1961;
} else {var v$692 = v$689;
var v$693 = v$692[0];
var v$694 = v$692[1];
return fix$2019.$search$(fix$2019.$search(v$693,v$1961),v$694);
};
};
fix$2019.$search = function(v$707,v$708){var n$699 = tools$UnionFindPoly$.find$57(v$707);
var r$700 = (tools$UnionFindPoly$.find_info$77(n$699))[1][3];
if (r$700[0]) {return v$708;
} else {(r$700[0] = true,0);
return [n$699,fix$2019.$search$(v$708,(tools$UnionFindPoly$.find_info$77(n$699))[1][2])];
};
};
var search$$677 = fix$2019.$search$;
var search$676 = fix$2019.$search;
var result$709 = search$$677(null,l$675);
var fix$2020 = {};
fix$2020.$app = function(v$1377){lab$app: while (true) {if (v$1377 == null) {return 0;
} else {var v$1378 = v$1377;
var v$1379 = v$1378[0];
var v$1380 = v$1378[1];
((tools$UnionFindPoly$.find_info$77(v$1379))[1][3][0] = false,0);
var t$2021 = v$1380;
var v$1377 = t$2021;
continue lab$app;
};
};
};
var app$1376 = fix$2020.$app;
app$1376(result$709);
return result$709;
};
var en$EmptyStack$712 = new String("EmptyStack");
var exn$EmptyStack$712 = [en$EmptyStack$712];
tools$DiGraph$.scc$750 = function(layout_info$753,g$756){var scc_list$757 = [null];
var fix$2022 = {};
fix$2022.$min_list = function(v$1962,v$770){lab$min_list: while (true) {if (v$770 == null) {return v$1962;
} else {var v$777 = v$770;
var v$778 = v$777[0];
var v$779 = v$777[1];
if (v$778 < v$1962) {var t$2023 = v$778;
var t$2024 = v$779;
var v$1962 = t$2023;
var v$770 = t$2024;
continue lab$min_list;
} else {var t$2025 = v$1962;
var t$2026 = v$779;
var v$1962 = t$2025;
var v$770 = t$2026;
continue lab$min_list;
};
};
};
};
var min_list$758 = fix$2022.$min_list;
var count$791 = [1];
var stack$796 = [null];
var fix$2027 = {};
fix$2027.$lowlink = function(n$800){var n$801 = tools$UnionFindPoly$.find$57(n$800);
((tools$UnionFindPoly$.find_info$77(n$801))[1][3][0] = true,0);
((tools$UnionFindPoly$.find_info$77(n$801))[1][0][0] = count$791[0],0);
(count$791[0] = (SmlPrims.chk_ovf_i32(count$791[0] + 1)),0);
(stack$796[0] = [n$801,stack$796[0]],0);
var low$810 = (tools$UnionFindPoly$.find_info$77(n$801))[1][0][0];
var low$811;
var t$2039 = min_list$758;
var t$2038 = low$810;
var t$2034;
var l$1417 = (tools$UnionFindPoly$.find_info$77(n$801))[1][2];
var fix$2035 = {};
fix$2035.$map = function(v$1419){if (v$1419 == null) {return null;
} else {var v$1420 = v$1419;
var v$1421 = v$1420[0];
var v$1422 = v$1420[1];
var t$2037;
var t$2036;
var w$1913 = tools$UnionFindPoly$.find$57(v$1421);
if ((tools$UnionFindPoly$.find_info$77(w$1913))[1][3][0]) {var v$1914 = (tools$UnionFindPoly$.find_info$77(w$1913))[1][0][0];
t$2036 = ((v$1914 == 0)?low$810:((low$810 < v$1914)?low$810:v$1914));
} else {t$2036 = (fix$2027.$lowlink(w$1913));
};
t$2037 = [t$2036,fix$2035.$map(v$1422)];
return t$2037;
};
};
var map$1418 = fix$2035.$map;
t$2034 = (map$1418(l$1417));
low$811 = (t$2039(t$2038,t$2034));
var fix$2040 = {};
fix$2040.$loop = function(v$822){var x$823;
var res$1436;
try {res$1436 = (basis$List$.hd$635(stack$796[0]));
} catch(v$2041) {res$1436 = ((function(Hd$1438){throw exn$EmptyStack$712;
})(v$2041));
};
try {(stack$796[0] = (basis$List$.tl$636(stack$796[0])),0);
0;
} catch(v$2042) {(function(Tl$1441){throw exn$EmptyStack$712;
})(v$2042);
};
x$823 = res$1436;
((tools$UnionFindPoly$.find_info$77(x$823))[1][0][0] = 0,0);
(scc_list$757[0] = [[x$823,basis$List$.hd$635(scc_list$757[0])],basis$List$.tl$636(scc_list$757[0])],0);
if (tools$UnionFindPoly$.eq_Elements$119(x$823,n$801)) {return 0;
} else {return fix$2040.$loop(0);
};
};
var loop$820 = fix$2040.$loop;
if (low$811 == (tools$UnionFindPoly$.find_info$77(n$801))[1][0][0]) {(scc_list$757[0] = [null,scc_list$757[0]],0);
loop$820(0);
} else {0;
};
return low$811;
};
var lowlink$797 = fix$2027.$lowlink;
var fix$2028 = {};
fix$2028.$app = function(v$1456){lab$app: while (true) {if (v$1456 == null) {return 0;
} else {var v$1457 = v$1456;
var v$1458 = v$1457[0];
var v$1459 = v$1457[1];
((tools$UnionFindPoly$.find_info$77(v$1458))[1][0][0] = 0,0);
var t$2029 = v$1459;
var v$1456 = t$2029;
continue lab$app;
};
};
};
var app$1455 = fix$2028.$app;
app$1455(g$756);
var fix$2030 = {};
fix$2030.$app = function(v$1472){lab$app: while (true) {if (v$1472 == null) {return 0;
} else {var v$1473 = v$1472;
var v$1474 = v$1473[0];
var v$1475 = v$1473[1];
var n$1480 = tools$UnionFindPoly$.find$57(v$1474);
if ((tools$UnionFindPoly$.find_info$77(n$1480))[1][3][0]) {0;
} else {lowlink$797(n$1480);
0;
};
var t$2031 = v$1475;
var v$1472 = t$2031;
continue lab$app;
};
};
};
var app$1471 = fix$2030.$app;
app$1471(g$756);
var fix$2032 = {};
fix$2032.$app = function(v$1485){lab$app: while (true) {if (v$1485 == null) {return 0;
} else {var v$1486 = v$1485;
var v$1487 = v$1486[0];
var v$1488 = v$1486[1];
((tools$UnionFindPoly$.find_info$77(v$1487))[1][3][0] = false,0);
var t$2033 = v$1488;
var v$1485 = t$2033;
continue lab$app;
};
};
};
var app$1484 = fix$2032.$app;
app$1484(g$756);
return basis$List$.rev$641(scc_list$757[0]);
};
tools$DiGraph$.bottom_up_eval$856 = function(f$859,g$862){var fix$2043 = {};
fix$2043.$search = function(n$866){var n$867 = tools$UnionFindPoly$.find$57(n$866);
var r$868 = (tools$UnionFindPoly$.find_info$77(n$867))[1][3];
if (r$868[0]) {return 0;
} else {var ns$873 = (tools$UnionFindPoly$.find_info$77(n$867))[1][2];
(r$868[0] = true,0);
var t$2054 = f$859;
var t$2053;
var t$2052 = (tools$UnionFindPoly$.find_info$77(n$867))[1][1];
var t$2049;
var fix$2048 = {};
fix$2048.$map = function(v$1504){if (v$1504 == null) {return null;
} else {var v$1505 = v$1504;
var v$1506 = v$1505[0];
var v$1507 = v$1505[1];
var t$2051;
var t$2050;
fix$2043.$search(v$1506);
t$2050 = (tools$UnionFindPoly$.find_info$77(v$1506))[1][1];
t$2051 = [t$2050,fix$2048.$map(v$1507)];
return t$2051;
};
};
var map$1503 = fix$2048.$map;
t$2049 = (map$1503(ns$873));
t$2053 = [t$2052,t$2049];
return t$2054(t$2053);
};
};
var search$863 = fix$2043.$search;
var fix$2044 = {};
fix$2044.$app = function(v$1511){lab$app: while (true) {if (v$1511 == null) {return 0;
} else {var v$1512 = v$1511;
var v$1513 = v$1512[0];
var v$1514 = v$1512[1];
search$863(v$1513);
var t$2045 = v$1514;
var v$1511 = t$2045;
continue lab$app;
};
};
};
var app$1510 = fix$2044.$app;
app$1510(g$862);
var fix$2046 = {};
fix$2046.$app = function(v$1517){lab$app: while (true) {if (v$1517 == null) {return 0;
} else {var v$1518 = v$1517;
var v$1519 = v$1518[0];
var v$1520 = v$1518[1];
((tools$UnionFindPoly$.find_info$77(v$1519))[1][3][0] = false,0);
var t$2047 = v$1520;
var v$1517 = t$2047;
continue lab$app;
};
};
};
var app$1516 = fix$2046.$app;
return app$1516(g$862);
};
tools$DiGraph$.quotient$922 = function(layout_info$925,info_combine$928,g$931){var g$$932;
var l$1605 = tools$DiGraph$.scc$750(layout_info$925,g$931);
var fix$2055 = {};
fix$2055.$map = function(v$1607){if (v$1607 == null) {return null;
} else {var v$1608 = v$1607;
var v$1609 = v$1608[0];
var v$1610 = v$1608[1];
return [tools$DiGraph$.union_graph$235(info_combine$928,v$1609),fix$2055.$map(v$1610)];
};
};
var map$1606 = fix$2055.$map;
g$$932 = (map$1606(l$1605));
var fix$2056 = {};
fix$2056.$do_children = function(xs$1613){lab$do_children: while (true) {if (xs$1613 == null) {return null;
} else {var v$1614 = xs$1613;
var v$1615 = v$1614[0];
var v$1616 = v$1614[1];
var n$1617 = tools$UnionFindPoly$.find$57(v$1615);
var r$1619 = (tools$UnionFindPoly$.find_info$77(n$1617))[1][3];
if (r$1619[0]) {var t$2057 = v$1616;
var xs$1613 = t$2057;
continue lab$do_children;
} else {(r$1619[0] = true,0);
return [n$1617,fix$2056.$do_children(v$1616)];
};
};
};
};
var do_children$1612 = fix$2056.$do_children;
var fix$2058 = {};
fix$2058.$app = function(v$1623){if (v$1623 == null) {return 0;
} else {var v$1624 = v$1623;
var v$1625 = v$1624[0];
var v$1626 = v$1624[1];
var children$1628 = (tools$UnionFindPoly$.find_info$77(v$1625))[1][2];
var fix$2059 = {};
fix$2059.$app = function(v$1630){lab$app: while (true) {if (v$1630 == null) {return 0;
} else {var v$1631 = v$1630;
var v$1632 = v$1631[0];
var v$1633 = v$1631[1];
((tools$UnionFindPoly$.find_info$77(v$1632))[1][3][0] = false,0);
var t$2060 = v$1633;
var v$1630 = t$2060;
continue lab$app;
};
};
};
var app$1629 = fix$2059.$app;
app$1629(children$1628);
((tools$UnionFindPoly$.find_info$77(v$1625))[1][3][0] = true,0);
var newout$1636 = do_children$1612(children$1628);
var v$1637 = tools$UnionFindPoly$.find_info$77(v$1625);
var v$1638 = v$1637[1];
var v$1639 = v$1638[1];
var v$1640 = v$1638[3];
var v$1641 = v$1638[0];
tools$UnionFindPoly$.set_info$103(v$1625,[0,[v$1641,v$1639,newout$1636,v$1640]]);
return fix$2058.$app(v$1626);
};
};
var app$1622 = fix$2058.$app;
app$1622(g$$932);
var fix$2061 = {};
fix$2061.$app = function(v$1644){lab$app: while (true) {if (v$1644 == null) {return 0;
} else {var v$1645 = v$1644;
var v$1646 = v$1645[0];
var v$1647 = v$1645[1];
((tools$UnionFindPoly$.find_info$77(v$1646))[1][3][0] = false,0);
var t$2062 = v$1647;
var v$1644 = t$2062;
continue lab$app;
};
};
};
var app$1643 = fix$2061.$app;
app$1643(g$$932);
return g$$932;
};
tools$DiGraph$.graft$935 = function(v$979,v$980){var n2$940 = tools$UnionFindPoly$.find$57(v$980);
var fix$2063 = {};
fix$2063.$accum = function(v$955,v$1963,v$1964){lab$accum: while (true) {if (v$955 == null) {return [v$1963,v$1964];
} else {var v$962 = v$955;
var v$963 = v$962[0];
var v$964 = v$962[1];
if ((tools$UnionFindPoly$.find_info$77(v$963))[1][3][0]) {var t$2064 = v$964;
var t$2065 = v$1963;
var t$2066 = v$1964;
var v$955 = t$2064;
var v$1963 = t$2065;
var v$1964 = t$2066;
continue lab$accum;
} else {var t$2067 = v$964;
var t$2068 = [v$963,v$1963];
var t$2069 = [v$963,v$1964];
var v$955 = t$2067;
var v$1963 = t$2068;
var v$1964 = t$2069;
continue lab$accum;
};
};
};
};
var accum$941 = fix$2063.$accum;
var v$974;
var t$2073 = accum$941;
var t$2072 = v$979;
var t$2071 = null;
var t$2070;
tools$DiGraph$.visit_all$571(n2$940);
t$2070 = (tools$UnionFindPoly$.find_info$77(n2$940))[1][2];
v$974 = (t$2073(t$2072,t$2071,t$2070));
var v$975 = v$974[0];
var v$976 = v$974[1];
var v$1658 = tools$UnionFindPoly$.find_info$77(n2$940);
var v$1659 = v$1658[1];
var v$1660 = v$1659[1];
var v$1661 = v$1659[3];
var v$1662 = v$1659[0];
tools$UnionFindPoly$.set_info$103(n2$940,[0,[v$1662,v$1660,v$976,v$1661]]);
tools$DiGraph$.unvisit_all$598(n2$940);
return [n2$940,v$975];
};
tools$DiGraph$.multi_graft$981 = function(bound_to_free$984,l$987){var fix$2074 = {};
fix$2074.$map = function(v$1681){if (v$1681 == null) {return null;
} else {var v$1682 = v$1681;
var v$1683 = v$1682[0];
var v$1684 = v$1682[1];
var t$2088;
var t$2075;
var v$1917 = v$1683[0];
var v$1918 = v$1683[1];
var m$1919 = tools$UnionFindPoly$.find$57(v$1918);
var fix$2076 = {};
fix$2076.$accum = function(v$1922,v$1965){lab$accum: while (true) {if (v$1922 == null) {return v$1965;
} else {var v$1923 = v$1922;
var v$1924 = v$1923[0];
var v$1925 = v$1923[1];
var v$1927 = v$1965[0];
var v$1928 = v$1965[1];
var child$1929 = tools$UnionFindPoly$.find$57(v$1924);
var v$1930 = bound_to_free$984(child$1929);
switch (v$1930[0]) { case 0: {var v$1931 = v$1930[1];
if ((tools$UnionFindPoly$.find_info$77(v$1931))[1][3][0]) {var t$2077 = v$1925;
var t$2078 = [v$1927,v$1928];
var v$1922 = t$2077;
var v$1965 = t$2078;
continue lab$accum;
} else {var t$2079 = v$1925;
var t$2080 = [[v$1931,v$1927],[v$1931,v$1928]];
var v$1922 = t$2079;
var v$1965 = t$2080;
continue lab$accum;
};
 break; }default: {var t$2081 = v$1925;
var t$2082 = fix$2076.$accum((tools$UnionFindPoly$.find_info$77(child$1929))[1][2],v$1965);
var v$1922 = t$2081;
var v$1965 = t$2082;
continue lab$accum;
} };
};
};
};
var accum$1920 = fix$2076.$accum;
var v$1932;
var t$2087 = accum$1920;
var t$2086;
var n$1933 = tools$UnionFindPoly$.find$57(v$1917);
t$2086 = (tools$UnionFindPoly$.find_info$77(n$1933))[1][2];
var t$2085;
var t$2084 = null;
var t$2083;
tools$DiGraph$.visit_all$571(m$1919);
t$2083 = (tools$UnionFindPoly$.find_info$77(m$1919))[1][2];
t$2085 = [t$2084,t$2083];
v$1932 = (t$2087(t$2086,t$2085));
var v$1934 = v$1932[0];
var v$1935 = v$1932[1];
var v$1936 = tools$UnionFindPoly$.find_info$77(m$1919);
var v$1937 = v$1936[1];
var v$1938 = v$1937[1];
var v$1939 = v$1937[3];
var v$1940 = v$1937[0];
tools$UnionFindPoly$.set_info$103(m$1919,[0,[v$1940,v$1938,v$1935,v$1939]]);
tools$DiGraph$.unvisit_all$598(m$1919);
t$2075 = [m$1919,v$1934];
t$2088 = [t$2075,fix$2074.$map(v$1684)];
return t$2088;
};
};
var map$1680 = fix$2074.$map;
return map$1680(l$987);
};
tools$DiGraph$.layout_graph$1042 = function(layout_info$1045,g$1048){var t$2089;
var v$1052 = [0,","];
var t$2091;
var fix$2090 = {};
fix$2090.$map = function(v$1721){if (v$1721 == null) {return null;
} else {var v$1722 = v$1721;
var v$1723 = v$1722[0];
var v$1724 = v$1722[1];
var t$2105;
var t$2092;
var v$1942 = (tools$UnionFindPoly$.find_info$77(v$1723))[1][2];
if (v$1942 == null) {var v$1943 = tools$UnionFindPoly$.find_info$77(v$1723);
var v$1944 = v$1943[1];
var v$1945 = v$1944[1];
t$2092 = (layout_info$1045(v$1945));
} else {var t$2093;
var v$1946 = [1];
var t$2104;
var t$2103;
var t$2102;
var v$1947 = tools$UnionFindPoly$.find_info$77(v$1723);
var v$1948 = v$1947[1];
var v$1949 = v$1948[1];
t$2102 = (layout_info$1045(v$1949));
var t$2101;
var t$2100;
var t$2099;
var t$2094;
var v$1950 = [0,","];
var t$2096;
var fix$2095 = {};
fix$2095.$map = function(v$1952){if (v$1952 == null) {return null;
} else {var v$1953 = v$1952;
var v$1954 = v$1953[0];
var v$1955 = v$1953[1];
var t$2098;
var t$2097;
var v$1956 = tools$UnionFindPoly$.find_info$77(v$1954);
var v$1957 = v$1956[1];
var v$1958 = v$1957[1];
t$2097 = (layout_info$1045(v$1958));
t$2098 = [t$2097,fix$2095.$map(v$1955)];
return t$2098;
};
};
var map$1951 = fix$2095.$map;
t$2096 = (map$1951(v$1942));
t$2094 = [t$2096,v$1950,")",2,"("];
t$2099 = [0,t$2094];
t$2100 = [t$2099,null];
t$2101 = t$2100;
t$2103 = [t$2102,t$2101];
t$2104 = t$2103;
t$2093 = [t$2104,v$1946,"",0,""];
t$2092 = [0,t$2093];
};
t$2105 = [t$2092,fix$2090.$map(v$1724)];
return t$2105;
};
};
var map$1720 = fix$2090.$map;
t$2091 = (map$1720(g$1048));
t$2089 = [t$2091,v$1052,"]",1,"["];
return [0,t$2089];
};
tools$DiGraph$.layout_nodes_deep$1054 = function(layout_info$1057,g$1060){var fix$2106 = {};
fix$2106.$layout = function(n$1081){var n$1082 = tools$UnionFindPoly$.find$57(n$1081);
if ((tools$UnionFindPoly$.find_info$77(n$1082))[1][3][0]) {var t$2118;
var v$1090 = [1];
var t$2121;
var t$2120;
var t$2119;
var v$1770 = tools$UnionFindPoly$.find_info$77(n$1082);
var v$1771 = v$1770[1];
var v$1772 = v$1771[1];
t$2119 = (layout_info$1057(v$1772));
t$2120 = [t$2119,null];
t$2121 = t$2120;
t$2118 = [t$2121,v$1090,"",1,"@"];
return [0,t$2118];
} else {((tools$UnionFindPoly$.find_info$77(n$1082))[1][3][0] = true,0);
if ((tools$UnionFindPoly$.find_info$77(n$1082))[1][2] == null) {var v$1780 = tools$UnionFindPoly$.find_info$77(n$1082);
var v$1781 = v$1780[1];
var v$1782 = v$1781[1];
return layout_info$1057(v$1782);
} else {var t$2122;
var v$1106 = [1];
var t$2131;
var t$2130;
var t$2129;
var v$1785 = tools$UnionFindPoly$.find_info$77(n$1082);
var v$1786 = v$1785[1];
var v$1787 = v$1786[1];
t$2129 = (layout_info$1057(v$1787));
var t$2128;
var t$2127;
var t$2126;
var t$2123;
var v$1101 = [0,","];
var t$2124;
var l$1789 = (tools$UnionFindPoly$.find_info$77(n$1082))[1][2];
var fix$2125 = {};
fix$2125.$map = function(v$1791){if (v$1791 == null) {return null;
} else {var v$1792 = v$1791;
var v$1793 = v$1792[0];
var v$1794 = v$1792[1];
return [fix$2106.$layout(v$1793),fix$2125.$map(v$1794)];
};
};
var map$1790 = fix$2125.$map;
t$2124 = (map$1790(l$1789));
t$2123 = [t$2124,v$1101,")",1,"("];
t$2126 = [0,t$2123];
t$2127 = [t$2126,null];
t$2128 = t$2127;
t$2130 = [t$2129,t$2128];
t$2131 = t$2130;
t$2122 = [t$2131,v$1106,"",0,""];
return [0,t$2122];
};
};
};
var layout$1078 = fix$2106.$layout;
var t$2117;
var t$2113;
if (g$1060 == null) {var t$2110;
var v$1814 = [0,","];
var t$2112;
var fix$2111 = {};
fix$2111.$map = function(v$1818){if (v$1818 == null) {return null;
} else {var v$1819 = v$1818;
var v$1820 = v$1819[0];
var v$1821 = v$1819[1];
return [layout$1078(v$1820),fix$2111.$map(v$1821)];
};
};
var map$1817 = fix$2111.$map;
t$2112 = (map$1817(g$1060));
t$2110 = [t$2112,v$1814,"]",1,"["];
t$2113 = [0,t$2110];
} else {var v$1115 = g$1060;
if (v$1115[1] == null) {var v$1117 = v$1115[0];
t$2113 = (layout$1078(v$1117));
} else {var t$2114;
var v$1805 = [0,","];
var t$2116;
var fix$2115 = {};
fix$2115.$map = function(v$1809){if (v$1809 == null) {return null;
} else {var v$1810 = v$1809;
var v$1811 = v$1810[0];
var v$1812 = v$1810[1];
return [layout$1078(v$1811),fix$2115.$map(v$1812)];
};
};
var map$1808 = fix$2115.$map;
t$2116 = (map$1808(g$1060));
t$2114 = [t$2116,v$1805,"]",1,"["];
t$2113 = [0,t$2114];
};
};
var t$2109;
var fix$2107 = {};
fix$2107.$app = function(v$1824){lab$app: while (true) {if (v$1824 == null) {return 0;
} else {var v$1825 = v$1824;
var v$1826 = v$1825[0];
var v$1827 = v$1825[1];
tools$DiGraph$.unvisit_all$598(v$1826);
var t$2108 = v$1827;
var v$1824 = t$2108;
continue lab$app;
};
};
};
var app$1823 = fix$2107.$app;
t$2109 = (app$1823(g$1060));
t$2117 = [t$2113,t$2109];
return t$2117[0];
};
tools$DiGraph$.layout_nodes$1124 = function(l$1127){return function(v$1979){return tools$DiGraph$.layout_graph$1042(l$1127,v$1979);
};
};
return 0;
})();
