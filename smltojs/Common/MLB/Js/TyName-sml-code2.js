if ((typeof(special_objects$TyName$$2)) == "undefined") {special_objects$TyName$$2 = {};
};
(function(){special_objects$TyName$$2.die$1006 = function(s$1009){return tools$Crash$.impossible$50("QuasiMap2." + s$1009);
};
special_objects$TyName$$2.key$1010 = function(v$2241,v$2242,v$2243,v$2244,v$2245,v$2246){return v$2243[0][1];
};
special_objects$TyName$$2.rigid$1014 = function(v$2247,v$2248,v$2249,v$2250,v$2251,v$2252){return v$2249[0][2];
};
special_objects$TyName$$2.empty$1022 = function(v$2279){return null;
};
special_objects$TyName$$2.singleton$1023 = function(v$1034,v$1035){var nd$1028 = v$1034[2];
var k$1029 = nd$1028[0][1];
return nd$1028[0][2]?[[0,tools$IntStringFinMap$.singleton$109(k$1029,[v$1034,v$1035])]]:[[1,[tools$IntStringFinMap$.singleton$109(k$1029,[v$1034,v$1035]),special_objects$Name$.current_matchcount$60(0)]]];
};
special_objects$TyName$$2.isEmpty$1036 = function(v$1039){return (v$1039 == null)?true:false;
};
special_objects$TyName$$2.imap$1044 = function(v$1047){if (v$1047 == null) {return [1];
} else {var v$1056 = v$1047;
switch (v$1056[0][0]) { case 0: {var v$1058 = v$1056[0][1];
return [0,v$1058];
 break; }default: {var v$1059 = v$1056[0][1];
var v$1060 = v$1059[0];
return [0,v$1060];
} };
};
};
special_objects$TyName$$2.imap$$1061 = function(v$1064){if (v$1064 == null) {return tools$Crash$.impossible$50("QuasiMap2.imap': impossible");
} else {var v$1074 = v$1064;
switch (v$1074[0][0]) { case 0: {return v$1074[0][1];
 break; }default: {return v$1074[0][1][0];
} };
};
};
special_objects$TyName$$2.ensure_consistent_imap$1079 = function(imap$1082){var v$1102 = tools$IntStringFinMap$.Fold$69(function(v$1110){var v$1119 = v$1110[0];
var v$1120 = v$1119[0];
var v$1121 = v$1119[1];
var v$1122 = v$1121[0];
var v$1123 = v$1110[1];
var v$1124 = v$1123[0];
var v$1125 = v$1123[1];
var t$2280;
if (v$1124) {var v$2101 = v$1122[2][0][1];
t$2280 = ((v$2101[0] == v$1120[0])?(v$2101[1] == v$1120[1]):false);
} else {t$2280 = false;
};
return [t$2280,v$1125?v$1122[2][0][2]:false];
},[true,true],imap$1082);
var v$1103 = v$1102[0];
var v$1104 = v$1102[1];
return [v$1103?imap$1082:(tools$IntStringFinMap$.fold$53(function(v$1095){var v$1096 = v$1095[0];
var v$1097 = v$1096[0];
var v$1098 = v$1096[1];
var v$1099 = v$1095[1];
return tools$IntStringFinMap$.add$228(v$1097[2][0][1],[v$1097,v$1098],v$1099);
},tools$IntStringFinMap$.empty$108(0),imap$1082)),v$1104];
};
special_objects$TyName$$2.ensure_consistent$1126 = function(v$1129){if (v$1129 == null) {return v$1129;
} else {var v$1142 = v$1129;
switch (v$1142[0][0]) { case 0: {return v$1129;
 break; }default: {var v$1162 = v$1142[0][1];
var v$1163 = v$1162[0];
var v$1164 = v$1162[1];
if (v$1164 < (special_objects$Name$.current_matchcount$60(0))) {var v$1159 = special_objects$TyName$$2.ensure_consistent_imap$1079(v$1163);
var v$1160 = v$1159[1];
var v$1161 = v$1159[0];
if (v$1160) {(v$1142[0] = [0,v$1161],0);
return v$1129;
} else {(v$1142[0] = [1,[v$1161,special_objects$Name$.current_matchcount$60(0)]],0);
return v$1129;
};
} else {return v$1129;
};
} };
};
};
special_objects$TyName$$2.mk_flex$1165 = function(imap$1168){return [[1,[imap$1168,special_objects$Name$.current_matchcount$60(0)]]];
};
special_objects$TyName$$2.mk_rigid$1169 = function(imap$1172){return [[0,imap$1172]];
};
special_objects$TyName$$2.lookup$1173 = function(m$1176,d$1179){var v$1184;
var v$1844 = special_objects$TyName$$2.ensure_consistent$1126(m$1176);
if (v$1844 == null) {v$1184 = [1];
} else {var v$1845 = v$1844;
switch (v$1845[0][0]) { case 0: {var v$1846 = v$1845[0][1];
v$1184 = [0,v$1846];
 break; }default: {var v$1847 = v$1845[0][1];
var v$1848 = v$1847[0];
v$1184 = [0,v$1848];
} };
};
switch (v$1184[0]) { case 0: {var v$1194 = v$1184[1];
var v$1190 = tools$IntStringFinMap$.lookup$120(v$1194,d$1179[2][0][1]);
switch (v$1190[0]) { case 0: {var v$1192 = v$1190[1];
var v$1193 = v$1192[1];
return [0,v$1193];
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
};
special_objects$TyName$$2.add$1195 = function(v$1220,v$1221,v$1222){var v$1208 = special_objects$TyName$$2.ensure_consistent$1126(v$1222);
if (v$1208 == null) {var nd$1853 = v$1220[2];
var k$1854 = nd$1853[0][1];
return nd$1853[0][2]?[[0,tools$IntStringFinMap$.singleton$109(k$1854,[v$1220,v$1221])]]:[[1,[tools$IntStringFinMap$.singleton$109(k$1854,[v$1220,v$1221]),special_objects$Name$.current_matchcount$60(0)]]];
} else {var v$1209 = v$1208;
switch (v$1209[0][0]) { case 0: {var v$1217 = v$1209[0][1];
var nd$1211 = v$1220[2];
var i$1212 = nd$1211[0][1];
return nd$1211[0][2]?[[0,tools$IntStringFinMap$.add$228(i$1212,[v$1220,v$1221],v$1217)]]:[[1,[tools$IntStringFinMap$.add$228(i$1212,[v$1220,v$1221],v$1217),special_objects$Name$.current_matchcount$60(0)]]];
 break; }default: {var v$1218 = v$1209[0][1];
var v$1219 = v$1218[0];
return [[1,[tools$IntStringFinMap$.add$228(v$1220[2][0][1],[v$1220,v$1221],v$1219),special_objects$Name$.current_matchcount$60(0)]]];
} };
};
};
special_objects$TyName$$2.plus$1223 = function(v$1257,v$1258){var m1$1228 = special_objects$TyName$$2.ensure_consistent$1126(v$1257);
var m2$1229 = special_objects$TyName$$2.ensure_consistent$1126(v$1258);
if (m1$1228 == null) {return m2$1229;
} else {if (m2$1229 == null) {return m1$1228;
} else {var v$1248 = m1$1228;
switch (v$1248[0][0]) { case 0: {var v$1250 = m2$1229;
switch (v$1250[0][0]) { case 0: {var v$1252 = v$1248[0][1];
var v$1253 = v$1250[0][1];
return [[0,tools$IntStringFinMap$.plus$246(v$1252,v$1253)]];
 break; }default: {var t$2287;
var t$2286;
var t$2285;
var t$2284;
var t$2283 = tools$IntStringFinMap$.plus$246;
var t$2282;
if (m1$1228 == null) {t$2282 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2178 = m1$1228;
switch (v$2178[0][0]) { case 0: {t$2282 = v$2178[0][1];
 break; }default: {t$2282 = v$2178[0][1][0];
} };
};
var t$2281;
if (m2$1229 == null) {t$2281 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2179 = m2$1229;
switch (v$2179[0][0]) { case 0: {t$2281 = v$2179[0][1];
 break; }default: {t$2281 = v$2179[0][1][0];
} };
};
t$2284 = (t$2283(t$2282,t$2281));
t$2285 = [t$2284,special_objects$Name$.current_matchcount$60(0)];
t$2286 = [1,t$2285];
t$2287 = [t$2286];
return t$2287;
} };
 break; }default: {var t$2294;
var t$2293;
var t$2292;
var t$2291;
var t$2290 = tools$IntStringFinMap$.plus$246;
var t$2289;
if (m1$1228 == null) {t$2289 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2181 = m1$1228;
switch (v$2181[0][0]) { case 0: {t$2289 = v$2181[0][1];
 break; }default: {t$2289 = v$2181[0][1][0];
} };
};
var t$2288;
if (m2$1229 == null) {t$2288 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2182 = m2$1229;
switch (v$2182[0][0]) { case 0: {t$2288 = v$2182[0][1];
 break; }default: {t$2288 = v$2182[0][1][0];
} };
};
t$2291 = (t$2290(t$2289,t$2288));
t$2292 = [t$2291,special_objects$Name$.current_matchcount$60(0)];
t$2293 = [1,t$2292];
t$2294 = [t$2293];
return t$2294;
} };
};
};
};
special_objects$TyName$$2.remove$1259 = function(v$1300,v$1301){var m$1264 = special_objects$TyName$$2.ensure_consistent$1126(v$1301);
if (m$1264 == null) {return [1];
} else {var v$1273 = m$1264;
switch (v$1273[0][0]) { case 0: {var v$1286 = v$1273[0][1];
var v$1279 = tools$IntStringFinMap$.remove$253(v$1300[2][0][1],v$1286);
switch (v$1279[0]) { case 0: {var v$1285 = v$1279[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$1285))?[0,null]:[0,[[0,v$1285]]];
 break; }default: {return [1];
} };
 break; }default: {var v$1298 = v$1273[0][1];
var v$1299 = v$1298[0];
var v$1291 = tools$IntStringFinMap$.remove$253(v$1300[2][0][1],v$1299);
switch (v$1291[0]) { case 0: {var v$1297 = v$1291[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$1297))?[0,null]:[0,[[1,[v$1297,special_objects$Name$.current_matchcount$60(0)]]]];
 break; }default: {return [1];
} };
} };
};
};
special_objects$TyName$$2.dom$1302 = function(v$1305){if (v$1305 == null) {return null;
} else {var l$1877;
var t$2296 = tools$IntStringFinMap$.range$275;
var t$2295;
var v$1883 = special_objects$TyName$$2.ensure_consistent$1126(v$1305);
if (v$1883 == null) {t$2295 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1884 = v$1883;
switch (v$1884[0][0]) { case 0: {t$2295 = v$1884[0][1];
 break; }default: {t$2295 = v$1884[0][1][0];
} };
};
l$1877 = (t$2296(t$2295));
var fix$2297 = {};
fix$2297.$map = function(v$1879){if (v$1879 == null) {return null;
} else {var v$1880 = v$1879;
var v$1881 = v$1880[0];
var v$1882 = v$1880[1];
return [v$1881[0],fix$2297.$map(v$1882)];
};
};
var map$1878 = fix$2297.$map;
return map$1878(l$1877);
};
};
special_objects$TyName$$2.range$1315 = function(v$1318){if (v$1318 == null) {return null;
} else {var l$1888;
var t$2299 = tools$IntStringFinMap$.range$275;
var t$2298;
var v$1894 = special_objects$TyName$$2.ensure_consistent$1126(v$1318);
if (v$1894 == null) {t$2298 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1895 = v$1894;
switch (v$1895[0][0]) { case 0: {t$2298 = v$1895[0][1];
 break; }default: {t$2298 = v$1895[0][1][0];
} };
};
l$1888 = (t$2299(t$2298));
var fix$2300 = {};
fix$2300.$map = function(v$1890){if (v$1890 == null) {return null;
} else {var v$1891 = v$1890;
var v$1892 = v$1891[0];
var v$1893 = v$1891[1];
return [v$1892[1],fix$2300.$map(v$1893)];
};
};
var map$1889 = fix$2300.$map;
return map$1889(l$1888);
};
};
special_objects$TyName$$2.list$1328 = function(v$1331){if (v$1331 == null) {return null;
} else {var t$2302 = tools$IntStringFinMap$.range$275;
var t$2301;
var v$1898 = special_objects$TyName$$2.ensure_consistent$1126(v$1331);
if (v$1898 == null) {t$2301 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1899 = v$1898;
switch (v$1899[0][0]) { case 0: {t$2301 = v$1899[0][1];
 break; }default: {t$2301 = v$1899[0][1][0];
} };
};
return t$2302(t$2301);
};
};
special_objects$TyName$$2.fromList$1337 = function(v$1340){if (v$1340 == null) {return null;
} else {var v$1353;
var b$1903 = [tools$IntStringFinMap$.empty$108(0),true];
var fix$2303 = {};
fix$2303.$foldl = function(v$1906,v$1907){lab$foldl: while (true) {if (v$1907 == null) {return v$1906;
} else {var v$1908 = v$1907;
var v$1909 = v$1908[0];
var v$1910 = v$1908[1];
var t$2304;
var v$2187 = v$1909[0];
var v$2188 = v$1909[1];
var v$2190 = v$1906[0];
var v$2191 = v$1906[1];
t$2304 = [tools$IntStringFinMap$.add$228(v$2187[2][0][1],[v$2187,v$2188],v$2190),v$2191?v$2187[2][0][2]:false];
var t$2305 = t$2304;
var t$2306 = v$1910;
var v$1906 = t$2305;
var v$1907 = t$2306;
continue lab$foldl;
};
};
};
var foldl$1905 = fix$2303.$foldl;
v$1353 = (foldl$1905(b$1903,v$1340));
var v$1354 = v$1353[0];
return v$1353[1]?[[0,v$1354]]:[[1,[v$1354,special_objects$Name$.current_matchcount$60(0)]]];
};
};
special_objects$TyName$$2.composemap$1372 = function(f$1375,m$1378){var v$1383;
if (m$1378 == null) {v$1383 = null;
} else {var t$2308 = tools$IntStringFinMap$.range$275;
var t$2307;
var v$1916 = special_objects$TyName$$2.ensure_consistent$1126(m$1378);
if (v$1916 == null) {t$2307 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1917 = v$1916;
switch (v$1917[0][0]) { case 0: {t$2307 = v$1917[0][1];
 break; }default: {t$2307 = v$1917[0][1][0];
} };
};
v$1383 = (t$2308(t$2307));
};
if (v$1383 == null) {return null;
} else {var v$1391;
var b$1920 = [tools$IntStringFinMap$.empty$108(0),true];
var fix$2309 = {};
fix$2309.$foldl = function(v$1923,v$1924){lab$foldl: while (true) {if (v$1924 == null) {return v$1923;
} else {var v$1925 = v$1924;
var v$1926 = v$1925[0];
var v$1927 = v$1925[1];
var t$2310;
var v$2194 = v$1926[0];
var v$2195 = v$1926[1];
var v$2197 = v$1923[0];
var v$2198 = v$1923[1];
t$2310 = [tools$IntStringFinMap$.add$228(v$2194[2][0][1],[v$2194,f$1375(v$2195)],v$2197),v$2198?v$2194[2][0][2]:false];
var t$2311 = t$2310;
var t$2312 = v$1927;
var v$1923 = t$2311;
var v$1924 = t$2312;
continue lab$foldl;
};
};
};
var foldl$1922 = fix$2309.$foldl;
v$1391 = (foldl$1922(b$1920,v$1383));
var v$1392 = v$1391[0];
return v$1391[1]?[[0,v$1392]]:[[1,[v$1392,special_objects$Name$.current_matchcount$60(0)]]];
};
};
special_objects$TyName$$2.ComposeMap$1410 = function(f$1413,m$1416){var v$1421;
if (m$1416 == null) {v$1421 = null;
} else {var t$2314 = tools$IntStringFinMap$.range$275;
var t$2313;
var v$1933 = special_objects$TyName$$2.ensure_consistent$1126(m$1416);
if (v$1933 == null) {t$2313 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1934 = v$1933;
switch (v$1934[0][0]) { case 0: {t$2313 = v$1934[0][1];
 break; }default: {t$2313 = v$1934[0][1][0];
} };
};
v$1421 = (t$2314(t$2313));
};
if (v$1421 == null) {return null;
} else {var v$1429;
var b$1937 = [tools$IntStringFinMap$.empty$108(0),true];
var fix$2315 = {};
fix$2315.$foldl = function(v$1940,v$1941){lab$foldl: while (true) {if (v$1941 == null) {return v$1940;
} else {var v$1942 = v$1941;
var v$1943 = v$1942[0];
var v$1944 = v$1942[1];
var t$2316;
var v$2201 = v$1943[0];
var v$2202 = v$1943[1];
var v$2204 = v$1940[0];
var v$2205 = v$1940[1];
t$2316 = [tools$IntStringFinMap$.add$228(v$2201[2][0][1],[v$2201,f$1413([v$2201,v$2202])],v$2204),v$2205?v$2201[2][0][2]:false];
var t$2317 = t$2316;
var t$2318 = v$1944;
var v$1940 = t$2317;
var v$1941 = t$2318;
continue lab$foldl;
};
};
};
var foldl$1939 = fix$2315.$foldl;
v$1429 = (foldl$1939(b$1937,v$1421));
var v$1430 = v$1429[0];
return v$1429[1]?[[0,v$1430]]:[[1,[v$1430,special_objects$Name$.current_matchcount$60(0)]]];
};
};
special_objects$TyName$$2.fold$1448 = function(f$1451,b$1454,m$1457){var c$1951 = special_objects$TyName$$2.range$1315(m$1457);
var fix$2319 = {};
fix$2319.$foldl = function(v$1953,v$1954){lab$foldl: while (true) {if (v$1954 == null) {return v$1953;
} else {var v$1955 = v$1954;
var v$1956 = v$1955[0];
var v$1957 = v$1955[1];
var t$2320 = f$1451([v$1956,v$1953]);
var t$2321 = v$1957;
var v$1953 = t$2320;
var v$1954 = t$2321;
continue lab$foldl;
};
};
};
var foldl$1952 = fix$2319.$foldl;
return foldl$1952(b$1454,c$1951);
};
special_objects$TyName$$2.Fold$1458 = function(f$1461,b$1464,m$1467){var c$1960;
if (m$1467 == null) {c$1960 = null;
} else {var t$2323 = tools$IntStringFinMap$.range$275;
var t$2322;
var v$1968 = special_objects$TyName$$2.ensure_consistent$1126(m$1467);
if (v$1968 == null) {t$2322 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1969 = v$1968;
switch (v$1969[0][0]) { case 0: {t$2322 = v$1969[0][1];
 break; }default: {t$2322 = v$1969[0][1][0];
} };
};
c$1960 = (t$2323(t$2322));
};
var fix$2324 = {};
fix$2324.$foldl = function(v$1962,v$1963){lab$foldl: while (true) {if (v$1963 == null) {return v$1962;
} else {var v$1964 = v$1963;
var v$1965 = v$1964[0];
var v$1966 = v$1964[1];
var t$2325 = f$1461([v$1965,v$1962]);
var t$2326 = v$1966;
var v$1962 = t$2325;
var v$1963 = t$2326;
continue lab$foldl;
};
};
};
var foldl$1961 = fix$2324.$foldl;
return foldl$1961(b$1464,c$1960);
};
special_objects$TyName$$2.filter$1468 = function(f$1471,m$1474){var l$1475;
if (m$1474 == null) {l$1475 = null;
} else {var t$2328 = tools$IntStringFinMap$.range$275;
var t$2327;
var v$1972 = special_objects$TyName$$2.ensure_consistent$1126(m$1474);
if (v$1972 == null) {t$2327 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1973 = v$1972;
switch (v$1973[0][0]) { case 0: {t$2327 = v$1973[0][1];
 break; }default: {t$2327 = v$1973[0][1][0];
} };
};
l$1475 = (t$2328(t$2327));
};
var l$$1476;
var fix$2329 = {};
fix$2329.$filter = function(v$1977){lab$filter: while (true) {if (v$1977 == null) {return null;
} else {var v$1978 = v$1977;
var v$1979 = v$1978[0];
var v$1980 = v$1978[1];
if (f$1471(v$1979)) {return [v$1979,fix$2329.$filter(v$1980)];
} else {var t$2330 = v$1980;
var v$1977 = t$2330;
continue lab$filter;
};
};
};
};
var filter$1976 = fix$2329.$filter;
l$$1476 = (filter$1976(l$1475));
return special_objects$TyName$$2.fromList$1337(l$$1476);
};
special_objects$TyName$$2.addList$1477 = function(l$1480,m1$1483){var m2$1484 = special_objects$TyName$$2.fromList$1337(l$1480);
return special_objects$TyName$$2.plus$1223(m1$1483,m2$1484);
};
special_objects$TyName$$2.mergeMap$1485 = function(f$1488,m1$1491,m2$1494){var m1$1495 = special_objects$TyName$$2.ensure_consistent$1126(m1$1491);
var m2$1496 = special_objects$TyName$$2.ensure_consistent$1126(m2$1494);
var f$$1497 = function(v$1508,v$2253){var v$1509 = v$1508[0];
var v$1510 = v$1508[1];
var v$1512 = v$2253[0];
var v$1513 = v$2253[1];
var t$2331;
var v$2135 = v$1509[2][0][1];
var v$2136 = v$1512[2][0][1];
t$2331 = ((v$2135[0] == v$2136[0])?(v$2135[1] == v$2136[1]):false);
if (t$2331) {return [v$1509,f$1488([v$1510,v$1513])];
} else {return tools$Crash$.impossible$50("QuasiMap2.mergeMap, f'");
};
};
if (m1$1495 == null) {return m2$1496;
} else {if (m2$1496 == null) {return m1$1495;
} else {var v$1532 = m1$1495;
switch (v$1532[0][0]) { case 0: {var v$1534 = m2$1496;
switch (v$1534[0][0]) { case 0: {var v$1536 = v$1532[0][1];
var v$1537 = v$1534[0][1];
return [[0,tools$IntStringFinMap$.mergeMap$365(function(v$2254){return f$$1497(v$2254[0],v$2254[1]);
},v$1536,v$1537)]];
 break; }default: {var t$2339;
var t$2338;
var t$2337;
var t$2336;
var t$2335 = tools$IntStringFinMap$.mergeMap$365;
var t$2334 = function(v$2255){return f$$1497(v$2255[0],v$2255[1]);
};
var t$2333;
if (m1$1495 == null) {t$2333 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2208 = m1$1495;
switch (v$2208[0][0]) { case 0: {t$2333 = v$2208[0][1];
 break; }default: {t$2333 = v$2208[0][1][0];
} };
};
var t$2332;
if (m2$1496 == null) {t$2332 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2209 = m2$1496;
switch (v$2209[0][0]) { case 0: {t$2332 = v$2209[0][1];
 break; }default: {t$2332 = v$2209[0][1][0];
} };
};
t$2336 = (t$2335(t$2334,t$2333,t$2332));
t$2337 = [t$2336,special_objects$Name$.current_matchcount$60(0)];
t$2338 = [1,t$2337];
t$2339 = [t$2338];
return t$2339;
} };
 break; }default: {var t$2347;
var t$2346;
var t$2345;
var t$2344;
var t$2343 = tools$IntStringFinMap$.mergeMap$365;
var t$2342 = function(v$2256){return f$$1497(v$2256[0],v$2256[1]);
};
var t$2341;
if (m1$1495 == null) {t$2341 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2211 = m1$1495;
switch (v$2211[0][0]) { case 0: {t$2341 = v$2211[0][1];
 break; }default: {t$2341 = v$2211[0][1][0];
} };
};
var t$2340;
if (m2$1496 == null) {t$2340 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2212 = m2$1496;
switch (v$2212[0][0]) { case 0: {t$2340 = v$2212[0][1];
 break; }default: {t$2340 = v$2212[0][1][0];
} };
};
t$2344 = (t$2343(t$2342,t$2341,t$2340));
t$2345 = [t$2344,special_objects$Name$.current_matchcount$60(0)];
t$2346 = [1,t$2345];
t$2347 = [t$2346];
return t$2347;
} };
};
};
};
var fix$2348 = {};
fix$2348.$pp_lookup = function(v$1544,v$1547,v$1550){lab$pp_lookup: while (true) {if (v$1547 == null) {return tools$Crash$.impossible$50("QuasiMap2.pp_lookup; element not there");
} else {var v$1569 = v$1547;
var v$1570 = v$1569[0];
var v$1571 = v$1569[1];
var t$2349;
var v$2155 = v$1570[2][0][1];
t$2349 = ((v$1550[0] == v$2155[0])?(v$1550[1] == v$2155[1]):false);
if (t$2349) {return v$1544(v$1570);
} else {var t$2350 = v$1544;
var t$2351 = v$1571;
var t$2352 = v$1550;
var v$1544 = t$2350;
var v$1547 = t$2351;
var v$1550 = t$2352;
continue lab$pp_lookup;
};
};
};
};
special_objects$TyName$$2.pp_lookup$1541 = fix$2348.$pp_lookup;
special_objects$TyName$$2.en$Restrict$1573 = new String("Restrict");
special_objects$TyName$$2.restrict$1574 = function(v$2257,v$2258,v$1587){if (v$1587 == null) {return null;
} else {var v$1594 = special_objects$TyName$$2.ensure_consistent$1126(v$2258);
if (v$1594 == null) {throw [special_objects$TyName$$2.en$Restrict$1573,"[empty map]"];
} else {var im$1595;
if (v$1594 == null) {im$1595 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2007 = v$1594;
switch (v$2007[0][0]) { case 0: {im$1595 = v$2007[0][1];
 break; }default: {im$1595 = v$2007[0][1][0];
} };
};
var ns$1596;
var fix$2353 = {};
fix$2353.$map = function(v$2013){if (v$2013 == null) {return null;
} else {var v$2014 = v$2013;
var v$2015 = v$2014[0];
var v$2016 = v$2014[1];
return [v$2015[2][0][1],fix$2353.$map(v$2016)];
};
};
var map$2012 = fix$2353.$map;
ns$1596 = (map$2012(v$1587));
var im$$1598;
try {var t$2360 = tools$IntStringFinMap$.restrict$382;
var t$2359;
var fix$2355 = {};
fix$2355.$pp_lookup = function(v$2272,v$2273){lab$pp_lookup: while (true) {if (v$2272 == null) {return tools$Crash$.impossible$50("QuasiMap2.pp_lookup; element not there");
} else {var v$2274 = v$2272;
var v$2275 = v$2274[0];
var v$2276 = v$2274[1];
var t$2356;
var v$2277 = v$2275[2][0][1];
t$2356 = ((v$2273[0] == v$2277[0])?(v$2273[1] == v$2277[1]):false);
if (t$2356) {return v$2257(v$2275);
} else {var t$2357 = v$2276;
var t$2358 = v$2273;
var v$2272 = t$2357;
var v$2273 = t$2358;
continue lab$pp_lookup;
};
};
};
};
var pp_lookup$2271 = fix$2355.$pp_lookup;
t$2359 = (function(v$2278){return pp_lookup$2271(v$1587,v$2278);
});
im$$1598 = (t$2360(t$2359,im$1595,ns$1596));
} catch(v$2354) {im$$1598 = ((function(v$1602){var t$2361 = v$1602;
if (t$2361[0] == tools$IntStringFinMap$.en$Restrict$381) {var s$1599 = v$1602[1];
throw [special_objects$TyName$$2.en$Restrict$1573,s$1599];
} else {throw v$1602;
};
})(v$2354));
};
return (tools$IntStringFinMap$.fold$53(function(v$1607){var v$1612 = v$1607[0];
var v$1613 = v$1612[0];
return v$1607[1]?v$1613[2][0][2]:false;
},true,im$$1598))?[[0,im$$1598]]:[[1,[im$$1598,special_objects$Name$.current_matchcount$60(0)]]];
};
};
};
special_objects$TyName$$2.enrich$1621 = function(f$1624,v$1628){var v$1652 = v$1628[0];
var v$1653 = v$1628[1];
var m1$1629 = special_objects$TyName$$2.ensure_consistent$1126(v$1652);
var m2$1630 = special_objects$TyName$$2.ensure_consistent$1126(v$1653);
if (m2$1630 == null) {return true;
} else {if (m1$1629 == null) {return false;
} else {var im1$1641;
if (m1$1629 == null) {im1$1641 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2022 = m1$1629;
switch (v$2022[0][0]) { case 0: {im1$1641 = v$2022[0][1];
 break; }default: {im1$1641 = v$2022[0][1][0];
} };
};
var im2$1642;
if (m2$1630 == null) {im2$1642 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2026 = m2$1630;
switch (v$2026[0][0]) { case 0: {im2$1642 = v$2026[0][1];
 break; }default: {im2$1642 = v$2026[0][1][0];
} };
};
return tools$IntStringFinMap$.enrich$405(function(v$2029){var v$2030 = v$2029[0];
var v$2031 = v$2030[1];
var v$2032 = v$2029[1];
var v$2033 = v$2032[1];
return f$1624([v$2031,v$2033]);
},[im1$1641,im2$1642]);
};
};
};
special_objects$TyName$$2.layoutMap$1654 = function(v$1688,v$1690,v$1689,v$1687){return function(pp_dom$1663){return function(pp_range$1666){return function(m$1669){var t$2362;
var v$1685 = [0,v$1689];
var t$2365;
var l$2035;
if (m$1669 == null) {l$2035 = null;
} else {var t$2364 = tools$IntStringFinMap$.range$275;
var t$2363;
var v$2046 = special_objects$TyName$$2.ensure_consistent$1126(m$1669);
if (v$2046 == null) {t$2363 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2047 = v$2046;
switch (v$2047[0][0]) { case 0: {t$2363 = v$2047[0][1];
 break; }default: {t$2363 = v$2047[0][1][0];
} };
};
l$2035 = (t$2364(t$2363));
};
var fix$2366 = {};
fix$2366.$map = function(v$2037){if (v$2037 == null) {return null;
} else {var v$2038 = v$2037;
var v$2039 = v$2038[0];
var v$2040 = v$2038[1];
var t$2369;
var t$2367;
var v$2216 = v$2039[0];
var v$2217 = v$2039[1];
var t$2368;
var v$2218 = [0,v$1688];
t$2368 = [[pp_dom$1663(v$2216),[pp_range$1666(v$2217),null]],v$2218,"",1,""];
t$2367 = [0,t$2368];
t$2369 = [t$2367,fix$2366.$map(v$2040)];
return t$2369;
};
};
var map$2036 = fix$2366.$map;
t$2365 = (map$2036(l$2035));
t$2362 = [t$2365,v$1685,v$1690,1,v$1687];
return [0,t$2362];
};
};
};
};
special_objects$TyName$$2.reportMap$1691 = function(f$1694,m$1697){var t$2374 = tools$Report$.flatten$78;
var t$2372;
var l$2050;
if (m$1697 == null) {l$2050 = null;
} else {var t$2371 = tools$IntStringFinMap$.range$275;
var t$2370;
var v$2057 = special_objects$TyName$$2.ensure_consistent$1126(m$1697);
if (v$2057 == null) {t$2370 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2058 = v$2057;
switch (v$2058[0][0]) { case 0: {t$2370 = v$2058[0][1];
 break; }default: {t$2370 = v$2058[0][1][0];
} };
};
l$2050 = (t$2371(t$2370));
};
var fix$2373 = {};
fix$2373.$map = function(v$2052){if (v$2052 == null) {return null;
} else {var v$2053 = v$2052;
var v$2054 = v$2053[0];
var v$2055 = v$2053[1];
return [f$1694(v$2054),fix$2373.$map(v$2055)];
};
};
var map$2051 = fix$2373.$map;
t$2372 = (map$2051(l$2050));
return t$2374(t$2372);
};
special_objects$TyName$$2.pu_map0$1698 = function(pu_d$1701,pu_a$1704){var pu_m$1713 = pickle$pickle$.combHash$2081(function(m$2060){return tools$IntStringFinMap$.fold$53(function(v$2061){return SmlPrims.chk_ovf_i32(v$2061[1] + 1);
},0,m$2060);
},tools$IntStringFinMap$.pu$479(pickle$pickle$.pairGen$1044([pickle$pickle$.int$720,pickle$pickle$.string$900]),pickle$pickle$.pairGen$1044([pu_d$1701,pu_a$1704])));
return pickle$pickle$.dataGen$1479(["QuasiMap.map0",function(v$2066){switch (v$2066[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$2067){return pickle$pickle$.con1$2005(function(v$2068){return [0,v$2068];
},function(v$2069){switch (v$2069[0]) { case 0: {return v$2069[1];
 break; }default: {return tools$Crash$.impossible$50("QuasiMap2.pu_map0.Rigid");
} };
},pu_m$1713);
},[function(v$2072){return pickle$pickle$.con1$2005(function(v$2073){return [1,[v$2073[1],-1]];
},function(v$2074){switch (v$2074[0]) { case 1: {var v$2075 = v$2074[1];
return [v$2075[1],v$2075[0]];
 break; }default: {return tools$Crash$.impossible$50("QuasiMap2.pu_map0.Flexible");
} };
},pickle$pickle$.pairGen0$974(special_objects$Name$.pu_matchcount$287,pu_m$1713));
},null]]]);
};
special_objects$TyName$$2.pu$1755 = function(pu_d$1758,pu_a$1761){return pickle$pickle$.convert$2333([function(v$2084){switch (v$2084[0]) { case 0: {var v$2085 = v$2084[1];
return v$2085;
 break; }default: {return null;
} };
},function(v$2086){if (v$2086 == null) {return [1];
} else {var v$2087 = v$2086;
var t$2377;
var t$2376 = tools$IntStringFinMap$.isEmpty$119(0);
var t$2375;
if (v$2086 == null) {t$2375 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$2089 = v$2086;
switch (v$2089[0][0]) { case 0: {t$2375 = v$2089[0][1];
 break; }default: {t$2375 = v$2089[0][1][0];
} };
};
t$2377 = (t$2376(t$2375));
if (t$2377) {return tools$Crash$.impossible$50("QuasiMap2.pu.hmmm");
} else {return [0,v$2087];
};
};
}],pickle$pickle$.optionGen$2125(pickle$pickle$.ref0ShGen$1259(special_objects$TyName$$2.pu_map0$1698(pu_d$1758,pu_a$1761))));
};
return 0;
})();
