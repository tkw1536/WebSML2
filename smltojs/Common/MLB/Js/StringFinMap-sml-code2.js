if ((typeof(tools$StringFinMap$$2)) == "undefined") {tools$StringFinMap$$2 = {};
};
(function(){tools$StringFinMap$$2.eq_bal$1357 = function(v$1359,v$1360){switch (v$1359) { case 0: {switch (v$1360) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1360) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1360) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
var fix$1995 = {};
fix$1995.$eq_tree = function(v$1365,v$1366,v$1362){lab$eq_tree: while (true) {var v$1363 = v$1362[0];
var v$1364 = v$1362[1];
if (v$1363 == null) {return (v$1364 == null)?true:false;
} else {if (v$1364 == null) {return false;
} else {var v$1367 = v$1363;
var v$1368 = v$1364;
if (v$1365([v$1367[0],v$1368[0]])) {if (v$1366([v$1367[1],v$1368[1]])) {if (fix$1995.$eq_tree(v$1365,v$1366,[v$1367[2],v$1368[2]])) {var t$1996 = v$1365;
var t$1997 = v$1366;
var t$1998 = [v$1367[3],v$1368[3]];
var v$1365 = t$1996;
var v$1366 = t$1997;
var v$1362 = t$1998;
continue lab$eq_tree;
} else {return false;
};
} else {return false;
};
} else {return false;
};
};
};
};
};
tools$StringFinMap$$2.eq_tree$1361 = fix$1995.$eq_tree;
tools$StringFinMap$$2.die$88 = function(s$91){return tools$Crash$.impossible$50("OrderFinMap." + s$91);
};
tools$StringFinMap$$2.s$j$92 = function(v$1982,v$1983){return v$1982 < v$1983;
};
tools$StringFinMap$$2.lt$99 = function(v$1984,v$1985){return v$1984 < v$1985;
};
tools$StringFinMap$$2.eq$100 = function(v$109,v$110){return ((v$109 < v$110)?true:(v$110 < v$109))?false:true;
};
tools$StringFinMap$$2.empty$116 = function(v$1994){return null;
};
tools$StringFinMap$$2.singleton$117 = function(v$1986,v$1987){return [v$1986,v$1987,null,null,2];
};
tools$StringFinMap$$2.isEmpty$124 = function(v$127){return (v$127 == null)?true:false;
};
tools$StringFinMap$$2.lookup$132 = function(t$135,key$138){var fix$1999 = {};
fix$1999.$search = function(v$142){lab$search: while (true) {if (v$142 == null) {return [1];
} else {var v$159 = v$142;
var v$160 = v$159[0];
var v$161 = v$159[1];
var v$162 = v$159[2];
var v$163 = v$159[3];
if (key$138 < v$160) {var t$2000 = v$162;
var v$142 = t$2000;
continue lab$search;
} else {if (v$160 < key$138) {var t$2001 = v$163;
var v$142 = t$2001;
continue lab$search;
} else {return [0,v$161];
};
};
};
};
};
var search$139 = fix$1999.$search;
return search$139(t$135);
};
tools$StringFinMap$$2.en$Impossible$164 = new String("Impossible");
tools$StringFinMap$$2.impossible$165 = function(s$168){throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMap" + s$168];
};
var en$ALREADYTHERE$169 = new String("ALREADYTHERE");
var exn$ALREADYTHERE$169 = [en$ALREADYTHERE$169];
tools$StringFinMap$$2.add$392 = function(v$401,v$402,v$403){try {var fix$2003 = {};
fix$2003.$ins = function(v$1478){if (v$1478 == null) {return [true,[v$401,v$402,null,null,2]];
} else {var v$1479 = v$1478;
var v$1480 = v$1479[0];
var v$1481 = v$1479[1];
var v$1482 = v$1479[2];
var v$1483 = v$1479[3];
var v$1484 = v$1479[4];
if (v$401 < v$1480) {var v$1486 = fix$2003.$ins(v$1482);
var v$1487 = v$1486[0];
var v$1488 = v$1486[1];
switch (v$1484) { case 2: {return v$1487?[true,[v$1480,v$1481,v$1488,v$1483,1]]:[false,[v$1480,v$1481,v$1488,v$1483,2]];
 break; }case 0: {return v$1487?[false,[v$1480,v$1481,v$1488,v$1483,2]]:[false,[v$1480,v$1481,v$1488,v$1483,0]];
 break; }default: {if (v$1487) {var v$1490;
if (v$1488 == null) {throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMapAVLfinmap 1"];
} else {v$1490 = v$1488;
};
var v$1493 = v$1490[0];
var v$1494 = v$1490[1];
var v$1495 = v$1490[2];
var v$1496 = v$1490[3];
var v$1497 = v$1490[4];
var t$2004;
var v$1737 = 1;
switch (v$1497) { case 0: {switch (v$1737) { case 0: {t$2004 = true;
 break; }default: {t$2004 = false;
} };
 break; }case 1: {switch (v$1737) { case 1: {t$2004 = true;
 break; }default: {t$2004 = false;
} };
 break; }case 2: {switch (v$1737) { case 2: {t$2004 = true;
 break; }default: {t$2004 = false;
} };
 break; } };
if (t$2004) {return [false,[v$1493,v$1494,v$1495,[v$1480,v$1481,v$1496,v$1483,2],2]];
} else {var v$1505;
if (v$1496 == null) {throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMapAVLfinmap 2"];
} else {v$1505 = v$1496;
};
var v$1508 = v$1505[0];
var v$1509 = v$1505[1];
var v$1510 = v$1505[2];
var v$1511 = v$1505[3];
var v$1512 = v$1505[4];
var t$2025 = false;
var t$2024;
var t$2023;
var t$2022 = v$1508;
var t$2021 = v$1509;
var t$2020;
var t$2019;
var t$2018 = v$1493;
var t$2017 = v$1494;
var t$2016 = v$1495;
var t$2015 = v$1510;
var t$2014;
var t$2013;
var v$1743 = 0;
switch (v$1512) { case 0: {switch (v$1743) { case 0: {t$2013 = true;
 break; }default: {t$2013 = false;
} };
 break; }case 1: {switch (v$1743) { case 1: {t$2013 = true;
 break; }default: {t$2013 = false;
} };
 break; }case 2: {switch (v$1743) { case 2: {t$2013 = true;
 break; }default: {t$2013 = false;
} };
 break; } };
t$2014 = (t$2013?1:2);
t$2019 = [t$2018,t$2017,t$2016,t$2015,t$2014];
t$2020 = t$2019;
var t$2012;
var t$2011;
var t$2010 = v$1480;
var t$2009 = v$1481;
var t$2008 = v$1511;
var t$2007 = v$1483;
var t$2006;
var t$2005;
var v$1747 = 1;
switch (v$1512) { case 0: {switch (v$1747) { case 0: {t$2005 = true;
 break; }default: {t$2005 = false;
} };
 break; }case 1: {switch (v$1747) { case 1: {t$2005 = true;
 break; }default: {t$2005 = false;
} };
 break; }case 2: {switch (v$1747) { case 2: {t$2005 = true;
 break; }default: {t$2005 = false;
} };
 break; } };
t$2006 = (t$2005?0:2);
t$2011 = [t$2010,t$2009,t$2008,t$2007,t$2006];
t$2012 = t$2011;
t$2023 = [t$2022,t$2021,t$2020,t$2012,2];
t$2024 = t$2023;
return [t$2025,t$2024];
};
} else {return [false,[v$1480,v$1481,v$1488,v$1483,1]];
};
} };
} else {if (v$1480 < v$401) {var v$1528 = fix$2003.$ins(v$1483);
var v$1529 = v$1528[0];
var v$1530 = v$1528[1];
switch (v$1484) { case 2: {return v$1529?[true,[v$1480,v$1481,v$1482,v$1530,0]]:[false,[v$1480,v$1481,v$1482,v$1530,2]];
 break; }case 1: {return v$1529?[false,[v$1480,v$1481,v$1482,v$1530,2]]:[false,[v$1480,v$1481,v$1482,v$1530,1]];
 break; }default: {if (v$1529) {var v$1532;
if (v$1530 == null) {throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMapAVLfinmap 3"];
} else {v$1532 = v$1530;
};
var v$1535 = v$1532[0];
var v$1536 = v$1532[1];
var v$1537 = v$1532[2];
var v$1538 = v$1532[3];
var v$1539 = v$1532[4];
var t$2026;
var v$1757 = 0;
switch (v$1539) { case 0: {switch (v$1757) { case 0: {t$2026 = true;
 break; }default: {t$2026 = false;
} };
 break; }case 1: {switch (v$1757) { case 1: {t$2026 = true;
 break; }default: {t$2026 = false;
} };
 break; }case 2: {switch (v$1757) { case 2: {t$2026 = true;
 break; }default: {t$2026 = false;
} };
 break; } };
if (t$2026) {return [false,[v$1535,v$1536,[v$1480,v$1481,v$1482,v$1537,2],v$1538,2]];
} else {var v$1547;
if (v$1537 == null) {throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMapAVLfinmap 4"];
} else {v$1547 = v$1537;
};
var v$1550 = v$1547[0];
var v$1551 = v$1547[1];
var v$1552 = v$1547[2];
var v$1553 = v$1547[3];
var v$1554 = v$1547[4];
var t$2047 = false;
var t$2046;
var t$2045;
var t$2044 = v$1550;
var t$2043 = v$1551;
var t$2042;
var t$2041;
var t$2040 = v$1480;
var t$2039 = v$1481;
var t$2038 = v$1482;
var t$2037 = v$1552;
var t$2036;
var t$2035;
var v$1763 = 0;
switch (v$1554) { case 0: {switch (v$1763) { case 0: {t$2035 = true;
 break; }default: {t$2035 = false;
} };
 break; }case 1: {switch (v$1763) { case 1: {t$2035 = true;
 break; }default: {t$2035 = false;
} };
 break; }case 2: {switch (v$1763) { case 2: {t$2035 = true;
 break; }default: {t$2035 = false;
} };
 break; } };
t$2036 = (t$2035?1:2);
t$2041 = [t$2040,t$2039,t$2038,t$2037,t$2036];
t$2042 = t$2041;
var t$2034;
var t$2033;
var t$2032 = v$1535;
var t$2031 = v$1536;
var t$2030 = v$1553;
var t$2029 = v$1538;
var t$2028;
var t$2027;
var v$1767 = 1;
switch (v$1554) { case 0: {switch (v$1767) { case 0: {t$2027 = true;
 break; }default: {t$2027 = false;
} };
 break; }case 1: {switch (v$1767) { case 1: {t$2027 = true;
 break; }default: {t$2027 = false;
} };
 break; }case 2: {switch (v$1767) { case 2: {t$2027 = true;
 break; }default: {t$2027 = false;
} };
 break; } };
t$2028 = (t$2027?0:2);
t$2033 = [t$2032,t$2031,t$2030,t$2029,t$2028];
t$2034 = t$2033;
t$2045 = [t$2044,t$2043,t$2042,t$2034,2];
t$2046 = t$2045;
return [t$2047,t$2046];
};
} else {return [false,[v$1480,v$1481,v$1482,v$1530,0]];
};
} };
} else {throw exn$ALREADYTHERE$169;
};
};
};
};
var ins$1477 = fix$2003.$ins;
return (ins$1477(v$403))[1];
} catch(v$2002) {return (function(ALREADYTHERE$400){var t$2048 = ALREADYTHERE$400;
if (t$2048[0] == en$ALREADYTHERE$169) {var fix$2049 = {};
fix$2049.$repl = function(v$1593){if (v$1593 == null) {throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMapAVLupdate.repl"];
} else {var v$1596 = v$1593;
var v$1597 = v$1596[0];
var v$1598 = v$1596[1];
var v$1599 = v$1596[2];
var v$1600 = v$1596[3];
var v$1601 = v$1596[4];
return (v$401 < v$1597)?[v$1597,v$1598,fix$2049.$repl(v$1599),v$1600,v$1601]:((v$1597 < v$401)?[v$1597,v$1598,v$1599,fix$2049.$repl(v$1600),v$1601]:[v$1597,v$402,v$1599,v$1600,v$1601]);
};
};
var repl$1592 = fix$2049.$repl;
return repl$1592(v$403);
} else {throw ALREADYTHERE$400;
};
})(v$2002);
};
};
var fix$2050 = {};
fix$2050.$plus = function(v$422,v$423){lab$plus: while (true) {if (v$423 == null) {return v$422;
} else {var v$417 = v$423;
var v$418 = v$417[0];
var v$419 = v$417[1];
var v$420 = v$417[2];
var v$421 = v$417[3];
var t$2051 = fix$2050.$plus(tools$StringFinMap$$2.add$392(v$418,v$419,v$422),v$420);
var t$2052 = v$421;
var v$422 = t$2051;
var v$423 = t$2052;
continue lab$plus;
};
};
};
tools$StringFinMap$$2.plus$404 = fix$2050.$plus;
var en$NOTFOUND$424 = new String("NOTFOUND");
var exn$NOTFOUND$424 = [en$NOTFOUND$424];
var delete$425 = function(v$710,v$711){var balance1$430 = function(v$433){if (v$433 == null) {throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMap(balance1 on an empty map)"];
} else {var v$503 = v$433;
var v$504 = v$503[0];
var v$505 = v$503[1];
var v$506 = v$503[2];
var v$507 = v$503[3];
switch (v$503[4]) { case 1: {return [[v$504,v$505,v$506,v$507,2],true];
 break; }case 2: {return [[v$504,v$505,v$506,v$507,0],false];
 break; }default: {var v$490;
if (v$507 == null) {throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMapAVLfinmap 5"];
} else {v$490 = v$507;
};
var v$491 = v$490[0];
var v$492 = v$490[1];
var v$493 = v$490[2];
var v$494 = v$490[3];
switch (v$490[4]) { case 1: {var v$477;
if (v$493 == null) {throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMapAVLfinmap 6"];
} else {v$477 = v$493;
};
var v$478 = v$477[0];
var v$479 = v$477[1];
var v$480 = v$477[2];
var v$481 = v$477[3];
var v$482 = v$477[4];
var t$2072;
var t$2071;
var t$2070 = v$478;
var t$2069 = v$479;
var t$2068;
var t$2067;
var t$2066 = v$504;
var t$2065 = v$505;
var t$2064 = v$506;
var t$2063 = v$480;
var t$2062;
var t$2061;
var v$1785 = 0;
switch (v$482) { case 0: {switch (v$1785) { case 0: {t$2061 = true;
 break; }default: {t$2061 = false;
} };
 break; }case 1: {switch (v$1785) { case 1: {t$2061 = true;
 break; }default: {t$2061 = false;
} };
 break; }case 2: {switch (v$1785) { case 2: {t$2061 = true;
 break; }default: {t$2061 = false;
} };
 break; } };
t$2062 = (t$2061?1:2);
t$2067 = [t$2066,t$2065,t$2064,t$2063,t$2062];
t$2068 = t$2067;
var t$2060;
var t$2059;
var t$2058 = v$491;
var t$2057 = v$492;
var t$2056 = v$481;
var t$2055 = v$494;
var t$2054;
var t$2053;
var v$1787 = 1;
switch (v$482) { case 0: {switch (v$1787) { case 0: {t$2053 = true;
 break; }default: {t$2053 = false;
} };
 break; }case 1: {switch (v$1787) { case 1: {t$2053 = true;
 break; }default: {t$2053 = false;
} };
 break; }case 2: {switch (v$1787) { case 2: {t$2053 = true;
 break; }default: {t$2053 = false;
} };
 break; } };
t$2054 = (t$2053?0:2);
t$2059 = [t$2058,t$2057,t$2056,t$2055,t$2054];
t$2060 = t$2059;
t$2071 = [t$2070,t$2069,t$2068,t$2060,2];
t$2072 = t$2071;
return [t$2072,true];
 break; }case 2: {return [[v$491,v$492,[v$504,v$505,v$506,v$493,0],v$494,1],false];
 break; }default: {return [[v$491,v$492,[v$504,v$505,v$506,v$493,2],v$494,2],true];
} };
} };
};
};
var balance2$509 = function(v$512){if (v$512 == null) {throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMap(balance2 on an empty map)"];
} else {var v$582 = v$512;
var v$583 = v$582[0];
var v$584 = v$582[1];
var v$585 = v$582[2];
var v$586 = v$582[3];
switch (v$582[4]) { case 0: {return [[v$583,v$584,v$585,v$586,2],true];
 break; }case 2: {return [[v$583,v$584,v$585,v$586,1],false];
 break; }default: {var v$569;
if (v$585 == null) {throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMapAVLfinmap 7"];
} else {v$569 = v$585;
};
var v$570 = v$569[0];
var v$571 = v$569[1];
var v$572 = v$569[2];
var v$573 = v$569[3];
switch (v$569[4]) { case 0: {var v$556;
if (v$573 == null) {throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMapAVLfinmap 8"];
} else {v$556 = v$573;
};
var v$557 = v$556[0];
var v$558 = v$556[1];
var v$559 = v$556[2];
var v$560 = v$556[3];
var v$561 = v$556[4];
var t$2092;
var t$2091;
var t$2090 = v$557;
var t$2089 = v$558;
var t$2088;
var t$2087;
var t$2086 = v$570;
var t$2085 = v$571;
var t$2084 = v$572;
var t$2083 = v$559;
var t$2082;
var t$2081;
var v$1797 = 0;
switch (v$561) { case 0: {switch (v$1797) { case 0: {t$2081 = true;
 break; }default: {t$2081 = false;
} };
 break; }case 1: {switch (v$1797) { case 1: {t$2081 = true;
 break; }default: {t$2081 = false;
} };
 break; }case 2: {switch (v$1797) { case 2: {t$2081 = true;
 break; }default: {t$2081 = false;
} };
 break; } };
t$2082 = (t$2081?1:2);
t$2087 = [t$2086,t$2085,t$2084,t$2083,t$2082];
t$2088 = t$2087;
var t$2080;
var t$2079;
var t$2078 = v$583;
var t$2077 = v$584;
var t$2076 = v$560;
var t$2075 = v$586;
var t$2074;
var t$2073;
var v$1795 = 1;
switch (v$561) { case 0: {switch (v$1795) { case 0: {t$2073 = true;
 break; }default: {t$2073 = false;
} };
 break; }case 1: {switch (v$1795) { case 1: {t$2073 = true;
 break; }default: {t$2073 = false;
} };
 break; }case 2: {switch (v$1795) { case 2: {t$2073 = true;
 break; }default: {t$2073 = false;
} };
 break; } };
t$2074 = (t$2073?0:2);
t$2079 = [t$2078,t$2077,t$2076,t$2075,t$2074];
t$2080 = t$2079;
t$2091 = [t$2090,t$2089,t$2088,t$2080,2];
t$2092 = t$2091;
return [t$2092,true];
 break; }case 2: {return [[v$570,v$571,v$572,[v$583,v$584,v$573,v$586,1],0],false];
 break; }default: {return [[v$570,v$571,v$572,[v$583,v$584,v$573,v$586,2],2],true];
} };
} };
};
};
var fix$2093 = {};
fix$2093.$remove_rightmost = function(v$591){if (v$591 == null) {throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMap(remove_rightmost on empty map)"];
} else {var v$607 = v$591;
var v$608 = v$607[3];
if (v$608 == null) {return [v$607[2],v$607[0],v$607[1],true];
} else {var v$633 = v$607[0];
var v$634 = v$607[1];
var v$635 = v$607[2];
var v$636 = v$607[4];
var v$628 = fix$2093.$remove_rightmost(v$608);
var v$629 = v$628[0];
var v$630 = v$628[1];
var v$631 = v$628[2];
if (v$628[3]) {var v$625 = balance2$509([v$633,v$634,v$635,v$629,v$636]);
return [v$625[0],v$630,v$631,v$625[1]];
} else {return [[v$633,v$634,v$635,v$629,v$636],v$630,v$631,false];
};
};
};
};
var remove_rightmost$588 = fix$2093.$remove_rightmost;
var fix$2094 = {};
fix$2094.$del = function(v$640){lab$del: while (true) {if (v$640 == null) {throw exn$NOTFOUND$424;
} else {var v$700 = v$640;
var v$701 = v$700[0];
var v$702 = v$700[1];
var v$703 = v$700[2];
var v$704 = v$700[3];
var v$705 = v$700[4];
if (v$710 < v$701) {var v$661 = fix$2094.$del(v$703);
var v$662 = v$661[0];
if (v$661[1]) {return balance1$430([v$701,v$702,v$662,v$704,v$705]);
} else {return [[v$701,v$702,v$662,v$704,v$705],false];
};
} else {if (v$701 < v$710) {var v$675 = fix$2094.$del(v$704);
var v$676 = v$675[0];
if (v$675[1]) {return balance2$509([v$701,v$702,v$703,v$676,v$705]);
} else {return [[v$701,v$702,v$703,v$676,v$705],false];
};
} else {if (v$704 == null) {return [v$703,true];
} else {if (v$703 == null) {return [v$704,true];
} else {var v$695 = remove_rightmost$588(v$703);
var v$696 = v$695[0];
var v$697 = v$695[1];
var v$698 = v$695[2];
if (v$695[3]) {return balance1$430([v$697,v$698,v$696,v$704,v$705]);
} else {return [[v$697,v$698,v$696,v$704,v$705],false];
};
};
};
};
};
};
};
};
var del$637 = fix$2094.$del;
return (del$637(v$711))[0];
};
tools$StringFinMap$$2.remove$712 = function(v$720,v$721){try {return [0,delete$425(v$720,v$721)];
} catch(v$2095) {return (function(NOTFOUND$719){var t$2096 = NOTFOUND$719;
if (t$2096[0] == en$NOTFOUND$424) {return [1];
} else {throw NOTFOUND$719;
};
})(v$2095);
};
};
tools$StringFinMap$$2.delete$722 = function(v$730,v$731){try {return delete$425(v$730,v$731);
} catch(v$2097) {return (function(NOTFOUND$729){var t$2098 = NOTFOUND$729;
if (t$2098[0] == en$NOTFOUND$424) {return v$731;
} else {throw NOTFOUND$729;
};
})(v$2097);
};
};
tools$StringFinMap$$2.dom$732 = function(m$735){var fix$2099 = {};
fix$2099.$dom$ = function(v$739,v$742){lab$dom$: while (true) {if (v$739 == null) {return v$742;
} else {var v$754 = v$739;
var v$755 = v$754[0];
var v$756 = v$754[2];
var v$757 = v$754[3];
var t$2100 = v$756;
var t$2101 = [v$755,fix$2099.$dom$(v$757,v$742)];
var v$739 = t$2100;
var v$742 = t$2101;
continue lab$dom$;
};
};
};
var dom$$736 = fix$2099.$dom$;
return dom$$736(m$735,null);
};
tools$StringFinMap$$2.range$759 = function(m$762){var fix$2102 = {};
fix$2102.$ran = function(v$766,v$769){lab$ran: while (true) {if (v$766 == null) {return v$769;
} else {var v$781 = v$766;
var v$782 = v$781[1];
var v$783 = v$781[2];
var v$784 = v$781[3];
var t$2103 = v$783;
var t$2104 = [v$782,fix$2102.$ran(v$784,v$769)];
var v$766 = t$2103;
var v$769 = t$2104;
continue lab$ran;
};
};
};
var ran$763 = fix$2102.$ran;
return ran$763(m$762,null);
};
tools$StringFinMap$$2.list$786 = function(m$789){var fix$2105 = {};
fix$2105.$li = function(v$793,v$796){lab$li: while (true) {if (v$793 == null) {return v$796;
} else {var v$809 = v$793;
var v$810 = v$809[0];
var v$811 = v$809[1];
var v$812 = v$809[2];
var v$813 = v$809[3];
var t$2106 = v$812;
var t$2107 = [[v$810,v$811],fix$2105.$li(v$813,v$796)];
var v$793 = t$2106;
var v$796 = t$2107;
continue lab$li;
};
};
};
var li$790 = fix$2105.$li;
return li$790(m$789,null);
};
var fix$2108 = {};
fix$2108.$composemap = function(f$818,t$821){if (t$821 == null) {return null;
} else {var v$832 = t$821;
var v$833 = v$832[0];
var v$834 = v$832[1];
var v$835 = v$832[2];
var v$836 = v$832[3];
var v$837 = v$832[4];
var l$$831 = fix$2108.$composemap(f$818,v$835);
return [v$833,f$818(v$834),l$$831,fix$2108.$composemap(f$818,v$836),v$837];
};
};
tools$StringFinMap$$2.composemap$815 = fix$2108.$composemap;
var fix$2109 = {};
fix$2109.$ComposeMap = function(f$841,t$844){if (t$844 == null) {return null;
} else {var v$855 = t$844;
var v$856 = v$855[0];
var v$857 = v$855[1];
var v$858 = v$855[2];
var v$859 = v$855[3];
var v$860 = v$855[4];
var l$$854 = fix$2109.$ComposeMap(f$841,v$858);
return [v$856,f$841([v$856,v$857]),l$$854,fix$2109.$ComposeMap(f$841,v$859),v$860];
};
};
tools$StringFinMap$$2.ComposeMap$838 = fix$2109.$ComposeMap;
tools$StringFinMap$$2.fold$861 = function(f$864,e$867,t$870){var fix$2110 = {};
fix$2110.$fold$ = function(v$874,v$877){lab$fold$: while (true) {if (v$874 == null) {return v$877;
} else {var v$889 = v$874;
var v$890 = v$889[1];
var v$891 = v$889[2];
var v$892 = v$889[3];
var t$2111 = v$892;
var t$2112 = f$864([v$890,fix$2110.$fold$(v$891,v$877)]);
var v$874 = t$2111;
var v$877 = t$2112;
continue lab$fold$;
};
};
};
var fold$$871 = fix$2110.$fold$;
return fold$$871(t$870,e$867);
};
tools$StringFinMap$$2.Fold$894 = function(f$897,e$900,t$903){var fix$2113 = {};
fix$2113.$fold$ = function(v$907,v$910){lab$fold$: while (true) {if (v$907 == null) {return v$910;
} else {var v$923 = v$907;
var v$924 = v$923[0];
var v$925 = v$923[1];
var v$926 = v$923[2];
var v$927 = v$923[3];
var t$2114 = v$927;
var t$2115 = f$897([[v$924,v$925],fix$2113.$fold$(v$926,v$910)]);
var v$907 = t$2114;
var v$910 = t$2115;
continue lab$fold$;
};
};
};
var fold$$904 = fix$2113.$fold$;
return fold$$904(t$903,e$900);
};
tools$StringFinMap$$2.filter$929 = function(f$932,t$935){var fix$2116 = {};
fix$2116.$fold$ = function(v$1844,v$1845){lab$fold$: while (true) {if (v$1844 == null) {return v$1845;
} else {var v$1846 = v$1844;
var v$1847 = v$1846[0];
var v$1848 = v$1846[1];
var v$1849 = v$1846[2];
var v$1850 = v$1846[3];
var t$2118 = v$1850;
var t$2117;
var v$1975 = fix$2116.$fold$(v$1849,v$1845);
t$2117 = ((f$932([v$1847,v$1848]))?(tools$StringFinMap$$2.add$392(v$1847,v$1848,v$1975)):v$1975);
var t$2119 = t$2118;
var t$2120 = t$2117;
var v$1844 = t$2119;
var v$1845 = t$2120;
continue lab$fold$;
};
};
};
var fold$$1843 = fix$2116.$fold$;
return fold$$1843(t$935,tools$StringFinMap$$2.empty$116(0));
};
var fix$2121 = {};
fix$2121.$addList = function(v$952,v$955){lab$addList: while (true) {if (v$952 == null) {return v$955;
} else {var v$967 = v$952;
var v$968 = v$967[0];
var v$969 = v$968[0];
var v$970 = v$968[1];
var v$971 = v$967[1];
var t$2122 = v$971;
var t$2123 = tools$StringFinMap$$2.add$392(v$969,v$970,v$955);
var v$952 = t$2122;
var v$955 = t$2123;
continue lab$addList;
};
};
};
tools$StringFinMap$$2.addList$949 = fix$2121.$addList;
tools$StringFinMap$$2.fromList$973 = function(l$976){return tools$StringFinMap$$2.addList$949(l$976,tools$StringFinMap$$2.empty$116(0));
};
tools$StringFinMap$$2.fromSortedList$977 = function(l$980){var fix$2124 = {};
fix$2124.$build = function(v$1009,v$1988){switch (v$1009) { case 0: {return [v$1988,null];
 break; }default: {var n$$1011 = SmlPrims.div_i32(v$1009,2,CompilerInitial.exn$Div$40);
var v$1042 = fix$2124.$build(n$$1011,v$1988);
var v$1043 = v$1042[0];
var v$1044 = v$1042[1];
var v$1025;
if (v$1043 == null) {throw [tools$StringFinMap$$2.en$Impossible$164,"OrderFinMapbuild"];
} else {var v$1037 = v$1043;
var v$1038 = v$1037[0];
v$1025 = [v$1038[0],v$1038[1],v$1037[1]];
};
var v$1026 = v$1025[0];
var v$1027 = v$1025[1];
var v$1028 = v$1025[2];
var v$1022 = fix$2124.$build(SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(v$1009 - n$$1011)) - 1),v$1028);
return [v$1022[0],[v$1026,v$1027,v$1044,v$1022[1]]];
} };
};
var build$998 = fix$2124.$build;
var fix$2125 = {};
fix$2125.$mk_avl = function(v$1060){if (v$1060 == null) {return [null,0];
} else {var v$1089 = v$1060;
var v$1090 = v$1089[0];
var v$1091 = v$1089[1];
var v$1092 = v$1089[2];
var v$1093 = v$1089[3];
var v$1086 = fix$2125.$mk_avl(v$1092);
var v$1087 = v$1086[0];
var v$1088 = v$1086[1];
var v$1083 = fix$2125.$mk_avl(v$1093);
var v$1084 = v$1083[0];
var v$1085 = v$1083[1];
return [[v$1090,v$1091,v$1087,v$1084,(v$1088 == v$1085)?2:((v$1088 > v$1085)?1:0)],SmlPrims.chk_ovf_i32(1 + ((v$1088 > v$1085)?v$1088:v$1085))];
};
};
var mk_avl$1057 = fix$2125.$mk_avl;
var t$2134;
var t$2133 = mk_avl$1057;
var t$2132;
var t$2131;
var t$2130 = build$998;
var t$2129;
var fix$2126 = {};
fix$2126.$acc = function(v$1663,v$1664){lab$acc: while (true) {if (v$1663 == null) {return v$1664;
} else {var v$1665 = v$1663;
var v$1666 = v$1665[1];
var t$2127 = v$1666;
var t$2128 = SmlPrims.chk_ovf_i32(v$1664 + 1);
var v$1663 = t$2127;
var v$1664 = t$2128;
continue lab$acc;
};
};
};
var acc$1662 = fix$2126.$acc;
t$2129 = (acc$1662(l$980,0));
t$2131 = (t$2130(t$2129,l$980));
t$2132 = t$2131[1];
t$2134 = (t$2133(t$2132));
return t$2134[0];
};
tools$StringFinMap$$2.mergeMap$1102 = function(f$1105,t1$1108,t2$1111){var fix$2135 = {};
fix$2135.$merge = function(v$1132,v$1989){if (v$1132 == null) {return v$1989;
} else {if (v$1989 == null) {return v$1132;
} else {var v$1143 = v$1132;
var v$1144 = v$1143[0];
var v$1145 = v$1144[0];
var v$1146 = v$1144[1];
var v$1147 = v$1143[1];
var v$1148 = v$1989;
var v$1149 = v$1148[0];
var v$1150 = v$1149[0];
var v$1151 = v$1149[1];
var v$1152 = v$1148[1];
return (v$1145 < v$1150)?[[v$1145,v$1146],fix$2135.$merge(v$1147,v$1989)]:((v$1150 < v$1145)?[[v$1150,v$1151],fix$2135.$merge(v$1132,v$1152)]:[[v$1145,f$1105([v$1146,v$1151])],fix$2135.$merge(v$1147,v$1152)]);
};
};
};
var merge$1112 = fix$2135.$merge;
var t$2146 = tools$StringFinMap$$2.fromSortedList$977;
var t$2145;
var t$2144 = merge$1112;
var t$2143;
var fix$2140 = {};
fix$2140.$li = function(v$1853,v$1854){lab$li: while (true) {if (v$1853 == null) {return v$1854;
} else {var v$1855 = v$1853;
var v$1856 = v$1855[0];
var v$1857 = v$1855[1];
var v$1858 = v$1855[2];
var v$1859 = v$1855[3];
var t$2141 = v$1858;
var t$2142 = [[v$1856,v$1857],fix$2140.$li(v$1859,v$1854)];
var v$1853 = t$2141;
var v$1854 = t$2142;
continue lab$li;
};
};
};
var li$1852 = fix$2140.$li;
t$2143 = (li$1852(t1$1108,null));
var t$2139;
var fix$2136 = {};
fix$2136.$li = function(v$1862,v$1863){lab$li: while (true) {if (v$1862 == null) {return v$1863;
} else {var v$1864 = v$1862;
var v$1865 = v$1864[0];
var v$1866 = v$1864[1];
var v$1867 = v$1864[2];
var v$1868 = v$1864[3];
var t$2137 = v$1867;
var t$2138 = [[v$1865,v$1866],fix$2136.$li(v$1868,v$1863)];
var v$1862 = t$2137;
var v$1863 = t$2138;
continue lab$li;
};
};
};
var li$1861 = fix$2136.$li;
t$2139 = (li$1861(t2$1111,null));
t$2145 = (t$2144(t$2143,t$2139));
return t$2146(t$2145);
};
var fix$2147 = {};
fix$2147.$oneForWhich = function(f$1156,t$1159){lab$oneForWhich: while (true) {if (t$1159 == null) {return [1];
} else {var v$1179 = t$1159;
var v$1180 = v$1179[0];
var v$1181 = v$1179[1];
var v$1182 = v$1179[2];
var v$1183 = v$1179[3];
if (f$1156([v$1180,v$1181])) {return [0,[v$1180,v$1181]];
} else {var v$1176 = fix$2147.$oneForWhich(f$1156,v$1182);
switch (v$1176[0]) { case 0: {var v$1178 = v$1176[1];
return [0,v$1178];
 break; }default: {var t$2148 = f$1156;
var t$2149 = v$1183;
var f$1156 = t$2148;
var t$1159 = t$2149;
continue lab$oneForWhich;
} };
};
};
};
};
tools$StringFinMap$$2.oneForWhich$1153 = fix$2147.$oneForWhich;
tools$StringFinMap$$2.en$Restrict$1184 = new String("Restrict");
tools$StringFinMap$$2.restrict$1185 = function(v$1204,v$1205,v$1206){var fix$2150 = {};
fix$2150.$foldl = function(v$1673,v$1674){if (v$1674 == null) {return v$1673;
} else {var v$1675 = v$1674;
var v$1676 = v$1675[0];
var v$1677 = v$1675[1];
var t$2155 = fix$2150.$foldl;
var t$2154;
var v$1881;
var fix$2151 = {};
fix$2151.$search = function(v$1885){lab$search: while (true) {if (v$1885 == null) {return [1];
} else {var v$1886 = v$1885;
var v$1887 = v$1886[0];
var v$1888 = v$1886[1];
var v$1889 = v$1886[2];
var v$1890 = v$1886[3];
if (v$1676 < v$1887) {var t$2152 = v$1889;
var v$1885 = t$2152;
continue lab$search;
} else {if (v$1887 < v$1676) {var t$2153 = v$1890;
var v$1885 = t$2153;
continue lab$search;
} else {return [0,v$1888];
};
};
};
};
};
var search$1884 = fix$2151.$search;
v$1881 = (search$1884(v$1205));
switch (v$1881[0]) { case 0: {var v$1891 = v$1881[1];
t$2154 = (tools$StringFinMap$$2.add$392(v$1676,v$1891,v$1673));
 break; }default: {throw [tools$StringFinMap$$2.en$Restrict$1184,v$1204(v$1676)];
} };
return t$2155(t$2154,v$1677);
};
};
var foldl$1672 = fix$2150.$foldl;
return foldl$1672(tools$StringFinMap$$2.empty$116(0),v$1206);
};
tools$StringFinMap$$2.enrich$1207 = function(en$1210,v$1214){var v$1235 = v$1214[0];
var v$1236 = v$1214[1];
var fix$2156 = {};
fix$2156.$fold$ = function(v$1896,v$1897){if (v$1896 == null) {return v$1897;
} else {var v$1898 = v$1896;
var v$1899 = v$1898[0];
var v$1900 = v$1898[1];
var v$1901 = v$1898[2];
var v$1902 = v$1898[3];
var t$2162 = fix$2156.$fold$;
var t$2161 = v$1902;
var t$2160;
if (fix$2156.$fold$(v$1901,v$1897)) {var v$1965;
var fix$2157 = {};
fix$2157.$search = function(v$1967){lab$search: while (true) {if (v$1967 == null) {return [1];
} else {var v$1968 = v$1967;
var v$1969 = v$1968[0];
var v$1970 = v$1968[1];
var v$1971 = v$1968[2];
var v$1972 = v$1968[3];
if (v$1899 < v$1969) {var t$2158 = v$1971;
var v$1967 = t$2158;
continue lab$search;
} else {if (v$1969 < v$1899) {var t$2159 = v$1972;
var v$1967 = t$2159;
continue lab$search;
} else {return [0,v$1970];
};
};
};
};
};
var search$1966 = fix$2157.$search;
v$1965 = (search$1966(v$1235));
switch (v$1965[0]) { case 0: {var v$1973 = v$1965[1];
t$2160 = (en$1210([v$1973,v$1900]));
 break; }default: {t$2160 = false;
} };
} else {t$2160 = false;
};
return t$2162(t$2161,t$2160);
};
};
var fold$$1895 = fix$2156.$fold$;
return fold$$1895(v$1236,true);
};
tools$StringFinMap$$2.layoutMap$1237 = function(v$1270,v$1272,v$1271,v$1269){return function(layoutDom$1246){return function(layoutRan$1249){return function(m$1252){var t$2170;
var t$2166;
var l$1679;
var fix$2163 = {};
fix$2163.$li = function(v$1914,v$1915){lab$li: while (true) {if (v$1914 == null) {return v$1915;
} else {var v$1916 = v$1914;
var v$1917 = v$1916[0];
var v$1918 = v$1916[1];
var v$1919 = v$1916[2];
var v$1920 = v$1916[3];
var t$2164 = v$1919;
var t$2165 = [[v$1917,v$1918],fix$2163.$li(v$1920,v$1915)];
var v$1914 = t$2164;
var v$1915 = t$2165;
continue lab$li;
};
};
};
var li$1913 = fix$2163.$li;
l$1679 = (li$1913(m$1252,null));
var fix$2167 = {};
fix$2167.$map = function(v$1681){if (v$1681 == null) {return null;
} else {var v$1682 = v$1681;
var v$1683 = v$1682[0];
var v$1684 = v$1682[1];
var t$2169;
var t$2168;
var v$1922 = v$1683[0];
var v$1923 = v$1683[1];
t$2168 = [0,[[layoutDom$1246(v$1922),[layoutRan$1249(v$1923),null]],[0,v$1270],"",3,""]];
t$2169 = [t$2168,fix$2167.$map(v$1684)];
return t$2169;
};
};
var map$1680 = fix$2167.$map;
t$2166 = (map$1680(l$1679));
t$2170 = [t$2166,[0,v$1271],v$1272,3,v$1269];
return [0,t$2170];
};
};
};
};
tools$StringFinMap$$2.reportMap$1273 = function(f$1276,t$1279){var t$2176 = tools$Report$.flatten$78;
var t$2174;
var l$1686;
var fix$2171 = {};
fix$2171.$li = function(v$1926,v$1927){lab$li: while (true) {if (v$1926 == null) {return v$1927;
} else {var v$1928 = v$1926;
var v$1929 = v$1928[0];
var v$1930 = v$1928[1];
var v$1931 = v$1928[2];
var v$1932 = v$1928[3];
var t$2172 = v$1931;
var t$2173 = [[v$1929,v$1930],fix$2171.$li(v$1932,v$1927)];
var v$1926 = t$2172;
var v$1927 = t$2173;
continue lab$li;
};
};
};
var li$1925 = fix$2171.$li;
l$1686 = (li$1925(t$1279,null));
var fix$2175 = {};
fix$2175.$map = function(v$1688){if (v$1688 == null) {return null;
} else {var v$1689 = v$1688;
var v$1690 = v$1689[0];
var v$1691 = v$1689[1];
return [f$1276(v$1690),fix$2175.$map(v$1691)];
};
};
var map$1687 = fix$2175.$map;
t$2174 = (map$1687(l$1686));
return t$2176(t$2174);
};
tools$StringFinMap$$2.reportMapSORTED$1280 = function(f$1692,t$1693){var t$2182 = tools$Report$.flatten$78;
var t$2180;
var l$1695;
var fix$2177 = {};
fix$2177.$li = function(v$1935,v$1936){lab$li: while (true) {if (v$1935 == null) {return v$1936;
} else {var v$1937 = v$1935;
var v$1938 = v$1937[0];
var v$1939 = v$1937[1];
var v$1940 = v$1937[2];
var v$1941 = v$1937[3];
var t$2178 = v$1940;
var t$2179 = [[v$1938,v$1939],fix$2177.$li(v$1941,v$1936)];
var v$1935 = t$2178;
var v$1936 = t$2179;
continue lab$li;
};
};
};
var li$1934 = fix$2177.$li;
l$1695 = (li$1934(t$1693,null));
var fix$2181 = {};
fix$2181.$map = function(v$1697){if (v$1697 == null) {return null;
} else {var v$1698 = v$1697;
var v$1699 = v$1698[0];
var v$1700 = v$1698[1];
return [f$1692(v$1699),fix$2181.$map(v$1700)];
};
};
var map$1696 = fix$2181.$map;
t$2180 = (map$1696(l$1695));
return t$2182(t$2180);
};
tools$StringFinMap$$2.pu_bal$1281 = pickle$pickle$.enumGen$2149(function(v$1701){var v$1702 = v$1701[0];
var v$1703 = v$1701[1];
switch (v$1702) { case 0: {switch (v$1703) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1703) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1703) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
},["OrderFinMap.bal",[1,[2,[0,null]]]]);
tools$StringFinMap$$2.pu$1282 = function(pu_dom$1285,pu_r$1288){var fun_E$1297;
var v$1992 = null;
fun_E$1297 = (function(v$1993){return pickle$pickle$.con0$1979(v$1992,v$1993);
});
return pickle$pickle$.dataGen$1479(["OrderFinMap.map",function(v$1706){return (v$1706 == null)?0:1;
},[fun_E$1297,[function(pu$1707){return pickle$pickle$.con1$2005(function(v$1708){var v$1709 = v$1708[0];
return [v$1709[0],v$1709[1],v$1709[2],v$1709[3],v$1708[1]];
},function(v$1710){if (v$1710 == null) {return tools$Crash$.impossible$50("OrderFinMap.pu.fun_N");
} else {var v$1711 = v$1710;
return [[v$1711[0],v$1711[1],v$1711[2],v$1711[3]],v$1711[4]];
};
},pickle$pickle$.pairGen0$974(pickle$pickle$.tup4Gen0$2368(pu_dom$1285,pu_r$1288,pu$1707,pu$1707),tools$StringFinMap$$2.pu_bal$1281));
},null]]]);
};
return 0;
})();
