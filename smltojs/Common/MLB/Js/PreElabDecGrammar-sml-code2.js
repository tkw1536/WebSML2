if ((typeof(basics$PreElabDecGrammar$$2)) == "undefined") {basics$PreElabDecGrammar$$2 = {};
};
(function(){basics$PreElabDecGrammar$$2.eq_op_opt$2932 = function(v$2936,v$2933){var v$2934 = v$2933[0];
var v$2935 = v$2933[1];
switch (v$2935[0]) { case 0: {var v$2937 = v$2934[1];
var v$2938 = v$2935[1];
return (v$2936([v$2937[0],v$2938[0]]))?(v$2937[1] == v$2938[1]):false;
 break; }default: {return false;
} };
};
basics$PreElabDecGrammar$$2.eq_opid$2941 = function(v$2943,v$2944){switch (v$2944[0]) { case 0: {var v$2945 = v$2943[1];
var v$2946 = v$2944[1];
return (syntax_objects$Ident$.eq_longid$244(v$2945[0],v$2946[0]))?(v$2945[1] == v$2946[1]):false;
 break; }default: {return false;
} };
};
basics$PreElabDecGrammar$$2.bogus_info$137 = basics$PreElabDecGrammar$$1.bogus_info$65;
basics$PreElabDecGrammar$$2.strip_info$140 = function(v$143){return v$143[1][1];
};
basics$PreElabDecGrammar$$2.get_info_ty$208 = function(obj$640){switch (obj$640[0]) { case 0: {return obj$640[1][0];
 break; }case 1: {return obj$640[1][0];
 break; }case 4: {return obj$640[1][0];
 break; }case 3: {return obj$640[1][0];
 break; }default: {return obj$640[1][0];
} };
};
basics$PreElabDecGrammar$$2.get_info_patrow$209 = function(obj$624){switch (obj$624[0]) { case 1: {return obj$624[1];
 break; }default: {return obj$624[1][0];
} };
};
basics$PreElabDecGrammar$$2.get_info_atpat$210 = function(obj$581){switch (obj$581[0]) { case 0: {return obj$581[1];
 break; }case 1: {return obj$581[1][0];
 break; }case 4: {return obj$581[1][0];
 break; }case 2: {return obj$581[1][0];
 break; }default: {return obj$581[1][0];
} };
};
basics$PreElabDecGrammar$$2.get_info_pat$211 = function(obj$534){switch (obj$534[0]) { case 4: {return obj$534[1][0];
 break; }case 3: {return obj$534[1][0];
 break; }case 1: {return obj$534[1][0];
 break; }case 2: {return obj$534[1][0];
 break; }default: {return obj$534[1][0];
} };
};
basics$PreElabDecGrammar$$2.get_info_conbind$212 = function(obj$523){return obj$523[1][0];
};
basics$PreElabDecGrammar$$2.get_info_datbind$213 = function(obj$512){return obj$512[1][0];
};
basics$PreElabDecGrammar$$2.get_info_valbind$214 = function(obj$492){switch (obj$492[0]) { case 1: {return obj$492[1][0];
 break; }default: {return obj$492[1][0];
} };
};
basics$PreElabDecGrammar$$2.get_info_dec$215 = function(obj$368){switch (obj$368[0]) { case 0: {return obj$368[1][0];
 break; }case 1: {return obj$368[1][0];
 break; }case 2: {return obj$368[1][0];
 break; }case 11: {return obj$368[1][0];
 break; }case 12: {return obj$368[1][0];
 break; }case 13: {return obj$368[1][0];
 break; }case 9: {return obj$368[1][0];
 break; }case 6: {return obj$368[1][0];
 break; }case 4: {return obj$368[1][0];
 break; }case 3: {return obj$368[1][0];
 break; }case 7: {return obj$368[1][0];
 break; }case 8: {return obj$368[1][0];
 break; }case 5: {return obj$368[1][0];
 break; }default: {return obj$368[1];
} };
};
basics$PreElabDecGrammar$$2.get_info_mrule$216 = function(obj$357){return obj$357[1][0];
};
basics$PreElabDecGrammar$$2.get_info_match$217 = function(obj$346){return obj$346[1][0];
};
basics$PreElabDecGrammar$$2.get_info_exp$218 = function(obj$281){switch (obj$281[0]) { case 5: {return obj$281[1][0];
 break; }case 6: {return obj$281[1][0];
 break; }case 1: {return obj$281[1][0];
 break; }case 3: {return obj$281[1][0];
 break; }case 2: {return obj$281[1][0];
 break; }case 4: {return obj$281[1][0];
 break; }default: {return obj$281[1][0];
} };
};
basics$PreElabDecGrammar$$2.get_info_exprow$219 = function(obj$270){return obj$270[1][0];
};
basics$PreElabDecGrammar$$2.get_info_atexp$220 = function(obj$223){switch (obj$223[0]) { case 0: {return obj$223[1][0];
 break; }case 4: {return obj$223[1][0];
 break; }case 1: {return obj$223[1][0];
 break; }case 3: {return obj$223[1][0];
 break; }default: {return obj$223[1][0];
} };
};
basics$PreElabDecGrammar$$2.get_info_typbind$685 = function(v$688){return v$688[1][0];
};
basics$PreElabDecGrammar$$2.get_info_tyrow$702 = function(v$705){return v$705[1][0];
};
basics$PreElabDecGrammar$$2.get_info_exbind$717 = function(v$720){switch (v$720[0]) { case 1: {return v$720[1][0];
 break; }default: {return v$720[1][0];
} };
};
basics$PreElabDecGrammar$$2.get_info_FValBind$744 = function(v$747){return v$747[1][0];
};
basics$PreElabDecGrammar$$2.get_info_FClause$757 = function(v$760){return v$760[1][0];
};
var fix$3419 = {};
fix$3419.$map_ty_info = function(f$1438,ty$1441){switch (ty$1441[0]) { case 0: {var v$1479 = ty$1441[1];
var v$1480 = v$1479[0];
var v$1481 = v$1479[1];
return [0,[f$1438(v$1480),v$1481]];
 break; }case 1: {var v$1475 = ty$1441[1];
var v$1476 = v$1475[0];
var v$1477 = v$1475[1];
var t$3667;
var t$3666 = f$1438(v$1476);
var t$3665;
switch (v$1477[0]) { case 1: {t$3665 = [1];
 break; }default: {var v$2954 = v$1477[1];
t$3665 = [0,fix$3419.$map_tyrow_info(f$1438,v$2954)];
} };
t$3667 = [t$3666,t$3665];
return [1,t$3667];
 break; }case 4: {var v$1470 = ty$1441[1];
var v$1471 = v$1470[0];
var v$1472 = v$1470[1];
var v$1473 = v$1470[2];
var t$3664;
var t$3663 = f$1438(v$1471);
var t$3662;
var fix$3661 = {};
fix$3661.$map = function(v$2958){if (v$2958 == null) {return null;
} else {var v$2959 = v$2958;
var v$2960 = v$2959[0];
var v$2961 = v$2959[1];
return [fix$3419.$map_ty_info(f$1438,v$2960),fix$3661.$map(v$2961)];
};
};
var map$2957 = fix$3661.$map;
t$3662 = (map$2957(v$1472));
t$3664 = [t$3663,t$3662,v$1473];
return [4,t$3664];
 break; }case 3: {var v$1465 = ty$1441[1];
var v$1466 = v$1465[0];
var v$1467 = v$1465[1];
var v$1468 = v$1465[2];
return [3,[f$1438(v$1466),fix$3419.$map_ty_info(f$1438,v$1467),fix$3419.$map_ty_info(f$1438,v$1468)]];
 break; }default: {var v$1482 = ty$1441[1];
var v$1483 = v$1482[0];
var v$1484 = v$1482[1];
return [2,[f$1438(v$1483),fix$3419.$map_ty_info(f$1438,v$1484)]];
} };
};
fix$3419.$map_tyrow_info = function(f$1487,v$1490){var v$1500 = v$1490[1];
var v$1501 = v$1500[0];
var v$1502 = v$1500[1];
var v$1503 = v$1500[2];
var v$1504 = v$1500[3];
var t$3660;
var t$3659 = f$1487(v$1501);
var t$3658 = v$1502;
var t$3657 = fix$3419.$map_ty_info(f$1487,v$1503);
var t$3656;
switch (v$1504[0]) { case 1: {t$3656 = [1];
 break; }default: {var v$2951 = v$1504[1];
t$3656 = [0,fix$3419.$map_tyrow_info(f$1487,v$2951)];
} };
t$3660 = [t$3659,t$3658,t$3657,t$3656];
return [0,t$3660];
};
basics$PreElabDecGrammar$$2.map_ty_info$788 = fix$3419.$map_ty_info;
basics$PreElabDecGrammar$$2.map_tyrow_info$787 = fix$3419.$map_tyrow_info;
var fix$3420 = {};
fix$3420.$map_patrow_info = function(f$1354,patrow$1357){switch (patrow$1357[0]) { case 1: {var v$1373 = patrow$1357[1];
return [1,f$1354(v$1373)];
 break; }default: {var v$1374 = patrow$1357[1];
var v$1375 = v$1374[3];
switch (v$1375[0]) { case 1: {var v$1376 = v$1374[0];
var v$1377 = v$1374[1];
var v$1378 = v$1374[2];
return [0,[f$1354(v$1376),v$1377,fix$3420.$map_pat_info(f$1354,v$1378),[1]]];
 break; }default: {var v$1379 = v$1374[0];
var v$1380 = v$1374[1];
var v$1381 = v$1374[2];
var v$1382 = v$1375[1];
return [0,[f$1354(v$1379),v$1380,fix$3420.$map_pat_info(f$1354,v$1381),[0,fix$3420.$map_patrow_info(f$1354,v$1382)]]];
} };
} };
};
fix$3420.$map_atpat_info = function(f$1307,atpat$1310){switch (atpat$1310[0]) { case 0: {var v$1348 = atpat$1310[1];
return [0,f$1307(v$1348)];
 break; }case 1: {var v$1344 = atpat$1310[1];
var v$1345 = v$1344[0];
var v$1346 = v$1344[1];
return [1,[f$1307(v$1345),v$1346]];
 break; }case 4: {var v$1340 = atpat$1310[1];
var v$1341 = v$1340[0];
var v$1342 = v$1340[1];
return [4,[f$1307(v$1341),v$1342]];
 break; }case 2: {var v$1334 = atpat$1310[1];
var v$1335 = v$1334[1];
switch (v$1335[0]) { case 1: {var v$1336 = v$1334[0];
return [2,[f$1307(v$1336),[1]]];
 break; }default: {var v$1337 = v$1334[0];
var v$1338 = v$1335[1];
return [2,[f$1307(v$1337),[0,fix$3420.$map_patrow_info(f$1307,v$1338)]]];
} };
 break; }default: {var v$1349 = atpat$1310[1];
var v$1350 = v$1349[0];
var v$1351 = v$1349[1];
return [3,[f$1307(v$1350),fix$3420.$map_pat_info(f$1307,v$1351)]];
} };
};
fix$3420.$map_pat_info = function(f$1385,pat$1388){switch (pat$1388[0]) { case 4: {var v$1430 = pat$1388[1];
var v$1431 = v$1430[0];
var v$1432 = v$1430[1];
return [4,[f$1385(v$1431),fix$3420.$map_atpat_info(f$1385,v$1432)]];
 break; }case 3: {var v$1425 = pat$1388[1];
var v$1426 = v$1425[0];
var v$1427 = v$1425[1];
var v$1428 = v$1425[2];
return [3,[f$1385(v$1426),v$1427,fix$3420.$map_atpat_info(f$1385,v$1428)]];
 break; }case 1: {var v$1420 = pat$1388[1];
var v$1421 = v$1420[0];
var v$1422 = v$1420[1];
var v$1423 = v$1420[2];
return [1,[f$1385(v$1421),fix$3420.$map_pat_info(f$1385,v$1422),basics$PreElabDecGrammar$$2.map_ty_info$788(f$1385,v$1423)]];
 break; }case 2: {var v$1414 = pat$1388[1];
var v$1415 = v$1414[0];
var v$1416 = v$1414[1];
var v$1417 = v$1414[2];
var v$1418 = v$1414[3];
var t$3651;
var t$3650 = f$1385(v$1415);
var t$3649 = v$1416;
var t$3648;
switch (v$1417[0]) { case 1: {t$3648 = [1];
 break; }default: {var v$2964 = v$1417[1];
t$3648 = [0,basics$PreElabDecGrammar$$2.map_ty_info$788(f$1385,v$2964)];
} };
t$3651 = [t$3650,t$3649,t$3648,fix$3420.$map_pat_info(f$1385,v$1418)];
return [2,t$3651];
 break; }default: {var v$1433 = pat$1388[1];
var v$1434 = v$1433[0];
var v$1435 = v$1433[1];
var t$3655;
var t$3654 = f$1385(v$1434);
var t$3653;
var fix$3652 = {};
fix$3652.$map = function(v$2968){if (v$2968 == null) {return null;
} else {var v$2969 = v$2968;
var v$2970 = v$2969[0];
var v$2971 = v$2969[1];
return [fix$3420.$map_atpat_info(f$1385,v$2970),fix$3652.$map(v$2971)];
};
};
var map$2967 = fix$3652.$map;
t$3653 = (map$2967(v$1435));
t$3655 = [t$3654,t$3653];
return [0,t$3655];
} };
};
basics$PreElabDecGrammar$$2.map_patrow_info$790 = fix$3420.$map_patrow_info;
basics$PreElabDecGrammar$$2.map_atpat_info$791 = fix$3420.$map_atpat_info;
basics$PreElabDecGrammar$$2.map_pat_info$789 = fix$3420.$map_pat_info;
var fix$3421 = {};
fix$3421.$map_exbind_info = function(f$1278,exbind$1281){switch (exbind$1281[0]) { case 1: {var v$1295 = exbind$1281[1];
var v$1296 = v$1295[0];
var v$1297 = v$1295[1];
var v$1298 = v$1295[2];
var v$1299 = v$1295[3];
var t$3642;
var t$3641 = f$1278(v$1296);
var t$3640 = v$1297;
var t$3639;
switch (v$1298[0]) { case 1: {t$3639 = [1];
 break; }default: {var v$2974 = v$1298[1];
t$3639 = [0,basics$PreElabDecGrammar$$2.map_ty_info$788(f$1278,v$2974)];
} };
var t$3638;
switch (v$1299[0]) { case 1: {t$3638 = [1];
 break; }default: {var v$2977 = v$1299[1];
t$3638 = [0,fix$3421.$map_exbind_info(f$1278,v$2977)];
} };
t$3642 = [t$3641,t$3640,t$3639,t$3638];
return [1,t$3642];
 break; }default: {var v$1300 = exbind$1281[1];
var v$1301 = v$1300[0];
var v$1302 = v$1300[1];
var v$1303 = v$1300[2];
var v$1304 = v$1300[3];
var t$3647;
var t$3646 = f$1278(v$1301);
var t$3645 = v$1302;
var t$3644 = v$1303;
var t$3643;
switch (v$1304[0]) { case 1: {t$3643 = [1];
 break; }default: {var v$2980 = v$1304[1];
t$3643 = [0,fix$3421.$map_exbind_info(f$1278,v$2980)];
} };
t$3647 = [t$3646,t$3645,t$3644,t$3643];
return [0,t$3647];
} };
};
basics$PreElabDecGrammar$$2.map_exbind_info$792 = fix$3421.$map_exbind_info;
var fix$3422 = {};
fix$3422.$map_conbind_info = function(f$1258,v$1261){var v$1271 = v$1261[1];
var v$1272 = v$1271[0];
var v$1273 = v$1271[1];
var v$1274 = v$1271[2];
var v$1275 = v$1271[3];
var t$3637;
var t$3636 = f$1258(v$1272);
var t$3635 = v$1273;
var t$3634;
switch (v$1274[0]) { case 1: {t$3634 = [1];
 break; }default: {var v$2983 = v$1274[1];
t$3634 = [0,basics$PreElabDecGrammar$$2.map_ty_info$788(f$1258,v$2983)];
} };
var t$3633;
switch (v$1275[0]) { case 1: {t$3633 = [1];
 break; }default: {var v$2986 = v$1275[1];
t$3633 = [0,fix$3422.$map_conbind_info(f$1258,v$2986)];
} };
t$3637 = [t$3636,t$3635,t$3634,t$3633];
return [0,t$3637];
};
basics$PreElabDecGrammar$$2.map_conbind_info$793 = fix$3422.$map_conbind_info;
var fix$3423 = {};
fix$3423.$map_datbind_info = function(f$1236,v$1239){var v$1250 = v$1239[1];
var v$1251 = v$1250[0];
var v$1252 = v$1250[1];
var v$1253 = v$1250[2];
var v$1254 = v$1250[3];
var v$1255 = v$1250[4];
var t$3632;
var t$3631 = f$1236(v$1251);
var t$3630 = v$1252;
var t$3629 = v$1253;
var t$3623;
var fix$3622 = {};
fix$3622.$map_conbind_info = function(v$3295){var v$3296 = v$3295[1];
var v$3297 = v$3296[0];
var v$3298 = v$3296[1];
var v$3299 = v$3296[2];
var v$3300 = v$3296[3];
var t$3628;
var t$3627 = f$1236(v$3297);
var t$3626 = v$3298;
var t$3625;
switch (v$3299[0]) { case 1: {t$3625 = [1];
 break; }default: {var v$3302 = v$3299[1];
t$3625 = [0,basics$PreElabDecGrammar$$2.map_ty_info$788(f$1236,v$3302)];
} };
var t$3624;
switch (v$3300[0]) { case 1: {t$3624 = [1];
 break; }default: {var v$3304 = v$3300[1];
t$3624 = [0,fix$3622.$map_conbind_info(v$3304)];
} };
t$3628 = [t$3627,t$3626,t$3625,t$3624];
return [0,t$3628];
};
var map_conbind_info$3294 = fix$3622.$map_conbind_info;
t$3623 = (map_conbind_info$3294(v$1254));
var t$3621;
switch (v$1255[0]) { case 1: {t$3621 = [1];
 break; }default: {var v$2989 = v$1255[1];
t$3621 = [0,fix$3423.$map_datbind_info(f$1236,v$2989)];
} };
t$3632 = [t$3631,t$3630,t$3629,t$3623,t$3621];
return [0,t$3632];
};
basics$PreElabDecGrammar$$2.map_datbind_info$794 = fix$3423.$map_datbind_info;
var fix$3424 = {};
fix$3424.$map_typbind_info = function(f$1214,v$1217){var v$1228 = v$1217[1];
var v$1229 = v$1228[0];
var v$1230 = v$1228[1];
var v$1231 = v$1228[2];
var v$1232 = v$1228[3];
var v$1233 = v$1228[4];
var t$3620;
var t$3619 = f$1214(v$1229);
var t$3618 = v$1230;
var t$3617 = v$1231;
var t$3616 = basics$PreElabDecGrammar$$2.map_ty_info$788(f$1214,v$1232);
var t$3615;
switch (v$1233[0]) { case 1: {t$3615 = [1];
 break; }default: {var v$2992 = v$1233[1];
t$3615 = [0,fix$3424.$map_typbind_info(f$1214,v$2992)];
} };
t$3620 = [t$3619,t$3618,t$3617,t$3616,t$3615];
return [0,t$3620];
};
basics$PreElabDecGrammar$$2.map_typbind_info$795 = fix$3424.$map_typbind_info;
var fix$3425 = {};
fix$3425.$map_exprow_info = function(f$859,exprow$862){var v$874 = exprow$862[1];
var v$875 = v$874[3];
switch (v$875[0]) { case 1: {var v$876 = v$874[0];
var v$877 = v$874[1];
var v$878 = v$874[2];
return [0,[f$859(v$876),v$877,fix$3425.$map_exp_info(f$859,v$878),[1]]];
 break; }default: {var v$879 = v$874[0];
var v$880 = v$874[1];
var v$881 = v$874[2];
var v$882 = v$875[1];
return [0,[f$859(v$879),v$880,fix$3425.$map_exp_info(f$859,v$881),[0,fix$3425.$map_exprow_info(f$859,v$882)]]];
} };
};
fix$3425.$map_FClause_info = function(f$1146,v$1149){var v$1172 = v$1149[1];
var v$1173 = v$1172[0];
var v$1174 = v$1172[1];
var v$1175 = v$1172[2];
var v$1176 = v$1172[3];
var v$1177 = v$1172[4];
var t$3614;
var t$3613 = f$1146(v$1173);
var t$3612;
var fix$3611 = {};
fix$3611.$map = function(v$3003){if (v$3003 == null) {return null;
} else {var v$3004 = v$3003;
var v$3005 = v$3004[0];
var v$3006 = v$3004[1];
return [basics$PreElabDecGrammar$$2.map_atpat_info$791(f$1146,v$3005),fix$3611.$map(v$3006)];
};
};
var map$3002 = fix$3611.$map;
t$3612 = (map$3002(v$1174));
var t$3610;
switch (v$1175[0]) { case 1: {t$3610 = [1];
 break; }default: {var v$1163 = v$1175[1];
t$3610 = [0,basics$PreElabDecGrammar$$2.map_ty_info$788(f$1146,v$1163)];
} };
var t$3609 = fix$3425.$map_exp_info(f$1146,v$1176);
var t$3608;
switch (v$1177[0]) { case 1: {t$3608 = [1];
 break; }default: {var v$1169 = v$1177[1];
t$3608 = [0,fix$3425.$map_FClause_info(f$1146,v$1169)];
} };
t$3614 = [t$3613,t$3612,t$3610,t$3609,t$3608];
return [0,t$3614];
};
fix$3425.$map_FValBind_info = function(f$1122,v$1125){var v$1140 = v$1125[1];
var v$1141 = v$1140[0];
var v$1142 = v$1140[1];
var v$1143 = v$1140[2];
var t$3607;
var t$3606 = f$1122(v$1141);
var t$3605 = fix$3425.$map_FClause_info(f$1122,v$1142);
var t$3604;
switch (v$1143[0]) { case 1: {t$3604 = [1];
 break; }default: {var v$1137 = v$1143[1];
t$3604 = [0,fix$3425.$map_FValBind_info(f$1122,v$1137)];
} };
t$3607 = [t$3606,t$3605,t$3604];
return [0,t$3607];
};
fix$3425.$map_dec_info = function(f$992,dec$995){switch (dec$995[0]) { case 0: {var v$1115 = dec$995[1];
var v$1116 = v$1115[0];
var v$1117 = v$1115[1];
var v$1118 = v$1115[2];
return [0,[f$992(v$1116),v$1117,fix$3425.$map_valbind_info(f$992,v$1118)]];
 break; }case 1: {var v$1110 = dec$995[1];
var v$1111 = v$1110[0];
var v$1112 = v$1110[1];
var v$1113 = v$1110[2];
return [1,[f$992(v$1111),v$1112,fix$3425.$map_FValBind_info(f$992,v$1113)]];
 break; }case 2: {var v$1106 = dec$995[1];
var v$1107 = v$1106[0];
var v$1108 = v$1106[1];
var t$3603;
var t$3602 = f$992(v$1107);
var t$3595;
var fix$3594 = {};
fix$3594.$map_typbind_info = function(v$3307){var v$3308 = v$3307[1];
var v$3309 = v$3308[0];
var v$3310 = v$3308[1];
var v$3311 = v$3308[2];
var v$3312 = v$3308[3];
var v$3313 = v$3308[4];
var t$3601;
var t$3600 = f$992(v$3309);
var t$3599 = v$3310;
var t$3598 = v$3311;
var t$3597 = basics$PreElabDecGrammar$$2.map_ty_info$788(f$992,v$3312);
var t$3596;
switch (v$3313[0]) { case 1: {t$3596 = [1];
 break; }default: {var v$3315 = v$3313[1];
t$3596 = [0,fix$3594.$map_typbind_info(v$3315)];
} };
t$3601 = [t$3600,t$3599,t$3598,t$3597,t$3596];
return [0,t$3601];
};
var map_typbind_info$3306 = fix$3594.$map_typbind_info;
t$3595 = (map_typbind_info$3306(v$1108));
t$3603 = [t$3602,t$3595];
return [2,t$3603];
 break; }case 11: {var v$1102 = dec$995[1];
var v$1103 = v$1102[0];
var v$1104 = v$1102[1];
var t$3593;
var t$3592 = f$992(v$1103);
var t$3579;
var fix$3578 = {};
fix$3578.$map_datbind_info = function(v$3318){var v$3319 = v$3318[1];
var v$3320 = v$3319[0];
var v$3321 = v$3319[1];
var v$3322 = v$3319[2];
var v$3323 = v$3319[3];
var v$3324 = v$3319[4];
var t$3591;
var t$3590 = f$992(v$3320);
var t$3589 = v$3321;
var t$3588 = v$3322;
var t$3582;
var fix$3581 = {};
fix$3581.$map_conbind_info = function(v$3329){var v$3330 = v$3329[1];
var v$3331 = v$3330[0];
var v$3332 = v$3330[1];
var v$3333 = v$3330[2];
var v$3334 = v$3330[3];
var t$3587;
var t$3586 = f$992(v$3331);
var t$3585 = v$3332;
var t$3584;
switch (v$3333[0]) { case 1: {t$3584 = [1];
 break; }default: {var v$3336 = v$3333[1];
t$3584 = [0,basics$PreElabDecGrammar$$2.map_ty_info$788(f$992,v$3336)];
} };
var t$3583;
switch (v$3334[0]) { case 1: {t$3583 = [1];
 break; }default: {var v$3338 = v$3334[1];
t$3583 = [0,fix$3581.$map_conbind_info(v$3338)];
} };
t$3587 = [t$3586,t$3585,t$3584,t$3583];
return [0,t$3587];
};
var map_conbind_info$3328 = fix$3581.$map_conbind_info;
t$3582 = (map_conbind_info$3328(v$3323));
var t$3580;
switch (v$3324[0]) { case 1: {t$3580 = [1];
 break; }default: {var v$3326 = v$3324[1];
t$3580 = [0,fix$3578.$map_datbind_info(v$3326)];
} };
t$3591 = [t$3590,t$3589,t$3588,t$3582,t$3580];
return [0,t$3591];
};
var map_datbind_info$3317 = fix$3578.$map_datbind_info;
t$3579 = (map_datbind_info$3317(v$1104));
t$3593 = [t$3592,t$3579];
return [11,t$3593];
 break; }case 12: {var v$1097 = dec$995[1];
var v$1098 = v$1097[0];
var v$1099 = v$1097[1];
var v$1100 = v$1097[2];
return [12,[f$992(v$1098),v$1099,v$1100]];
 break; }case 13: {var v$1092 = dec$995[1];
var v$1093 = v$1092[0];
var v$1094 = v$1092[1];
var v$1095 = v$1092[2];
var t$3577;
var t$3576 = f$992(v$1093);
var t$3563;
var fix$3562 = {};
fix$3562.$map_datbind_info = function(v$3341){var v$3342 = v$3341[1];
var v$3343 = v$3342[0];
var v$3344 = v$3342[1];
var v$3345 = v$3342[2];
var v$3346 = v$3342[3];
var v$3347 = v$3342[4];
var t$3575;
var t$3574 = f$992(v$3343);
var t$3573 = v$3344;
var t$3572 = v$3345;
var t$3566;
var fix$3565 = {};
fix$3565.$map_conbind_info = function(v$3352){var v$3353 = v$3352[1];
var v$3354 = v$3353[0];
var v$3355 = v$3353[1];
var v$3356 = v$3353[2];
var v$3357 = v$3353[3];
var t$3571;
var t$3570 = f$992(v$3354);
var t$3569 = v$3355;
var t$3568;
switch (v$3356[0]) { case 1: {t$3568 = [1];
 break; }default: {var v$3359 = v$3356[1];
t$3568 = [0,basics$PreElabDecGrammar$$2.map_ty_info$788(f$992,v$3359)];
} };
var t$3567;
switch (v$3357[0]) { case 1: {t$3567 = [1];
 break; }default: {var v$3361 = v$3357[1];
t$3567 = [0,fix$3565.$map_conbind_info(v$3361)];
} };
t$3571 = [t$3570,t$3569,t$3568,t$3567];
return [0,t$3571];
};
var map_conbind_info$3351 = fix$3565.$map_conbind_info;
t$3566 = (map_conbind_info$3351(v$3346));
var t$3564;
switch (v$3347[0]) { case 1: {t$3564 = [1];
 break; }default: {var v$3349 = v$3347[1];
t$3564 = [0,fix$3562.$map_datbind_info(v$3349)];
} };
t$3575 = [t$3574,t$3573,t$3572,t$3566,t$3564];
return [0,t$3575];
};
var map_datbind_info$3340 = fix$3562.$map_datbind_info;
t$3563 = (map_datbind_info$3340(v$1094));
t$3577 = [t$3576,t$3563,fix$3425.$map_dec_info(f$992,v$1095)];
return [13,t$3577];
 break; }case 9: {var v$1088 = dec$995[1];
var v$1089 = v$1088[0];
var v$1090 = v$1088[1];
var t$3561;
var t$3560 = f$992(v$1089);
var t$3549;
var fix$3548 = {};
fix$3548.$map_exbind_info = function(exbind$3241){switch (exbind$3241[0]) { case 1: {var v$3242 = exbind$3241[1];
var v$3243 = v$3242[0];
var v$3244 = v$3242[1];
var v$3245 = v$3242[2];
var v$3246 = v$3242[3];
var t$3554;
var t$3553 = f$992(v$3243);
var t$3552 = v$3244;
var t$3551;
switch (v$3245[0]) { case 1: {t$3551 = [1];
 break; }default: {var v$3249 = v$3245[1];
t$3551 = [0,basics$PreElabDecGrammar$$2.map_ty_info$788(f$992,v$3249)];
} };
var t$3550;
switch (v$3246[0]) { case 1: {t$3550 = [1];
 break; }default: {var v$3252 = v$3246[1];
t$3550 = [0,fix$3548.$map_exbind_info(v$3252)];
} };
t$3554 = [t$3553,t$3552,t$3551,t$3550];
return [1,t$3554];
 break; }default: {var v$3253 = exbind$3241[1];
var v$3254 = v$3253[0];
var v$3255 = v$3253[1];
var v$3256 = v$3253[2];
var v$3257 = v$3253[3];
var t$3559;
var t$3558 = f$992(v$3254);
var t$3557 = v$3255;
var t$3556 = v$3256;
var t$3555;
switch (v$3257[0]) { case 1: {t$3555 = [1];
 break; }default: {var v$3260 = v$3257[1];
t$3555 = [0,fix$3548.$map_exbind_info(v$3260)];
} };
t$3559 = [t$3558,t$3557,t$3556,t$3555];
return [0,t$3559];
} };
};
var map_exbind_info$3240 = fix$3548.$map_exbind_info;
t$3549 = (map_exbind_info$3240(v$1090));
t$3561 = [t$3560,t$3549];
return [9,t$3561];
 break; }case 6: {var v$1083 = dec$995[1];
var v$1084 = v$1083[0];
var v$1085 = v$1083[1];
var v$1086 = v$1083[2];
return [6,[f$992(v$1084),fix$3425.$map_dec_info(f$992,v$1085),fix$3425.$map_dec_info(f$992,v$1086)]];
 break; }case 4: {var v$1079 = dec$995[1];
var v$1080 = v$1079[0];
var v$1081 = v$1079[1];
return [4,[f$992(v$1080),v$1081]];
 break; }case 3: {var v$1074 = dec$995[1];
var v$1075 = v$1074[0];
var v$1076 = v$1074[1];
var v$1077 = v$1074[2];
return [3,[f$992(v$1075),fix$3425.$map_dec_info(f$992,v$1076),fix$3425.$map_dec_info(f$992,v$1077)]];
 break; }case 7: {var v$1069 = dec$995[1];
var v$1070 = v$1069[0];
var v$1071 = v$1069[1];
var v$1072 = v$1069[2];
return [7,[f$992(v$1070),v$1071,v$1072]];
 break; }case 8: {var v$1064 = dec$995[1];
var v$1065 = v$1064[0];
var v$1066 = v$1064[1];
var v$1067 = v$1064[2];
return [8,[f$992(v$1065),v$1066,v$1067]];
 break; }case 5: {var v$1060 = dec$995[1];
var v$1061 = v$1060[0];
var v$1062 = v$1060[1];
return [5,[f$992(v$1061),v$1062]];
 break; }default: {var v$1119 = dec$995[1];
return [10,f$992(v$1119)];
} };
};
fix$3425.$map_atexp_info = function(f$807,atexp$810){switch (atexp$810[0]) { case 0: {var v$851 = atexp$810[1];
var v$852 = v$851[0];
var v$853 = v$851[1];
return [0,[f$807(v$852),v$853]];
 break; }case 4: {var v$847 = atexp$810[1];
var v$848 = v$847[0];
var v$849 = v$847[1];
return [4,[f$807(v$848),v$849]];
 break; }case 1: {var v$841 = atexp$810[1];
var v$842 = v$841[1];
switch (v$842[0]) { case 1: {var v$843 = v$841[0];
return [1,[f$807(v$843),[1]]];
 break; }default: {var v$844 = v$841[0];
var v$845 = v$842[1];
return [1,[f$807(v$844),[0,fix$3425.$map_exprow_info(f$807,v$845)]]];
} };
 break; }case 3: {var v$836 = atexp$810[1];
var v$837 = v$836[0];
var v$838 = v$836[1];
var v$839 = v$836[2];
return [3,[f$807(v$837),fix$3425.$map_dec_info(f$807,v$838),fix$3425.$map_exp_info(f$807,v$839)]];
 break; }default: {var v$854 = atexp$810[1];
var v$855 = v$854[0];
var v$856 = v$854[1];
return [2,[f$807(v$855),fix$3425.$map_exp_info(f$807,v$856)]];
} };
};
fix$3425.$map_mrule_info = function(f$974,v$977){var v$986 = v$977[1];
var v$987 = v$986[0];
var v$988 = v$986[1];
var v$989 = v$986[2];
return [0,[f$974(v$987),basics$PreElabDecGrammar$$2.map_pat_info$789(f$974,v$988),fix$3425.$map_exp_info(f$974,v$989)]];
};
fix$3425.$map_match_info = function(f$952,match$955){var v$965 = match$955[1];
var v$966 = v$965[2];
switch (v$966[0]) { case 1: {var v$967 = v$965[0];
var v$968 = v$965[1];
return [0,[f$952(v$967),fix$3425.$map_mrule_info(f$952,v$968),[1]]];
 break; }default: {var v$969 = v$965[0];
var v$970 = v$965[1];
var v$971 = v$966[1];
return [0,[f$952(v$969),fix$3425.$map_mrule_info(f$952,v$970),[0,fix$3425.$map_match_info(f$952,v$971)]]];
} };
};
fix$3425.$map_exp_info = function(f$885,exp$888){switch (exp$888[0]) { case 5: {var v$944 = exp$888[1];
var v$945 = v$944[0];
var v$946 = v$944[1];
return [5,[f$885(v$945),fix$3425.$map_atexp_info(f$885,v$946)]];
 break; }case 6: {var v$939 = exp$888[1];
var v$940 = v$939[0];
var v$941 = v$939[1];
var v$942 = v$939[2];
return [6,[f$885(v$940),fix$3425.$map_exp_info(f$885,v$941),fix$3425.$map_atexp_info(f$885,v$942)]];
 break; }case 1: {var v$934 = exp$888[1];
var v$935 = v$934[0];
var v$936 = v$934[1];
var v$937 = v$934[2];
return [1,[f$885(v$935),fix$3425.$map_exp_info(f$885,v$936),v$937]];
 break; }case 3: {var v$929 = exp$888[1];
var v$930 = v$929[0];
var v$931 = v$929[1];
var v$932 = v$929[2];
return [3,[f$885(v$930),fix$3425.$map_exp_info(f$885,v$931),fix$3425.$map_match_info(f$885,v$932)]];
 break; }case 2: {var v$925 = exp$888[1];
var v$926 = v$925[0];
var v$927 = v$925[1];
return [2,[f$885(v$926),fix$3425.$map_exp_info(f$885,v$927)]];
 break; }case 4: {var v$921 = exp$888[1];
var v$922 = v$921[0];
var v$923 = v$921[1];
return [4,[f$885(v$922),fix$3425.$map_match_info(f$885,v$923)]];
 break; }default: {var v$947 = exp$888[1];
var v$948 = v$947[0];
var v$949 = v$947[1];
var t$3547;
var t$3546 = f$885(v$948);
var t$3545;
var fix$3544 = {};
fix$3544.$map = function(v$2996){if (v$2996 == null) {return null;
} else {var v$2997 = v$2996;
var v$2998 = v$2997[0];
var v$2999 = v$2997[1];
return [fix$3425.$map_atexp_info(f$885,v$2998),fix$3544.$map(v$2999)];
};
};
var map$2995 = fix$3544.$map;
t$3545 = (map$2995(v$949));
t$3547 = [t$3546,t$3545];
return [0,t$3547];
} };
};
fix$3425.$map_valbind_info = function(f$1180,valbind$1183){switch (valbind$1183[0]) { case 1: {var v$1200 = valbind$1183[1];
var v$1201 = v$1200[3];
switch (v$1201[0]) { case 1: {var v$1202 = v$1200[0];
var v$1203 = v$1200[1];
var v$1204 = v$1200[2];
return [1,[f$1180(v$1202),basics$PreElabDecGrammar$$2.map_pat_info$789(f$1180,v$1203),fix$3425.$map_exp_info(f$1180,v$1204),[1]]];
 break; }default: {var v$1205 = v$1200[0];
var v$1206 = v$1200[1];
var v$1207 = v$1200[2];
var v$1208 = v$1201[1];
return [1,[f$1180(v$1205),basics$PreElabDecGrammar$$2.map_pat_info$789(f$1180,v$1206),fix$3425.$map_exp_info(f$1180,v$1207),[0,fix$3425.$map_valbind_info(f$1180,v$1208)]]];
} };
 break; }default: {var v$1209 = valbind$1183[1];
var v$1210 = v$1209[0];
var v$1211 = v$1209[1];
return [0,[f$1180(v$1210),fix$3425.$map_valbind_info(f$1180,v$1211)]];
} };
};
basics$PreElabDecGrammar$$2.map_exprow_info$803 = fix$3425.$map_exprow_info;
basics$PreElabDecGrammar$$2.map_FClause_info$797 = fix$3425.$map_FClause_info;
basics$PreElabDecGrammar$$2.map_FValBind_info$798 = fix$3425.$map_FValBind_info;
basics$PreElabDecGrammar$$2.map_dec_info$799 = fix$3425.$map_dec_info;
basics$PreElabDecGrammar$$2.map_atexp_info$804 = fix$3425.$map_atexp_info;
basics$PreElabDecGrammar$$2.map_mrule_info$800 = fix$3425.$map_mrule_info;
basics$PreElabDecGrammar$$2.map_match_info$801 = fix$3425.$map_match_info;
basics$PreElabDecGrammar$$2.map_exp_info$802 = fix$3425.$map_exp_info;
basics$PreElabDecGrammar$$2.map_valbind_info$796 = fix$3425.$map_valbind_info;
basics$PreElabDecGrammar$$2.expansive$1505 = function(harmless_con$1508,exp$1511){var fix$3426 = {};
fix$3426.$conexp_exp = function(v$1623){switch (v$1623[0]) { case 5: {var v$1641 = v$1623[1];
var v$1643 = v$1641[1];
return fix$3426.$conexp_atexp(v$1643);
 break; }case 1: {var v$1636 = v$1623[1];
var v$1638 = v$1636[1];
return fix$3426.$conexp_exp(v$1638);
 break; }default: {return false;
} };
};
fix$3426.$conexp_atexp = function(v$1646){switch (v$1646[0]) { case 4: {var v$1663 = v$1646[1];
var v$1665 = v$1663[1];
var v$1666 = v$1665[1];
var v$1667 = v$1666[0];
return harmless_con$1508(v$1667);
 break; }case 2: {var v$1659 = v$1646[1];
var v$1661 = v$1659[1];
return fix$3426.$conexp_exp(v$1661);
 break; }default: {return false;
} };
};
var conexp_exp$1513 = fix$3426.$conexp_exp;
var conexp_atexp$1512 = fix$3426.$conexp_atexp;
var fix$3427 = {};
fix$3427.$nexp_atexp = function(v$1564){switch (v$1564[0]) { case 0: {return true;
 break; }case 4: {return true;
 break; }case 1: {var v$1588 = v$1564[1];
var v$1590 = v$1588[1];
return fix$3427.$nexp_exprow_opt(v$1590);
 break; }case 2: {var v$1584 = v$1564[1];
var v$1586 = v$1584[1];
return fix$3427.$nexp_exp(v$1586);
 break; }default: {return false;
} };
};
fix$3427.$nexp_exp = function(v$1519){switch (v$1519[0]) { case 5: {var v$1559 = v$1519[1];
var v$1561 = v$1559[1];
return fix$3427.$nexp_atexp(v$1561);
 break; }case 6: {var v$1554 = v$1519[1];
var v$1556 = v$1554[1];
var v$1557 = v$1554[2];
if (conexp_exp$1513(v$1556)) {return fix$3427.$nexp_atexp(v$1557);
} else {return false;
};
 break; }case 1: {var v$1545 = v$1519[1];
var v$1547 = v$1545[1];
return fix$3427.$nexp_exp(v$1547);
 break; }case 4: {return true;
 break; }default: {return false;
} };
};
fix$3427.$nexp_exprow_opt = function(v$1601){switch (v$1601[0]) { case 0: {var v$1615 = v$1601[1];
var v$1616 = v$1615[1];
var v$1619 = v$1616[2];
var v$1620 = v$1616[3];
if (fix$3427.$nexp_exp(v$1619)) {return fix$3427.$nexp_exprow_opt(v$1620);
} else {return false;
};
 break; }default: {return true;
} };
};
var nexp_atexp$1515 = fix$3427.$nexp_atexp;
var nexp_exp$1516 = fix$3427.$nexp_exp;
var nexp_exprow_opt$1514 = fix$3427.$nexp_exprow_opt;
return (nexp_exp$1516(exp$1511))?false:true;
};
var fix$3428 = {};
fix$3428.$fTy = function(ty$1674,res$1677){switch (ty$1674[0]) { case 0: {return [ty$1674[1][1],res$1677];
 break; }case 1: {var v$1710 = ty$1674[1];
var v$1711 = v$1710[1];
switch (v$1711[0]) { case 1: {return res$1677;
 break; }default: {var v$1712 = v$1711[1];
return fix$3428.$fTyrow(v$1712,res$1677);
} };
 break; }case 4: {var v$1707 = ty$1674[1];
var v$1708 = v$1707[1];
var fix$3541 = {};
fix$3541.$foldl = function(v$3012,v$3013){lab$foldl: while (true) {if (v$3013 == null) {return v$3012;
} else {var v$3014 = v$3013;
var v$3015 = v$3014[0];
var v$3016 = v$3014[1];
var t$3542 = fix$3428.$fTy(v$3015,v$3012);
var t$3543 = v$3016;
var v$3012 = t$3542;
var v$3013 = t$3543;
continue lab$foldl;
};
};
};
var foldl$3011 = fix$3541.$foldl;
return foldl$3011(res$1677,v$1708);
 break; }case 3: {var v$1697 = ty$1674[1];
var v$1698 = v$1697[1];
var v$1699 = v$1697[2];
return fix$3428.$fTy(v$1698,fix$3428.$fTy(v$1699,res$1677));
 break; }default: {var v$1716 = ty$1674[1];
var v$1717 = v$1716[1];
return fix$3428.$fTy(v$1717,res$1677);
} };
};
fix$3428.$fTyrow = function(v$1720,res$1723){var v$1736 = v$1720[1];
var v$1737 = v$1736[2];
var v$1738 = v$1736[3];
switch (v$1738[0]) { case 1: {return fix$3428.$fTy(v$1737,res$1723);
 break; }default: {var v$1734 = v$1738[1];
return fix$3428.$fTyrow(v$1734,fix$3428.$fTy(v$1737,res$1723));
} };
};
var fTy$1671 = fix$3428.$fTy;
var fTyrow$1670 = fix$3428.$fTyrow;
var fix$3429 = {};
fix$3429.$fConbind = function(v$1742,res$1745){lab$fConbind: while (true) {var v$1765 = v$1742[1];
var v$1766 = v$1765[2];
var v$1767 = v$1765[3];
var res$$1751;
switch (v$1766[0]) { case 1: {res$$1751 = res$1745;
 break; }default: {var v$1757 = v$1766[1];
res$$1751 = (fTy$1671(v$1757,res$1745));
} };
switch (v$1767[0]) { case 1: {return res$$1751;
 break; }default: {var v$1763 = v$1767[1];
var t$3430 = v$1763;
var t$3431 = res$$1751;
var v$1742 = t$3430;
var res$1745 = t$3431;
continue lab$fConbind;
} };
};
};
var fConbind$1669 = fix$3429.$fConbind;
basics$PreElabDecGrammar$$2.getExplicitTyVarsTy$1769 = function(ty$1772){return fTy$1671(ty$1772,null);
};
basics$PreElabDecGrammar$$2.getExplicitTyVarsConbind$1773 = function(ty$1776){return fConbind$1669(ty$1776,null);
};
var fix$3432 = {};
fix$3432.$find_topmost_id_in_pat = function(v$1781){switch (v$1781[0]) { case 4: {var v$1802 = v$1781[1];
var v$1803 = v$1802[1];
return fix$3432.$find_topmost_id_in_atpat(v$1803);
 break; }case 2: {var v$1797 = v$1781[1];
var v$1798 = v$1797[1];
var v$1799 = v$1798[1];
var v$1800 = v$1799[0];
return [0,syntax_objects$Ident$.pr_id$53(v$1800)];
 break; }case 1: {var v$1794 = v$1781[1];
var v$1795 = v$1794[1];
return fix$3432.$find_topmost_id_in_pat(v$1795);
 break; }default: {return [1];
} };
};
fix$3432.$find_topmost_id_in_atpat = function(v$1806){switch (v$1806[0]) { case 4: {var v$1819 = v$1806[1];
var v$1820 = v$1819[1];
var v$1821 = v$1820[1];
var v$1822 = v$1821[0];
return [0,syntax_objects$Ident$.pr_longid$62(v$1822)];
 break; }case 3: {var v$1816 = v$1806[1];
var v$1817 = v$1816[1];
return fix$3432.$find_topmost_id_in_pat(v$1817);
 break; }default: {return [1];
} };
};
basics$PreElabDecGrammar$$2.find_topmost_id_in_pat$1778 = fix$3432.$find_topmost_id_in_pat;
basics$PreElabDecGrammar$$2.find_topmost_id_in_atpat$1777 = fix$3432.$find_topmost_id_in_atpat;
basics$PreElabDecGrammar$$2.is_$true$_$nil$_etc$1823 = function(id$1826){if (syntax_objects$Ident$.eq_id$237(id$1826,syntax_objects$Ident$.id_TRUE$132)) {return true;
} else {if (syntax_objects$Ident$.eq_id$237(id$1826,syntax_objects$Ident$.id_FALSE$133)) {return true;
} else {if (syntax_objects$Ident$.eq_id$237(id$1826,syntax_objects$Ident$.id_NIL$130)) {return true;
} else {if (syntax_objects$Ident$.eq_id$237(id$1826,syntax_objects$Ident$.id_CONS$131)) {return true;
} else {return syntax_objects$Ident$.eq_id$237(id$1826,syntax_objects$Ident$.id_REF$134);
};
};
};
};
};
basics$PreElabDecGrammar$$2.is_$it$$1843 = function(id$1846){return syntax_objects$Ident$.eq_id$237(id$1846,syntax_objects$Ident$.id_IT$137);
};
basics$PreElabDecGrammar$$2.list_from_opt$1847 = function(v$1850){switch (v$1850[0]) { case 0: {return [v$1850[1],null];
 break; }default: {return null;
} };
};
basics$PreElabDecGrammar$$2.INDENT$1858 = 3;
var fix$3433 = {};
fix$3433.$layoutTy = function(ty$2791){switch (ty$2791[0]) { case 0: {var v$2863 = ty$2791[1];
var v$2864 = v$2863[1];
return [1,syntax_objects$SyntaxTyVar$.pr_tyvar$51(v$2864)];
 break; }case 1: {var v$2860 = ty$2791[1];
var v$2861 = v$2860[1];
switch (v$2861[0]) { case 0: {var v$2859 = v$2861[1];
return [0,[[fix$3433.$layoutTyrow(v$2859),null],[1],"}",1,"{"]];
 break; }default: {return [1,"{}"];
} };
 break; }case 4: {var v$2844 = ty$2791[1];
var v$2845 = v$2844[1];
var v$2846 = v$2844[2];
if (v$2845 == null) {return [1,syntax_objects$TyCon$.pr_LongTyCon$62(v$2846)];
} else {var v$2836 = v$2845;
if (v$2836[1] == null) {var v$2838 = v$2836[0];
return [0,[[fix$3433.$layoutTy(v$2838),null],[1]," " + (syntax_objects$TyCon$.pr_LongTyCon$62(v$2846)),0,""]];
} else {var t$3540;
var t$3539;
var t$3538;
var t$3537;
var t$3536;
var t$3535;
var fix$3534 = {};
fix$3534.$map = function(v$3049){if (v$3049 == null) {return null;
} else {var v$3050 = v$3049;
var v$3051 = v$3050[0];
var v$3052 = v$3050[1];
return [fix$3433.$layoutTy(v$3051),fix$3534.$map(v$3052)];
};
};
var map$3048 = fix$3534.$map;
t$3535 = (map$3048(v$2845));
t$3536 = [t$3535,[0,", "],")",1,"("];
t$3537 = [0,t$3536];
t$3538 = [t$3537,null];
t$3539 = t$3538;
t$3540 = [t$3539,[1]," " + (syntax_objects$TyCon$.pr_LongTyCon$62(v$2846)),0,""];
return [0,t$3540];
};
};
 break; }case 3: {var v$2815 = ty$2791[1];
var v$2816 = v$2815[1];
var v$2817 = v$2815[2];
return [0,[[fix$3433.$layoutTy(v$2816),[fix$3433.$layoutTy(v$2817),null]],[2," -> "],"",0,""]];
 break; }default: {var v$2870 = ty$2791[1];
var v$2871 = v$2870[1];
return [0,[[fix$3433.$layoutTy(v$2871),null],[1],")",1,"("]];
} };
};
fix$3433.$layoutTyrow = function(row$2874){var fix$3530 = {};
fix$3530.$treesOfTyrow = function(v$2878){var v$2897 = v$2878[1];
var v$2898 = v$2897[1];
var v$2899 = v$2897[2];
var v$2900 = v$2897[3];
var t$3533;
var t$3532 = [0,[[[1,syntax_objects$Lab$.pr_Lab$94(v$2898)],[fix$3433.$layoutTy(v$2899),null]],[2," : "],"",0,""]];
var t$3531;
switch (v$2900[0]) { case 0: {var v$2896 = v$2900[1];
t$3531 = (fix$3530.$treesOfTyrow(v$2896));
 break; }default: {t$3531 = null;
} };
t$3533 = [t$3532,t$3531];
return t$3533;
};
var treesOfTyrow$2875 = fix$3530.$treesOfTyrow;
return [0,[treesOfTyrow$2875(row$2874),[0,", "],"",0,""]];
};
basics$PreElabDecGrammar$$2.layoutTy$1860 = fix$3433.$layoutTy;
basics$PreElabDecGrammar$$2.layoutTyrow$1859 = fix$3433.$layoutTyrow;
var fix$3434 = {};
fix$3434.$layoutPatrow = function(row$2661){var fix$3526 = {};
fix$3526.$treesOfPatrow = function(row$2665){switch (row$2665[0]) { case 1: {return [[1,"..."],null];
 break; }default: {var v$2687 = row$2665[1];
var v$2688 = v$2687[1];
var v$2689 = v$2687[2];
var v$2690 = v$2687[3];
var t$3529;
var t$3528 = [0,[[[1,syntax_objects$Lab$.pr_Lab$94(v$2688)],[fix$3434.$layoutPat(v$2689),null]],[0," = "],"",0,""]];
var t$3527;
switch (v$2690[0]) { case 0: {var v$2686 = v$2690[1];
t$3527 = (fix$3526.$treesOfPatrow(v$2686));
 break; }default: {t$3527 = null;
} };
t$3529 = [t$3528,t$3527];
return t$3529;
} };
};
var treesOfPatrow$2662 = fix$3526.$treesOfPatrow;
return [0,[treesOfPatrow$2662(row$2661),[0,", "],"",0,""]];
};
fix$3434.$layoutAtpat = function(atpat$2607){switch (atpat$2607[0]) { case 0: {return [1,"_"];
 break; }case 1: {var v$2649 = atpat$2607[1];
var v$2650 = v$2649[1];
return [1,syntax_objects$SCon$.pr_scon$131(v$2650)];
 break; }case 4: {var v$2643 = atpat$2607[1];
var v$2644 = v$2643[1];
var v$2645 = v$2644[1];
var v$2646 = v$2645[0];
var v$2647 = v$2645[1];
return [1,(v$2647?"op ":"") + (syntax_objects$Ident$.pr_longid$62(v$2646))];
 break; }case 2: {var v$2636 = atpat$2607[1];
var v$2637 = v$2636[1];
switch (v$2637[0]) { case 0: {var v$2635 = v$2637[1];
return [0,[[fix$3434.$layoutPatrow(v$2635),null],[1],"}",1,"{"]];
 break; }default: {return [1,"{}"];
} };
 break; }default: {var v$2657 = atpat$2607[1];
var v$2658 = v$2657[1];
return [0,[[fix$3434.$layoutPat(v$2658),null],[1],")",1,"("]];
} };
};
fix$3434.$layoutPat = function(pat$2698){switch (pat$2698[0]) { case 4: {var v$2780 = pat$2698[1];
var v$2781 = v$2780[1];
return fix$3434.$layoutAtpat(v$2781);
 break; }case 3: {var v$2773 = pat$2698[1];
var v$2774 = v$2773[1];
var v$2775 = v$2774[1];
var v$2776 = v$2775[0];
var v$2777 = v$2775[1];
var v$2778 = v$2773[2];
var t$3522;
var v$2768 = ((v$2777?"op ":"") + (syntax_objects$Ident$.pr_longid$62(v$2776))) + " ";
t$3522 = [[fix$3434.$layoutAtpat(v$2778),null],[1],"",3,v$2768];
return [0,t$3522];
 break; }case 1: {var v$2760 = pat$2698[1];
var v$2761 = v$2760[1];
var v$2762 = v$2760[2];
return [0,[[fix$3434.$layoutPat(v$2761),[basics$PreElabDecGrammar$$2.layoutTy$1860(v$2762),null]],[2," : "],"",0,""]];
 break; }case 2: {var v$2745 = pat$2698[1];
var v$2746 = v$2745[1];
var v$2747 = v$2746[1];
var v$2748 = v$2747[0];
var v$2749 = v$2747[1];
var v$2750 = v$2745[2];
var v$2751 = v$2745[3];
var idT$2721 = [1,(v$2749?"op ":"") + (syntax_objects$Ident$.pr_id$53(v$2748))];
var t$3521;
var t$3520;
var t$3519;
var t$3518;
switch (v$2750[0]) { case 0: {var v$2738 = v$2750[1];
t$3518 = [0,[[idT$2721,[basics$PreElabDecGrammar$$2.layoutTy$1860(v$2738),null]],[2," : "],"",0,""]];
 break; }default: {t$3518 = idT$2721;
} };
t$3519 = [t$3518,[fix$3434.$layoutPat(v$2751),null]];
t$3520 = t$3519;
t$3521 = [t$3520,[2," as "],"",0,""];
return [0,t$3521];
 break; }default: {var v$2787 = pat$2698[1];
var v$2788 = v$2787[1];
var t$3525;
var t$3524;
var fix$3523 = {};
fix$3523.$map = function(v$3059){if (v$3059 == null) {return null;
} else {var v$3060 = v$3059;
var v$3061 = v$3060[0];
var v$3062 = v$3060[1];
return [fix$3434.$layoutAtpat(v$3061),fix$3523.$map(v$3062)];
};
};
var map$3058 = fix$3523.$map;
t$3524 = (map$3058(v$2788));
t$3525 = [t$3524,[0," "],">",3,"<UNRES_INFIX "];
return [0,t$3525];
} };
};
basics$PreElabDecGrammar$$2.layoutPatrow$1862 = fix$3434.$layoutPatrow;
basics$PreElabDecGrammar$$2.layoutAtpat$1863 = fix$3434.$layoutAtpat;
basics$PreElabDecGrammar$$2.layoutPat$1861 = fix$3434.$layoutPat;
basics$PreElabDecGrammar$$2.layoutExbind$1864 = function(exbind$2507){var fix$3435 = {};
fix$3435.$layoutIdSubTRest = function(v$2534,v$2535,v$2536,v$2537,v$2538){var t$3441;
var t$3440 = [0,[[[1,(v$2535?"op ":"") + (syntax_objects$Ident$.pr_id$53(v$2534))],[v$2537,null]],[2,v$2536],"",0,""]];
var t$3439;
switch (v$2538[0]) { case 0: {var v$2533 = v$2538[1];
t$3439 = (fix$3435.$treesOfExbind(v$2533));
 break; }default: {t$3439 = null;
} };
t$3441 = [t$3440,t$3439];
return t$3441;
};
fix$3435.$treesOfExbind = function(exbind$2541){switch (exbind$2541[0]) { case 1: {var v$2561 = exbind$2541[1];
var v$2562 = v$2561[2];
switch (v$2562[0]) { case 0: {var v$2564 = v$2561[1];
var v$2565 = v$2564[1];
var v$2566 = v$2565[0];
var v$2567 = v$2565[1];
var v$2568 = v$2562[1];
var v$2569 = v$2561[3];
return fix$3435.$layoutIdSubTRest(v$2566,v$2567," of ",basics$PreElabDecGrammar$$2.layoutTy$1860(v$2568),v$2569);
 break; }default: {var v$2581 = v$2561[1];
var v$2582 = v$2581[1];
var v$2583 = v$2582[0];
var v$2584 = v$2582[1];
var v$2585 = v$2561[3];
var t$3438;
var t$3437 = [1,(v$2584?"op ":"") + (syntax_objects$Ident$.pr_id$53(v$2583))];
var t$3436;
switch (v$2585[0]) { case 0: {var v$2580 = v$2585[1];
t$3436 = (fix$3435.$treesOfExbind(v$2580));
 break; }default: {t$3436 = null;
} };
t$3438 = [t$3437,t$3436];
return t$3438;
} };
 break; }default: {var v$2590 = exbind$2541[1];
var v$2591 = v$2590[1];
var v$2592 = v$2591[1];
var v$2593 = v$2592[0];
var v$2594 = v$2592[1];
var v$2595 = v$2590[2];
var v$2596 = v$2595[1];
var v$2597 = v$2596[0];
var v$2598 = v$2596[1];
var v$2599 = v$2590[3];
return fix$3435.$layoutIdSubTRest(v$2593,v$2594," = ",[1,(v$2598?"op ":"") + (syntax_objects$Ident$.pr_longid$62(v$2597))],v$2599);
} };
};
var layoutIdSubTRest$2509 = fix$3435.$layoutIdSubTRest;
var treesOfExbind$2508 = fix$3435.$treesOfExbind;
return [0,[treesOfExbind$2508(exbind$2507),[2," and "],"",0,""]];
};
basics$PreElabDecGrammar$$2.layoutConbind$1865 = function(conbind$2457){var fix$3442 = {};
fix$3442.$treesOfConbind = function(v$2461){var v$2493 = v$2461[1];
var v$2494 = v$2493[1];
var v$2495 = v$2494[1];
var v$2496 = v$2495[0];
var v$2497 = v$2495[1];
var v$2498 = v$2493[2];
var v$2499 = v$2493[3];
var conT$2468 = [1,(v$2497?"op ":"") + (syntax_objects$Ident$.pr_id$53(v$2496))];
var t$3445;
var t$3444;
switch (v$2498[0]) { case 0: {var v$2485 = v$2498[1];
t$3444 = [0,[[conT$2468,[basics$PreElabDecGrammar$$2.layoutTy$1860(v$2485),null]],[2," of "],"",0,""]];
 break; }default: {t$3444 = conT$2468;
} };
var t$3443;
switch (v$2499[0]) { case 0: {var v$2492 = v$2499[1];
t$3443 = (fix$3442.$treesOfConbind(v$2492));
 break; }default: {t$3443 = null;
} };
t$3445 = [t$3444,t$3443];
return t$3445;
};
var treesOfConbind$2458 = fix$3442.$treesOfConbind;
return [0,[treesOfConbind$2458(conbind$2457),[2," | "],"",0,""]];
};
basics$PreElabDecGrammar$$2.layoutTyvarseq$1868 = function(tyvars$2338){if (tyvars$2338 == null) {return [1];
} else {var v$2347 = tyvars$2338;
if (v$2347[1] == null) {var v$2349 = v$2347[0];
return [0,[1,syntax_objects$SyntaxTyVar$.pr_tyvar$51(v$2349)]];
} else {var t$3451;
var t$3450;
var t$3447;
var fix$3446 = {};
fix$3446.$map = function(v$3071){if (v$3071 == null) {return null;
} else {var v$3072 = v$3071;
var v$3073 = v$3072[0];
var v$3074 = v$3072[1];
var t$3449;
var t$3448;
var v$3267 = syntax_objects$SyntaxTyVar$.pr_tyvar$51(v$3073);
t$3448 = [1,v$3267];
t$3449 = [t$3448,fix$3446.$map(v$3074)];
return t$3449;
};
};
var map$3070 = fix$3446.$map;
t$3447 = (map$3070(tyvars$2338));
t$3450 = [t$3447,[0,", "],")",1,"("];
t$3451 = [0,t$3450];
return [0,t$3451];
};
};
};
basics$PreElabDecGrammar$$2.layoutDatbind$1866 = function(datbind$2405){var fix$3452 = {};
fix$3452.$treesOfDatbind = function(v$2409){var v$2445 = v$2409[1];
var v$2446 = v$2445[1];
var v$2447 = v$2445[2];
var v$2448 = v$2445[3];
var v$2449 = v$2445[4];
var tyvarsT_opt$2416 = basics$PreElabDecGrammar$$2.layoutTyvarseq$1868(v$2446);
var tyconT$2417 = [1,syntax_objects$TyCon$.pr_TyCon$53(v$2447)];
var t$3459;
var t$3458;
var t$3457;
var t$3456;
var t$3455;
var t$3454;
switch (tyvarsT_opt$2416[0]) { case 1: {t$3454 = tyconT$2417;
 break; }default: {t$3454 = [0,[[tyvarsT_opt$2416[1],[tyconT$2417,null]],[0," "],"",0,""]];
} };
t$3455 = [t$3454,[[1," = "],[basics$PreElabDecGrammar$$2.layoutConbind$1865(v$2448),null]]];
t$3456 = t$3455;
t$3457 = [t$3456,[1],"",0,""];
t$3458 = [0,t$3457];
var t$3453;
switch (v$2449[0]) { case 0: {var v$2444 = v$2449[1];
t$3453 = (fix$3452.$treesOfDatbind(v$2444));
 break; }default: {t$3453 = null;
} };
t$3459 = [t$3458,t$3453];
return t$3459;
};
var treesOfDatbind$2406 = fix$3452.$treesOfDatbind;
return [0,[treesOfDatbind$2406(datbind$2405),[2," and "],"",0,""]];
};
basics$PreElabDecGrammar$$2.layoutTypbind$1867 = function(typbind$2358){var fix$3460 = {};
fix$3460.$treesOfTypbind = function(v$2362){var v$2393 = v$2362[1];
var v$2394 = v$2393[1];
var v$2395 = v$2393[2];
var v$2396 = v$2393[3];
var v$2397 = v$2393[4];
var tyvars_opt$2369 = basics$PreElabDecGrammar$$2.layoutTyvarseq$1868(v$2394);
var tyconT$2370 = [1,syntax_objects$TyCon$.pr_TyCon$53(v$2395)];
var eqT$2371 = [1," = "];
var tyT$2372 = basics$PreElabDecGrammar$$2.layoutTy$1860(v$2396);
var t$3468;
var t$3467;
var t$3466;
var t$3465;
var t$3464 = basis$List$.s$n$645;
var t$3463;
var t$3462;
switch (tyvars_opt$2369[0]) { case 0: {t$3462 = [tyvars_opt$2369[1],null];
 break; }default: {t$3462 = null;
} };
t$3463 = [t$3462,[tyconT$2370,[eqT$2371,[tyT$2372,null]]]];
t$3465 = (t$3464(t$3463));
t$3466 = [t$3465,[1],"",0,""];
t$3467 = [0,t$3466];
var t$3461;
switch (v$2397[0]) { case 0: {var v$2392 = v$2397[1];
t$3461 = (fix$3460.$treesOfTypbind(v$2392));
 break; }default: {t$3461 = null;
} };
t$3468 = [t$3467,t$3461];
return t$3468;
};
var treesOfTypbind$2359 = fix$3460.$treesOfTypbind;
return [0,[treesOfTypbind$2359(typbind$2358),[2," and "],"",0,""]];
};
basics$PreElabDecGrammar$$2.layout_datatype_replication$1870 = function(v$3362,v$2287,v$2288){return [1,((("datatype " + (syntax_objects$TyCon$.pr_TyCon$53(v$2287))) + " = ") + "datatype ") + (syntax_objects$TyCon$.pr_LongTyCon$62(v$2288))];
};
var fix$3469 = {};
fix$3469.$layoutExprow = function(row$1945){var fix$3514 = {};
fix$3514.$treesOfExprow = function(v$1949){var v$1968 = v$1949[1];
var v$1969 = v$1968[1];
var v$1970 = v$1968[2];
var v$1971 = v$1968[3];
var t$3517;
var t$3516 = [0,[[[1,syntax_objects$Lab$.pr_Lab$94(v$1969)],[fix$3469.$layoutExp(v$1970),null]],[0," = "],"",0,""]];
var t$3515;
switch (v$1971[0]) { case 0: {var v$1967 = v$1971[1];
t$3515 = (fix$3514.$treesOfExprow(v$1967));
 break; }default: {t$3515 = null;
} };
t$3517 = [t$3516,t$3515];
return t$3517;
};
var treesOfExprow$1946 = fix$3514.$treesOfExprow;
return [0,[treesOfExprow$1946(row$1945),[0,", "],"",0,""]];
};
fix$3469.$layoutDec = function(dec$2108){switch (dec$2108[0]) { case 0: {var v$2278 = dec$2108[1];
var v$2279 = v$2278[1];
var v$2280 = v$2278[2];
var t$3513;
var t$3512;
var t$3511 = basis$List$.s$n$645;
var t$3510;
var t$3509;
var v$3091 = basics$PreElabDecGrammar$$2.layoutTyvarseq$1868(v$2279);
switch (v$3091[0]) { case 0: {t$3509 = [v$3091[1],null];
 break; }default: {t$3509 = null;
} };
t$3510 = [t$3509,[fix$3469.$layoutValbind(v$2280),null]];
t$3512 = (t$3511(t$3510));
t$3513 = [t$3512,[1],"",4,"val "];
return [0,t$3513];
 break; }case 1: {return [1,"<UNRES_FUN>"];
 break; }case 2: {var v$2269 = dec$2108[1];
var v$2270 = v$2269[1];
return [0,[[basics$PreElabDecGrammar$$2.layoutTypbind$1867(v$2270),null],[1],"",5,"type "]];
 break; }case 11: {var v$2261 = dec$2108[1];
var v$2262 = v$2261[1];
return [0,[[basics$PreElabDecGrammar$$2.layoutDatbind$1866(v$2262),null],[1],"",3,"datatype "]];
 break; }case 12: {var v$2251 = dec$2108[1];
var v$2253 = v$2251[1];
var v$2254 = v$2251[2];
return [1,((("datatype " + (syntax_objects$TyCon$.pr_TyCon$53(v$2253))) + " = ") + "datatype ") + (syntax_objects$TyCon$.pr_LongTyCon$62(v$2254))];
 break; }case 13: {var v$2247 = dec$2108[1];
var v$2248 = v$2247[1];
var v$2249 = v$2247[2];
return [0,[[basics$PreElabDecGrammar$$2.layoutDatbind$1866(v$2248),[fix$3469.$layoutDec(v$2249),null]],[2," with "]," end",3,"abstype "]];
 break; }case 9: {var v$2237 = dec$2108[1];
var v$2238 = v$2237[1];
return [0,[[basics$PreElabDecGrammar$$2.layoutExbind$1864(v$2238),null],[1],"",3,"exception "]];
 break; }case 6: {var v$2228 = dec$2108[1];
var v$2229 = v$2228[1];
var v$2230 = v$2228[2];
return [0,[[fix$3469.$layoutDec(v$2229),[fix$3469.$layoutDec(v$2230),null]],[2," in "]," end",3,"local "]];
 break; }case 4: {var v$2218 = dec$2108[1];
var v$2219 = v$2218[1];
var t$3508;
var t$3505;
var fix$3504 = {};
fix$3504.$map = function(v$3102){if (v$3102 == null) {return null;
} else {var v$3103 = v$3102;
var v$3104 = v$3103[0];
var v$3105 = v$3103[1];
var t$3507;
var t$3506;
var x$3277 = v$3104[1][1];
var v$3278 = syntax_objects$StrId$.pr_LongStrId$61(x$3277);
t$3506 = [1,v$3278];
t$3507 = [t$3506,fix$3504.$map(v$3105)];
return t$3507;
};
};
var map$3101 = fix$3504.$map;
t$3505 = (map$3101(v$2219));
t$3508 = [t$3505,[0," "],"",5,"open "];
return [0,t$3508];
 break; }case 3: {var v$2208 = dec$2108[1];
var v$2209 = v$2208[1];
var v$2210 = v$2208[2];
return [0,[[fix$3469.$layoutDec(v$2209),[fix$3469.$layoutDec(v$2210),null]],[0,"; "],")",0,"("]];
 break; }case 7: {var v$2197 = dec$2108[1];
var v$2198 = v$2197[1];
var v$2199 = v$2197[2];
var t$3503;
var t$3502;
var t$3501 = basis$List$.s$n$645;
var t$3500;
var t$3499;
switch (v$2198[0]) { case 0: {var v$2190 = v$2198[1];
t$3499 = [[1,basis$Int32$.toString$449(v$2190)],null];
 break; }default: {t$3499 = null;
} };
var t$3496;
var fix$3495 = {};
fix$3495.$map = function(v$3118){if (v$3118 == null) {return null;
} else {var v$3119 = v$3118;
var v$3120 = v$3119[0];
var v$3121 = v$3119[1];
var t$3498;
var t$3497;
var v$3282 = syntax_objects$Ident$.pr_id$53(v$3120);
t$3497 = [1,v$3282];
t$3498 = [t$3497,fix$3495.$map(v$3121)];
return t$3498;
};
};
var map$3117 = fix$3495.$map;
t$3496 = (map$3117(v$2199));
t$3500 = [t$3499,t$3496];
t$3502 = (t$3501(t$3500));
t$3503 = [t$3502,[0," "],"",6,"infix "];
return [0,t$3503];
 break; }case 8: {var v$2180 = dec$2108[1];
var v$2181 = v$2180[1];
var v$2182 = v$2180[2];
var t$3494;
var t$3493;
var t$3492 = basis$List$.s$n$645;
var t$3491;
var t$3490;
switch (v$2181[0]) { case 0: {var v$2173 = v$2181[1];
t$3490 = [[1,basis$Int32$.toString$449(v$2173)],null];
 break; }default: {t$3490 = null;
} };
var t$3487;
var fix$3486 = {};
fix$3486.$map = function(v$3129){if (v$3129 == null) {return null;
} else {var v$3130 = v$3129;
var v$3131 = v$3130[0];
var v$3132 = v$3130[1];
var t$3489;
var t$3488;
var v$3286 = syntax_objects$Ident$.pr_id$53(v$3131);
t$3488 = [1,v$3286];
t$3489 = [t$3488,fix$3486.$map(v$3132)];
return t$3489;
};
};
var map$3128 = fix$3486.$map;
t$3487 = (map$3128(v$2182));
t$3491 = [t$3490,t$3487];
t$3493 = (t$3492(t$3491));
t$3494 = [t$3493,[0," "],"",7,"infixr "];
return [0,t$3494];
 break; }case 5: {var v$2164 = dec$2108[1];
var v$2165 = v$2164[1];
var t$3485;
var t$3482;
var fix$3481 = {};
fix$3481.$map = function(v$3140){if (v$3140 == null) {return null;
} else {var v$3141 = v$3140;
var v$3142 = v$3141[0];
var v$3143 = v$3141[1];
var t$3484;
var t$3483;
var v$3290 = syntax_objects$Ident$.pr_id$53(v$3142);
t$3483 = [1,v$3290];
t$3484 = [t$3483,fix$3481.$map(v$3143)];
return t$3484;
};
};
var map$3139 = fix$3481.$map;
t$3482 = (map$3139(v$2165));
t$3485 = [t$3482,[0," "],"",7,"nonfix "];
return [0,t$3485];
 break; }default: {return [1,"(emptydec)"];
} };
};
fix$3469.$layoutAtexp = function(atexp$1879){switch (atexp$1879[0]) { case 0: {var v$1934 = atexp$1879[1];
var v$1935 = v$1934[1];
return [1,syntax_objects$SCon$.pr_scon$131(v$1935)];
 break; }case 4: {var v$1928 = atexp$1879[1];
var v$1929 = v$1928[1];
var v$1930 = v$1929[1];
var v$1931 = v$1930[0];
var v$1932 = v$1930[1];
return [1,(v$1932?"op ":"") + (syntax_objects$Ident$.pr_longid$62(v$1931))];
 break; }case 1: {var v$1921 = atexp$1879[1];
var v$1922 = v$1921[1];
switch (v$1922[0]) { case 0: {var v$1920 = v$1922[1];
return [0,[[fix$3469.$layoutExprow(v$1920),null],[1],"}",1,"{"]];
 break; }default: {return [1,"{}"];
} };
 break; }case 3: {var v$1905 = atexp$1879[1];
var v$1906 = v$1905[1];
var v$1907 = v$1905[2];
return [0,[[fix$3469.$layoutDec(v$1906),[fix$3469.$layoutExp(v$1907),null]],[2," in "]," end",4,"let "]];
 break; }default: {var v$1941 = atexp$1879[1];
var v$1942 = v$1941[1];
return [0,[[fix$3469.$layoutExp(v$1942),null],[1],")",1,"("]];
} };
};
fix$3469.$layoutMrule = function(v$2091){var v$2103 = v$2091[1];
var v$2104 = v$2103[1];
var v$2105 = v$2103[2];
return [0,[[basics$PreElabDecGrammar$$2.layoutPat$1861(v$2104),[fix$3469.$layoutExp(v$2105),null]],[0," => "],"",0,""]];
};
fix$3469.$layoutMatch = function(match$2065){var fix$3477 = {};
fix$3477.$treesOfMatch = function(v$2069){var v$2081 = v$2069[1];
var v$2082 = v$2081[1];
var v$2083 = v$2081[2];
var t$3480;
var t$3479 = fix$3469.$layoutMrule(v$2082);
var t$3478;
switch (v$2083[0]) { case 0: {var v$2080 = v$2083[1];
t$3478 = (fix$3477.$treesOfMatch(v$2080));
 break; }default: {t$3478 = null;
} };
t$3480 = [t$3479,t$3478];
return t$3480;
};
var treesOfMatch$2066 = fix$3477.$treesOfMatch;
return [0,[treesOfMatch$2066(match$2065),[2," | "],"",0,""]];
};
fix$3469.$layoutExp = function(exp$1979){switch (exp$1979[0]) { case 5: {var v$2054 = exp$1979[1];
var v$2055 = v$2054[1];
return fix$3469.$layoutAtexp(v$2055);
 break; }case 6: {var v$2050 = exp$1979[1];
var v$2051 = v$2050[1];
var v$2052 = v$2050[2];
return [0,[[fix$3469.$layoutExp(v$2051),[fix$3469.$layoutAtexp(v$2052),null]],[0," "],"",0,""]];
 break; }case 1: {var v$2039 = exp$1979[1];
var v$2040 = v$2039[1];
var v$2041 = v$2039[2];
return [0,[[fix$3469.$layoutExp(v$2040),[basics$PreElabDecGrammar$$2.layoutTy$1860(v$2041),null]],[2," : "],"",0,""]];
 break; }case 3: {var v$2028 = exp$1979[1];
var v$2029 = v$2028[1];
var v$2030 = v$2028[2];
return [0,[[fix$3469.$layoutExp(v$2029),[fix$3469.$layoutMatch(v$2030),null]],[2," handle "],"",0,""]];
 break; }case 2: {var v$2018 = exp$1979[1];
var v$2019 = v$2018[1];
return [0,[[fix$3469.$layoutExp(v$2019),null],[1],"",6,"raise "]];
 break; }case 4: {var v$2010 = exp$1979[1];
var v$2011 = v$2010[1];
return [0,[[fix$3469.$layoutMatch(v$2011),null],[1],"",3,"fn "]];
 break; }default: {var v$2061 = exp$1979[1];
var v$2062 = v$2061[1];
var t$3476;
var t$3475;
var fix$3474 = {};
fix$3474.$map = function(v$3086){if (v$3086 == null) {return null;
} else {var v$3087 = v$3086;
var v$3088 = v$3087[0];
var v$3089 = v$3087[1];
return [fix$3469.$layoutAtexp(v$3088),fix$3474.$map(v$3089)];
};
};
var map$3085 = fix$3474.$map;
t$3475 = (map$3085(v$2062));
t$3476 = [t$3475,[0," "],">",3,"<UNRES_INFIX "];
return [0,t$3476];
} };
};
fix$3469.$layoutValbind = function(valbind$2291){var fix$3470 = {};
fix$3470.$treesOfValbind = function(valbind$2295){switch (valbind$2295[0]) { case 1: {var v$2320 = valbind$2295[1];
var v$2321 = v$2320[1];
var v$2322 = v$2320[2];
var v$2323 = v$2320[3];
var t$3473;
var t$3472 = [0,[[basics$PreElabDecGrammar$$2.layoutPat$1861(v$2321),[fix$3469.$layoutExp(v$2322),null]],[0," = "],"",0,""]];
var t$3471;
switch (v$2323[0]) { case 0: {var v$2319 = v$2323[1];
t$3471 = (fix$3470.$treesOfValbind(v$2319));
 break; }default: {t$3471 = null;
} };
t$3473 = [t$3472,t$3471];
return t$3473;
 break; }default: {var v$2329 = valbind$2295[1];
var v$2330 = v$2329[1];
return [[0,[fix$3470.$treesOfValbind(v$2330),[2," and "],"",4,"rec "]],null];
} };
};
var treesOfValbind$2292 = fix$3470.$treesOfValbind;
return [0,[treesOfValbind$2292(valbind$2291),[2," and "],"",0,""]];
};
basics$PreElabDecGrammar$$2.layoutExprow$1875 = fix$3469.$layoutExprow;
basics$PreElabDecGrammar$$2.layoutDec$1871 = fix$3469.$layoutDec;
basics$PreElabDecGrammar$$2.layoutAtexp$1876 = fix$3469.$layoutAtexp;
basics$PreElabDecGrammar$$2.layoutMrule$1872 = fix$3469.$layoutMrule;
basics$PreElabDecGrammar$$2.layoutMatch$1873 = fix$3469.$layoutMatch;
basics$PreElabDecGrammar$$2.layoutExp$1874 = fix$3469.$layoutExp;
basics$PreElabDecGrammar$$2.layoutValbind$1869 = fix$3469.$layoutValbind;
return 0;
})();
