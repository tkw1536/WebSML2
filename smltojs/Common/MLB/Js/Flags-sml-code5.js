if ((typeof(tools$Flags$$5)) == "undefined") {tools$Flags$$5 = {};
};
(function(){tools$Flags$$5.eq_kindOfHelp$3724 = function(v$3726,v$3727){switch (v$3726) { case 0: {switch (v$3727) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$3727) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$3727) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
tools$Flags$$5.dir$2454 = [tools$Flags$$4.empty$387(0)];
tools$Flags$$5.bool_entry$2455 = function(e$2458){switch ((tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],e$2458[2]))[0]) { case 0: {return tools$Flags$$1.die$60(("bool_entry: entry " + e$2458[2]) + " already in directory");
 break; }default: {var t$4569 = tools$Flags$$5.dir$2454;
var t$4568;
var t$4567 = tools$Flags$$4.add$663;
var t$4566 = e$2458[2];
var t$4565 = [3,e$2458];
var t$4564;
var v$2485 = e$2458[5];
switch (v$2485[0]) { case 0: {var v$2487 = v$2485[1];
t$4564 = (tools$Flags$$4.add$663(v$2487,[3,e$2458],tools$Flags$$5.dir$2454[0]));
 break; }default: {t$4564 = tools$Flags$$5.dir$2454[0];
} };
t$4568 = (t$4567(t$4566,t$4565,t$4564));
(t$4569[0] = t$4568,0);
var r$2470 = e$2458[1];
return function(v$2476){return r$2470[0];
};
} };
};
tools$Flags$$5.bool_action_entry$2496 = function(e$2499){switch ((tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],e$2499[2]))[0]) { case 0: {return tools$Flags$$1.die$60(("bool_action_entry: entry " + e$2499[2]) + " already in directory");
 break; }default: {var t$4575 = tools$Flags$$5.dir$2454;
var t$4574;
var t$4573 = tools$Flags$$4.add$663;
var t$4572 = e$2499[2];
var t$4571 = [4,e$2499];
var t$4570;
var v$2517 = e$2499[6];
switch (v$2517[0]) { case 0: {var v$2519 = v$2517[1];
t$4570 = (tools$Flags$$4.add$663(v$2519,[4,e$2499],tools$Flags$$5.dir$2454[0]));
 break; }default: {t$4570 = tools$Flags$$5.dir$2454[0];
} };
t$4574 = (t$4573(t$4572,t$4571,t$4570));
return (t$4575[0] = t$4574,0);
} };
};
tools$Flags$$5.string_entry$2528 = function(e$2531){switch ((tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],e$2531[2]))[0]) { case 0: {return tools$Flags$$1.die$60(("string_entry: entry " + e$2531[2]) + " already in directory");
 break; }default: {var t$4581 = tools$Flags$$5.dir$2454;
var t$4580;
var t$4579 = tools$Flags$$4.add$663;
var t$4578 = e$2531[2];
var t$4577 = [0,e$2531];
var t$4576;
var v$2558 = e$2531[4];
switch (v$2558[0]) { case 0: {var v$2560 = v$2558[1];
t$4576 = (tools$Flags$$4.add$663(v$2560,[0,e$2531],tools$Flags$$5.dir$2454[0]));
 break; }default: {t$4576 = tools$Flags$$5.dir$2454[0];
} };
t$4580 = (t$4579(t$4578,t$4577,t$4576));
(t$4581[0] = t$4580,0);
var r$2543 = e$2531[1];
return function(v$2549){return r$2543[0];
};
} };
};
tools$Flags$$5.stringlist_entry$2569 = function(e$2572){switch ((tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],e$2572[2]))[0]) { case 0: {return tools$Flags$$1.die$60(("stringlist_entry: entry " + e$2572[2]) + " already in directory");
 break; }default: {var t$4587 = tools$Flags$$5.dir$2454;
var t$4586;
var t$4585 = tools$Flags$$4.add$663;
var t$4584 = e$2572[2];
var t$4583 = [1,e$2572];
var t$4582;
var v$2599 = e$2572[4];
switch (v$2599[0]) { case 0: {var v$2601 = v$2599[1];
t$4582 = (tools$Flags$$4.add$663(v$2601,[1,e$2572],tools$Flags$$5.dir$2454[0]));
 break; }default: {t$4582 = tools$Flags$$5.dir$2454[0];
} };
t$4586 = (t$4585(t$4584,t$4583,t$4582));
(t$4587[0] = t$4586,0);
var r$2584 = e$2572[1];
return function(v$2590){return r$2584[0];
};
} };
};
tools$Flags$$5.int_entry$2610 = function(e$2613){switch ((tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],e$2613[2]))[0]) { case 0: {return tools$Flags$$1.die$60(("int_entry: entry " + e$2613[2]) + " already in directory");
 break; }default: {var t$4593 = tools$Flags$$5.dir$2454;
var t$4592;
var t$4591 = tools$Flags$$4.add$663;
var t$4590 = e$2613[2];
var t$4589 = [2,e$2613];
var t$4588;
var v$2640 = e$2613[4];
switch (v$2640[0]) { case 0: {var v$2642 = v$2640[1];
t$4588 = (tools$Flags$$4.add$663(v$2642,[2,e$2613],tools$Flags$$5.dir$2454[0]));
 break; }default: {t$4588 = tools$Flags$$5.dir$2454[0];
} };
t$4592 = (t$4591(t$4590,t$4589,t$4588));
(t$4593[0] = t$4592,0);
var r$2625 = e$2613[1];
return function(v$2631){return r$2625[0];
};
} };
};
tools$Flags$$5.lookup_flag_entry$2651 = function(key$2654){var v$2661 = tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],key$2654);
switch (v$2661[0]) { case 0: {var v$2663 = v$2661[1];
switch (v$2663[0]) { case 3: {return v$2663[1][1];
 break; }default: {return tools$Flags$$1.die$60(("lookup_flag_entry: entry " + key$2654) + " is of wrong kind");
} };
 break; }default: {return tools$Flags$$1.die$60(("lookup_flag_entry: no entry " + key$2654) + " in directory");
} };
};
tools$Flags$$5.lookup_string_entry$2670 = function(key$2673){var v$2680 = tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],key$2673);
switch (v$2680[0]) { case 0: {var v$2682 = v$2680[1];
switch (v$2682[0]) { case 0: {return v$2682[1][1];
 break; }default: {return tools$Flags$$1.die$60(("lookup_string_entry: entry " + key$2673) + " is of wrong kind");
} };
 break; }default: {return tools$Flags$$1.die$60(("lookup_string_entry: no entry " + key$2673) + " in directory");
} };
};
tools$Flags$$5.lookup_stringlist_entry$2689 = function(key$2692){var v$2699 = tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],key$2692);
switch (v$2699[0]) { case 0: {var v$2701 = v$2699[1];
switch (v$2701[0]) { case 1: {return v$2701[1][1];
 break; }default: {return tools$Flags$$1.die$60(("lookup_stringlist_entry: entry " + key$2692) + " is of wrong kind");
} };
 break; }default: {return tools$Flags$$1.die$60(("lookup_stringlist_entry: no entry " + key$2692) + " in directory");
} };
};
tools$Flags$$5.lookup_int_entry$2708 = function(key$2711){var v$2718 = tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],key$2711);
switch (v$2718[0]) { case 0: {var v$2720 = v$2718[1];
switch (v$2720[0]) { case 2: {return v$2720[1][1];
 break; }default: {return tools$Flags$$1.die$60(("lookup_int_entry: entry " + key$2711) + " is of wrong kind");
} };
 break; }default: {return tools$Flags$$1.die$60(("lookup_int_entry: no entry " + key$2711) + " in directory");
} };
};
tools$Flags$$5.get_string_entry$2727 = function(x$3788){var t$4594;
var v$4453 = tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],x$3788);
switch (v$4453[0]) { case 0: {var v$4454 = v$4453[1];
switch (v$4454[0]) { case 0: {t$4594 = v$4454[1][1];
 break; }default: {t$4594 = (tools$Flags$$1.die$60(("lookup_string_entry: entry " + x$3788) + " is of wrong kind"));
} };
 break; }default: {t$4594 = (tools$Flags$$1.die$60(("lookup_string_entry: no entry " + x$3788) + " in directory"));
} };
return t$4594[0];
};
tools$Flags$$5.get_stringlist_entry$2728 = function(x$3793){var t$4595;
var v$4464 = tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],x$3793);
switch (v$4464[0]) { case 0: {var v$4465 = v$4464[1];
switch (v$4465[0]) { case 1: {t$4595 = v$4465[1][1];
 break; }default: {t$4595 = (tools$Flags$$1.die$60(("lookup_stringlist_entry: entry " + x$3793) + " is of wrong kind"));
} };
 break; }default: {t$4595 = (tools$Flags$$1.die$60(("lookup_stringlist_entry: no entry " + x$3793) + " in directory"));
} };
return t$4595[0];
};
tools$Flags$$5.is_on0$2729 = function(key$2732){var v$2742 = tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],key$2732);
switch (v$2742[0]) { case 0: {var v$2744 = v$2742[1];
switch (v$2744[0]) { case 3: {var v$2753 = v$2744[1];
var v$2754 = v$2753[1];
return function(v$2752){return v$2754[0];
};
 break; }case 4: {var v$2748 = v$2744[1];
var v$2749 = v$2748[1];
return function(v$2747){return v$2749[0];
};
 break; }default: {return tools$Flags$$1.die$60(("is_on0: entry " + key$2732) + " is of wrong kind");
} };
 break; }default: {return tools$Flags$$1.die$60(("is_on0: no entry " + key$2732) + " in directory");
} };
};
tools$Flags$$5.is_on$2755 = function(k$2758){var t$4596;
var v$4467 = tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],k$2758);
switch (v$4467[0]) { case 0: {var v$4468 = v$4467[1];
switch (v$4468[0]) { case 3: {var v$4469 = v$4468[1];
var v$4470 = v$4469[1];
t$4596 = (function(v$4471){return v$4470[0];
});
 break; }case 4: {var v$4472 = v$4468[1];
var v$4473 = v$4472[1];
t$4596 = (function(v$4474){return v$4473[0];
});
 break; }default: {t$4596 = (tools$Flags$$1.die$60(("is_on0: entry " + k$2758) + " is of wrong kind"));
} };
 break; }default: {t$4596 = (tools$Flags$$1.die$60(("is_on0: no entry " + k$2758) + " in directory"));
} };
return t$4596(0);
};
tools$Flags$$5.turn_on$2759 = function(key$2762){var v$2772 = tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],key$2762);
switch (v$2772[0]) { case 0: {var v$2774 = v$2772[1];
switch (v$2774[0]) { case 3: {return (v$2774[1][1][0] = true,0);
 break; }case 4: {var v$2780 = v$2774[1];
return v$2780[5](0);
 break; }default: {throw [basis$Initial$.en$Fail$45,("option " + key$2762) + " is of wrong kind"];
} };
 break; }default: {throw [basis$Initial$.en$Fail$45,"invalid option: " + key$2762];
} };
};
tools$Flags$$5.turn_off$2787 = function(key$2790){var v$2800 = tools$Flags$$4.lookup$403(tools$Flags$$5.dir$2454[0],key$2790);
switch (v$2800[0]) { case 0: {var v$2802 = v$2800[1];
switch (v$2802[0]) { case 3: {return (v$2802[1][1][0] = false,0);
 break; }case 4: {var v$2808 = v$2802[1];
return v$2808[4](0);
 break; }default: {return tools$Flags$$1.die$60(("turn_off: entry " + key$2790) + " is of wrong kind");
} };
 break; }default: {return tools$Flags$$1.die$60(("turn_off: no entry " + key$2790) + " in directory");
} };
};
tools$Flags$$5.add_string_entry$2815 = function(v$2825,v$2826){return tools$Flags$$5.string_entry$2528(["",v$2826,v$2825,null,[1]]);
};
tools$Flags$$5.add_stringlist_entry$2827 = function(v$2837,v$2838){return tools$Flags$$5.stringlist_entry$2569(["",v$2838,v$2837,null,[1]]);
};
tools$Flags$$5.add_int_entry$2839 = function(v$2849,v$2850){return tools$Flags$$5.int_entry$2610(["",v$2850,v$2849,null,[1]]);
};
tools$Flags$$5.add_bool_entry$2851 = function(v$2862,v$2863){return tools$Flags$$5.bool_entry$2455(["",v$2863,v$2862,null,false,[1]]);
};
tools$Flags$$5.lookup_notnull_menu$2864 = function(dir$2867,key$2870){var v$2907 = tools$Flags$$4.lookup$403(dir$2867,key$2870);
switch (v$2907[0]) { case 0: {var v$2913 = v$2907[1];
var t$4597;
switch (v$2913[0]) { case 3: {var v$3819 = v$2913[1];
t$4597 = ((v$3819[3] == null)?false:true);
 break; }case 4: {var v$3820 = v$2913[1];
t$4597 = ((v$3820[3] == null)?false:true);
 break; }case 0: {var v$3821 = v$2913[1];
t$4597 = ((v$3821[3] == null)?false:true);
 break; }case 2: {var v$3822 = v$2913[1];
t$4597 = ((v$3822[3] == null)?false:true);
 break; }default: {t$4597 = true;
} };
return t$4597?v$2907:[1];
 break; }default: {return [1];
} };
};
tools$Flags$$5.opt$2914 = function(s$2917){var v$2927;
var fix$4598 = {};
fix$4598.$h = function(v$3826,v$3827){lab$h: while (true) {if (v$3826 < 0) {return v$3827;
} else {var t$4599 = SmlPrims.chk_ovf_i32(v$3826 - 1);
var t$4600 = [s$2917.charCodeAt(v$3826),v$3827];
var v$3826 = t$4599;
var v$3827 = t$4600;
continue lab$h;
};
};
};
var h$3824 = fix$4598.$h;
v$2927 = (h$3824(SmlPrims.chk_ovf_i32(s$2917.length - 1),null));
if (v$2927 == null) {return [1];
} else {var v$2929 = v$2927;
switch (v$2929[0]) { case 45: {var v$2931 = v$2929[1];
if (v$2931 == null) {return [0,SmlPrims.implode(v$2927[1])];
} else {var v$2933 = v$2931;
switch (v$2933[0]) { case 45: {return [0,SmlPrims.implode(v$2933[1])];
 break; }default: {return [0,SmlPrims.implode(v$2927[1])];
} };
};
 break; }default: {return [1];
} };
};
};
tools$Flags$$5.negation$2940 = function(s$2943){var v$2953;
var fix$4601 = {};
fix$4601.$h = function(v$3837,v$3838){lab$h: while (true) {if (v$3837 < 0) {return v$3838;
} else {var t$4602 = SmlPrims.chk_ovf_i32(v$3837 - 1);
var t$4603 = [s$2943.charCodeAt(v$3837),v$3838];
var v$3837 = t$4602;
var v$3838 = t$4603;
continue lab$h;
};
};
};
var h$3835 = fix$4601.$h;
v$2953 = (h$3835(SmlPrims.chk_ovf_i32(s$2943.length - 1),null));
if (v$2953 == null) {return [1];
} else {var v$2955 = v$2953;
switch (v$2955[0]) { case 110: {var v$2957 = v$2955[1];
if (v$2957 == null) {return [1];
} else {var v$2959 = v$2957;
switch (v$2959[0]) { case 111: {var v$2961 = v$2959[1];
if (v$2961 == null) {return [1];
} else {var v$2963 = v$2961;
switch (v$2963[0]) { case 95: {return [0,SmlPrims.implode(v$2963[1])];
 break; }default: {return [1];
} };
};
 break; }default: {return [1];
} };
};
 break; }default: {return [1];
} };
};
};
tools$Flags$$5.lookup_key$2967 = function(key$2970,l$2973){var fix$4604 = {};
fix$4604.$look = function(v$2977){lab$look: while (true) {if (v$2977 == null) {return [1];
} else {var v$2989 = v$2977;
var v$2990 = v$2989[0];
var v$2991 = v$2990[0];
var v$2992 = v$2990[1];
var v$2993 = v$2989[1];
if (key$2970 == v$2991) {return [0,v$2992];
} else {var t$4605 = v$2993;
var v$2977 = t$4605;
continue lab$look;
};
};
};
};
var look$2974 = fix$4604.$look;
return look$2974(l$2973);
};
tools$Flags$$5.read_options$2994 = function(v$3239,v$3241,v$3240){var fix$4606 = {};
fix$4606.$loop = function(v$3003){if (v$3003 == null) {return null;
} else {var v$3236 = v$3003;
var v$3237 = v$3236[0];
var v$3238 = v$3236[1];
var v$3015 = tools$Flags$$5.opt$2914(v$3237);
switch (v$3015[0]) { case 0: {var v$3235 = v$3015[1];
var v$3021 = tools$Flags$$5.negation$2940(v$3235);
switch (v$3021[0]) { case 0: {var v$3059 = v$3021[1];
var v$3032 = tools$Flags$$5.lookup_notnull_menu$2864(tools$Flags$$5.dir$2454[0],v$3059);
switch (v$3032[0]) { case 0: {var v$3034 = v$3032[1];
switch (v$3034[0]) { case 3: {var v$3058 = v$3034[1];
if (v$3058[4]) {(v$3058[1][0] = false,0);
return fix$4606.$loop(v$3238);
} else {throw [basis$Initial$.en$Fail$45,"negation not allowed on option: " + v$3059];
};
 break; }case 4: {var v$3042 = v$3034[1];
v$3042[4](0);
return fix$4606.$loop(v$3238);
 break; }default: {throw [basis$Initial$.en$Fail$45,"negation not allowed on option: " + v$3059];
} };
 break; }default: {throw [basis$Initial$.en$Fail$45,"unknown option: " + v$3237];
} };
 break; }default: {var v$3076 = tools$Flags$$5.lookup_notnull_menu$2864(tools$Flags$$5.dir$2454[0],v$3235);
switch (v$3076[0]) { case 0: {var v$3078 = v$3076[1];
switch (v$3078[0]) { case 3: {var v$3178 = v$3078[1];
(v$3178[1][0] = true,0);
return fix$4606.$loop(v$3238);
 break; }case 4: {var v$3170 = v$3078[1];
v$3170[5](0);
return fix$4606.$loop(v$3238);
 break; }case 0: {var v$3162 = v$3078[1];
if (v$3238 == null) {throw [basis$Initial$.en$Fail$45,"missing argument to " + v$3237];
} else {var v$3159 = v$3238;
var v$3160 = v$3159[0];
var v$3161 = v$3159[1];
(v$3162[1][0] = v$3160,0);
return fix$4606.$loop(v$3161);
};
 break; }case 1: {var v$3144 = v$3078[1];
var fix$4607 = {};
fix$4607.$readToOpt = function(v$3104,v$4559){if (v$3104 == null) {return [basis$List$.rev$641(v$4559),null];
} else {var v$3106 = v$3104;
var v$3107 = v$3106[1];
if (v$3107 == null) {var v$3123 = v$3106[0];
var t$4609;
try {t$4609 = ((basis$String$.sub$92(v$3123,0)) == 45);
} catch(v$4608) {t$4609 = ((function(v$3860){return false;
})(v$4608));
};
if (t$4609) {return [basis$List$.rev$641(v$4559),v$3104];
} else {var v$3116 = basis$Path$.ext$595(v$3123);
switch (v$3116[0]) { case 0: {var v$3122 = v$3116[1];
var t$4610;
switch (v$3122) { case "sml": {t$4610 = true;
 break; }case "sig": {t$4610 = true;
 break; }default: {t$4610 = false;
} };
return t$4610?[basis$List$.rev$641(v$4559),v$3104]:[basis$List$.rev$641([v$3123,v$4559]),null];
 break; }default: {return [basis$List$.rev$641([v$3123,v$4559]),null];
} };
};
} else {var v$3129 = v$3106[0];
var t$4612;
try {t$4612 = ((basis$String$.sub$92(v$3129,0)) == 45);
} catch(v$4611) {t$4612 = ((function(v$3863){return false;
})(v$4611));
};
if (t$4612) {return [basis$List$.rev$641(v$4559),v$3104];
} else {return fix$4607.$readToOpt(v$3107,[v$3129,v$4559]);
};
};
};
};
var readToOpt$3086 = fix$4607.$readToOpt;
var v$3141 = readToOpt$3086(v$3238,null);
var v$3142 = v$3141[0];
var v$3143 = v$3141[1];
(v$3144[1][0] = v$3142,0);
return fix$4606.$loop(v$3143);
 break; }default: {var v$3202 = v$3078[1];
if (v$3238 == null) {throw [basis$Initial$.en$Fail$45,"missing argument to " + v$3237];
} else {var v$3199 = v$3238;
var v$3200 = v$3199[0];
var v$3201 = v$3199[1];
var v$3190 = basis$Int32$.fromString$453(v$3200);
switch (v$3190[0]) { case 0: {var v$3198 = v$3190[1];
(v$3202[1][0] = v$3198,0);
return fix$4606.$loop(v$3201);
 break; }default: {throw [basis$Initial$.en$Fail$45,"expecting integer argument to " + v$3200];
} };
};
} };
 break; }default: {var v$3220;
var fix$4613 = {};
fix$4613.$look = function(v$4479){lab$look: while (true) {if (v$4479 == null) {return [1];
} else {var v$4480 = v$4479;
var v$4481 = v$4480[0];
var v$4482 = v$4481[0];
var v$4483 = v$4481[1];
var v$4484 = v$4480[1];
if (v$3235 == v$4482) {return [0,v$4483];
} else {var t$4614 = v$4484;
var v$4479 = t$4614;
continue lab$look;
};
};
};
};
var look$4478 = fix$4613.$look;
v$3220 = (look$4478(v$3240));
switch (v$3220[0]) { case 0: {var v$3234 = v$3220[1];
if (v$3238 == null) {var exn$3868 = [basis$Initial$.en$Fail$45,"missing argument to " + v$3237];
var v$3869;
var fix$4615 = {};
fix$4615.$look = function(v$4489){lab$look: while (true) {if (v$4489 == null) {return [1];
} else {var v$4490 = v$4489;
var v$4491 = v$4490[0];
var v$4492 = v$4491[0];
var v$4493 = v$4491[1];
var v$4494 = v$4490[1];
if (v$3235 == v$4492) {return [0,v$4493];
} else {var t$4616 = v$4494;
var v$4489 = t$4616;
continue lab$look;
};
};
};
};
var look$4488 = fix$4615.$look;
v$3869 = (look$4488(v$3239));
switch (v$3869[0]) { case 0: {var v$3870 = v$3869[1];
v$3870(0);
return fix$4606.$loop(v$3238);
 break; }default: {throw exn$3868;
} };
} else {var v$3231 = v$3238;
var v$3232 = v$3231[0];
var v$3233 = v$3231[1];
v$3234(v$3232);
return fix$4606.$loop(v$3233);
};
 break; }default: {var exn$3872 = [basis$Initial$.en$Fail$45,"unknown option: " + v$3237];
var v$3873;
var fix$4617 = {};
fix$4617.$look = function(v$4499){lab$look: while (true) {if (v$4499 == null) {return [1];
} else {var v$4500 = v$4499;
var v$4501 = v$4500[0];
var v$4502 = v$4501[0];
var v$4503 = v$4501[1];
var v$4504 = v$4500[1];
if (v$3235 == v$4502) {return [0,v$4503];
} else {var t$4618 = v$4504;
var v$4499 = t$4618;
continue lab$look;
};
};
};
};
var look$4498 = fix$4617.$look;
v$3873 = (look$4498(v$3239));
switch (v$3873[0]) { case 0: {var v$3874 = v$3873[1];
v$3874(0);
return fix$4606.$loop(v$3238);
 break; }default: {throw exn$3872;
} };
} };
} };
} };
 break; }default: {return v$3003;
} };
};
};
var loop$3000 = fix$4606.$loop;
return loop$3000(v$3241);
};
tools$Flags$$5.help$$3245 = function(key$3248){var v$3364 = tools$Flags$$5.lookup_notnull_menu$2864(tools$Flags$$5.dir$2454[0],key$3248);
switch (v$3364[0]) { case 0: {var v$3366 = v$3364[1];
switch (v$3366[0]) { case 3: {var v$3459 = v$3366[1];
var t$4656;
var t$4655;
var v$3454 = [v$3459[2],null];
var v$3455;
var v$3911 = v$3459[5];
switch (v$3911[0]) { case 1: {v$3455 = null;
 break; }default: {v$3455 = [v$3911[1],null];
} };
var v$3456 = [1];
t$4655 = [[0,v$3459[1][0]?"on":"off"],v$3459[0],v$3456,v$3454,v$3455];
var t$4643;
var v$4365 = [1];
if (v$3459[4]?false:true) {t$4643 = null;
} else {var t$4654;
var t$4653;
var t$4652 = [1];
var t$4651;
var t$4650;
var t$4649 = "Opposite of --" + v$3459[2];
var t$4648;
var v$3920 = v$3459[5];
switch (v$3920[0]) { case 0: {t$4648 = (", -" + v$3920[1]);
 break; }default: {t$4648 = "";
} };
t$4650 = (t$4649 + t$4648);
t$4651 = (t$4650 + ".");
var t$4647 = v$4365;
var t$4646 = ["no_" + v$3459[2],null];
var t$4644;
var l$3927;
var v$3928 = v$3459[5];
switch (v$3928[0]) { case 1: {l$3927 = null;
 break; }default: {l$3927 = [v$3928[1],null];
} };
var fix$4645 = {};
fix$4645.$map = function(v$3930){if (v$3930 == null) {return null;
} else {var v$3931 = v$3930;
var v$3932 = v$3931[0];
var v$3933 = v$3931[1];
return ["no_" + v$3932,fix$4645.$map(v$3933)];
};
};
var map$3929 = fix$4645.$map;
t$4644 = (map$3929(l$3927));
t$4653 = [t$4652,t$4651,t$4647,t$4646,t$4644];
t$4654 = [t$4653,null];
t$4643 = t$4654;
};
t$4656 = [t$4655,t$4643];
return t$4656;
 break; }case 4: {var v$3436 = v$3366[1];
var t$4642;
var t$4641;
var v$3431 = [v$3436[2],null];
var v$3432;
var v$3936 = v$3436[6];
switch (v$3936[0]) { case 1: {v$3432 = null;
 break; }default: {v$3432 = [v$3936[1],null];
} };
t$4641 = [[0,v$3436[1][0]?"on":"off"],v$3436[0],[1],v$3431,v$3432];
var t$4640;
var t$4639;
var t$4638;
var t$4637 = [1];
var t$4636;
var t$4635;
var t$4634 = "Opposite of --" + v$3436[2];
var t$4633;
var v$3944 = v$3436[6];
switch (v$3944[0]) { case 0: {t$4633 = (", -" + v$3944[1]);
 break; }default: {t$4633 = "";
} };
t$4635 = (t$4634 + t$4633);
t$4636 = (t$4635 + ".");
var t$4632 = [1];
var t$4631 = ["no_" + v$3436[2],null];
var t$4629;
var l$3951;
var v$3952 = v$3436[6];
switch (v$3952[0]) { case 1: {l$3951 = null;
 break; }default: {l$3951 = [v$3952[1],null];
} };
var fix$4630 = {};
fix$4630.$map = function(v$3954){if (v$3954 == null) {return null;
} else {var v$3955 = v$3954;
var v$3956 = v$3955[0];
var v$3957 = v$3955[1];
return ["no_" + v$3956,fix$4630.$map(v$3957)];
};
};
var map$3953 = fix$4630.$map;
t$4629 = (map$3953(l$3951));
t$4638 = [t$4637,t$4636,t$4632,t$4631,t$4629];
t$4639 = [t$4638,null];
t$4640 = t$4639;
t$4642 = [t$4641,t$4640];
return t$4642;
 break; }case 0: {var v$3413 = v$3366[1];
var t$4628;
var t$4626;
var v$3408 = [v$3413[2],null];
var v$3409;
var v$3960 = v$3413[4];
switch (v$3960[0]) { case 1: {v$3409 = null;
 break; }default: {v$3409 = [v$3960[1],null];
} };
var t$4627;
var a$3395 = basis$String$.toString$437(v$3413[1][0]);
t$4627 = ((a$3395 == "")?[1]:[0,a$3395]);
t$4626 = [t$4627,v$3413[0],[0,"S"],v$3408,v$3409];
t$4628 = [t$4626,null];
return t$4628;
 break; }case 1: {var v$3385 = v$3366[1];
var t$4625;
var t$4624;
var t$4623 = [1];
var t$4622 = v$3385[0];
var t$4621 = [0,"S"];
var t$4620 = [v$3385[2],null];
var t$4619;
var v$3966 = v$3385[4];
switch (v$3966[0]) { case 1: {t$4619 = null;
 break; }default: {t$4619 = [v$3966[1],null];
} };
t$4624 = [t$4623,t$4622,t$4621,t$4620,t$4619];
t$4625 = [t$4624,null];
return t$4625;
 break; }default: {var v$3481 = v$3366[1];
var t$4658;
var t$4657;
var v$3476 = [v$3481[2],null];
var v$3477;
var v$3967 = v$3481[4];
switch (v$3967[0]) { case 1: {v$3477 = null;
 break; }default: {v$3477 = [v$3967[1],null];
} };
t$4657 = [[0,basis$Int32$.toString$449(v$3481[1][0])],v$3481[0],[0,"N"],v$3476,v$3477];
t$4658 = [t$4657,null];
return t$4658;
} };
 break; }default: {throw [basis$Initial$.en$Fail$45,"no help available for option: " + key$3248];
} };
};
tools$Flags$$5.print_help$3482 = function(tail$3485,x$3488){var t$4660;
var fix$4659 = {};
fix$4659.$map = function(v$4049){if (v$4049 == null) {return null;
} else {var v$4050 = v$4049;
var v$4051 = v$4050[0];
var v$4052 = v$4050[1];
var t$4688;
var t$4661;
var v$4105 = v$4051[3];
var v$4106 = v$4051[4];
var v$4107 = v$4051[2];
var v$4108 = v$4051[0];
var v$4109 = v$4051[1];
var name$4110;
var t$4682;
var t$4681 = basis$List$.s$n$645;
var t$4680;
var t$4672;
var fix$4671 = {};
fix$4671.$addBetween = function(v$4541){if (v$4541 == null) {return null;
} else {var v$4542 = v$4541;
var v$4543 = v$4542[1];
if (v$4543 == null) {return [v$4542[0],null];
} else {var v$4544 = v$4542[0];
var v$4545 = v$4543;
var v$4546 = v$4545[0];
var v$4547 = v$4545[1];
return [v$4544,[", ",fix$4671.$addBetween([v$4546,v$4547])]];
};
};
};
var addBetween$4540 = fix$4671.$addBetween;
var t$4679 = addBetween$4540;
var t$4674;
var fix$4673 = {};
fix$4673.$map = function(v$4112){if (v$4112 == null) {return null;
} else {var v$4113 = v$4112;
var v$4114 = v$4113[0];
var v$4115 = v$4113[1];
var t$4678;
var t$4677;
var t$4676 = "--" + v$4114;
var t$4675;
switch (v$4107[0]) { case 1: {t$4675 = "";
 break; }default: {t$4675 = (" " + v$4107[1]);
} };
t$4677 = (t$4676 + t$4675);
t$4678 = [t$4677,fix$4673.$map(v$4115)];
return t$4678;
};
};
var map$4111 = fix$4673.$map;
t$4674 = (map$4111(v$4105));
t$4672 = (t$4679(t$4674));
var t$4670;
var t$4669 = basis$List$.s$n$645;
var t$4668;
var t$4663;
var fix$4662 = {};
fix$4662.$map = function(v$4121){if (v$4121 == null) {return null;
} else {var v$4122 = v$4121;
var v$4123 = v$4122[0];
var v$4124 = v$4122[1];
var t$4667;
var t$4666;
var t$4665 = ", -" + v$4123;
var t$4664;
switch (v$4107[0]) { case 1: {t$4664 = "";
 break; }default: {t$4664 = (" " + v$4107[1]);
} };
t$4666 = (t$4665 + t$4664);
t$4667 = [t$4666,fix$4662.$map(v$4124)];
return t$4667;
};
};
var map$4120 = fix$4662.$map;
t$4663 = (map$4120(v$4106));
t$4668 = [t$4663,[" ",null]];
t$4670 = (t$4669(t$4668));
t$4680 = [t$4672,t$4670];
t$4682 = (t$4681(t$4680));
name$4110 = (SmlPrims.concat(t$4682));
var firstline$4129;
switch (v$4108[0]) { case 1: {firstline$4129 = (name$4110 + "\n");
 break; }default: {var v$4131 = v$4108[1];
var t$4686;
var t$4685;
var t$4683;
var n$4135 = SmlPrims.chk_ovf_i32(60 - v$4131.length);
var ssize$4136 = name$4110.length;
var fix$4684 = {};
fix$4684.$f = function(v$4138){switch (v$4138) { case 0: {return null;
 break; }default: {return [32,fix$4684.$f(SmlPrims.chk_ovf_i32(v$4138 - 1))];
} };
};
var f$4137 = fix$4684.$f;
t$4683 = ((n$4135 <= ssize$4136)?name$4110:(SmlPrims.concat([name$4110,[SmlPrims.implode(f$4137(SmlPrims.chk_ovf_i32(n$4135 - ssize$4136))),null]])));
t$4685 = (t$4683 + "(");
t$4686 = (t$4685 + v$4131);
firstline$4129 = (t$4686 + ")\n");
} };
var body$4139;
var l$4140 = basis$String$.tokens$215(function(c$4141){return c$4141 == 10;
},v$4109);
var fix$4687 = {};
fix$4687.$map = function(v$4143){if (v$4143 == null) {return null;
} else {var v$4144 = v$4143;
var v$4145 = v$4144[0];
var v$4146 = v$4144[1];
return [("     " + v$4145) + "\n",fix$4687.$map(v$4146)];
};
};
var map$4142 = fix$4687.$map;
body$4139 = (map$4142(l$4140));
t$4661 = (SmlPrims.concat([firstline$4129,basis$List$.s$n$645([body$4139,[tail$3485,null]])]));
t$4688 = [t$4661,fix$4659.$map(v$4052)];
return t$4688;
};
};
var map$4048 = fix$4659.$map;
t$4660 = (map$4048(x$3488));
return SmlPrims.concat(t$4660);
};
tools$Flags$$5.help$3565 = function(x$3568){return tools$Flags$$5.print_help$3482("",tools$Flags$$5.help$$3245(x$3568));
};
tools$Flags$$5.help_all$$3569 = function(v$3571){var dom$3572 = basis$List$.rev$641(tools$Flags$$4.dom$1003(tools$Flags$$5.dir$2454[0]));
var t$4698 = kitlib$Listsort$.sort$45;
var t$4697 = function(v$3689){var v$3690 = v$3689[0];
var v$3691 = v$3690[3];
var v$3692 = v$3689[1];
var v$3693 = v$3692[3];
var fix$4694 = {};
fix$4694.$cmp = function(v$4551,v$4560){lab$cmp: while (true) {if (v$4551 == null) {return (v$4560 == null)?2:0;
} else {if (v$4560 == null) {return 1;
} else {var v$4553 = v$4551;
var v$4554 = v$4553[0];
var v$4555 = v$4553[1];
var v$4556 = v$4560;
var v$4557 = v$4556[0];
var v$4558 = v$4556[1];
switch (basis$String$.compare$342(v$4554,v$4557)) { case 2: {var t$4695 = v$4555;
var t$4696 = v$4558;
var v$4551 = t$4695;
var v$4560 = t$4696;
continue lab$cmp;
 break; }case 1: {return 1;
 break; }default: {return 0;
} };
};
};
};
};
var cmp$4549 = fix$4694.$cmp;
return cmp$4549(v$3691,v$3693);
};
var t$4689;
var b$4196 = null;
var fix$4690 = {};
fix$4690.$foldl = function(v$4199,v$4200){lab$foldl: while (true) {if (v$4200 == null) {return v$4199;
} else {var v$4201 = v$4200;
var v$4202 = v$4201[0];
var v$4203 = v$4201[1];
var t$4691;
var v$4510 = tools$Flags$$5.lookup_notnull_menu$2864(tools$Flags$$5.dir$2454[0],v$4202);
switch (v$4510[0]) { case 0: {var v$4511 = v$4510[1];
switch (v$4511[0]) { case 2: {var v$4512 = v$4511[1];
var v$4513 = v$4512[4];
switch (v$4513[0]) { case 0: {var v$4514 = v$4513[1];
t$4691 = ((v$4514 == v$4202)?v$4199:(basis$List$.s$n$645([tools$Flags$$5.help$$3245(v$4202),v$4199])));
 break; }default: {t$4691 = (basis$List$.s$n$645([tools$Flags$$5.help$$3245(v$4202),v$4199]));
} };
 break; }case 3: {var v$4515 = v$4511[1];
var v$4516 = v$4515[5];
switch (v$4516[0]) { case 0: {var v$4517 = v$4516[1];
t$4691 = ((v$4517 == v$4202)?v$4199:(basis$List$.s$n$645([tools$Flags$$5.help$$3245(v$4202),v$4199])));
 break; }default: {t$4691 = (basis$List$.s$n$645([tools$Flags$$5.help$$3245(v$4202),v$4199]));
} };
 break; }case 4: {var v$4518 = v$4511[1];
var v$4519 = v$4518[6];
switch (v$4519[0]) { case 0: {var v$4520 = v$4519[1];
t$4691 = ((v$4520 == v$4202)?v$4199:(basis$List$.s$n$645([tools$Flags$$5.help$$3245(v$4202),v$4199])));
 break; }default: {t$4691 = (basis$List$.s$n$645([tools$Flags$$5.help$$3245(v$4202),v$4199]));
} };
 break; }case 0: {var v$4521 = v$4511[1];
var v$4522 = v$4521[4];
switch (v$4522[0]) { case 0: {var v$4523 = v$4522[1];
t$4691 = ((v$4523 == v$4202)?v$4199:(basis$List$.s$n$645([tools$Flags$$5.help$$3245(v$4202),v$4199])));
 break; }default: {t$4691 = (basis$List$.s$n$645([tools$Flags$$5.help$$3245(v$4202),v$4199]));
} };
 break; }default: {var v$4524 = v$4511[1];
var v$4525 = v$4524[4];
switch (v$4525[0]) { case 0: {var v$4526 = v$4525[1];
t$4691 = ((v$4526 == v$4202)?v$4199:(basis$List$.s$n$645([tools$Flags$$5.help$$3245(v$4202),v$4199])));
 break; }default: {t$4691 = (basis$List$.s$n$645([tools$Flags$$5.help$$3245(v$4202),v$4199]));
} };
} };
 break; }default: {t$4691 = v$4199;
} };
var t$4692 = t$4691;
var t$4693 = v$4203;
var v$4199 = t$4692;
var v$4200 = t$4693;
continue lab$foldl;
};
};
};
var foldl$4198 = fix$4690.$foldl;
t$4689 = (foldl$4198(b$4196,dom$3572));
return t$4698(t$4697,t$4689);
};
tools$Flags$$5.help_all$3694 = function(v$3696){return tools$Flags$$5.print_help$3482("\n",tools$Flags$$5.help_all$$3569(0));
};
tools$Flags$$5.getOptions$3697 = function(v$4563){return tools$Flags$$5.help_all$$3569(v$4563);
};
return 0;
})();
