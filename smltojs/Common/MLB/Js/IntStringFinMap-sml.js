if ((typeof(tools$IntStringFinMap$)) == "undefined") {tools$IntStringFinMap$ = {};
};
(function(){tools$IntStringFinMap$.fold$53 = function(f$56,a$59,im$62){return tools$IntFinMapPT$.fold$392(function(v$66){var v$67 = v$66[0];
var v$68 = v$66[1];
return tools$StringFinMap$$2.fold$861(f$56,v$68,v$67);
},a$59,im$62);
};
tools$IntStringFinMap$.Fold$69 = function(f$72,a$75,im$78){return tools$IntFinMapPT$.Fold$432(function(v$83){var v$93 = v$83[0];
var v$94 = v$93[0];
var v$95 = v$93[1];
var v$96 = v$83[1];
return tools$StringFinMap$$2.Fold$894(function(v$88){var v$89 = v$88[0];
var v$90 = v$89[0];
var v$91 = v$89[1];
var v$92 = v$88[1];
return f$72([[[v$94,v$90],v$91],v$92]);
},v$96,v$95);
},a$75,im$78);
};
tools$IntStringFinMap$.dom$97 = function(m$100){var a$514 = null;
return tools$IntFinMapPT$.Fold$432(function(v$516){var v$517 = v$516[0];
var v$518 = v$517[0];
var v$519 = v$517[1];
var v$520 = v$516[1];
return tools$StringFinMap$$2.Fold$894(function(v$521){return [[v$518,v$521[0][0]],v$521[1]];
},v$520,v$519);
},a$514,m$100);
};
tools$IntStringFinMap$.empty$108 = function(v$817){return tools$IntFinMapPT$.empty$127(0);
};
tools$IntStringFinMap$.singleton$109 = function(v$115,v$808){var v$116 = v$115[0];
var v$117 = v$115[1];
return tools$IntFinMapPT$.singleton$139(v$116,tools$StringFinMap$$2.singleton$117(v$117,v$808));
};
tools$IntStringFinMap$.isEmpty$119 = function(v$818){return function(v$819){return tools$IntFinMapPT$.isEmpty$146(v$819);
};
};
tools$IntStringFinMap$.lookup$120 = function(m$123,v$127){var v$134 = v$127[0];
var v$135 = v$127[1];
var v$132 = tools$IntFinMapPT$.lookup$154(m$123,v$134);
switch (v$132[0]) { case 1: {return [1];
 break; }default: {var v$133 = v$132[1];
return tools$StringFinMap$$2.lookup$132(v$133,v$135);
} };
};
tools$IntStringFinMap$.add$228 = function(v$241,v$809,v$810){var v$242 = v$241[0];
var v$243 = v$241[1];
var v$239 = tools$IntFinMapPT$.lookup$154(v$810,v$242);
switch (v$239[0]) { case 1: {return tools$IntFinMapPT$.add$264(v$242,tools$StringFinMap$$2.singleton$117(v$243,v$809),v$810);
 break; }default: {var v$240 = v$239[1];
return tools$IntFinMapPT$.add$264(v$242,tools$StringFinMap$$2.add$392(v$243,v$809,v$240),v$810);
} };
};
tools$IntStringFinMap$.plus$246 = function(v$251,v$252){return tools$IntFinMapPT$.mergeMap$382(function(v$811){return tools$StringFinMap$$2.plus$404(v$811[0],v$811[1]);
},v$251,v$252);
};
tools$IntStringFinMap$.remove$253 = function(v$271,v$812){var v$272 = v$271[0];
var v$273 = v$271[1];
var v$263 = tools$IntFinMapPT$.lookup$154(v$812,v$272);
switch (v$263[0]) { case 1: {return [1];
 break; }default: {var v$270 = v$263[1];
var v$268 = tools$StringFinMap$$2.remove$712(v$273,v$270);
switch (v$268[0]) { case 1: {return [1];
 break; }default: {var v$269 = v$268[1];
return [0,tools$IntFinMapPT$.add$264(v$272,v$269,v$812)];
} };
} };
};
tools$IntStringFinMap$.range$275 = function(m$278){var a$568 = null;
return tools$IntFinMapPT$.Fold$432(function(v$570){var v$571 = v$570[0];
var v$573 = v$571[1];
var v$574 = v$570[1];
return tools$StringFinMap$$2.Fold$894(function(v$575){return [v$575[0][1],v$575[1]];
},v$574,v$573);
},a$568,m$278);
};
tools$IntStringFinMap$.composemap$286 = function(f$289,m$292){return tools$IntFinMapPT$.composemap$497(function(v$814){return tools$StringFinMap$$2.composemap$815(f$289,v$814);
},m$292);
};
tools$IntStringFinMap$.ComposeMap$293 = function(f$296,m$299){return tools$IntFinMapPT$.ComposeMap$532(function(v$303){var v$310 = v$303[0];
var v$311 = v$303[1];
return tools$StringFinMap$$2.ComposeMap$838(function(v$307){var v$308 = v$307[0];
var v$309 = v$307[1];
return f$296([[v$310,v$308],v$309]);
},v$311);
},m$299);
};
tools$IntStringFinMap$.list$312 = function(m$315){var a$581 = null;
return tools$IntFinMapPT$.Fold$432(function(v$583){var v$584 = v$583[0];
var v$585 = v$584[0];
var v$586 = v$584[1];
var v$587 = v$583[1];
return tools$StringFinMap$$2.Fold$894(function(v$588){var v$589 = v$588[0];
return [[[v$585,v$589[0]],v$589[1]],v$588[1]];
},v$587,v$586);
},a$581,m$315);
};
tools$IntStringFinMap$.filter$317 = function(f$320,t$323){return tools$IntFinMapPT$.Fold$432(function(v$596){var v$597 = v$596[0];
var v$598 = v$597[0];
var v$599 = v$597[1];
var v$600 = v$596[1];
return tools$StringFinMap$$2.Fold$894(function(v$601){var v$602 = v$601[0];
var v$603 = v$602[0];
var v$604 = v$602[1];
var v$605 = v$601[1];
var v$802 = [v$598,v$603];
if (f$320([v$802,v$604])) {var v$713 = v$802[0];
var v$714 = v$802[1];
var v$717 = tools$IntFinMapPT$.lookup$154(v$605,v$713);
switch (v$717[0]) { case 1: {return tools$IntFinMapPT$.add$264(v$713,tools$StringFinMap$$2.singleton$117(v$714,v$604),v$605);
 break; }default: {var v$718 = v$717[1];
return tools$IntFinMapPT$.add$264(v$713,tools$StringFinMap$$2.add$392(v$714,v$604,v$718),v$605);
} };
} else {return v$605;
};
},v$600,v$599);
},tools$IntFinMapPT$.empty$127(0),t$323);
};
var fix$820 = {};
fix$820.$addList = function(v$340,v$343){lab$addList: while (true) {if (v$340 == null) {return v$343;
} else {var v$355 = v$340;
var v$356 = v$355[0];
var v$357 = v$356[0];
var v$358 = v$356[1];
var v$359 = v$355[1];
var t$822 = v$359;
var t$821;
var v$721 = v$357[0];
var v$722 = v$357[1];
var v$725 = tools$IntFinMapPT$.lookup$154(v$343,v$721);
switch (v$725[0]) { case 1: {t$821 = (tools$IntFinMapPT$.add$264(v$721,tools$StringFinMap$$2.singleton$117(v$722,v$358),v$343));
 break; }default: {var v$726 = v$725[1];
t$821 = (tools$IntFinMapPT$.add$264(v$721,tools$StringFinMap$$2.add$392(v$722,v$358,v$726),v$343));
} };
var t$823 = t$822;
var t$824 = t$821;
var v$340 = t$823;
var v$343 = t$824;
continue lab$addList;
};
};
};
tools$IntStringFinMap$.addList$337 = fix$820.$addList;
tools$IntStringFinMap$.fromList$361 = function(l$364){return tools$IntStringFinMap$.addList$337(l$364,tools$IntFinMapPT$.empty$127(0));
};
tools$IntStringFinMap$.mergeMap$365 = function(f$368,im1$371,im2$374){return tools$IntFinMapPT$.mergeMap$382(function(v$378){var v$379 = v$378[0];
var v$380 = v$378[1];
return tools$StringFinMap$$2.mergeMap$1102(f$368,v$379,v$380);
},im1$371,im2$374);
};
tools$IntStringFinMap$.en$Restrict$381 = new String("Restrict");
tools$IntStringFinMap$.restrict$382 = function(v$402,v$403,v$404){var fix$825 = {};
fix$825.$foldl = function(v$624,v$625){lab$foldl: while (true) {if (v$625 == null) {return v$624;
} else {var v$626 = v$625;
var v$627 = v$626[0];
var v$628 = v$626[1];
var t$826;
var v$738;
var v$739 = v$627[0];
var v$740 = v$627[1];
var v$741 = tools$IntFinMapPT$.lookup$154(v$403,v$739);
switch (v$741[0]) { case 1: {v$738 = [1];
 break; }default: {var v$742 = v$741[1];
v$738 = (tools$StringFinMap$$2.lookup$132(v$742,v$740));
} };
switch (v$738[0]) { case 0: {var v$743 = v$738[1];
var v$746 = v$627[0];
var v$747 = v$627[1];
var v$750 = tools$IntFinMapPT$.lookup$154(v$624,v$746);
switch (v$750[0]) { case 1: {t$826 = (tools$IntFinMapPT$.add$264(v$746,tools$StringFinMap$$2.singleton$117(v$747,v$743),v$624));
 break; }default: {var v$751 = v$750[1];
t$826 = (tools$IntFinMapPT$.add$264(v$746,tools$StringFinMap$$2.add$392(v$747,v$743,v$751),v$624));
} };
 break; }default: {throw [tools$IntStringFinMap$.en$Restrict$381,v$402(v$627)];
} };
var t$827 = t$826;
var t$828 = v$628;
var v$624 = t$827;
var v$625 = t$828;
continue lab$foldl;
};
};
};
var foldl$623 = fix$825.$foldl;
return foldl$623(tools$IntFinMapPT$.empty$127(0),v$404);
};
tools$IntStringFinMap$.enrich$405 = function(en$408,v$412){var v$433 = v$412[0];
var v$434 = v$412[1];
return tools$IntFinMapPT$.Fold$432(function(v$638){var v$639 = v$638[0];
var v$640 = v$639[0];
var v$641 = v$639[1];
var v$642 = v$638[1];
return tools$StringFinMap$$2.Fold$894(function(v$643){var v$644 = v$643[0];
var v$645 = v$644[0];
var v$646 = v$644[1];
if (v$643[1]) {var v$756;
var v$759 = tools$IntFinMapPT$.lookup$154(v$433,v$640);
switch (v$759[0]) { case 1: {v$756 = [1];
 break; }default: {var v$760 = v$759[1];
v$756 = (tools$StringFinMap$$2.lookup$132(v$760,v$645));
} };
switch (v$756[0]) { case 0: {var v$761 = v$756[1];
return en$408([v$761,v$646]);
 break; }default: {return false;
} };
} else {return false;
};
},v$642,v$641);
},true,v$434);
};
tools$IntStringFinMap$.layoutMap$435 = function(v$468,v$470,v$469,v$467){return function(layoutDom$444){return function(layoutRan$447){return function(m$450){var t$833;
var t$829;
var l$655;
var a$763 = null;
l$655 = (tools$IntFinMapPT$.Fold$432(function(v$764){var v$765 = v$764[0];
var v$766 = v$765[0];
var v$767 = v$765[1];
var v$768 = v$764[1];
return tools$StringFinMap$$2.Fold$894(function(v$769){var v$770 = v$769[0];
return [[[v$766,v$770[0]],v$770[1]],v$769[1]];
},v$768,v$767);
},a$763,m$450));
var fix$830 = {};
fix$830.$map = function(v$657){if (v$657 == null) {return null;
} else {var v$658 = v$657;
var v$659 = v$658[0];
var v$660 = v$658[1];
var t$832;
var t$831;
var v$772 = v$659[0];
var v$773 = v$659[1];
t$831 = [0,[[layoutDom$444(v$772),[layoutRan$447(v$773),null]],[0,v$468],"",3,""]];
t$832 = [t$831,fix$830.$map(v$660)];
return t$832;
};
};
var map$656 = fix$830.$map;
t$829 = (map$656(l$655));
t$833 = [t$829,[0,v$469],v$470,3,v$467];
return [0,t$833];
};
};
};
};
tools$IntStringFinMap$.reportMap$471 = function(f$474,t$477){var t$836 = tools$Report$.flatten$78;
var t$834;
var l$662;
var a$775 = null;
l$662 = (tools$IntFinMapPT$.Fold$432(function(v$776){var v$777 = v$776[0];
var v$778 = v$777[0];
var v$779 = v$777[1];
var v$780 = v$776[1];
return tools$StringFinMap$$2.Fold$894(function(v$781){var v$782 = v$781[0];
return [[[v$778,v$782[0]],v$782[1]],v$781[1]];
},v$780,v$779);
},a$775,t$477));
var fix$835 = {};
fix$835.$map = function(v$664){if (v$664 == null) {return null;
} else {var v$665 = v$664;
var v$666 = v$665[0];
var v$667 = v$665[1];
return [f$474(v$666),fix$835.$map(v$667)];
};
};
var map$663 = fix$835.$map;
t$834 = (map$663(l$662));
return t$836(t$834);
};
tools$IntStringFinMap$.pu$479 = function(pu_dom$482,pu_r$485){return tools$IntFinMapPT$.pu$799(pickle$pickle$.int$720,tools$StringFinMap$$2.pu$1282(pickle$pickle$.string$900,pu_r$485));
};
return 0;
})();
