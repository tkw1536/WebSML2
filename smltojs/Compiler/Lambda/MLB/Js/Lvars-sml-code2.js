if ((typeof(compiler_objects$Lvars$$2)) == "undefined") {compiler_objects$Lvars$$2 = {};
};
(function(){compiler_objects$Lvars$$2.die$386 = function(s$389){return tools$Crash$.impossible$50("QuasiMap2." + s$389);
};
compiler_objects$Lvars$$2.key$390 = function(v$1621,v$1622,v$1623,v$1624,v$1625){return v$1623[0][1];
};
compiler_objects$Lvars$$2.rigid$394 = function(v$1626,v$1627,v$1628,v$1629,v$1630){return v$1628[0][2];
};
compiler_objects$Lvars$$2.empty$402 = function(v$1657){return null;
};
compiler_objects$Lvars$$2.singleton$403 = function(v$414,v$415){var nd$408 = v$414[2];
var k$409 = nd$408[0][1];
return nd$408[0][2]?[[0,tools$IntStringFinMap$.singleton$109(k$409,[v$414,v$415])]]:[[1,[tools$IntStringFinMap$.singleton$109(k$409,[v$414,v$415]),special_objects$Name$.current_matchcount$60(0)]]];
};
compiler_objects$Lvars$$2.isEmpty$416 = function(v$419){return (v$419 == null)?true:false;
};
compiler_objects$Lvars$$2.imap$424 = function(v$427){if (v$427 == null) {return [1];
} else {var v$436 = v$427;
switch (v$436[0][0]) { case 0: {var v$438 = v$436[0][1];
return [0,v$438];
 break; }default: {var v$439 = v$436[0][1];
var v$440 = v$439[0];
return [0,v$440];
} };
};
};
compiler_objects$Lvars$$2.imap$$441 = function(v$444){if (v$444 == null) {return tools$Crash$.impossible$50("QuasiMap2.imap': impossible");
} else {var v$454 = v$444;
switch (v$454[0][0]) { case 0: {return v$454[0][1];
 break; }default: {return v$454[0][1][0];
} };
};
};
compiler_objects$Lvars$$2.ensure_consistent_imap$459 = function(imap$462){var v$482 = tools$IntStringFinMap$.Fold$69(function(v$490){var v$499 = v$490[0];
var v$500 = v$499[0];
var v$501 = v$499[1];
var v$502 = v$501[0];
var v$503 = v$490[1];
var v$504 = v$503[0];
var v$505 = v$503[1];
var t$1658;
if (v$504) {var v$1481 = v$502[2][0][1];
t$1658 = ((v$1481[0] == v$500[0])?(v$1481[1] == v$500[1]):false);
} else {t$1658 = false;
};
return [t$1658,v$505?v$502[2][0][2]:false];
},[true,true],imap$462);
var v$483 = v$482[0];
var v$484 = v$482[1];
return [v$483?imap$462:(tools$IntStringFinMap$.fold$53(function(v$475){var v$476 = v$475[0];
var v$477 = v$476[0];
var v$478 = v$476[1];
var v$479 = v$475[1];
return tools$IntStringFinMap$.add$228(v$477[2][0][1],[v$477,v$478],v$479);
},tools$IntStringFinMap$.empty$108(0),imap$462)),v$484];
};
compiler_objects$Lvars$$2.ensure_consistent$506 = function(v$509){if (v$509 == null) {return v$509;
} else {var v$522 = v$509;
switch (v$522[0][0]) { case 0: {return v$509;
 break; }default: {var v$542 = v$522[0][1];
var v$543 = v$542[0];
var v$544 = v$542[1];
if (v$544 < (special_objects$Name$.current_matchcount$60(0))) {var v$539 = compiler_objects$Lvars$$2.ensure_consistent_imap$459(v$543);
var v$540 = v$539[1];
var v$541 = v$539[0];
if (v$540) {(v$522[0] = [0,v$541],0);
return v$509;
} else {(v$522[0] = [1,[v$541,special_objects$Name$.current_matchcount$60(0)]],0);
return v$509;
};
} else {return v$509;
};
} };
};
};
compiler_objects$Lvars$$2.mk_flex$545 = function(imap$548){return [[1,[imap$548,special_objects$Name$.current_matchcount$60(0)]]];
};
compiler_objects$Lvars$$2.mk_rigid$549 = function(imap$552){return [[0,imap$552]];
};
compiler_objects$Lvars$$2.lookup$553 = function(m$556,d$559){var v$564;
var v$1224 = compiler_objects$Lvars$$2.ensure_consistent$506(m$556);
if (v$1224 == null) {v$564 = [1];
} else {var v$1225 = v$1224;
switch (v$1225[0][0]) { case 0: {var v$1226 = v$1225[0][1];
v$564 = [0,v$1226];
 break; }default: {var v$1227 = v$1225[0][1];
var v$1228 = v$1227[0];
v$564 = [0,v$1228];
} };
};
switch (v$564[0]) { case 0: {var v$574 = v$564[1];
var v$570 = tools$IntStringFinMap$.lookup$120(v$574,d$559[2][0][1]);
switch (v$570[0]) { case 0: {var v$572 = v$570[1];
var v$573 = v$572[1];
return [0,v$573];
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
};
compiler_objects$Lvars$$2.add$575 = function(v$600,v$601,v$602){var v$588 = compiler_objects$Lvars$$2.ensure_consistent$506(v$602);
if (v$588 == null) {var nd$1233 = v$600[2];
var k$1234 = nd$1233[0][1];
return nd$1233[0][2]?[[0,tools$IntStringFinMap$.singleton$109(k$1234,[v$600,v$601])]]:[[1,[tools$IntStringFinMap$.singleton$109(k$1234,[v$600,v$601]),special_objects$Name$.current_matchcount$60(0)]]];
} else {var v$589 = v$588;
switch (v$589[0][0]) { case 0: {var v$597 = v$589[0][1];
var nd$591 = v$600[2];
var i$592 = nd$591[0][1];
return nd$591[0][2]?[[0,tools$IntStringFinMap$.add$228(i$592,[v$600,v$601],v$597)]]:[[1,[tools$IntStringFinMap$.add$228(i$592,[v$600,v$601],v$597),special_objects$Name$.current_matchcount$60(0)]]];
 break; }default: {var v$598 = v$589[0][1];
var v$599 = v$598[0];
return [[1,[tools$IntStringFinMap$.add$228(v$600[2][0][1],[v$600,v$601],v$599),special_objects$Name$.current_matchcount$60(0)]]];
} };
};
};
compiler_objects$Lvars$$2.plus$603 = function(v$637,v$638){var m1$608 = compiler_objects$Lvars$$2.ensure_consistent$506(v$637);
var m2$609 = compiler_objects$Lvars$$2.ensure_consistent$506(v$638);
if (m1$608 == null) {return m2$609;
} else {if (m2$609 == null) {return m1$608;
} else {var v$628 = m1$608;
switch (v$628[0][0]) { case 0: {var v$630 = m2$609;
switch (v$630[0][0]) { case 0: {var v$632 = v$628[0][1];
var v$633 = v$630[0][1];
return [[0,tools$IntStringFinMap$.plus$246(v$632,v$633)]];
 break; }default: {var t$1665;
var t$1664;
var t$1663;
var t$1662;
var t$1661 = tools$IntStringFinMap$.plus$246;
var t$1660;
if (m1$608 == null) {t$1660 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1558 = m1$608;
switch (v$1558[0][0]) { case 0: {t$1660 = v$1558[0][1];
 break; }default: {t$1660 = v$1558[0][1][0];
} };
};
var t$1659;
if (m2$609 == null) {t$1659 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1559 = m2$609;
switch (v$1559[0][0]) { case 0: {t$1659 = v$1559[0][1];
 break; }default: {t$1659 = v$1559[0][1][0];
} };
};
t$1662 = (t$1661(t$1660,t$1659));
t$1663 = [t$1662,special_objects$Name$.current_matchcount$60(0)];
t$1664 = [1,t$1663];
t$1665 = [t$1664];
return t$1665;
} };
 break; }default: {var t$1672;
var t$1671;
var t$1670;
var t$1669;
var t$1668 = tools$IntStringFinMap$.plus$246;
var t$1667;
if (m1$608 == null) {t$1667 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1561 = m1$608;
switch (v$1561[0][0]) { case 0: {t$1667 = v$1561[0][1];
 break; }default: {t$1667 = v$1561[0][1][0];
} };
};
var t$1666;
if (m2$609 == null) {t$1666 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1562 = m2$609;
switch (v$1562[0][0]) { case 0: {t$1666 = v$1562[0][1];
 break; }default: {t$1666 = v$1562[0][1][0];
} };
};
t$1669 = (t$1668(t$1667,t$1666));
t$1670 = [t$1669,special_objects$Name$.current_matchcount$60(0)];
t$1671 = [1,t$1670];
t$1672 = [t$1671];
return t$1672;
} };
};
};
};
compiler_objects$Lvars$$2.remove$639 = function(v$680,v$681){var m$644 = compiler_objects$Lvars$$2.ensure_consistent$506(v$681);
if (m$644 == null) {return [1];
} else {var v$653 = m$644;
switch (v$653[0][0]) { case 0: {var v$666 = v$653[0][1];
var v$659 = tools$IntStringFinMap$.remove$253(v$680[2][0][1],v$666);
switch (v$659[0]) { case 0: {var v$665 = v$659[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$665))?[0,null]:[0,[[0,v$665]]];
 break; }default: {return [1];
} };
 break; }default: {var v$678 = v$653[0][1];
var v$679 = v$678[0];
var v$671 = tools$IntStringFinMap$.remove$253(v$680[2][0][1],v$679);
switch (v$671[0]) { case 0: {var v$677 = v$671[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$677))?[0,null]:[0,[[1,[v$677,special_objects$Name$.current_matchcount$60(0)]]]];
 break; }default: {return [1];
} };
} };
};
};
compiler_objects$Lvars$$2.dom$682 = function(v$685){if (v$685 == null) {return null;
} else {var l$1257;
var t$1674 = tools$IntStringFinMap$.range$275;
var t$1673;
var v$1263 = compiler_objects$Lvars$$2.ensure_consistent$506(v$685);
if (v$1263 == null) {t$1673 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1264 = v$1263;
switch (v$1264[0][0]) { case 0: {t$1673 = v$1264[0][1];
 break; }default: {t$1673 = v$1264[0][1][0];
} };
};
l$1257 = (t$1674(t$1673));
var fix$1675 = {};
fix$1675.$map = function(v$1259){if (v$1259 == null) {return null;
} else {var v$1260 = v$1259;
var v$1261 = v$1260[0];
var v$1262 = v$1260[1];
return [v$1261[0],fix$1675.$map(v$1262)];
};
};
var map$1258 = fix$1675.$map;
return map$1258(l$1257);
};
};
compiler_objects$Lvars$$2.range$695 = function(v$698){if (v$698 == null) {return null;
} else {var l$1268;
var t$1677 = tools$IntStringFinMap$.range$275;
var t$1676;
var v$1274 = compiler_objects$Lvars$$2.ensure_consistent$506(v$698);
if (v$1274 == null) {t$1676 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1275 = v$1274;
switch (v$1275[0][0]) { case 0: {t$1676 = v$1275[0][1];
 break; }default: {t$1676 = v$1275[0][1][0];
} };
};
l$1268 = (t$1677(t$1676));
var fix$1678 = {};
fix$1678.$map = function(v$1270){if (v$1270 == null) {return null;
} else {var v$1271 = v$1270;
var v$1272 = v$1271[0];
var v$1273 = v$1271[1];
return [v$1272[1],fix$1678.$map(v$1273)];
};
};
var map$1269 = fix$1678.$map;
return map$1269(l$1268);
};
};
compiler_objects$Lvars$$2.list$708 = function(v$711){if (v$711 == null) {return null;
} else {var t$1680 = tools$IntStringFinMap$.range$275;
var t$1679;
var v$1278 = compiler_objects$Lvars$$2.ensure_consistent$506(v$711);
if (v$1278 == null) {t$1679 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1279 = v$1278;
switch (v$1279[0][0]) { case 0: {t$1679 = v$1279[0][1];
 break; }default: {t$1679 = v$1279[0][1][0];
} };
};
return t$1680(t$1679);
};
};
compiler_objects$Lvars$$2.fromList$717 = function(v$720){if (v$720 == null) {return null;
} else {var v$733;
var b$1283 = [tools$IntStringFinMap$.empty$108(0),true];
var fix$1681 = {};
fix$1681.$foldl = function(v$1286,v$1287){lab$foldl: while (true) {if (v$1287 == null) {return v$1286;
} else {var v$1288 = v$1287;
var v$1289 = v$1288[0];
var v$1290 = v$1288[1];
var t$1682;
var v$1567 = v$1289[0];
var v$1568 = v$1289[1];
var v$1570 = v$1286[0];
var v$1571 = v$1286[1];
t$1682 = [tools$IntStringFinMap$.add$228(v$1567[2][0][1],[v$1567,v$1568],v$1570),v$1571?v$1567[2][0][2]:false];
var t$1683 = t$1682;
var t$1684 = v$1290;
var v$1286 = t$1683;
var v$1287 = t$1684;
continue lab$foldl;
};
};
};
var foldl$1285 = fix$1681.$foldl;
v$733 = (foldl$1285(b$1283,v$720));
var v$734 = v$733[0];
return v$733[1]?[[0,v$734]]:[[1,[v$734,special_objects$Name$.current_matchcount$60(0)]]];
};
};
compiler_objects$Lvars$$2.composemap$752 = function(f$755,m$758){var v$763;
if (m$758 == null) {v$763 = null;
} else {var t$1686 = tools$IntStringFinMap$.range$275;
var t$1685;
var v$1296 = compiler_objects$Lvars$$2.ensure_consistent$506(m$758);
if (v$1296 == null) {t$1685 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1297 = v$1296;
switch (v$1297[0][0]) { case 0: {t$1685 = v$1297[0][1];
 break; }default: {t$1685 = v$1297[0][1][0];
} };
};
v$763 = (t$1686(t$1685));
};
if (v$763 == null) {return null;
} else {var v$771;
var b$1300 = [tools$IntStringFinMap$.empty$108(0),true];
var fix$1687 = {};
fix$1687.$foldl = function(v$1303,v$1304){lab$foldl: while (true) {if (v$1304 == null) {return v$1303;
} else {var v$1305 = v$1304;
var v$1306 = v$1305[0];
var v$1307 = v$1305[1];
var t$1688;
var v$1574 = v$1306[0];
var v$1575 = v$1306[1];
var v$1577 = v$1303[0];
var v$1578 = v$1303[1];
t$1688 = [tools$IntStringFinMap$.add$228(v$1574[2][0][1],[v$1574,f$755(v$1575)],v$1577),v$1578?v$1574[2][0][2]:false];
var t$1689 = t$1688;
var t$1690 = v$1307;
var v$1303 = t$1689;
var v$1304 = t$1690;
continue lab$foldl;
};
};
};
var foldl$1302 = fix$1687.$foldl;
v$771 = (foldl$1302(b$1300,v$763));
var v$772 = v$771[0];
return v$771[1]?[[0,v$772]]:[[1,[v$772,special_objects$Name$.current_matchcount$60(0)]]];
};
};
compiler_objects$Lvars$$2.ComposeMap$790 = function(f$793,m$796){var v$801;
if (m$796 == null) {v$801 = null;
} else {var t$1692 = tools$IntStringFinMap$.range$275;
var t$1691;
var v$1313 = compiler_objects$Lvars$$2.ensure_consistent$506(m$796);
if (v$1313 == null) {t$1691 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1314 = v$1313;
switch (v$1314[0][0]) { case 0: {t$1691 = v$1314[0][1];
 break; }default: {t$1691 = v$1314[0][1][0];
} };
};
v$801 = (t$1692(t$1691));
};
if (v$801 == null) {return null;
} else {var v$809;
var b$1317 = [tools$IntStringFinMap$.empty$108(0),true];
var fix$1693 = {};
fix$1693.$foldl = function(v$1320,v$1321){lab$foldl: while (true) {if (v$1321 == null) {return v$1320;
} else {var v$1322 = v$1321;
var v$1323 = v$1322[0];
var v$1324 = v$1322[1];
var t$1694;
var v$1581 = v$1323[0];
var v$1582 = v$1323[1];
var v$1584 = v$1320[0];
var v$1585 = v$1320[1];
t$1694 = [tools$IntStringFinMap$.add$228(v$1581[2][0][1],[v$1581,f$793([v$1581,v$1582])],v$1584),v$1585?v$1581[2][0][2]:false];
var t$1695 = t$1694;
var t$1696 = v$1324;
var v$1320 = t$1695;
var v$1321 = t$1696;
continue lab$foldl;
};
};
};
var foldl$1319 = fix$1693.$foldl;
v$809 = (foldl$1319(b$1317,v$801));
var v$810 = v$809[0];
return v$809[1]?[[0,v$810]]:[[1,[v$810,special_objects$Name$.current_matchcount$60(0)]]];
};
};
compiler_objects$Lvars$$2.fold$828 = function(f$831,b$834,m$837){var c$1331 = compiler_objects$Lvars$$2.range$695(m$837);
var fix$1697 = {};
fix$1697.$foldl = function(v$1333,v$1334){lab$foldl: while (true) {if (v$1334 == null) {return v$1333;
} else {var v$1335 = v$1334;
var v$1336 = v$1335[0];
var v$1337 = v$1335[1];
var t$1698 = f$831([v$1336,v$1333]);
var t$1699 = v$1337;
var v$1333 = t$1698;
var v$1334 = t$1699;
continue lab$foldl;
};
};
};
var foldl$1332 = fix$1697.$foldl;
return foldl$1332(b$834,c$1331);
};
compiler_objects$Lvars$$2.Fold$838 = function(f$841,b$844,m$847){var c$1340;
if (m$847 == null) {c$1340 = null;
} else {var t$1701 = tools$IntStringFinMap$.range$275;
var t$1700;
var v$1348 = compiler_objects$Lvars$$2.ensure_consistent$506(m$847);
if (v$1348 == null) {t$1700 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1349 = v$1348;
switch (v$1349[0][0]) { case 0: {t$1700 = v$1349[0][1];
 break; }default: {t$1700 = v$1349[0][1][0];
} };
};
c$1340 = (t$1701(t$1700));
};
var fix$1702 = {};
fix$1702.$foldl = function(v$1342,v$1343){lab$foldl: while (true) {if (v$1343 == null) {return v$1342;
} else {var v$1344 = v$1343;
var v$1345 = v$1344[0];
var v$1346 = v$1344[1];
var t$1703 = f$841([v$1345,v$1342]);
var t$1704 = v$1346;
var v$1342 = t$1703;
var v$1343 = t$1704;
continue lab$foldl;
};
};
};
var foldl$1341 = fix$1702.$foldl;
return foldl$1341(b$844,c$1340);
};
compiler_objects$Lvars$$2.filter$848 = function(f$851,m$854){var l$855;
if (m$854 == null) {l$855 = null;
} else {var t$1706 = tools$IntStringFinMap$.range$275;
var t$1705;
var v$1352 = compiler_objects$Lvars$$2.ensure_consistent$506(m$854);
if (v$1352 == null) {t$1705 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1353 = v$1352;
switch (v$1353[0][0]) { case 0: {t$1705 = v$1353[0][1];
 break; }default: {t$1705 = v$1353[0][1][0];
} };
};
l$855 = (t$1706(t$1705));
};
var l$$856;
var fix$1707 = {};
fix$1707.$filter = function(v$1357){lab$filter: while (true) {if (v$1357 == null) {return null;
} else {var v$1358 = v$1357;
var v$1359 = v$1358[0];
var v$1360 = v$1358[1];
if (f$851(v$1359)) {return [v$1359,fix$1707.$filter(v$1360)];
} else {var t$1708 = v$1360;
var v$1357 = t$1708;
continue lab$filter;
};
};
};
};
var filter$1356 = fix$1707.$filter;
l$$856 = (filter$1356(l$855));
return compiler_objects$Lvars$$2.fromList$717(l$$856);
};
compiler_objects$Lvars$$2.addList$857 = function(l$860,m1$863){var m2$864 = compiler_objects$Lvars$$2.fromList$717(l$860);
return compiler_objects$Lvars$$2.plus$603(m1$863,m2$864);
};
compiler_objects$Lvars$$2.mergeMap$865 = function(f$868,m1$871,m2$874){var m1$875 = compiler_objects$Lvars$$2.ensure_consistent$506(m1$871);
var m2$876 = compiler_objects$Lvars$$2.ensure_consistent$506(m2$874);
var f$$877 = function(v$888,v$1631){var v$889 = v$888[0];
var v$890 = v$888[1];
var v$892 = v$1631[0];
var v$893 = v$1631[1];
var t$1709;
var v$1515 = v$889[2][0][1];
var v$1516 = v$892[2][0][1];
t$1709 = ((v$1515[0] == v$1516[0])?(v$1515[1] == v$1516[1]):false);
if (t$1709) {return [v$889,f$868([v$890,v$893])];
} else {return tools$Crash$.impossible$50("QuasiMap2.mergeMap, f'");
};
};
if (m1$875 == null) {return m2$876;
} else {if (m2$876 == null) {return m1$875;
} else {var v$912 = m1$875;
switch (v$912[0][0]) { case 0: {var v$914 = m2$876;
switch (v$914[0][0]) { case 0: {var v$916 = v$912[0][1];
var v$917 = v$914[0][1];
return [[0,tools$IntStringFinMap$.mergeMap$365(function(v$1632){return f$$877(v$1632[0],v$1632[1]);
},v$916,v$917)]];
 break; }default: {var t$1717;
var t$1716;
var t$1715;
var t$1714;
var t$1713 = tools$IntStringFinMap$.mergeMap$365;
var t$1712 = function(v$1633){return f$$877(v$1633[0],v$1633[1]);
};
var t$1711;
if (m1$875 == null) {t$1711 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1588 = m1$875;
switch (v$1588[0][0]) { case 0: {t$1711 = v$1588[0][1];
 break; }default: {t$1711 = v$1588[0][1][0];
} };
};
var t$1710;
if (m2$876 == null) {t$1710 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1589 = m2$876;
switch (v$1589[0][0]) { case 0: {t$1710 = v$1589[0][1];
 break; }default: {t$1710 = v$1589[0][1][0];
} };
};
t$1714 = (t$1713(t$1712,t$1711,t$1710));
t$1715 = [t$1714,special_objects$Name$.current_matchcount$60(0)];
t$1716 = [1,t$1715];
t$1717 = [t$1716];
return t$1717;
} };
 break; }default: {var t$1725;
var t$1724;
var t$1723;
var t$1722;
var t$1721 = tools$IntStringFinMap$.mergeMap$365;
var t$1720 = function(v$1634){return f$$877(v$1634[0],v$1634[1]);
};
var t$1719;
if (m1$875 == null) {t$1719 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1591 = m1$875;
switch (v$1591[0][0]) { case 0: {t$1719 = v$1591[0][1];
 break; }default: {t$1719 = v$1591[0][1][0];
} };
};
var t$1718;
if (m2$876 == null) {t$1718 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1592 = m2$876;
switch (v$1592[0][0]) { case 0: {t$1718 = v$1592[0][1];
 break; }default: {t$1718 = v$1592[0][1][0];
} };
};
t$1722 = (t$1721(t$1720,t$1719,t$1718));
t$1723 = [t$1722,special_objects$Name$.current_matchcount$60(0)];
t$1724 = [1,t$1723];
t$1725 = [t$1724];
return t$1725;
} };
};
};
};
var fix$1726 = {};
fix$1726.$pp_lookup = function(v$924,v$927,v$930){lab$pp_lookup: while (true) {if (v$927 == null) {return tools$Crash$.impossible$50("QuasiMap2.pp_lookup; element not there");
} else {var v$949 = v$927;
var v$950 = v$949[0];
var v$951 = v$949[1];
var t$1727;
var v$1535 = v$950[2][0][1];
t$1727 = ((v$930[0] == v$1535[0])?(v$930[1] == v$1535[1]):false);
if (t$1727) {return v$924(v$950);
} else {var t$1728 = v$924;
var t$1729 = v$951;
var t$1730 = v$930;
var v$924 = t$1728;
var v$927 = t$1729;
var v$930 = t$1730;
continue lab$pp_lookup;
};
};
};
};
compiler_objects$Lvars$$2.pp_lookup$921 = fix$1726.$pp_lookup;
compiler_objects$Lvars$$2.en$Restrict$953 = new String("Restrict");
compiler_objects$Lvars$$2.restrict$954 = function(v$1635,v$1636,v$967){if (v$967 == null) {return null;
} else {var v$974 = compiler_objects$Lvars$$2.ensure_consistent$506(v$1636);
if (v$974 == null) {throw [compiler_objects$Lvars$$2.en$Restrict$953,"[empty map]"];
} else {var im$975;
if (v$974 == null) {im$975 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1387 = v$974;
switch (v$1387[0][0]) { case 0: {im$975 = v$1387[0][1];
 break; }default: {im$975 = v$1387[0][1][0];
} };
};
var ns$976;
var fix$1731 = {};
fix$1731.$map = function(v$1393){if (v$1393 == null) {return null;
} else {var v$1394 = v$1393;
var v$1395 = v$1394[0];
var v$1396 = v$1394[1];
return [v$1395[2][0][1],fix$1731.$map(v$1396)];
};
};
var map$1392 = fix$1731.$map;
ns$976 = (map$1392(v$967));
var im$$978;
try {var t$1738 = tools$IntStringFinMap$.restrict$382;
var t$1737;
var fix$1733 = {};
fix$1733.$pp_lookup = function(v$1650,v$1651){lab$pp_lookup: while (true) {if (v$1650 == null) {return tools$Crash$.impossible$50("QuasiMap2.pp_lookup; element not there");
} else {var v$1652 = v$1650;
var v$1653 = v$1652[0];
var v$1654 = v$1652[1];
var t$1734;
var v$1655 = v$1653[2][0][1];
t$1734 = ((v$1651[0] == v$1655[0])?(v$1651[1] == v$1655[1]):false);
if (t$1734) {return v$1635(v$1653);
} else {var t$1735 = v$1654;
var t$1736 = v$1651;
var v$1650 = t$1735;
var v$1651 = t$1736;
continue lab$pp_lookup;
};
};
};
};
var pp_lookup$1649 = fix$1733.$pp_lookup;
t$1737 = (function(v$1656){return pp_lookup$1649(v$967,v$1656);
});
im$$978 = (t$1738(t$1737,im$975,ns$976));
} catch(v$1732) {im$$978 = ((function(v$982){var t$1739 = v$982;
if (t$1739[0] == tools$IntStringFinMap$.en$Restrict$381) {var s$979 = v$982[1];
throw [compiler_objects$Lvars$$2.en$Restrict$953,s$979];
} else {throw v$982;
};
})(v$1732));
};
return (tools$IntStringFinMap$.fold$53(function(v$987){var v$992 = v$987[0];
var v$993 = v$992[0];
return v$987[1]?v$993[2][0][2]:false;
},true,im$$978))?[[0,im$$978]]:[[1,[im$$978,special_objects$Name$.current_matchcount$60(0)]]];
};
};
};
compiler_objects$Lvars$$2.enrich$1001 = function(f$1004,v$1008){var v$1032 = v$1008[0];
var v$1033 = v$1008[1];
var m1$1009 = compiler_objects$Lvars$$2.ensure_consistent$506(v$1032);
var m2$1010 = compiler_objects$Lvars$$2.ensure_consistent$506(v$1033);
if (m2$1010 == null) {return true;
} else {if (m1$1009 == null) {return false;
} else {var im1$1021;
if (m1$1009 == null) {im1$1021 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1402 = m1$1009;
switch (v$1402[0][0]) { case 0: {im1$1021 = v$1402[0][1];
 break; }default: {im1$1021 = v$1402[0][1][0];
} };
};
var im2$1022;
if (m2$1010 == null) {im2$1022 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1406 = m2$1010;
switch (v$1406[0][0]) { case 0: {im2$1022 = v$1406[0][1];
 break; }default: {im2$1022 = v$1406[0][1][0];
} };
};
return tools$IntStringFinMap$.enrich$405(function(v$1409){var v$1410 = v$1409[0];
var v$1411 = v$1410[1];
var v$1412 = v$1409[1];
var v$1413 = v$1412[1];
return f$1004([v$1411,v$1413]);
},[im1$1021,im2$1022]);
};
};
};
compiler_objects$Lvars$$2.layoutMap$1034 = function(v$1068,v$1070,v$1069,v$1067){return function(pp_dom$1043){return function(pp_range$1046){return function(m$1049){var t$1740;
var v$1065 = [0,v$1069];
var t$1743;
var l$1415;
if (m$1049 == null) {l$1415 = null;
} else {var t$1742 = tools$IntStringFinMap$.range$275;
var t$1741;
var v$1426 = compiler_objects$Lvars$$2.ensure_consistent$506(m$1049);
if (v$1426 == null) {t$1741 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1427 = v$1426;
switch (v$1427[0][0]) { case 0: {t$1741 = v$1427[0][1];
 break; }default: {t$1741 = v$1427[0][1][0];
} };
};
l$1415 = (t$1742(t$1741));
};
var fix$1744 = {};
fix$1744.$map = function(v$1417){if (v$1417 == null) {return null;
} else {var v$1418 = v$1417;
var v$1419 = v$1418[0];
var v$1420 = v$1418[1];
var t$1747;
var t$1745;
var v$1596 = v$1419[0];
var v$1597 = v$1419[1];
var t$1746;
var v$1598 = [0,v$1068];
t$1746 = [[pp_dom$1043(v$1596),[pp_range$1046(v$1597),null]],v$1598,"",1,""];
t$1745 = [0,t$1746];
t$1747 = [t$1745,fix$1744.$map(v$1420)];
return t$1747;
};
};
var map$1416 = fix$1744.$map;
t$1743 = (map$1416(l$1415));
t$1740 = [t$1743,v$1065,v$1070,1,v$1067];
return [0,t$1740];
};
};
};
};
compiler_objects$Lvars$$2.reportMap$1071 = function(f$1074,m$1077){var t$1752 = tools$Report$.flatten$78;
var t$1750;
var l$1430;
if (m$1077 == null) {l$1430 = null;
} else {var t$1749 = tools$IntStringFinMap$.range$275;
var t$1748;
var v$1437 = compiler_objects$Lvars$$2.ensure_consistent$506(m$1077);
if (v$1437 == null) {t$1748 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1438 = v$1437;
switch (v$1438[0][0]) { case 0: {t$1748 = v$1438[0][1];
 break; }default: {t$1748 = v$1438[0][1][0];
} };
};
l$1430 = (t$1749(t$1748));
};
var fix$1751 = {};
fix$1751.$map = function(v$1432){if (v$1432 == null) {return null;
} else {var v$1433 = v$1432;
var v$1434 = v$1433[0];
var v$1435 = v$1433[1];
return [f$1074(v$1434),fix$1751.$map(v$1435)];
};
};
var map$1431 = fix$1751.$map;
t$1750 = (map$1431(l$1430));
return t$1752(t$1750);
};
compiler_objects$Lvars$$2.pu_map0$1078 = function(pu_d$1081,pu_a$1084){var pu_m$1093 = pickle$pickle$.combHash$2081(function(m$1440){return tools$IntStringFinMap$.fold$53(function(v$1441){return SmlPrims.chk_ovf_i32(v$1441[1] + 1);
},0,m$1440);
},tools$IntStringFinMap$.pu$479(pickle$pickle$.pairGen$1044([pickle$pickle$.int$720,pickle$pickle$.string$900]),pickle$pickle$.pairGen$1044([pu_d$1081,pu_a$1084])));
return pickle$pickle$.dataGen$1479(["QuasiMap.map0",function(v$1446){switch (v$1446[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$1447){return pickle$pickle$.con1$2005(function(v$1448){return [0,v$1448];
},function(v$1449){switch (v$1449[0]) { case 0: {return v$1449[1];
 break; }default: {return tools$Crash$.impossible$50("QuasiMap2.pu_map0.Rigid");
} };
},pu_m$1093);
},[function(v$1452){return pickle$pickle$.con1$2005(function(v$1453){return [1,[v$1453[1],-1]];
},function(v$1454){switch (v$1454[0]) { case 1: {var v$1455 = v$1454[1];
return [v$1455[1],v$1455[0]];
 break; }default: {return tools$Crash$.impossible$50("QuasiMap2.pu_map0.Flexible");
} };
},pickle$pickle$.pairGen0$974(special_objects$Name$.pu_matchcount$287,pu_m$1093));
},null]]]);
};
compiler_objects$Lvars$$2.pu$1135 = function(pu_d$1138,pu_a$1141){return pickle$pickle$.convert$2333([function(v$1464){switch (v$1464[0]) { case 0: {var v$1465 = v$1464[1];
return v$1465;
 break; }default: {return null;
} };
},function(v$1466){if (v$1466 == null) {return [1];
} else {var v$1467 = v$1466;
var t$1755;
var t$1754 = tools$IntStringFinMap$.isEmpty$119(0);
var t$1753;
if (v$1466 == null) {t$1753 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1469 = v$1466;
switch (v$1469[0][0]) { case 0: {t$1753 = v$1469[0][1];
 break; }default: {t$1753 = v$1469[0][1][0];
} };
};
t$1755 = (t$1754(t$1753));
if (t$1755) {return tools$Crash$.impossible$50("QuasiMap2.pu.hmmm");
} else {return [0,v$1467];
};
};
}],pickle$pickle$.optionGen$2125(pickle$pickle$.ref0ShGen$1259(compiler_objects$Lvars$$2.pu_map0$1078(pu_d$1138,pu_a$1141))));
};
return 0;
})();
