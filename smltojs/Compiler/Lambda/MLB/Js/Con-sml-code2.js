if ((typeof(compiler_objects$Con$$2)) == "undefined") {compiler_objects$Con$$2 = {};
};
(function(){compiler_objects$Con$$2.die$323 = function(s$326){return tools$Crash$.impossible$50("QuasiMap2." + s$326);
};
compiler_objects$Con$$2.key$327 = function(v$1558,v$1559){return v$1558[0][1];
};
compiler_objects$Con$$2.rigid$331 = function(v$1560,v$1561){return v$1560[0][2];
};
compiler_objects$Con$$2.empty$339 = function(v$1588){return null;
};
compiler_objects$Con$$2.singleton$340 = function(v$351,v$352){var nd$345 = v$351[0];
var k$346 = nd$345[0][1];
return nd$345[0][2]?[[0,tools$IntStringFinMap$.singleton$109(k$346,[v$351,v$352])]]:[[1,[tools$IntStringFinMap$.singleton$109(k$346,[v$351,v$352]),special_objects$Name$.current_matchcount$60(0)]]];
};
compiler_objects$Con$$2.isEmpty$353 = function(v$356){return (v$356 == null)?true:false;
};
compiler_objects$Con$$2.imap$361 = function(v$364){if (v$364 == null) {return [1];
} else {var v$373 = v$364;
switch (v$373[0][0]) { case 0: {var v$375 = v$373[0][1];
return [0,v$375];
 break; }default: {var v$376 = v$373[0][1];
var v$377 = v$376[0];
return [0,v$377];
} };
};
};
compiler_objects$Con$$2.imap$$378 = function(v$381){if (v$381 == null) {return tools$Crash$.impossible$50("QuasiMap2.imap': impossible");
} else {var v$391 = v$381;
switch (v$391[0][0]) { case 0: {return v$391[0][1];
 break; }default: {return v$391[0][1][0];
} };
};
};
compiler_objects$Con$$2.ensure_consistent_imap$396 = function(imap$399){var v$419 = tools$IntStringFinMap$.Fold$69(function(v$427){var v$436 = v$427[0];
var v$437 = v$436[0];
var v$438 = v$436[1];
var v$439 = v$438[0];
var v$440 = v$427[1];
var v$441 = v$440[0];
var v$442 = v$440[1];
var t$1589;
if (v$441) {var v$1418 = v$439[0][0][1];
t$1589 = ((v$1418[0] == v$437[0])?(v$1418[1] == v$437[1]):false);
} else {t$1589 = false;
};
return [t$1589,v$442?v$439[0][0][2]:false];
},[true,true],imap$399);
var v$420 = v$419[0];
var v$421 = v$419[1];
return [v$420?imap$399:(tools$IntStringFinMap$.fold$53(function(v$412){var v$413 = v$412[0];
var v$414 = v$413[0];
var v$415 = v$413[1];
var v$416 = v$412[1];
return tools$IntStringFinMap$.add$228(v$414[0][0][1],[v$414,v$415],v$416);
},tools$IntStringFinMap$.empty$108(0),imap$399)),v$421];
};
compiler_objects$Con$$2.ensure_consistent$443 = function(v$446){if (v$446 == null) {return v$446;
} else {var v$459 = v$446;
switch (v$459[0][0]) { case 0: {return v$446;
 break; }default: {var v$479 = v$459[0][1];
var v$480 = v$479[0];
var v$481 = v$479[1];
if (v$481 < (special_objects$Name$.current_matchcount$60(0))) {var v$476 = compiler_objects$Con$$2.ensure_consistent_imap$396(v$480);
var v$477 = v$476[1];
var v$478 = v$476[0];
if (v$477) {(v$459[0] = [0,v$478],0);
return v$446;
} else {(v$459[0] = [1,[v$478,special_objects$Name$.current_matchcount$60(0)]],0);
return v$446;
};
} else {return v$446;
};
} };
};
};
compiler_objects$Con$$2.mk_flex$482 = function(imap$485){return [[1,[imap$485,special_objects$Name$.current_matchcount$60(0)]]];
};
compiler_objects$Con$$2.mk_rigid$486 = function(imap$489){return [[0,imap$489]];
};
compiler_objects$Con$$2.lookup$490 = function(m$493,d$496){var v$501;
var v$1161 = compiler_objects$Con$$2.ensure_consistent$443(m$493);
if (v$1161 == null) {v$501 = [1];
} else {var v$1162 = v$1161;
switch (v$1162[0][0]) { case 0: {var v$1163 = v$1162[0][1];
v$501 = [0,v$1163];
 break; }default: {var v$1164 = v$1162[0][1];
var v$1165 = v$1164[0];
v$501 = [0,v$1165];
} };
};
switch (v$501[0]) { case 0: {var v$511 = v$501[1];
var v$507 = tools$IntStringFinMap$.lookup$120(v$511,d$496[0][0][1]);
switch (v$507[0]) { case 0: {var v$509 = v$507[1];
var v$510 = v$509[1];
return [0,v$510];
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
};
compiler_objects$Con$$2.add$512 = function(v$537,v$538,v$539){var v$525 = compiler_objects$Con$$2.ensure_consistent$443(v$539);
if (v$525 == null) {var nd$1170 = v$537[0];
var k$1171 = nd$1170[0][1];
return nd$1170[0][2]?[[0,tools$IntStringFinMap$.singleton$109(k$1171,[v$537,v$538])]]:[[1,[tools$IntStringFinMap$.singleton$109(k$1171,[v$537,v$538]),special_objects$Name$.current_matchcount$60(0)]]];
} else {var v$526 = v$525;
switch (v$526[0][0]) { case 0: {var v$534 = v$526[0][1];
var nd$528 = v$537[0];
var i$529 = nd$528[0][1];
return nd$528[0][2]?[[0,tools$IntStringFinMap$.add$228(i$529,[v$537,v$538],v$534)]]:[[1,[tools$IntStringFinMap$.add$228(i$529,[v$537,v$538],v$534),special_objects$Name$.current_matchcount$60(0)]]];
 break; }default: {var v$535 = v$526[0][1];
var v$536 = v$535[0];
return [[1,[tools$IntStringFinMap$.add$228(v$537[0][0][1],[v$537,v$538],v$536),special_objects$Name$.current_matchcount$60(0)]]];
} };
};
};
compiler_objects$Con$$2.plus$540 = function(v$574,v$575){var m1$545 = compiler_objects$Con$$2.ensure_consistent$443(v$574);
var m2$546 = compiler_objects$Con$$2.ensure_consistent$443(v$575);
if (m1$545 == null) {return m2$546;
} else {if (m2$546 == null) {return m1$545;
} else {var v$565 = m1$545;
switch (v$565[0][0]) { case 0: {var v$567 = m2$546;
switch (v$567[0][0]) { case 0: {var v$569 = v$565[0][1];
var v$570 = v$567[0][1];
return [[0,tools$IntStringFinMap$.plus$246(v$569,v$570)]];
 break; }default: {var t$1596;
var t$1595;
var t$1594;
var t$1593;
var t$1592 = tools$IntStringFinMap$.plus$246;
var t$1591;
if (m1$545 == null) {t$1591 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1495 = m1$545;
switch (v$1495[0][0]) { case 0: {t$1591 = v$1495[0][1];
 break; }default: {t$1591 = v$1495[0][1][0];
} };
};
var t$1590;
if (m2$546 == null) {t$1590 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1496 = m2$546;
switch (v$1496[0][0]) { case 0: {t$1590 = v$1496[0][1];
 break; }default: {t$1590 = v$1496[0][1][0];
} };
};
t$1593 = (t$1592(t$1591,t$1590));
t$1594 = [t$1593,special_objects$Name$.current_matchcount$60(0)];
t$1595 = [1,t$1594];
t$1596 = [t$1595];
return t$1596;
} };
 break; }default: {var t$1603;
var t$1602;
var t$1601;
var t$1600;
var t$1599 = tools$IntStringFinMap$.plus$246;
var t$1598;
if (m1$545 == null) {t$1598 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1498 = m1$545;
switch (v$1498[0][0]) { case 0: {t$1598 = v$1498[0][1];
 break; }default: {t$1598 = v$1498[0][1][0];
} };
};
var t$1597;
if (m2$546 == null) {t$1597 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1499 = m2$546;
switch (v$1499[0][0]) { case 0: {t$1597 = v$1499[0][1];
 break; }default: {t$1597 = v$1499[0][1][0];
} };
};
t$1600 = (t$1599(t$1598,t$1597));
t$1601 = [t$1600,special_objects$Name$.current_matchcount$60(0)];
t$1602 = [1,t$1601];
t$1603 = [t$1602];
return t$1603;
} };
};
};
};
compiler_objects$Con$$2.remove$576 = function(v$617,v$618){var m$581 = compiler_objects$Con$$2.ensure_consistent$443(v$618);
if (m$581 == null) {return [1];
} else {var v$590 = m$581;
switch (v$590[0][0]) { case 0: {var v$603 = v$590[0][1];
var v$596 = tools$IntStringFinMap$.remove$253(v$617[0][0][1],v$603);
switch (v$596[0]) { case 0: {var v$602 = v$596[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$602))?[0,null]:[0,[[0,v$602]]];
 break; }default: {return [1];
} };
 break; }default: {var v$615 = v$590[0][1];
var v$616 = v$615[0];
var v$608 = tools$IntStringFinMap$.remove$253(v$617[0][0][1],v$616);
switch (v$608[0]) { case 0: {var v$614 = v$608[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$614))?[0,null]:[0,[[1,[v$614,special_objects$Name$.current_matchcount$60(0)]]]];
 break; }default: {return [1];
} };
} };
};
};
compiler_objects$Con$$2.dom$619 = function(v$622){if (v$622 == null) {return null;
} else {var l$1194;
var t$1605 = tools$IntStringFinMap$.range$275;
var t$1604;
var v$1200 = compiler_objects$Con$$2.ensure_consistent$443(v$622);
if (v$1200 == null) {t$1604 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1201 = v$1200;
switch (v$1201[0][0]) { case 0: {t$1604 = v$1201[0][1];
 break; }default: {t$1604 = v$1201[0][1][0];
} };
};
l$1194 = (t$1605(t$1604));
var fix$1606 = {};
fix$1606.$map = function(v$1196){if (v$1196 == null) {return null;
} else {var v$1197 = v$1196;
var v$1198 = v$1197[0];
var v$1199 = v$1197[1];
return [v$1198[0],fix$1606.$map(v$1199)];
};
};
var map$1195 = fix$1606.$map;
return map$1195(l$1194);
};
};
compiler_objects$Con$$2.range$632 = function(v$635){if (v$635 == null) {return null;
} else {var l$1205;
var t$1608 = tools$IntStringFinMap$.range$275;
var t$1607;
var v$1211 = compiler_objects$Con$$2.ensure_consistent$443(v$635);
if (v$1211 == null) {t$1607 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1212 = v$1211;
switch (v$1212[0][0]) { case 0: {t$1607 = v$1212[0][1];
 break; }default: {t$1607 = v$1212[0][1][0];
} };
};
l$1205 = (t$1608(t$1607));
var fix$1609 = {};
fix$1609.$map = function(v$1207){if (v$1207 == null) {return null;
} else {var v$1208 = v$1207;
var v$1209 = v$1208[0];
var v$1210 = v$1208[1];
return [v$1209[1],fix$1609.$map(v$1210)];
};
};
var map$1206 = fix$1609.$map;
return map$1206(l$1205);
};
};
compiler_objects$Con$$2.list$645 = function(v$648){if (v$648 == null) {return null;
} else {var t$1611 = tools$IntStringFinMap$.range$275;
var t$1610;
var v$1215 = compiler_objects$Con$$2.ensure_consistent$443(v$648);
if (v$1215 == null) {t$1610 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1216 = v$1215;
switch (v$1216[0][0]) { case 0: {t$1610 = v$1216[0][1];
 break; }default: {t$1610 = v$1216[0][1][0];
} };
};
return t$1611(t$1610);
};
};
compiler_objects$Con$$2.fromList$654 = function(v$657){if (v$657 == null) {return null;
} else {var v$670;
var b$1220 = [tools$IntStringFinMap$.empty$108(0),true];
var fix$1612 = {};
fix$1612.$foldl = function(v$1223,v$1224){lab$foldl: while (true) {if (v$1224 == null) {return v$1223;
} else {var v$1225 = v$1224;
var v$1226 = v$1225[0];
var v$1227 = v$1225[1];
var t$1613;
var v$1504 = v$1226[0];
var v$1505 = v$1226[1];
var v$1507 = v$1223[0];
var v$1508 = v$1223[1];
t$1613 = [tools$IntStringFinMap$.add$228(v$1504[0][0][1],[v$1504,v$1505],v$1507),v$1508?v$1504[0][0][2]:false];
var t$1614 = t$1613;
var t$1615 = v$1227;
var v$1223 = t$1614;
var v$1224 = t$1615;
continue lab$foldl;
};
};
};
var foldl$1222 = fix$1612.$foldl;
v$670 = (foldl$1222(b$1220,v$657));
var v$671 = v$670[0];
return v$670[1]?[[0,v$671]]:[[1,[v$671,special_objects$Name$.current_matchcount$60(0)]]];
};
};
compiler_objects$Con$$2.composemap$689 = function(f$692,m$695){var v$700;
if (m$695 == null) {v$700 = null;
} else {var t$1617 = tools$IntStringFinMap$.range$275;
var t$1616;
var v$1233 = compiler_objects$Con$$2.ensure_consistent$443(m$695);
if (v$1233 == null) {t$1616 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1234 = v$1233;
switch (v$1234[0][0]) { case 0: {t$1616 = v$1234[0][1];
 break; }default: {t$1616 = v$1234[0][1][0];
} };
};
v$700 = (t$1617(t$1616));
};
if (v$700 == null) {return null;
} else {var v$708;
var b$1237 = [tools$IntStringFinMap$.empty$108(0),true];
var fix$1618 = {};
fix$1618.$foldl = function(v$1240,v$1241){lab$foldl: while (true) {if (v$1241 == null) {return v$1240;
} else {var v$1242 = v$1241;
var v$1243 = v$1242[0];
var v$1244 = v$1242[1];
var t$1619;
var v$1511 = v$1243[0];
var v$1512 = v$1243[1];
var v$1514 = v$1240[0];
var v$1515 = v$1240[1];
t$1619 = [tools$IntStringFinMap$.add$228(v$1511[0][0][1],[v$1511,f$692(v$1512)],v$1514),v$1515?v$1511[0][0][2]:false];
var t$1620 = t$1619;
var t$1621 = v$1244;
var v$1240 = t$1620;
var v$1241 = t$1621;
continue lab$foldl;
};
};
};
var foldl$1239 = fix$1618.$foldl;
v$708 = (foldl$1239(b$1237,v$700));
var v$709 = v$708[0];
return v$708[1]?[[0,v$709]]:[[1,[v$709,special_objects$Name$.current_matchcount$60(0)]]];
};
};
compiler_objects$Con$$2.ComposeMap$727 = function(f$730,m$733){var v$738;
if (m$733 == null) {v$738 = null;
} else {var t$1623 = tools$IntStringFinMap$.range$275;
var t$1622;
var v$1250 = compiler_objects$Con$$2.ensure_consistent$443(m$733);
if (v$1250 == null) {t$1622 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1251 = v$1250;
switch (v$1251[0][0]) { case 0: {t$1622 = v$1251[0][1];
 break; }default: {t$1622 = v$1251[0][1][0];
} };
};
v$738 = (t$1623(t$1622));
};
if (v$738 == null) {return null;
} else {var v$746;
var b$1254 = [tools$IntStringFinMap$.empty$108(0),true];
var fix$1624 = {};
fix$1624.$foldl = function(v$1257,v$1258){lab$foldl: while (true) {if (v$1258 == null) {return v$1257;
} else {var v$1259 = v$1258;
var v$1260 = v$1259[0];
var v$1261 = v$1259[1];
var t$1625;
var v$1518 = v$1260[0];
var v$1519 = v$1260[1];
var v$1521 = v$1257[0];
var v$1522 = v$1257[1];
t$1625 = [tools$IntStringFinMap$.add$228(v$1518[0][0][1],[v$1518,f$730([v$1518,v$1519])],v$1521),v$1522?v$1518[0][0][2]:false];
var t$1626 = t$1625;
var t$1627 = v$1261;
var v$1257 = t$1626;
var v$1258 = t$1627;
continue lab$foldl;
};
};
};
var foldl$1256 = fix$1624.$foldl;
v$746 = (foldl$1256(b$1254,v$738));
var v$747 = v$746[0];
return v$746[1]?[[0,v$747]]:[[1,[v$747,special_objects$Name$.current_matchcount$60(0)]]];
};
};
compiler_objects$Con$$2.fold$765 = function(f$768,b$771,m$774){var c$1268 = compiler_objects$Con$$2.range$632(m$774);
var fix$1628 = {};
fix$1628.$foldl = function(v$1270,v$1271){lab$foldl: while (true) {if (v$1271 == null) {return v$1270;
} else {var v$1272 = v$1271;
var v$1273 = v$1272[0];
var v$1274 = v$1272[1];
var t$1629 = f$768([v$1273,v$1270]);
var t$1630 = v$1274;
var v$1270 = t$1629;
var v$1271 = t$1630;
continue lab$foldl;
};
};
};
var foldl$1269 = fix$1628.$foldl;
return foldl$1269(b$771,c$1268);
};
compiler_objects$Con$$2.Fold$775 = function(f$778,b$781,m$784){var c$1277;
if (m$784 == null) {c$1277 = null;
} else {var t$1632 = tools$IntStringFinMap$.range$275;
var t$1631;
var v$1285 = compiler_objects$Con$$2.ensure_consistent$443(m$784);
if (v$1285 == null) {t$1631 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1286 = v$1285;
switch (v$1286[0][0]) { case 0: {t$1631 = v$1286[0][1];
 break; }default: {t$1631 = v$1286[0][1][0];
} };
};
c$1277 = (t$1632(t$1631));
};
var fix$1633 = {};
fix$1633.$foldl = function(v$1279,v$1280){lab$foldl: while (true) {if (v$1280 == null) {return v$1279;
} else {var v$1281 = v$1280;
var v$1282 = v$1281[0];
var v$1283 = v$1281[1];
var t$1634 = f$778([v$1282,v$1279]);
var t$1635 = v$1283;
var v$1279 = t$1634;
var v$1280 = t$1635;
continue lab$foldl;
};
};
};
var foldl$1278 = fix$1633.$foldl;
return foldl$1278(b$781,c$1277);
};
compiler_objects$Con$$2.filter$785 = function(f$788,m$791){var l$792;
if (m$791 == null) {l$792 = null;
} else {var t$1637 = tools$IntStringFinMap$.range$275;
var t$1636;
var v$1289 = compiler_objects$Con$$2.ensure_consistent$443(m$791);
if (v$1289 == null) {t$1636 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1290 = v$1289;
switch (v$1290[0][0]) { case 0: {t$1636 = v$1290[0][1];
 break; }default: {t$1636 = v$1290[0][1][0];
} };
};
l$792 = (t$1637(t$1636));
};
var l$$793;
var fix$1638 = {};
fix$1638.$filter = function(v$1294){lab$filter: while (true) {if (v$1294 == null) {return null;
} else {var v$1295 = v$1294;
var v$1296 = v$1295[0];
var v$1297 = v$1295[1];
if (f$788(v$1296)) {return [v$1296,fix$1638.$filter(v$1297)];
} else {var t$1639 = v$1297;
var v$1294 = t$1639;
continue lab$filter;
};
};
};
};
var filter$1293 = fix$1638.$filter;
l$$793 = (filter$1293(l$792));
return compiler_objects$Con$$2.fromList$654(l$$793);
};
compiler_objects$Con$$2.addList$794 = function(l$797,m1$800){var m2$801 = compiler_objects$Con$$2.fromList$654(l$797);
return compiler_objects$Con$$2.plus$540(m1$800,m2$801);
};
compiler_objects$Con$$2.mergeMap$802 = function(f$805,m1$808,m2$811){var m1$812 = compiler_objects$Con$$2.ensure_consistent$443(m1$808);
var m2$813 = compiler_objects$Con$$2.ensure_consistent$443(m2$811);
var f$$814 = function(v$825,v$1562){var v$826 = v$825[0];
var v$827 = v$825[1];
var v$829 = v$1562[0];
var v$830 = v$1562[1];
var t$1640;
var v$1452 = v$826[0][0][1];
var v$1453 = v$829[0][0][1];
t$1640 = ((v$1452[0] == v$1453[0])?(v$1452[1] == v$1453[1]):false);
if (t$1640) {return [v$826,f$805([v$827,v$830])];
} else {return tools$Crash$.impossible$50("QuasiMap2.mergeMap, f'");
};
};
if (m1$812 == null) {return m2$813;
} else {if (m2$813 == null) {return m1$812;
} else {var v$849 = m1$812;
switch (v$849[0][0]) { case 0: {var v$851 = m2$813;
switch (v$851[0][0]) { case 0: {var v$853 = v$849[0][1];
var v$854 = v$851[0][1];
return [[0,tools$IntStringFinMap$.mergeMap$365(function(v$1563){return f$$814(v$1563[0],v$1563[1]);
},v$853,v$854)]];
 break; }default: {var t$1648;
var t$1647;
var t$1646;
var t$1645;
var t$1644 = tools$IntStringFinMap$.mergeMap$365;
var t$1643 = function(v$1564){return f$$814(v$1564[0],v$1564[1]);
};
var t$1642;
if (m1$812 == null) {t$1642 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1525 = m1$812;
switch (v$1525[0][0]) { case 0: {t$1642 = v$1525[0][1];
 break; }default: {t$1642 = v$1525[0][1][0];
} };
};
var t$1641;
if (m2$813 == null) {t$1641 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1526 = m2$813;
switch (v$1526[0][0]) { case 0: {t$1641 = v$1526[0][1];
 break; }default: {t$1641 = v$1526[0][1][0];
} };
};
t$1645 = (t$1644(t$1643,t$1642,t$1641));
t$1646 = [t$1645,special_objects$Name$.current_matchcount$60(0)];
t$1647 = [1,t$1646];
t$1648 = [t$1647];
return t$1648;
} };
 break; }default: {var t$1656;
var t$1655;
var t$1654;
var t$1653;
var t$1652 = tools$IntStringFinMap$.mergeMap$365;
var t$1651 = function(v$1565){return f$$814(v$1565[0],v$1565[1]);
};
var t$1650;
if (m1$812 == null) {t$1650 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1528 = m1$812;
switch (v$1528[0][0]) { case 0: {t$1650 = v$1528[0][1];
 break; }default: {t$1650 = v$1528[0][1][0];
} };
};
var t$1649;
if (m2$813 == null) {t$1649 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1529 = m2$813;
switch (v$1529[0][0]) { case 0: {t$1649 = v$1529[0][1];
 break; }default: {t$1649 = v$1529[0][1][0];
} };
};
t$1653 = (t$1652(t$1651,t$1650,t$1649));
t$1654 = [t$1653,special_objects$Name$.current_matchcount$60(0)];
t$1655 = [1,t$1654];
t$1656 = [t$1655];
return t$1656;
} };
};
};
};
var fix$1657 = {};
fix$1657.$pp_lookup = function(v$861,v$864,v$867){lab$pp_lookup: while (true) {if (v$864 == null) {return tools$Crash$.impossible$50("QuasiMap2.pp_lookup; element not there");
} else {var v$886 = v$864;
var v$887 = v$886[0];
var v$888 = v$886[1];
var t$1658;
var v$1472 = v$887[0][0][1];
t$1658 = ((v$867[0] == v$1472[0])?(v$867[1] == v$1472[1]):false);
if (t$1658) {return v$861(v$887);
} else {var t$1659 = v$861;
var t$1660 = v$888;
var t$1661 = v$867;
var v$861 = t$1659;
var v$864 = t$1660;
var v$867 = t$1661;
continue lab$pp_lookup;
};
};
};
};
compiler_objects$Con$$2.pp_lookup$858 = fix$1657.$pp_lookup;
compiler_objects$Con$$2.en$Restrict$890 = new String("Restrict");
compiler_objects$Con$$2.restrict$891 = function(v$1566,v$1567,v$904){if (v$904 == null) {return null;
} else {var v$911 = compiler_objects$Con$$2.ensure_consistent$443(v$1567);
if (v$911 == null) {throw [compiler_objects$Con$$2.en$Restrict$890,"[empty map]"];
} else {var im$912;
if (v$911 == null) {im$912 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1324 = v$911;
switch (v$1324[0][0]) { case 0: {im$912 = v$1324[0][1];
 break; }default: {im$912 = v$1324[0][1][0];
} };
};
var ns$913;
var fix$1662 = {};
fix$1662.$map = function(v$1330){if (v$1330 == null) {return null;
} else {var v$1331 = v$1330;
var v$1332 = v$1331[0];
var v$1333 = v$1331[1];
return [v$1332[0][0][1],fix$1662.$map(v$1333)];
};
};
var map$1329 = fix$1662.$map;
ns$913 = (map$1329(v$904));
var im$$915;
try {var t$1669 = tools$IntStringFinMap$.restrict$382;
var t$1668;
var fix$1664 = {};
fix$1664.$pp_lookup = function(v$1581,v$1582){lab$pp_lookup: while (true) {if (v$1581 == null) {return tools$Crash$.impossible$50("QuasiMap2.pp_lookup; element not there");
} else {var v$1583 = v$1581;
var v$1584 = v$1583[0];
var v$1585 = v$1583[1];
var t$1665;
var v$1586 = v$1584[0][0][1];
t$1665 = ((v$1582[0] == v$1586[0])?(v$1582[1] == v$1586[1]):false);
if (t$1665) {return v$1566(v$1584);
} else {var t$1666 = v$1585;
var t$1667 = v$1582;
var v$1581 = t$1666;
var v$1582 = t$1667;
continue lab$pp_lookup;
};
};
};
};
var pp_lookup$1580 = fix$1664.$pp_lookup;
t$1668 = (function(v$1587){return pp_lookup$1580(v$904,v$1587);
});
im$$915 = (t$1669(t$1668,im$912,ns$913));
} catch(v$1663) {im$$915 = ((function(v$919){var t$1670 = v$919;
if (t$1670[0] == tools$IntStringFinMap$.en$Restrict$381) {var s$916 = v$919[1];
throw [compiler_objects$Con$$2.en$Restrict$890,s$916];
} else {throw v$919;
};
})(v$1663));
};
return (tools$IntStringFinMap$.fold$53(function(v$924){var v$929 = v$924[0];
var v$930 = v$929[0];
return v$924[1]?v$930[0][0][2]:false;
},true,im$$915))?[[0,im$$915]]:[[1,[im$$915,special_objects$Name$.current_matchcount$60(0)]]];
};
};
};
compiler_objects$Con$$2.enrich$938 = function(f$941,v$945){var v$969 = v$945[0];
var v$970 = v$945[1];
var m1$946 = compiler_objects$Con$$2.ensure_consistent$443(v$969);
var m2$947 = compiler_objects$Con$$2.ensure_consistent$443(v$970);
if (m2$947 == null) {return true;
} else {if (m1$946 == null) {return false;
} else {var im1$958;
if (m1$946 == null) {im1$958 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1339 = m1$946;
switch (v$1339[0][0]) { case 0: {im1$958 = v$1339[0][1];
 break; }default: {im1$958 = v$1339[0][1][0];
} };
};
var im2$959;
if (m2$947 == null) {im2$959 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1343 = m2$947;
switch (v$1343[0][0]) { case 0: {im2$959 = v$1343[0][1];
 break; }default: {im2$959 = v$1343[0][1][0];
} };
};
return tools$IntStringFinMap$.enrich$405(function(v$1346){var v$1347 = v$1346[0];
var v$1348 = v$1347[1];
var v$1349 = v$1346[1];
var v$1350 = v$1349[1];
return f$941([v$1348,v$1350]);
},[im1$958,im2$959]);
};
};
};
compiler_objects$Con$$2.layoutMap$971 = function(v$1005,v$1007,v$1006,v$1004){return function(pp_dom$980){return function(pp_range$983){return function(m$986){var t$1671;
var v$1002 = [0,v$1006];
var t$1674;
var l$1352;
if (m$986 == null) {l$1352 = null;
} else {var t$1673 = tools$IntStringFinMap$.range$275;
var t$1672;
var v$1363 = compiler_objects$Con$$2.ensure_consistent$443(m$986);
if (v$1363 == null) {t$1672 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1364 = v$1363;
switch (v$1364[0][0]) { case 0: {t$1672 = v$1364[0][1];
 break; }default: {t$1672 = v$1364[0][1][0];
} };
};
l$1352 = (t$1673(t$1672));
};
var fix$1675 = {};
fix$1675.$map = function(v$1354){if (v$1354 == null) {return null;
} else {var v$1355 = v$1354;
var v$1356 = v$1355[0];
var v$1357 = v$1355[1];
var t$1678;
var t$1676;
var v$1533 = v$1356[0];
var v$1534 = v$1356[1];
var t$1677;
var v$1535 = [0,v$1005];
t$1677 = [[pp_dom$980(v$1533),[pp_range$983(v$1534),null]],v$1535,"",1,""];
t$1676 = [0,t$1677];
t$1678 = [t$1676,fix$1675.$map(v$1357)];
return t$1678;
};
};
var map$1353 = fix$1675.$map;
t$1674 = (map$1353(l$1352));
t$1671 = [t$1674,v$1002,v$1007,1,v$1004];
return [0,t$1671];
};
};
};
};
compiler_objects$Con$$2.reportMap$1008 = function(f$1011,m$1014){var t$1683 = tools$Report$.flatten$78;
var t$1681;
var l$1367;
if (m$1014 == null) {l$1367 = null;
} else {var t$1680 = tools$IntStringFinMap$.range$275;
var t$1679;
var v$1374 = compiler_objects$Con$$2.ensure_consistent$443(m$1014);
if (v$1374 == null) {t$1679 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1375 = v$1374;
switch (v$1375[0][0]) { case 0: {t$1679 = v$1375[0][1];
 break; }default: {t$1679 = v$1375[0][1][0];
} };
};
l$1367 = (t$1680(t$1679));
};
var fix$1682 = {};
fix$1682.$map = function(v$1369){if (v$1369 == null) {return null;
} else {var v$1370 = v$1369;
var v$1371 = v$1370[0];
var v$1372 = v$1370[1];
return [f$1011(v$1371),fix$1682.$map(v$1372)];
};
};
var map$1368 = fix$1682.$map;
t$1681 = (map$1368(l$1367));
return t$1683(t$1681);
};
compiler_objects$Con$$2.pu_map0$1015 = function(pu_d$1018,pu_a$1021){var pu_m$1030 = pickle$pickle$.combHash$2081(function(m$1377){return tools$IntStringFinMap$.fold$53(function(v$1378){return SmlPrims.chk_ovf_i32(v$1378[1] + 1);
},0,m$1377);
},tools$IntStringFinMap$.pu$479(pickle$pickle$.pairGen$1044([pickle$pickle$.int$720,pickle$pickle$.string$900]),pickle$pickle$.pairGen$1044([pu_d$1018,pu_a$1021])));
return pickle$pickle$.dataGen$1479(["QuasiMap.map0",function(v$1383){switch (v$1383[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$1384){return pickle$pickle$.con1$2005(function(v$1385){return [0,v$1385];
},function(v$1386){switch (v$1386[0]) { case 0: {return v$1386[1];
 break; }default: {return tools$Crash$.impossible$50("QuasiMap2.pu_map0.Rigid");
} };
},pu_m$1030);
},[function(v$1389){return pickle$pickle$.con1$2005(function(v$1390){return [1,[v$1390[1],-1]];
},function(v$1391){switch (v$1391[0]) { case 1: {var v$1392 = v$1391[1];
return [v$1392[1],v$1392[0]];
 break; }default: {return tools$Crash$.impossible$50("QuasiMap2.pu_map0.Flexible");
} };
},pickle$pickle$.pairGen0$974(special_objects$Name$.pu_matchcount$287,pu_m$1030));
},null]]]);
};
compiler_objects$Con$$2.pu$1072 = function(pu_d$1075,pu_a$1078){return pickle$pickle$.convert$2333([function(v$1401){switch (v$1401[0]) { case 0: {var v$1402 = v$1401[1];
return v$1402;
 break; }default: {return null;
} };
},function(v$1403){if (v$1403 == null) {return [1];
} else {var v$1404 = v$1403;
var t$1686;
var t$1685 = tools$IntStringFinMap$.isEmpty$119(0);
var t$1684;
if (v$1403 == null) {t$1684 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1406 = v$1403;
switch (v$1406[0][0]) { case 0: {t$1684 = v$1406[0][1];
 break; }default: {t$1684 = v$1406[0][1][0];
} };
};
t$1686 = (t$1685(t$1684));
if (t$1686) {return tools$Crash$.impossible$50("QuasiMap2.pu.hmmm");
} else {return [0,v$1404];
};
};
}],pickle$pickle$.optionGen$2125(pickle$pickle$.ref0ShGen$1259(compiler_objects$Con$$2.pu_map0$1015(pu_d$1075,pu_a$1078))));
};
return 0;
})();
