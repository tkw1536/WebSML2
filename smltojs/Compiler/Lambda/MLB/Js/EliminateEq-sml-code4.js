if ((typeof(compiler0$EliminateEq$$4)) == "undefined") {compiler0$EliminateEq$$4 = {};
};
(function(){compiler0$EliminateEq$$4.eq_result$4274 = function(v$4276,v$4277){switch (v$4276[0]) { case 0: {switch (v$4277[0]) { case 0: {var v$4278 = v$4276[1];
var v$4279 = v$4277[1];
return (v$4278[0] == v$4279[0])?((v$4278[1] == v$4279[1])?((v$4278[2] == v$4279[2])?((v$4278[3] == v$4279[3])?(v$4278[4] == v$4279[4]):false):false):false):false;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4277[0]) { case 1: {var v$4286 = v$4276[1];
var v$4287 = v$4277[1];
var t$5999;
var v$5558 = v$4286[0];
var v$5559 = v$4287[0];
t$5999 = ((v$5558[0] == v$5559[0])?((v$5558[1] == v$5559[1])?((v$5558[2] == v$5559[2])?((v$5558[3] == v$5559[3])?(v$5558[4] == v$5559[4]):false):false):false):false);
if (t$5999) {var fix$5996 = {};
fix$5996.$eq_list = function(v$4305,v$4306){lab$eq_list: while (true) {if (v$4305 == null) {return (v$4306 == null)?true:false;
} else {if (v$4306 == null) {return false;
} else {var v$4307 = v$4305;
var v$4308 = v$4306;
if (v$4307[0] == v$4308[0]) {var t$5997 = v$4307[1];
var t$5998 = v$4308[1];
var v$4305 = t$5997;
var v$4306 = t$5998;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$4303 = fix$5996.$eq_list;
return eq_list$4303(v$4286[1],v$4287[1]);
} else {return false;
};
 break; }default: {return false;
} };
 break; }case 2: {switch (v$4277[0]) { case 2: {return v$4276[1] == v$4277[1];
 break; }default: {return false;
} };
 break; } };
};
compiler0$EliminateEq$$4.die$2219 = function(s$2222){return tools$Crash$.impossible$50("EliminateEq." + s$2222);
};
compiler0$EliminateEq$$4.log$2223 = function(s$2226){basis$TextIO$.output$101(tools$Flags$$1.log$92[0],s$2226);
tools$Flags$$1.log$92[0];
return 0;
};
compiler0$EliminateEq$$4.quotation$2229 = tools$Flags$$6.is_on0$5026("quotation");
var empty$2233 = [special_objects$TyName$$2.empty$1022(0),compiler0$EliminateEq$$3.empty$152(0),compiler_objects$Lvars$$2.empty$402(0)];
var layout_tynamemap$2605 = ((special_objects$TyName$$2.layoutMap$1654(" -> ","}",", ","TyNameEnv = {"))(function(tn$4585){return [1,special_objects$TyName$$1.pr_TyName$289(tn$4585[0],tn$4585[1],tn$4585[2],tn$4585[3],tn$4585[4],tn$4585[5])];
}))(function(v$4586){switch (v$4586[0]) { case 2: {var v$4587 = v$4586[1];
return [1,v$4587];
 break; }case 1: {var v$4588 = v$4586[1];
var v$4589 = v$4588[0];
return [1,"MONO " + (compiler_objects$Lvars$$1.pr_lvar$68(v$4589[0],v$4589[1],v$4589[2],v$4589[3],v$4589[4]))];
 break; }default: {var v$4591 = v$4586[1];
return [1,"POLY " + (compiler_objects$Lvars$$1.pr_lvar$68(v$4591[0],v$4591[1],v$4591[2],v$4591[3],v$4591[4]))];
} };
});
var layout_tyvarmap$2610 = ((compiler0$EliminateEq$$3.layoutMap$1273(" -> ","}",", ","TyVarEnv = {"))(function(tv$4593){return [1,compiler_objects$LambdaExp$$4.pr_tyvar$1559(tv$4593)];
}))(function(lv$4594){return [1,compiler_objects$Lvars$$1.pr_lvar$$84(lv$4594[0],lv$4594[1],lv$4594[2],lv$4594[3],lv$4594[4])];
});
var layout_lvarmap$2615 = ((compiler_objects$Lvars$$2.layoutMap$1034(" -> ","}",", ","LvarEnv = {"))(function(lv$4595){return [1,compiler_objects$Lvars$$1.pr_lvar$$84(lv$4595[0],lv$4595[1],lv$4595[2],lv$4595[3],lv$4595[4])];
}))(function(tvs$4596){var t$6000;
var v$4597 = [0,","];
var t$6002;
var fix$6001 = {};
fix$6001.$map = function(v$4602){if (v$4602 == null) {return null;
} else {var v$4603 = v$4602;
var v$4604 = v$4603[0];
var v$4605 = v$4603[1];
return [[1,compiler_objects$LambdaExp$$4.pr_tyvar$1559(v$4604)],fix$6001.$map(v$4605)];
};
};
var map$4601 = fix$6001.$map;
t$6002 = (map$4601(tvs$4596));
t$6000 = [t$6002,v$4597,"}",0,"{"];
return [0,t$6000];
});
compiler0$EliminateEq$$4.empty$2638 = empty$2233;
compiler0$EliminateEq$$4.initial$2639 = empty$2233;
compiler0$EliminateEq$$4.plus$2640 = function(v$4608,v$5896){var v$4609 = v$4608[0];
var v$4610 = v$4608[1];
var v$4611 = v$4608[2];
var v$4613 = v$5896[0];
var v$4614 = v$5896[1];
var v$4615 = v$5896[2];
return [special_objects$TyName$$2.plus$1223(v$4609,v$4613),compiler0$EliminateEq$$3.plus$440(v$4610,v$4614),compiler_objects$Lvars$$2.plus$603(v$4611,v$4615)];
};
compiler0$EliminateEq$$4.add_tyname$2641 = function(v$4617,v$4618,v$4619){var v$4620 = v$4619[0];
var v$4621 = v$4619[1];
var v$4622 = v$4619[2];
return [special_objects$TyName$$2.add$1195(v$4617,v$4618,v$4620),v$4621,v$4622];
};
compiler0$EliminateEq$$4.lookup_tyname$2642 = function(v$4624,v$5897,v$5898){return function(v$5929){return special_objects$TyName$$2.lookup$1173(v$4624,v$5929);
};
};
compiler0$EliminateEq$$4.add_tyvar$2643 = function(v$4626,v$4627,v$4628){var v$4629 = v$4628[0];
var v$4630 = v$4628[1];
var v$4631 = v$4628[2];
return [v$4629,compiler0$EliminateEq$$3.add$428(v$4626,v$4627,v$4630),v$4631];
};
compiler0$EliminateEq$$4.lookup_tyvar$2644 = function(v$5899,v$4633,v$5900){return function(v$5931){return compiler0$EliminateEq$$3.lookup$168(v$4633,v$5931);
};
};
compiler0$EliminateEq$$4.add_lvar$2645 = function(v$4635,v$4636,v$4637){var v$4638 = v$4637[0];
var v$4639 = v$4637[1];
var v$4640 = v$4637[2];
return [v$4638,v$4639,compiler_objects$Lvars$$2.add$575(v$4635,v$4636,v$4640)];
};
compiler0$EliminateEq$$4.lookup_lvar$2646 = function(v$5901,v$5902,v$4642){return function(v$5933){return compiler_objects$Lvars$$2.lookup$553(v$4642,v$5933);
};
};
compiler0$EliminateEq$$4.env_range$2647 = function(v$4644,v$5903,v$5904){return special_objects$TyName$$2.range$1315(v$4644);
};
compiler0$EliminateEq$$4.env_map$2648 = function(f$4645,v$4646){var v$4647 = v$4646[0];
var v$4648 = v$4646[1];
var v$4649 = v$4646[2];
return [special_objects$TyName$$2.composemap$1372(f$4645,v$4647),v$4648,v$4649];
};
compiler0$EliminateEq$$4.enrich$2649 = function(v$4651,v$5905){var v$4652 = v$4651[0];
var v$4653 = v$4651[2];
var v$4655 = v$5905[0];
var v$4656 = v$5905[2];
if (special_objects$TyName$$2.Fold$1458(function(v$4660){var v$4661 = v$4660[0];
var v$4662 = v$4661[0];
var v$4663 = v$4661[1];
if (v$4660[1]) {var v$4664 = special_objects$TyName$$2.lookup$1173(v$4652,v$4662);
switch (v$4664[0]) { case 0: {var v$4665 = v$4664[1];
switch (v$4665[0]) { case 0: {switch (v$4663[0]) { case 0: {var v$4669 = v$4665[1];
var v$4670 = v$4663[1];
var v$4674 = v$4669[2];
var v$4675 = v$4670[2];
var v$4676 = v$4674[0][1];
var v$4677 = v$4675[0][1];
return (v$4676[0] == v$4677[0])?(v$4676[1] == v$4677[1]):false;
 break; }default: {switch (v$4663[0]) { case 1: {return tools$Crash$.impossible$50("EliminateEq.eq_tnres.MONOLVAR");
 break; }default: {return false;
} };
} };
 break; }case 1: {return tools$Crash$.impossible$50("EliminateEq.eq_tnres.MONOLVAR");
 break; }default: {switch (v$4663[0]) { case 1: {return tools$Crash$.impossible$50("EliminateEq.eq_tnres.MONOLVAR");
 break; }default: {return false;
} };
} };
 break; }default: {return false;
} };
} else {return false;
};
},true,v$4655)) {return compiler_objects$Lvars$$2.Fold$838(function(v$4684){var v$4685 = v$4684[0];
var v$4686 = v$4685[0];
var v$4687 = v$4685[1];
if (v$4684[1]) {var v$4688 = compiler_objects$Lvars$$2.lookup$553(v$4653,v$4686);
switch (v$4688[0]) { case 0: {var v$4689 = v$4688[1];
var v$5602;
var fix$6003 = {};
fix$6003.$map = function(v$4704){if (v$4704 == null) {return null;
} else {var v$4705 = v$4704;
var v$4706 = v$4705[0];
var v$4707 = v$4705[1];
return [compiler_objects$LambdaExp$$4.equality_tyvar$1555(v$4706),fix$6003.$map(v$4707)];
};
};
var map$4703 = fix$6003.$map;
v$5602 = (map$4703(v$4689));
var v$5603;
var fix$6004 = {};
fix$6004.$map = function(v$4709){if (v$4709 == null) {return null;
} else {var v$4710 = v$4709;
var v$4711 = v$4710[0];
var v$4712 = v$4710[1];
return [compiler_objects$LambdaExp$$4.equality_tyvar$1555(v$4711),fix$6004.$map(v$4712)];
};
};
var map$4708 = fix$6004.$map;
v$5603 = (map$4708(v$4687));
var fix$6005 = {};
fix$6005.$eq_list = function(v$5975,v$5976){lab$eq_list: while (true) {if (v$5975 == null) {return (v$5976 == null)?true:false;
} else {if (v$5976 == null) {return false;
} else {var v$5977 = v$5975;
var v$5978 = v$5976;
if (v$5977[0] == v$5978[0]) {var t$6006 = v$5977[1];
var t$6007 = v$5978[1];
var v$5975 = t$6006;
var v$5976 = t$6007;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$5974 = fix$6005.$eq_list;
return eq_list$5974(v$5602,v$5603);
 break; }default: {return false;
} };
} else {return false;
};
},true,v$4656);
} else {return false;
};
};
compiler0$EliminateEq$$4.match$2650 = function(v$4716,v$5907){var v$4717 = v$4716[0];
var v$4718 = v$4716[1];
var v$4719 = v$4716[2];
var v$4721 = v$5907[0];
var t$6008;
var tnmap$4725 = special_objects$TyName$$2.fromList$1337(special_objects$TyName$$2.list$1328(v$4717));
special_objects$TyName$$2.Fold$1458(function(v$4726){var v$4727 = v$4726[0];
var v$4728 = v$4727[1];
switch (v$4728[0]) { case 0: {var v$4729 = v$4727[0];
var v$4730 = v$4728[1];
var v$4731 = special_objects$TyName$$2.lookup$1173(v$4721,v$4729);
switch (v$4731[0]) { case 0: {var v$4732 = v$4731[1];
switch (v$4732[0]) { case 0: {var v$4733 = v$4732[1];
return compiler_objects$Lvars$$1.match$161(v$4730,v$4733);
 break; }default: {return 0;
} };
 break; }default: {return 0;
} };
 break; }default: {return 0;
} };
},0,tnmap$4725);
t$6008 = tnmap$4725;
return [t$6008,v$4718,v$4719];
};
compiler0$EliminateEq$$4.restrict$2651 = function(v$2668,v$2669){var v$2670 = v$2669[0];
var v$2671 = v$2669[1];
try {var v$4736 = v$2668[0];
var v$4737 = v$2668[2];
var tnmap$$4741;
var fix$6010 = {};
fix$6010.$foldl = function(v$4743,v$4744){lab$foldl: while (true) {if (v$4744 == null) {return v$4743;
} else {var v$4745 = v$4744;
var v$4746 = v$4745[0];
var v$4747 = v$4745[1];
var t$6011;
var v$4751 = special_objects$TyName$$2.lookup$1173(v$4736,v$4746);
switch (v$4751[0]) { case 0: {var v$4752 = v$4751[1];
t$6011 = (special_objects$TyName$$2.add$1195(v$4746,v$4752,v$4743));
 break; }default: {t$6011 = v$4743;
} };
var t$6012 = t$6011;
var t$6013 = v$4747;
var v$4743 = t$6012;
var v$4744 = t$6013;
continue lab$foldl;
};
};
};
var foldl$4742 = fix$6010.$foldl;
tnmap$$4741 = (foldl$4742(special_objects$TyName$$2.empty$1022(0),v$2671));
var t$6022 = special_objects$TyName$$2.Fold$1458(function(v$4753){var v$4754 = v$4753[0];
var v$4755 = v$4754[1];
switch (v$4755[0]) { case 0: {return [v$4755[1],v$4753[1]];
 break; }case 2: {return v$4753[1];
 break; }default: {return tools$Crash$.impossible$50("EliminateEq.restrict.not POLYLVAR");
} };
},null,tnmap$$4741);
var t$6021;
var t$6020 = tnmap$$4741;
var t$6019 = compiler0$EliminateEq$$3.empty$152(0);
var t$6015;
var fix$6014 = {};
fix$6014.$foldl = function(v$4759,v$4760){if (v$4760 == null) {return v$4759;
} else {var v$4761 = v$4760;
var v$4762 = v$4761[0];
var v$4763 = v$4761[1];
var t$6018 = fix$6014.$foldl;
var t$6016;
var v$4767 = compiler_objects$Lvars$$2.lookup$553(v$4737,v$4762);
switch (v$4767[0]) { case 0: {var v$4768 = v$4767[1];
t$6016 = (compiler_objects$Lvars$$2.add$575(v$4762,v$4768,v$4759));
 break; }default: {var dom_lvmap$4769;
var l$4770 = compiler_objects$Lvars$$2.dom$682(v$4737);
var fix$6017 = {};
fix$6017.$pp = function(v$4772){lab$pp: while (true) {if (v$4772 == null) {return "";
} else {var v$4773 = v$4772;
var v$4774 = v$4773[1];
if (v$4774 == null) {var v$4775 = v$4773[0];
return compiler_objects$Lvars$$1.pr_lvar$$84(v$4775[0],v$4775[1],v$4775[2],v$4775[3],v$4775[4]);
} else {var v$4776 = v$4773[0];
return ((compiler_objects$Lvars$$1.pr_lvar$$84(v$4776[0],v$4776[1],v$4776[2],v$4776[3],v$4776[4])) + ", ") + (fix$6017.$pp(v$4774));
};
};
};
};
var pp$4771 = fix$6017.$pp;
dom_lvmap$4769 = (("[" + (pp$4771(l$4770))) + "]");
var s$4781 = (("restrict.lv: " + (compiler_objects$Lvars$$1.pr_lvar$$84(v$4762[0],v$4762[1],v$4762[2],v$4762[3],v$4762[4]))) + " not in map\ndom(lvmap) = ") + dom_lvmap$4769;
t$6016 = (tools$Crash$.impossible$50("EliminateEq." + s$4781));
} };
return t$6018(t$6016,v$4763);
};
};
var foldl$4758 = fix$6014.$foldl;
t$6015 = (foldl$4758(compiler_objects$Lvars$$2.empty$402(0),v$2670));
t$6021 = [t$6020,t$6019,t$6015];
return [t$6022,t$6021];
} catch(v$6009) {return (function(x$2659){basis$TextIO$.output$101([0],"ElimiateEq.restrict failed\n");
basis$TextIO$.output$101([0],"The equality environment is:\n");
var t$6027 = tools$PrettyPrint$.outputTree$1071;
var t$6026;
var t$6025 = function(s$4788){return basis$TextIO$.output$101([0],s$4788);
};
var t$6023;
var v$4790 = v$2668[0];
var v$4791 = v$2668[1];
var v$4792 = v$2668[2];
var t$6024;
var v$4793 = [0,", "];
t$6024 = [[layout_tynamemap$2605(v$4790),[layout_tyvarmap$2610(v$4791),[layout_lvarmap$2615(v$4792),null]]],v$4793,"]",2,"EqElimEnv = ["];
t$6023 = [0,t$6024];
t$6026 = [t$6025,t$6023,70];
t$6027(t$6026);
basis$TextIO$.output$101([0],"(end of equality environment)\n");
throw x$2659;
})(v$6009);
};
};
compiler0$EliminateEq$$4.layout_env$2672 = function(v$4796,v$4797,v$4798){var t$6028;
var v$4799 = [0,", "];
t$6028 = [[layout_tynamemap$2605(v$4796),[layout_tyvarmap$2610(v$4797),[layout_lvarmap$2615(v$4798),null]]],v$4799,"]",2,"EqElimEnv = ["];
return [0,t$6028];
};
compiler0$EliminateEq$$4.mk_eq_tau$2673 = function(tv$2676){var tau$2677 = [0,tv$2676];
return [3,[[[1,[tau$2677,[tau$2677,null]]],null],[compiler_objects$LambdaExp$$4.boolType$1684,null]]];
};
var fix$6029 = {};
fix$6029.$mk_eq_abs = function(v$2681,v$2684,v$2687){lab$mk_eq_abs: while (true) {if (v$2681 == null) {if (v$2684 == null) {return v$2687;
} else {return tools$Crash$.impossible$50("EliminateEq.mk_eq_abs");
};
} else {if (v$2684 == null) {return tools$Crash$.impossible$50("EliminateEq.mk_eq_abs");
} else {var v$2709 = v$2681;
var v$2710 = v$2709[0];
var v$2711 = v$2709[1];
var v$2712 = v$2684;
var v$2713 = v$2712[0];
var v$2714 = v$2712[1];
var t$6030;
var v$2707 = [[v$2710,v$2713],null];
t$6030 = [fix$6029.$mk_eq_abs(v$2711,v$2714,v$2687),v$2707];
return [15,t$6030];
};
};
};
};
compiler0$EliminateEq$$4.mk_eq_abs$2678 = fix$6029.$mk_eq_abs;
var fix$6031 = {};
fix$6031.$mk_env_tyvars = function(v$2719,v$2722,v$2725){lab$mk_env_tyvars: while (true) {if (v$2719 == null) {if (v$2722 == null) {return v$2725;
} else {return tools$Crash$.impossible$50("EliminateEq.mk_env_tyvars");
};
} else {if (v$2722 == null) {return tools$Crash$.impossible$50("EliminateEq.mk_env_tyvars");
} else {var v$2745 = v$2719;
var v$2746 = v$2745[0];
var v$2747 = v$2745[1];
var v$2748 = v$2722;
var v$2749 = v$2748[0];
var v$2750 = v$2748[1];
var t$6034 = v$2747;
var t$6033 = v$2750;
var t$6032;
var v$4817 = v$2725[0];
var v$4818 = v$2725[1];
var v$4819 = v$2725[2];
t$6032 = [v$4817,compiler0$EliminateEq$$3.add$428(v$2746,v$2749,v$4818),v$4819];
var t$6035 = t$6034;
var t$6036 = t$6033;
var t$6037 = t$6032;
var v$2719 = t$6035;
var v$2722 = t$6036;
var v$2725 = t$6037;
continue lab$mk_env_tyvars;
};
};
};
};
compiler0$EliminateEq$$4.mk_env_tyvars$2716 = fix$6031.$mk_env_tyvars;
compiler0$EliminateEq$$4.lamb_true$2752 = [10,[[13,[compiler_objects$Con$$1.con_TRUE$118,null]],null]];
compiler0$EliminateEq$$4.lamb_false$2753 = [10,[[13,[compiler_objects$Con$$1.con_FALSE$119,null]],null]];
compiler0$EliminateEq$$4.lamb_var$2754 = function(lv$2757){return [1,[null,lv$2757]];
};
compiler0$EliminateEq$$4.monolet$2760 = function(v$5908,v$5909,v$5910,v$5911){return [11,[v$5909,[[v$5910,null,v$5908],null],v$5911]];
};
compiler0$EliminateEq$$4.is_eq_prim_tn$2774 = function(v$5912,v$5913,v$5914,v$5915,v$5916,v$5917){var fix$6038 = {};
fix$6038.$exists = function(v$4827){lab$exists: while (true) {if (v$4827 == null) {return false;
} else {var v$4828 = v$4827;
var v$4829 = v$4828[0];
var v$4830 = v$4828[1];
var t$6039;
var v$4842 = v$4829[2];
var v$4844 = v$4842[0][1];
var v$4845 = v$5914[0][1];
t$6039 = ((v$4844[0] == v$4845[0])?(v$4844[1] == v$4845[1]):false);
if (t$6039) {return true;
} else {var t$6040 = v$4830;
var v$4827 = t$6040;
continue lab$exists;
};
};
};
};
var exists$4826 = fix$6038.$exists;
return exists$4826([special_objects$TyName$$1.tyName_INT31$206,[special_objects$TyName$$1.tyName_INT32$210,[special_objects$TyName$$1.tyName_WORD8$218,[special_objects$TyName$$1.tyName_WORD31$222,[special_objects$TyName$$1.tyName_WORD32$226,[special_objects$TyName$$1.tyName_BOOL$202,[special_objects$TyName$$1.tyName_STRING$234,[special_objects$TyName$$1.tyName_REF$250,[special_objects$TyName$$1.tyName_ARRAY$254,[special_objects$TyName$$1.tyName_FOREIGNPTR$266,[special_objects$TyName$$1.tyName_CHARARRAY$262,null]]]]]]]]]]]);
};
compiler0$EliminateEq$$4.en$DONT_SUPPORT_EQ$2781 = new String("DONT_SUPPORT_EQ");
compiler0$EliminateEq$$4.mk_prim_eq$2782 = function(tau$2785){var p$2786 = compiler_objects$Lvars$$1.newLvar$65(0);
return [15,[[10,[[8,[[1,[tau$2785,[tau$2785,null]]]]],[[10,[[1,0],[[1,[null,p$2786]],null]]],[[10,[[1,1],[[1,[null,p$2786]],null]]],null]]]],[[p$2786,[1,[tau$2785,[tau$2785,null]]]],null]]];
};
compiler0$EliminateEq$$4.gen_type_eq$2789 = function(v$5918,v$5919,v$5920){return function(tau$2795){var fix$6041 = {};
fix$6041.$gen = function(tau$2800){switch (tau$2800[0]) { case 0: {var v$2893 = tau$2800[1];
var v$2886 = compiler0$EliminateEq$$3.lookup$168(v$5919,v$2893);
switch (v$2886[0]) { case 0: {return [1,[null,v$2886[1]]];
 break; }default: {return [15,[compiler0$EliminateEq$$4.lamb_false$2753,[[compiler_objects$Lvars$$1.newLvar$65(0),[1,[[0,v$2893],[[0,v$2893],null]]]],null]]];
} };
 break; }case 3: {return tools$Crash$.impossible$50("EliminateEq.gen_type_eq.arrow type.");
 break; }case 2: {var v$2877 = tau$2800[1];
var v$2878 = v$2877[0];
var v$2879 = v$2877[1];
var fix$6042 = {};
fix$6042.$apply = function(v$2818,v$2821){lab$apply: while (true) {if (v$2821 == null) {return v$2818;
} else {var v$2833 = v$2821;
var v$2834 = v$2833[0];
var v$2835 = v$2833[1];
var t$6043 = [18,[v$2818,fix$6041.$gen(v$2834),[1]]];
var t$6044 = v$2835;
var v$2818 = t$6043;
var v$2821 = t$6044;
continue lab$apply;
};
};
};
var apply$2815 = fix$6042.$apply;
if (compiler0$EliminateEq$$4.is_eq_prim_tn$2774(v$2879[0],v$2879[1],v$2879[2],v$2879[3],v$2879[4],v$2879[5])) {return compiler0$EliminateEq$$4.mk_prim_eq$2782(tau$2800);
} else {var v$2854 = special_objects$TyName$$2.lookup$1173(v$5918,v$2879);
switch (v$2854[0]) { case 0: {var v$2856 = v$2854[1];
switch (v$2856[0]) { case 0: {var v$2875 = v$2856[1];
return apply$2815([1,[v$2878,v$2875]],v$2878);
 break; }case 1: {var v$2869 = v$2856[1];
var v$2870 = v$2869[0];
var v$2871 = v$2869[1];
var t$6046;
var v$5657;
var fix$6045 = {};
fix$6045.$map = function(v$4875){if (v$4875 == null) {return null;
} else {var v$4876 = v$4875;
var v$4877 = v$4876[0];
var v$4878 = v$4876[1];
var t$6048;
var t$6047;
switch (v$4877[0]) { case 0: {t$6047 = v$4877[1];
 break; }default: {throw [compiler0$EliminateEq$$4.en$DONT_SUPPORT_EQ$2781,special_objects$TyName$$1.pr_TyName$289(v$2879[0],v$2879[1],v$2879[2],v$2879[3],v$2879[4],v$2879[5])];
} };
t$6048 = [t$6047,fix$6045.$map(v$4878)];
return t$6048;
};
};
var map$4874 = fix$6045.$map;
v$5657 = (map$4874(v$2878));
var fix$6049 = {};
fix$6049.$eq_list = function(v$5981,v$5982){lab$eq_list: while (true) {if (v$5981 == null) {return (v$5982 == null)?true:false;
} else {if (v$5982 == null) {return false;
} else {var v$5983 = v$5981;
var v$5984 = v$5982;
if (v$5983[0] == v$5984[0]) {var t$6050 = v$5983[1];
var t$6051 = v$5984[1];
var v$5981 = t$6050;
var v$5982 = t$6051;
continue lab$eq_list;
} else {return false;
};
};
};
};
};
var eq_list$5980 = fix$6049.$eq_list;
t$6046 = (eq_list$5980(v$5657,v$2871));
if (t$6046) {return apply$2815([1,[null,v$2870]],v$2878);
} else {throw [compiler0$EliminateEq$$4.en$DONT_SUPPORT_EQ$2781,special_objects$TyName$$1.pr_TyName$289(v$2879[0],v$2879[1],v$2879[2],v$2879[3],v$2879[4],v$2879[5])];
};
 break; }default: {var v$2876 = v$2856[1];
throw [compiler0$EliminateEq$$4.en$DONT_SUPPORT_EQ$2781,v$2876];
} };
 break; }default: {var s$4882 = ("gen_type_eq. type name " + (special_objects$TyName$$1.pr_TyName$289(v$2879[0],v$2879[1],v$2879[2],v$2879[3],v$2879[4],v$2879[5]))) + " not in env.";
return tools$Crash$.impossible$50("EliminateEq." + s$4882);
} };
};
 break; }default: {var v$2897 = tau$2800[1];
var p$2894 = compiler_objects$Lvars$$1.newLvar$65(0);
var t$6052;
var v$2895 = [[p$2894,[1,[tau$2800,[tau$2800,null]]]],null];
t$6052 = [fix$6041.$gen_switch(0,p$2894,v$2897),v$2895];
return [15,t$6052];
} };
};
fix$6041.$gen_switch = function(n$2900,p$2903,v$2912){if (v$2912 == null) {return compiler0$EliminateEq$$4.lamb_true$2752;
} else {var v$2913 = v$2912;
var v$2914 = v$2913[1];
if (v$2914 == null) {var v$2922 = v$2913[0];
var v$2915 = [1,[null,p$2903]];
return [18,[fix$6041.$gen(v$2922),[10,[[4],[[10,[[1,n$2900],[[10,[[1,0],[v$2915,null]]],null]]],[[10,[[1,n$2900],[[10,[[1,1],[v$2915,null]]],null]]],null]]]],[1]]];
} else {var v$2931 = v$2913[0];
var v$2923 = [1,[null,p$2903]];
return [6,[0,[[18,[fix$6041.$gen(v$2931),[10,[[4],[[10,[[1,n$2900],[[10,[[1,0],[v$2923,null]]],null]]],[[10,[[1,n$2900],[[10,[[1,1],[v$2923,null]]],null]]],null]]]],[1]]],[[[compiler_objects$Con$$1.con_TRUE$118,[1]],fix$6041.$gen_switch(SmlPrims.chk_ovf_i32(n$2900 + 1),p$2903,v$2914)],null],[0,compiler0$EliminateEq$$4.lamb_false$2753]]]];
};
};
};
var gen$2797 = fix$6041.$gen;
var gen_switch$2796 = fix$6041.$gen_switch;
return gen$2797(tau$2795);
};
};
compiler0$EliminateEq$$4.gen_db$2932 = function(env$2935,v$2940){var v$3145 = v$2940[0];
var v$3146 = v$2940[1];
var v$3147 = v$2940[2];
var tau_tn$2946;
var t$6055;
var t$6054;
var fix$6053 = {};
fix$6053.$map = function(v$4889){if (v$4889 == null) {return null;
} else {var v$4890 = v$4889;
var v$4891 = v$4890[0];
var v$4892 = v$4890[1];
return [[0,v$4891],fix$6053.$map(v$4892)];
};
};
var map$4888 = fix$6053.$map;
t$6054 = (map$4888(v$3145));
t$6055 = [t$6054,v$3146];
tau_tn$2946 = [2,t$6055];
var fix$6056 = {};
fix$6056.$gen_tau = function(v$2951){if (v$2951 == null) {return [3,[[[1,[tau_tn$2946,[tau_tn$2946,null]]],null],[compiler_objects$LambdaExp$$4.boolType$1684,null]]];
} else {var v$2958 = v$2951;
var v$2959 = v$2958[0];
var v$2960 = v$2958[1];
var t$6087;
var t$6086;
var t$6085;
var t$6084;
var tau$4894 = [0,v$2959];
t$6084 = [3,[[[1,[tau$4894,[tau$4894,null]]],null],[compiler_objects$LambdaExp$$4.boolType$1684,null]]];
t$6085 = [t$6084,null];
t$6086 = t$6085;
t$6087 = [t$6086,[fix$6056.$gen_tau(v$2960),null]];
return [3,t$6087];
};
};
var gen_tau$2948 = fix$6056.$gen_tau;
var v$5665 = compiler_objects$Lvars$$1.newLvar$65(0);
var v$5666 = compiler_objects$Lvars$$1.newLvar$65(0);
var v$5667 = compiler_objects$Lvars$$1.newLvar$65(0);
var lvs$2965;
var fix$6057 = {};
fix$6057.$map = function(v$4898){if (v$4898 == null) {return null;
} else {var v$4899 = v$4898;
var v$4901 = v$4899[1];
return [compiler_objects$Lvars$$1.newLvar$65(0),fix$6057.$map(v$4901)];
};
};
var map$4897 = fix$6057.$map;
lvs$2965 = (map$4897(v$3145));
var env$$2968;
var fix$6058 = {};
fix$6058.$extend_env = function(v$2972,v$2975,v$2978){lab$extend_env: while (true) {if (v$2972 == null) {if (v$2975 == null) {return v$2978;
} else {return tools$Crash$.impossible$50("EliminateEq.extend_env");
};
} else {if (v$2975 == null) {return tools$Crash$.impossible$50("EliminateEq.extend_env");
} else {var v$2998 = v$2972;
var v$2999 = v$2998[0];
var v$3000 = v$2998[1];
var v$3001 = v$2975;
var v$3002 = v$3001[0];
var v$3003 = v$3001[1];
var t$6061 = v$3000;
var t$6060 = v$3003;
var t$6059;
var v$4911 = v$2978[0];
var v$4912 = v$2978[1];
var v$4913 = v$2978[2];
t$6059 = [v$4911,compiler0$EliminateEq$$3.add$428(v$2999,v$3002,v$4912),v$4913];
var t$6062 = t$6061;
var t$6063 = t$6060;
var t$6064 = t$6059;
var v$2972 = t$6062;
var v$2975 = t$6063;
var v$2978 = t$6064;
continue lab$extend_env;
};
};
};
};
var extend_env$2969 = fix$6058.$extend_env;
env$$2968 = (extend_env$2969(v$3145,lvs$2965,env$2935));
var fix$6065 = {};
fix$6065.$mk_abs_eq_fns = function(v$3008,v$3011,v$3014){lab$mk_abs_eq_fns: while (true) {if (v$3008 == null) {if (v$3011 == null) {return [15,[v$3014,[[v$5665,[1,[tau_tn$2946,[tau_tn$2946,null]]]],null]]];
} else {return tools$Crash$.impossible$50("EliminateEq.mk_abs_eq_fns");
};
} else {if (v$3011 == null) {return tools$Crash$.impossible$50("EliminateEq.mk_abs_eq_fns");
} else {var v$3038 = v$3008;
var v$3039 = v$3038[0];
var v$3040 = v$3038[1];
var v$3041 = v$3011;
var v$3042 = v$3041[0];
var v$3043 = v$3041[1];
var t$6070;
var v$3036;
var t$6069;
var t$6068;
var t$6067 = v$3042;
var t$6066;
var tau$4922 = [0,v$3039];
t$6066 = [3,[[[1,[tau$4922,[tau$4922,null]]],null],[compiler_objects$LambdaExp$$4.boolType$1684,null]]];
t$6068 = [t$6067,t$6066];
t$6069 = [t$6068,null];
v$3036 = t$6069;
t$6070 = [fix$6065.$mk_abs_eq_fns(v$3040,v$3043,v$3014),v$3036];
return [15,t$6070];
};
};
};
};
var mk_abs_eq_fns$3005 = fix$6065.$mk_abs_eq_fns;
var fix$6071 = {};
fix$6071.$mk_cases = function(v$3101){if (v$3101 == null) {return null;
} else {var v$3117 = v$3101;
var v$3118 = v$3117[0];
var v$3119 = v$3118[0];
var v$3120 = v$3118[1];
var v$3121 = v$3117[1];
var t$6083;
var t$6072;
switch (v$3120[0]) { case 1: {t$6072 = [[v$3119,[1]],[6,[0,[[1,[null,v$5667]],[[[v$3119,[1]],compiler0$EliminateEq$$4.lamb_true$2752],null],[0,compiler0$EliminateEq$$4.lamb_false$2753]]]]];
 break; }default: {var v$3116 = v$3120[1];
var lv$3115 = compiler_objects$Lvars$$1.newLvar$65(0);
var t$6082 = [v$3119,[0,lv$3115]];
var t$6073;
var p1$$4950 = compiler_objects$Lvars$$1.newLvar$65(0);
var mk_decon$4951 = function(p$$4952,p$4953,e$4954){var t$6081;
var t$6080;
var t$6079;
var t$6078;
var t$6077;
var t$6076 = v$3119;
var t$6075;
var fix$6074 = {};
fix$6074.$map = function(v$4960){if (v$4960 == null) {return null;
} else {var v$4961 = v$4960;
var v$4962 = v$4961[0];
var v$4963 = v$4961[1];
return [[0,v$4962],fix$6074.$map(v$4963)];
};
};
var map$4959 = fix$6074.$map;
t$6075 = (map$4959(v$3145));
t$6077 = [t$6076,t$6075,[0,p$$4952]];
t$6078 = [12,t$6077];
t$6079 = [t$6078,[[1,[null,p$4953]],null]];
t$6080 = [10,t$6079];
t$6081 = [t$6080,[[p$$4952,null,v$3116],null],e$4954];
return [11,t$6081];
};
var lamb_eq_fn_tau$4964 = (compiler0$EliminateEq$$4.gen_type_eq$2789(env$$2968[0],env$$2968[1],env$$2968[2]))(v$3116);
t$6073 = [6,[0,[[1,[null,v$5667]],[[[v$3119,[0,p1$$4950]],mk_decon$4951(lv$3115,v$5666,mk_decon$4951(p1$$4950,v$5667,[18,[lamb_eq_fn_tau$4964,[10,[[4],[[1,[null,lv$3115]],[[1,[null,p1$$4950]],null]]]],[1]]]))],null],[0,compiler0$EliminateEq$$4.lamb_false$2753]]]];
t$6072 = [t$6082,t$6073];
} };
t$6083 = [t$6072,fix$6071.$mk_cases(v$3121)];
return t$6083;
};
};
var mk_cases$3098 = fix$6071.$mk_cases;
var big_sw$3122 = [6,[0,[[1,[null,v$5666]],mk_cases$3098(v$3147),[1]]]];
var bind$3123 = mk_abs_eq_fns$3005(v$3145,lvs$2965,[11,[[10,[[1,0],[[1,[null,v$5665]],null]]],[[v$5666,null,tau_tn$2946],null],[11,[[10,[[1,1],[[1,[null,v$5665]],null]]],[[v$5667,null,tau_tn$2946],null],big_sw$3122]]]]);
var lvar$3124;
var v$3130;
var v$4979 = env$$2968[0];
v$3130 = (special_objects$TyName$$2.lookup$1173(v$4979,v$3146));
switch (v$3130[0]) { case 0: {var v$3132 = v$3130[1];
switch (v$3132[0]) { case 1: {lvar$3124 = v$3132[1][0];
 break; }default: {lvar$3124 = (tools$Crash$.impossible$50("EliminateEq.gen_db.lvar"));
} };
 break; }default: {lvar$3124 = (tools$Crash$.impossible$50("EliminateEq.gen_db.lvar"));
} };
return [gen_tau$2948(v$3145),bind$3123,lvar$3124,v$3145];
};
compiler0$EliminateEq$$4.gen_datatype_eq_dbs$3148 = function(v$5922,v$5923,v$5924){return function(dbs$3154){var fix$6088 = {};
fix$6088.$mono_env = function(v$3158,v$3161){lab$mono_env: while (true) {if (v$3158 == null) {return v$3161;
} else {var v$3179 = v$3158;
var v$3180 = v$3179[0];
var v$3181 = v$3180[0];
var v$3182 = v$3180[1];
var v$3183 = v$3179[1];
var env$$3173;
if (v$3182[1]) {var lvar$3178 = compiler_objects$Lvars$$1.new_named_lvar$56("eq_" + (special_objects$TyName$$1.pr_TyName$289(v$3182[0],v$3182[1],v$3182[2],v$3182[3],v$3182[4],v$3182[5])));
var v$5706 = [1,[lvar$3178,v$3181]];
var v$4994 = v$3161[0];
var v$4995 = v$3161[1];
var v$4996 = v$3161[2];
env$$3173 = [special_objects$TyName$$2.add$1195(v$3182,v$5706,v$4994),v$4995,v$4996];
} else {env$$3173 = v$3161;
};
var t$6089 = v$3183;
var t$6090 = env$$3173;
var v$3158 = t$6089;
var v$3161 = t$6090;
continue lab$mono_env;
};
};
};
var mono_env$3155 = fix$6088.$mono_env;
var env$3185 = mono_env$3155(dbs$3154,empty$2233);
var env$$3186;
var v$5003 = env$3185[0];
var v$5004 = env$3185[1];
var v$5005 = env$3185[2];
env$$3186 = [special_objects$TyName$$2.plus$1223(v$5922,v$5003),compiler0$EliminateEq$$3.plus$440(v$5923,v$5004),compiler_objects$Lvars$$2.plus$603(v$5924,v$5005)];
var fix$6091 = {};
fix$6091.$gen_dbs = function(v$3190){lab$gen_dbs: while (true) {if (v$3190 == null) {return null;
} else {var v$3203 = v$3190;
var v$3204 = v$3203[0];
var v$3205 = v$3204[1];
var v$3206 = v$3203[1];
if (v$3205[1]) {return [compiler0$EliminateEq$$4.gen_db$2932(env$$3186,v$3204),fix$6091.$gen_dbs(v$3206)];
} else {var t$6092 = v$3206;
var v$3190 = t$6092;
continue lab$gen_dbs;
};
};
};
};
var gen_dbs$3187 = fix$6091.$gen_dbs;
var functions$3207 = gen_dbs$3187(dbs$3154);
var t$6094 = function(e$5015){return [16,[functions$3207,e$5015]];
};
var t$6093;
var v$5024 = env$3185[0];
var v$5025 = env$3185[1];
var v$5026 = env$3185[2];
t$6093 = [special_objects$TyName$$2.composemap$1372(function(v$5027){switch (v$5027[0]) { case 1: {var v$5028 = v$5027[1];
var v$5029 = v$5028[0];
return [0,v$5029];
 break; }default: {return tools$Crash$.impossible$50("EliminateEq.poly_env");
} };
},v$5024),v$5025,v$5026];
return [t$6094,t$6093];
};
};
var fix$6095 = {};
fix$6095.$gen_datatype_eq = function(env0$3230,dbss$3233){if (dbss$3233 == null) {return [function(lexp$3242){return lexp$3242;
},empty$2233];
} else {var v$3296 = dbss$3233;
var v$3297 = v$3296[0];
var v$3298 = v$3296[1];
var fix$6271 = {};
fix$6271.$fail_env = function(v$3246,v$3249,v$3252){lab$fail_env: while (true) {if (v$3246 == null) {return v$3249;
} else {var v$3271 = v$3246;
var v$3272 = v$3271[0];
var v$3273 = v$3272[1];
var v$3274 = v$3271[1];
var env$$3266;
if (v$3273[1]) {var v$5716 = [2,v$3252];
var v$5036 = v$3249[0];
var v$5037 = v$3249[1];
var v$5038 = v$3249[2];
env$$3266 = [special_objects$TyName$$2.add$1195(v$3273,v$5716,v$5036),v$5037,v$5038];
} else {env$$3266 = v$3249;
};
var t$6272 = v$3274;
var t$6273 = env$$3266;
var t$6274 = v$3252;
var v$3246 = t$6272;
var v$3249 = t$6273;
var v$3252 = t$6274;
continue lab$fail_env;
};
};
};
var fail_env$3243 = fix$6271.$fail_env;
var v$3286;
try {v$3286 = ((compiler0$EliminateEq$$4.gen_datatype_eq_dbs$3148(env0$3230[0],env0$3230[1],env0$3230[2]))(v$3297));
} catch(v$6275) {v$3286 = ((function(v$3292){var t$6276 = v$3292;
if (t$6276[0] == compiler0$EliminateEq$$4.en$DONT_SUPPORT_EQ$2781) {var s$3289 = v$3292[1];
return [function(lexp$3295){return lexp$3295;
},fail_env$3243(v$3297,empty$2233,s$3289)];
} else {throw v$3292;
};
})(v$6275));
};
var v$3287 = v$3286[0];
var v$3288 = v$3286[1];
var v$3283;
var t$6278 = fix$6095.$gen_datatype_eq;
var t$6277;
var v$5041 = env0$3230[0];
var v$5042 = env0$3230[1];
var v$5043 = env0$3230[2];
var v$5045 = v$3288[0];
var v$5046 = v$3288[1];
var v$5047 = v$3288[2];
t$6277 = [special_objects$TyName$$2.plus$1223(v$5041,v$5045),compiler0$EliminateEq$$3.plus$440(v$5042,v$5046),compiler_objects$Lvars$$2.plus$603(v$5043,v$5047)];
v$3283 = (t$6278(t$6277,v$3298));
var v$3284 = v$3283[0];
var v$3285 = v$3283[1];
var t$6280 = function(x$5051){return v$3287(v$3284(x$5051));
};
var t$6279;
var v$5054 = v$3288[0];
var v$5055 = v$3288[1];
var v$5056 = v$3288[2];
var v$5058 = v$3285[0];
var v$5059 = v$3285[1];
var v$5060 = v$3285[2];
t$6279 = [special_objects$TyName$$2.plus$1223(v$5054,v$5058),compiler0$EliminateEq$$3.plus$440(v$5055,v$5059),compiler_objects$Lvars$$2.plus$603(v$5056,v$5060)];
return [t$6280,t$6279];
};
};
compiler0$EliminateEq$$4.gen_datatype_eq$3227 = fix$6095.$gen_datatype_eq;
compiler0$EliminateEq$$4.gen_datatype_for_table$3299 = function(v$3356){var s$3358 = special_objects$TyName$$1.pr_TyName$289(special_objects$TyName$$1.tyName_VECTOR$258[0],special_objects$TyName$$1.tyName_VECTOR$258[1],special_objects$TyName$$1.tyName_VECTOR$258[2],special_objects$TyName$$1.tyName_VECTOR$258[3],special_objects$TyName$$1.tyName_VECTOR$258[4],special_objects$TyName$$1.tyName_VECTOR$258[5]);
var alpha$3359 = compiler_objects$LambdaExp$$4.fresh_tyvar$1580(0);
var tau_alpha$3360 = [0,alpha$3359];
var tau_tyname$3361 = [2,[[tau_alpha$3360,null],special_objects$TyName$$1.tyName_VECTOR$258]];
var lvar_eq_table$3362 = compiler_objects$Lvars$$1.new_named_lvar$56("eq_" + s$3358);
var lvar_eq_alpha$3363 = compiler_objects$Lvars$$1.new_named_lvar$56("eq_'a");
var lvar_table_pair$3364 = compiler_objects$Lvars$$1.new_named_lvar$56(s$3358 + "_pair");
var lvar_table1$3365 = compiler_objects$Lvars$$1.new_named_lvar$56(s$3358 + "1");
var lvar_table2$3366 = compiler_objects$Lvars$$1.new_named_lvar$56(s$3358 + "2");
var lvar_n1$3367 = compiler_objects$Lvars$$1.new_named_lvar$56("n1");
var lvar_n2$3368 = compiler_objects$Lvars$$1.new_named_lvar$56("n2");
var lvar_loop$3369 = compiler_objects$Lvars$$1.new_named_lvar$56("loop");
var lvar_j$3370 = compiler_objects$Lvars$$1.new_named_lvar$56("j");
var var_eq_alpha$3371 = [1,[null,lvar_eq_alpha$3363]];
var var_table_pair$3372 = [1,[null,lvar_table_pair$3364]];
var var_table1$3373 = [1,[null,lvar_table1$3365]];
var var_table2$3374 = [1,[null,lvar_table2$3366]];
var var_n1$3375 = [1,[null,lvar_n1$3367]];
var var_n2$3376 = [1,[null,lvar_n2$3368]];
var var_loop$3377 = [1,[null,lvar_loop$3369]];
var var_j$3378 = [1,[null,lvar_j$3370]];
var let_nX_equal_table_size_in_bytes$3383 = function(lvar_nX$3386,var_tableX$3389,scope$3392){var alpha$$3393 = compiler_objects$LambdaExp$$4.fresh_tyvar$1580(0);
var v$5732 = compiler_objects$LambdaExp$$4.intDefaultType$1676(0);
var t$6100;
var t$6099;
var t$6098;
var t$6097;
var t$6096;
var v$3395 = [alpha$$3393,null];
var v$3396 = [[0,alpha$3359],null];
t$6096 = [[3,[[[2,[[[0,alpha$$3393],null],special_objects$TyName$$1.tyName_VECTOR$258]],null],[compiler_objects$LambdaExp$$4.intDefaultType$1676(0),null]]],v$3396,"table_size",v$3395];
t$6097 = [14,t$6096];
t$6098 = [t$6097,[var_tableX$3389,null]];
t$6099 = [10,t$6098];
t$6100 = [t$6099,[[lvar_nX$3386,null,v$5732],null],scope$3392];
return [11,t$6100];
};
var sub$3402 = function(var_tableX$3405){var alpha$$3406 = compiler_objects$LambdaExp$$4.fresh_tyvar$1580(0);
var tau_alpha$$3407 = [0,alpha$$3406];
var t$6103;
var t$6102;
var t$6101;
var v$3409 = [alpha$$3406,null];
var v$3410 = [[0,alpha$3359],null];
t$6101 = [[3,[[[2,[[tau_alpha$$3407,null],special_objects$TyName$$1.tyName_VECTOR$258]],[compiler_objects$LambdaExp$$4.intDefaultType$1676(0),null]],[tau_alpha$$3407,null]]],v$3410,"word_sub0",v$3409];
t$6102 = [14,t$6101];
t$6103 = [t$6102,[var_tableX$3405,[var_j$3378,null]]];
return [10,t$6103];
};
var tag_values$3416 = tools$Flags$$6.is_on0$5026("tag_values");
var t$6174 = function(scope$5150){var t$6173;
var t$6172;
var t$6171;
var t$6105;
var v$5151 = [alpha$3359,null];
var t$6170 = [3,[[[3,[[[1,[tau_alpha$3360,[tau_alpha$3360,null]]],null],[compiler_objects$LambdaExp$$4.boolType$1684,null]]],null],[[3,[[[1,[tau_tyname$3361,[tau_tyname$3361,null]]],null],[compiler_objects$LambdaExp$$4.boolType$1684,null]]],null]]];
var t$6169;
var t$6106;
var v$5152 = [[lvar_eq_alpha$3363,[3,[[[1,[tau_alpha$3360,[tau_alpha$3360,null]]],null],[compiler_objects$LambdaExp$$4.boolType$1684,null]]]],null];
var t$6168;
var t$6107;
var v$5153 = [[lvar_table_pair$3364,[1,[tau_tyname$3361,[tau_tyname$3361,null]]]],null];
var t$6167;
var t$6166;
var t$6165 = [10,[[1,0],[var_table_pair$3372,null]]];
var t$6164 = [[lvar_table1$3365,null,tau_tyname$3361],null];
var t$6163;
var t$6162;
var t$6161 = [10,[[1,1],[var_table_pair$3372,null]]];
var t$6160 = [[lvar_table2$3366,null,tau_tyname$3361],null];
var t$6159;
var t$6158 = let_nX_equal_table_size_in_bytes$3383;
var t$6157 = lvar_n1$3367;
var t$6156 = var_table1$3373;
var t$6155;
var t$6154 = let_nX_equal_table_size_in_bytes$3383;
var t$6153 = lvar_n2$3368;
var t$6152 = var_table2$3374;
var t$6151;
var t$6150;
var t$6149;
var t$6148;
var t$6122;
var v$5156 = null;
var t$6147 = [3,[[compiler_objects$LambdaExp$$4.intDefaultType$1676(0),null],[compiler_objects$LambdaExp$$4.boolType$1684,null]]];
var t$6146;
var t$6123;
var v$5157 = [[lvar_j$3370,compiler_objects$LambdaExp$$4.intDefaultType$1676(0)],null];
var t$6145;
var t$6144;
var t$6143;
var t$6142;
var t$6141;
var t$6140;
var n$5158 = (tag_values$3416(0))?"__less_int31":"__less_int32ub";
var t$5159 = compiler_objects$LambdaExp$$4.intDefaultType$1676(0);
t$6140 = [14,[[3,[[t$5159,[t$5159,null]],[compiler_objects$LambdaExp$$4.boolType$1684,null]]],null,n$5158,null]];
t$6141 = [t$6140,[var_j$3378,[[12,[0,compiler_objects$LambdaExp$$4.intDefaultType$1676(0)]],null]]];
t$6142 = [10,t$6141];
var t$6139 = [[[compiler_objects$Con$$1.con_TRUE$118,[1]],compiler0$EliminateEq$$4.lamb_true$2752],null];
var t$6138;
var t$6137;
var t$6136;
var t$6135;
var t$6134 = [18,[var_eq_alpha$3371,[10,[[4],[sub$3402(var_table1$3373),[sub$3402(var_table2$3374),null]]]],[1]]];
var t$6133;
var t$6132;
var t$6131;
var t$6130 = [compiler_objects$Con$$1.con_TRUE$118,[1]];
var t$6129;
var t$6128;
var t$6127 = var_loop$3377;
var t$6126;
var t$6125;
var t$6124;
var n$5160 = (tag_values$3416(0))?"__minus_int31":"__minus_int32ub";
var t$5161 = compiler_objects$LambdaExp$$4.intDefaultType$1676(0);
t$6124 = [14,[[3,[[t$5161,[t$5161,null]],[t$5161,null]]],null,n$5160,null]];
t$6125 = [t$6124,[var_j$3378,[[12,[1,compiler_objects$LambdaExp$$4.intDefaultType$1676(0)]],null]]];
t$6126 = [10,t$6125];
t$6128 = [t$6127,t$6126,[1]];
t$6129 = [18,t$6128];
t$6131 = [t$6130,t$6129];
t$6132 = [t$6131,null];
t$6133 = t$6132;
t$6135 = [t$6134,t$6133,[0,compiler0$EliminateEq$$4.lamb_false$2753]];
t$6136 = [0,t$6135];
t$6137 = [6,t$6136];
t$6138 = [0,t$6137];
t$6143 = [t$6142,t$6139,t$6138];
t$6144 = [0,t$6143];
t$6145 = [6,t$6144];
t$6123 = [t$6145,v$5157];
t$6146 = [15,t$6123];
t$6122 = [t$6147,t$6146,lvar_loop$3369,v$5156];
t$6148 = [t$6122,null];
t$6149 = t$6148;
var t$6121;
var t$6120;
var t$6119;
var t$6118 = [10,[[8,[[1,[compiler_objects$LambdaExp$$4.intDefaultType$1676(0),[compiler_objects$LambdaExp$$4.intDefaultType$1676(0),null]]]]],[var_n1$3375,[var_n2$3376,null]]]];
var t$6117;
var t$6116;
var t$6115;
var t$6114 = [compiler_objects$Con$$1.con_TRUE$118,[1]];
var t$6113;
var t$6112;
var t$6111 = var_loop$3377;
var t$6110;
var t$6109;
var t$6108;
var n$5162 = (tag_values$3416(0))?"__minus_int31":"__minus_int32ub";
var t$5163 = compiler_objects$LambdaExp$$4.intDefaultType$1676(0);
t$6108 = [14,[[3,[[t$5163,[t$5163,null]],[t$5163,null]]],null,n$5162,null]];
t$6109 = [t$6108,[var_n2$3376,[[12,[1,compiler_objects$LambdaExp$$4.intDefaultType$1676(0)]],null]]];
t$6110 = [10,t$6109];
t$6112 = [t$6111,t$6110,[1]];
t$6113 = [18,t$6112];
t$6115 = [t$6114,t$6113];
t$6116 = [t$6115,null];
t$6117 = t$6116;
t$6119 = [t$6118,t$6117,[0,compiler0$EliminateEq$$4.lamb_false$2753]];
t$6120 = [0,t$6119];
t$6121 = [6,t$6120];
t$6150 = [t$6149,t$6121];
t$6151 = [16,t$6150];
t$6155 = (t$6154(t$6153,t$6152,t$6151));
t$6159 = (t$6158(t$6157,t$6156,t$6155));
t$6162 = [t$6161,t$6160,t$6159];
t$6163 = [11,t$6162];
t$6166 = [t$6165,t$6164,t$6163];
t$6167 = [11,t$6166];
t$6107 = [t$6167,v$5153];
t$6168 = [15,t$6107];
t$6106 = [t$6168,v$5152];
t$6169 = [15,t$6106];
t$6105 = [t$6170,t$6169,lvar_eq_table$3362,v$5151];
t$6171 = [t$6105,null];
t$6172 = t$6171;
t$6173 = [t$6172,scope$5150];
return [16,t$6173];
};
var t$6104;
var v$5745 = [0,lvar_eq_table$3362];
var v$5168 = empty$2233[0];
var v$5169 = empty$2233[1];
var v$5170 = empty$2233[2];
t$6104 = [special_objects$TyName$$2.add$1195(special_objects$TyName$$1.tyName_VECTOR$258,v$5745,v$5168),v$5169,v$5170];
return [t$6174,t$6104];
};
compiler0$EliminateEq$$4.gen_datatype_for_quotation$3300 = function(v$3343){if (compiler0$EliminateEq$$4.quotation$2229(0)) {var tv$3348 = compiler_objects$LambdaExp$$4.fresh_tyvar$1580(0);
var tau_tv$3349 = [0,tv$3348];
var cbs$3350 = [[compiler_objects$Con$$1.con_QUOTE$122,[0,[2,[null,special_objects$TyName$$1.tyName_STRING$234]]]],[[compiler_objects$Con$$1.con_ANTIQUOTE$123,[0,tau_tv$3349]],null]];
var dbss$3351 = [[[[tv$3348,null],special_objects$TyName$$1.tyName_FRAG$246,cbs$3350],null],null];
return compiler0$EliminateEq$$4.gen_datatype_eq$3227(empty$2233,dbss$3351);
} else {return [function(e$3354){return e$3354;
},empty$2233];
};
};
compiler0$EliminateEq$$4.gen_datatype_for_intinf$3301 = function(e$3336){var int31$3337 = [2,[null,special_objects$TyName$$1.tyName_INT31$206]];
var int31list$3338 = [2,[[int31$3337,null],special_objects$TyName$$1.tyName_LIST$242]];
var bool$3339 = [2,[null,special_objects$TyName$$1.tyName_BOOL$202]];
var cbs$3340 = [[compiler_objects$Con$$1.con_INTINF$124,[0,[1,[int31list$3338,[bool$3339,null]]]]],null];
var dbss$3341 = function(v$5994){return [[[null,special_objects$TyName$$1.tyName_INTINF$214,cbs$3340],null],null];
};
return compiler0$EliminateEq$$4.gen_datatype_eq$3227(e$3336,dbss$3341(0));
};
compiler0$EliminateEq$$4.gen_datatype_builtin_eq$3302 = function(v$3304){var tv$3306 = compiler_objects$LambdaExp$$4.fresh_tyvar$1580(0);
var tau_tv$3307 = [0,tv$3306];
var cbs$3308 = [[compiler_objects$Con$$1.con_CONS$121,[0,[1,[tau_tv$3307,[[2,[[tau_tv$3307,null],special_objects$TyName$$1.tyName_LIST$242]],null]]]]],[[compiler_objects$Con$$1.con_NIL$120,[1]],null]];
var dbss$3309 = [[[[tv$3306,null],special_objects$TyName$$1.tyName_LIST$242,cbs$3308],null],null];
var v$3331 = compiler0$EliminateEq$$4.gen_datatype_eq$3227(empty$2233,dbss$3309);
var v$3332 = v$3331[0];
var v$3333 = v$3331[1];
var v$3328 = compiler0$EliminateEq$$4.gen_datatype_for_table$3299(0);
var v$3329 = v$3328[0];
var v$3330 = v$3328[1];
var v$3325 = compiler0$EliminateEq$$4.gen_datatype_for_quotation$3300(0);
var v$3326 = v$3325[0];
var v$3327 = v$3325[1];
var v$3322;
var int31$5172 = [2,[null,special_objects$TyName$$1.tyName_INT31$206]];
var int31list$5173 = [2,[[int31$5172,null],special_objects$TyName$$1.tyName_LIST$242]];
var bool$5174 = [2,[null,special_objects$TyName$$1.tyName_BOOL$202]];
var cbs$5175 = [[compiler_objects$Con$$1.con_INTINF$124,[0,[1,[int31list$5173,[bool$5174,null]]]]],null];
var dbss$5176 = function(v$5995){return [[[null,special_objects$TyName$$1.tyName_INTINF$214,cbs$5175],null],null];
};
v$3322 = (compiler0$EliminateEq$$4.gen_datatype_eq$3227(v$3333,dbss$5176(0)));
var v$3323 = v$3322[0];
var v$3324 = v$3322[1];
var t$6176 = function(x$5180){var x$5833 = v$3323(x$5180);
var x$5834 = v$3326(x$5833);
return v$3332(v$3329(x$5834));
};
var t$6175;
var v$5753;
var v$5755;
var v$5209 = v$3333[0];
var v$5210 = v$3333[1];
var v$5211 = v$3333[2];
var v$5213 = v$3330[0];
var v$5214 = v$3330[1];
var v$5215 = v$3330[2];
v$5755 = [special_objects$TyName$$2.plus$1223(v$5209,v$5213),compiler0$EliminateEq$$3.plus$440(v$5210,v$5214),compiler_objects$Lvars$$2.plus$603(v$5211,v$5215)];
var v$5200 = v$5755[0];
var v$5201 = v$5755[1];
var v$5202 = v$5755[2];
var v$5204 = v$3327[0];
var v$5205 = v$3327[1];
var v$5206 = v$3327[2];
v$5753 = [special_objects$TyName$$2.plus$1223(v$5200,v$5204),compiler0$EliminateEq$$3.plus$440(v$5201,v$5205),compiler_objects$Lvars$$2.plus$603(v$5202,v$5206)];
var v$5191 = v$5753[0];
var v$5192 = v$5753[1];
var v$5193 = v$5753[2];
var v$5195 = v$3324[0];
var v$5196 = v$3324[1];
var v$5197 = v$3324[2];
t$6175 = [special_objects$TyName$$2.plus$1223(v$5191,v$5195),compiler0$EliminateEq$$3.plus$440(v$5192,v$5196),compiler_objects$Lvars$$2.plus$603(v$5193,v$5197)];
return [t$6176,t$6175];
};
compiler0$EliminateEq$$4.extend_frame$3488 = function(v$5925,v$5926,v$5927){return function(lexp$3494){var fix$6177 = {};
fix$6177.$get_lvars = function(v$3498,v$3501){lab$get_lvars: while (true) {if (v$3498 == null) {return v$3501;
} else {var v$3518 = v$3498;
var v$3519 = v$3518[0];
switch (v$3519[0]) { case 2: {var v$3525 = v$3518[1];
var t$6180 = v$3525;
var t$6181 = v$3501;
var v$3498 = t$6180;
var v$3501 = t$6181;
continue lab$get_lvars;
 break; }case 0: {var v$3521 = v$3519[1];
var v$3522 = v$3518[1];
var t$6178 = v$3522;
var t$6179 = [v$3521,v$3501];
var v$3498 = t$6178;
var v$3501 = t$6179;
continue lab$get_lvars;
 break; }default: {return tools$Crash$.impossible$50("EliminateEq.extend_frame.get_lvars");
} };
};
};
};
var get_lvars$3495 = fix$6177.$get_lvars;
var lvars$3527 = get_lvars$3495(special_objects$TyName$$2.range$1315(v$5925),null);
var fix$6182 = {};
fix$6182.$f = function(e$3531){var f_sw$3532 = function(v$3535){var v$3554 = v$3535[1];
var v$3555 = v$3554[0];
var v$3556 = v$3554[1];
var v$3557 = v$3554[2];
var t$6189;
var t$6188 = fix$6182.$f(v$3555);
var t$6185;
var fix$6184 = {};
fix$6184.$map = function(v$5223){if (v$5223 == null) {return null;
} else {var v$5224 = v$5223;
var v$5225 = v$5224[0];
var v$5226 = v$5224[1];
var t$6187;
var t$6186;
var v$5836 = v$5225[0];
var v$5837 = v$5225[1];
t$6186 = [v$5836,fix$6182.$f(v$5837)];
t$6187 = [t$6186,fix$6184.$map(v$5226)];
return t$6187;
};
};
var map$5222 = fix$6184.$map;
t$6185 = (map$5222(v$3556));
var t$6183;
switch (v$3557[0]) { case 0: {var v$3553 = v$3557[1];
t$6183 = [0,fix$6182.$f(v$3553)];
 break; }default: {t$6183 = [1];
} };
t$6189 = [t$6188,t$6185,t$6183];
return [0,t$6189];
};
switch (e$3531[0]) { case 1: {return e$3531;
 break; }case 12: {return e$3531;
 break; }case 0: {return e$3531;
 break; }case 7: {return e$3531;
 break; }case 8: {return e$3531;
 break; }case 15: {var v$3691 = e$3531[1];
var v$3692 = v$3691[1];
var v$3693 = v$3691[0];
return [15,[fix$6182.$f(v$3693),v$3692]];
 break; }case 11: {var v$3684 = e$3531[1];
var v$3685 = v$3684[1];
var v$3686 = v$3684[0];
var v$3687 = v$3684[2];
return [11,[fix$6182.$f(v$3686),v$3685,fix$6182.$f(v$3687)]];
 break; }case 16: {var v$3677 = e$3531[1];
var v$3678 = v$3677[0];
var v$3679 = v$3677[1];
var t$6198;
var t$6195;
var fix$6194 = {};
fix$6194.$map = function(v$5230){if (v$5230 == null) {return null;
} else {var v$5231 = v$5230;
var v$5232 = v$5231[0];
var v$5233 = v$5231[1];
var t$6197;
var t$6196;
var v$5839 = v$5232[2];
var v$5840 = v$5232[3];
var v$5841 = v$5232[0];
var v$5842 = v$5232[1];
t$6196 = [v$5841,fix$6182.$f(v$5842),v$5839,v$5840];
t$6197 = [t$6196,fix$6194.$map(v$5233)];
return t$6197;
};
};
var map$5229 = fix$6194.$map;
t$6195 = (map$5229(v$3678));
t$6198 = [t$6195,fix$6182.$f(v$3679)];
return [16,t$6198];
 break; }case 18: {var v$3659 = e$3531[1];
var v$3660 = v$3659[0];
var v$3661 = v$3659[1];
return [18,[fix$6182.$f(v$3660),fix$6182.$f(v$3661),[1]]];
 break; }case 17: {var v$3654 = e$3531[1];
var v$3655 = v$3654[0];
var v$3656 = v$3654[1];
var v$3657 = v$3654[2];
return [17,[v$3655,v$3656,fix$6182.$f(v$3657)]];
 break; }case 9: {var v$3650 = e$3531[1];
var v$3651 = v$3650[0];
var v$3652 = v$3650[1];
return [9,[fix$6182.$f(v$3651),v$3652]];
 break; }case 13: {var v$3646 = e$3531[1];
var v$3647 = v$3646[0];
var v$3648 = v$3646[1];
return [13,[fix$6182.$f(v$3647),fix$6182.$f(v$3648)]];
 break; }case 4: {var v$3642 = e$3531[1];
var v$3643 = v$3642[1];
return [4,[v$3642[0],f_sw$3532(v$3643)]];
 break; }case 2: {var v$3636 = e$3531[1];
var v$3637 = v$3636[1];
return [2,[v$3636[0],f_sw$3532(v$3637)]];
 break; }case 3: {var v$3632 = e$3531[1];
return [3,f_sw$3532(v$3632)];
 break; }case 6: {var v$3630 = e$3531[1];
return [6,f_sw$3532(v$3630)];
 break; }case 5: {var v$3628 = e$3531[1];
return [5,f_sw$3532(v$3628)];
 break; }case 10: {var v$3624 = e$3531[1];
var v$3625 = v$3624[0];
var v$3626 = v$3624[1];
var t$6193;
var t$6192 = v$3625;
var t$6191;
var fix$6190 = {};
fix$6190.$map = function(v$5237){if (v$5237 == null) {return null;
} else {var v$5238 = v$5237;
var v$5239 = v$5238[0];
var v$5240 = v$5238[1];
return [fix$6182.$f(v$5239),fix$6190.$map(v$5240)];
};
};
var map$5236 = fix$6190.$map;
t$6191 = (map$5236(v$3626));
t$6193 = [t$6192,t$6191];
return [10,t$6193];
 break; }default: {var v$3709 = e$3531[1];
var v$3710 = v$3709[1];
var v$3711 = v$3709[0];
var new_declared_lvars$3699;
var fix$6199 = {};
fix$6199.$map = function(v$5244){if (v$5244 == null) {return null;
} else {var v$5245 = v$5244;
var v$5246 = v$5245[0];
var v$5247 = v$5245[1];
var t$6201;
var t$6200;
var tv$5844 = compiler_objects$LambdaExp$$4.fresh_tyvar$1580(0);
t$6200 = [[0,tv$5844],v$5246,[tv$5844,null]];
t$6201 = [t$6200,fix$6199.$map(v$5247)];
return t$6201;
};
};
var map$5243 = fix$6199.$map;
new_declared_lvars$3699 = (map$5243(lvars$3527));
return [14,[v$3711,basis$List$.s$n$645([v$3710,new_declared_lvars$3699])]];
} };
};
var f$3528 = fix$6182.$f;
return f$3528(lexp$3494);
};
};
var fix$6202 = {};
fix$6202.$apply_eq_fns = function(v$3715,v$3718,v$3721){lab$apply_eq_fns: while (true) {if (v$3718 == null) {return v$3721;
} else {var v$3737 = v$3718;
var v$3738 = v$3737[0];
var v$3739 = v$3737[1];
var f$3735 = [18,[v$3721,(compiler0$EliminateEq$$4.gen_type_eq$2789(v$3715[0],v$3715[1],v$3715[2]))(v$3738),[1]]];
var t$6203 = v$3715;
var t$6204 = v$3739;
var t$6205 = f$3735;
var v$3715 = t$6203;
var v$3718 = t$6204;
var v$3721 = t$6205;
continue lab$apply_eq_fns;
};
};
};
compiler0$EliminateEq$$4.apply_eq_fns$3712 = fix$6202.$apply_eq_fns;
var fix$6206 = {};
fix$6206.$eq_tyvars = function(v$3744){lab$eq_tyvars: while (true) {if (v$3744 == null) {return null;
} else {var v$3755 = v$3744;
var v$3756 = v$3755[0];
var v$3757 = v$3755[1];
if (compiler_objects$LambdaExp$$4.equality_tyvar$1555(v$3756)) {return [v$3756,fix$6206.$eq_tyvars(v$3757)];
} else {var t$6207 = v$3757;
var v$3744 = t$6207;
continue lab$eq_tyvars;
};
};
};
};
compiler0$EliminateEq$$4.eq_tyvars$3741 = fix$6206.$eq_tyvars;
compiler0$EliminateEq$$4.env_frame$3758 = [empty$2233];
compiler0$EliminateEq$$4.t_switch$3759 = function(t$3762,env$3765,v$3768){var v$3792 = v$3768[1];
var v$3793 = v$3792[0];
var v$3794 = v$3792[1];
var v$3795 = v$3792[2];
var t$6214;
var t$6213 = (t$3762(env$3765))(v$3793);
var t$6210;
var fix$6209 = {};
fix$6209.$map = function(v$5251){if (v$5251 == null) {return null;
} else {var v$5252 = v$5251;
var v$5253 = v$5252[0];
var v$5254 = v$5252[1];
var t$6212;
var t$6211;
var v$5846 = v$5253[0];
var v$5847 = v$5253[1];
t$6211 = [v$5846,(t$3762(env$3765))(v$5847)];
t$6212 = [t$6211,fix$6209.$map(v$5254)];
return t$6212;
};
};
var map$5250 = fix$6209.$map;
t$6210 = (map$5250(v$3794));
var t$6208;
switch (v$3795[0]) { case 0: {var v$3788 = v$3795[1];
t$6208 = [0,(t$3762(env$3765))(v$3788)];
 break; }default: {t$6208 = [1];
} };
t$6214 = [t$6213,t$6210,t$6208];
return [0,t$6214];
};
var fix$6215 = {};
fix$6215.$t = function(env$3799,lexp$3802){switch (lexp$3802[0]) { case 1: {var v$4100 = lexp$3802[1];
var v$4101 = v$4100[0];
if (v$4101 == null) {var v$4110 = v$4100[1];
var v$4106;
var v$5263 = env$3799[2];
v$4106 = (compiler_objects$Lvars$$2.lookup$553(v$5263,v$4110));
switch (v$4106[0]) { case 0: {var v$4109 = v$4106[1];
var fix$6261 = {};
fix$6261.$apply_eq_fns = function(v$5882,v$5883){lab$apply_eq_fns: while (true) {if (v$5882 == null) {return v$5883;
} else {var v$5884 = v$5882;
var v$5885 = v$5884[0];
var v$5886 = v$5884[1];
var f$5887 = [18,[v$5883,(compiler0$EliminateEq$$4.gen_type_eq$2789(env$3799[0],env$3799[1],env$3799[2]))(v$5885),[1]]];
var t$6262 = v$5886;
var t$6263 = f$5887;
var v$5882 = t$6262;
var v$5883 = t$6263;
continue lab$apply_eq_fns;
};
};
};
var apply_eq_fns$5881 = fix$6261.$apply_eq_fns;
var v$5946;
var l$5265 = compiler0$EliminateEq$$4.eq_tyvars$3741(v$4109);
var fix$6264 = {};
fix$6264.$map = function(v$5267){if (v$5267 == null) {return null;
} else {var v$5268 = v$5267;
var v$5269 = v$5268[0];
var v$5270 = v$5268[1];
return [[0,v$5269],fix$6264.$map(v$5270)];
};
};
var map$5266 = fix$6264.$map;
v$5946 = (map$5266(l$5265));
return apply_eq_fns$5881(v$5946,lexp$3802);
 break; }default: {return lexp$3802;
} };
} else {var v$4152 = v$4100[1];
var v$4115;
var v$5272 = env$3799[2];
v$4115 = (compiler_objects$Lvars$$2.lookup$553(v$5272,v$4152));
switch (v$4115[0]) { case 0: {var v$4151 = v$4115[1];
var fix$6265 = {};
fix$6265.$sel = function(v$4120,v$4123){lab$sel: while (true) {if (v$4120 == null) {if (v$4123 == null) {return null;
} else {var s$5273 = "t.VAR.sel [] _.  lvar=" + (compiler_objects$Lvars$$1.pr_lvar$68(v$4152[0],v$4152[1],v$4152[2],v$4152[3],v$4152[4]));
return tools$Crash$.impossible$50("EliminateEq." + s$5273);
};
} else {if (v$4123 == null) {var s$5276 = "t.VAR.sel _ [].  lvar=" + (compiler_objects$Lvars$$1.pr_lvar$68(v$4152[0],v$4152[1],v$4152[2],v$4152[3],v$4152[4]));
return tools$Crash$.impossible$50("EliminateEq." + s$5276);
} else {var v$4144 = v$4120;
var v$4145 = v$4144[0];
var v$4146 = v$4144[1];
var v$4147 = v$4123;
var v$4148 = v$4147[0];
var v$4149 = v$4147[1];
if (compiler_objects$LambdaExp$$4.equality_tyvar$1555(v$4145)) {return [v$4148,fix$6265.$sel(v$4146,v$4149)];
} else {var t$6266 = v$4146;
var t$6267 = v$4149;
var v$4120 = t$6266;
var v$4123 = t$6267;
continue lab$sel;
};
};
};
};
};
var sel$4117 = fix$6265.$sel;
var instances$$4150 = sel$4117(v$4151,v$4101);
var fix$6268 = {};
fix$6268.$apply_eq_fns = function(v$5890,v$5891){lab$apply_eq_fns: while (true) {if (v$5890 == null) {return v$5891;
} else {var v$5892 = v$5890;
var v$5893 = v$5892[0];
var v$5894 = v$5892[1];
var f$5895 = [18,[v$5891,(compiler0$EliminateEq$$4.gen_type_eq$2789(env$3799[0],env$3799[1],env$3799[2]))(v$5893),[1]]];
var t$6269 = v$5894;
var t$6270 = f$5895;
var v$5890 = t$6269;
var v$5891 = t$6270;
continue lab$apply_eq_fns;
};
};
};
var apply_eq_fns$5889 = fix$6268.$apply_eq_fns;
return apply_eq_fns$5889(instances$$4150,lexp$3802);
 break; }default: {return tools$Crash$.impossible$50("EliminateEq.f.VAR.lvar not in env");
} };
};
 break; }case 10: {var v$4062 = lexp$3802[1];
var v$4063 = v$4062[0];
switch (v$4063[0]) { case 8: {var v$4065 = v$4062[1];
if (v$4065 == null) {var v$5318 = lexp$3802[1];
var v$5319 = v$5318[0];
var v$5320 = v$5318[1];
var t$6248;
var t$6247 = v$5319;
var t$6246;
var fix$6245 = {};
fix$6245.$map = function(v$5324){if (v$5324 == null) {return null;
} else {var v$5325 = v$5324;
var v$5326 = v$5325[0];
var v$5327 = v$5325[1];
return [fix$6215.$t(env$3799,v$5326),fix$6245.$map(v$5327)];
};
};
var map$5323 = fix$6245.$map;
t$6246 = (map$5323(v$5320));
t$6248 = [t$6247,t$6246];
return [10,t$6248];
} else {var v$4067 = v$4065;
var v$4068 = v$4067[1];
if (v$4068 == null) {var v$5307 = lexp$3802[1];
var v$5308 = v$5307[0];
var v$5309 = v$5307[1];
var t$6252;
var t$6251 = v$5308;
var t$6250;
var fix$6249 = {};
fix$6249.$map = function(v$5313){if (v$5313 == null) {return null;
} else {var v$5314 = v$5313;
var v$5315 = v$5314[0];
var v$5316 = v$5314[1];
return [fix$6215.$t(env$3799,v$5315),fix$6249.$map(v$5316)];
};
};
var map$5312 = fix$6249.$map;
t$6250 = (map$5312(v$5309));
t$6252 = [t$6251,t$6250];
return [10,t$6252];
} else {var v$4070 = v$4068;
if (v$4070[1] == null) {var v$4091 = v$4063[1];
var v$4092 = v$4091[0];
var v$4093 = v$4067[0];
var v$4094 = v$4070[0];
switch (v$4092[0]) { case 1: {var v$4081 = v$4092[1];
if (v$4081 == null) {return tools$Crash$.impossible$50("EliminateEq.f.EQUALprim");
} else {var v$4083 = v$4081;
var v$4084 = v$4083[1];
if (v$4084 == null) {return tools$Crash$.impossible$50("EliminateEq.f.EQUALprim");
} else {var v$4086 = v$4084;
if (v$4086[1] == null) {var v$4089 = v$4083[0];
var e$4088 = [10,[[4],[fix$6215.$t(env$3799,v$4093),[fix$6215.$t(env$3799,v$4094),null]]]];
return [18,[(compiler0$EliminateEq$$4.gen_type_eq$2789(env$3799[0],env$3799[1],env$3799[2]))(v$4089),e$4088,[1]]];
} else {return tools$Crash$.impossible$50("EliminateEq.f.EQUALprim");
};
};
};
 break; }default: {return tools$Crash$.impossible$50("EliminateEq.f.EQUALprim");
} };
} else {var v$5296 = lexp$3802[1];
var v$5297 = v$5296[0];
var v$5298 = v$5296[1];
var t$6256;
var t$6255 = v$5297;
var t$6254;
var fix$6253 = {};
fix$6253.$map = function(v$5302){if (v$5302 == null) {return null;
} else {var v$5303 = v$5302;
var v$5304 = v$5303[0];
var v$5305 = v$5303[1];
return [fix$6215.$t(env$3799,v$5304),fix$6253.$map(v$5305)];
};
};
var map$5301 = fix$6253.$map;
t$6254 = (map$5301(v$5298));
t$6256 = [t$6255,t$6254];
return [10,t$6256];
};
};
};
 break; }default: {var v$5329 = lexp$3802[1];
var v$5330 = v$5329[0];
var v$5331 = v$5329[1];
var t$6260;
var t$6259 = v$5330;
var t$6258;
var fix$6257 = {};
fix$6257.$map = function(v$5335){if (v$5335 == null) {return null;
} else {var v$5336 = v$5335;
var v$5337 = v$5336[0];
var v$5338 = v$5336[1];
return [fix$6215.$t(env$3799,v$5337),fix$6257.$map(v$5338)];
};
};
var map$5334 = fix$6257.$map;
t$6258 = (map$5334(v$5331));
t$6260 = [t$6259,t$6258];
return [10,t$6260];
} };
 break; }case 11: {var v$4017 = lexp$3802[1];
var v$4018 = v$4017[1];
if (v$4018 == null) {var v$4059 = v$4017[0];
var v$4060 = v$4017[2];
return [11,[fix$6215.$t(env$3799,v$4059),null,fix$6215.$t(env$3799,v$4060)]];
} else {var v$4020 = v$4018;
if (v$4020[1] == null) {var v$4048 = v$4020[0];
var v$4049 = v$4048[0];
var v$4050 = v$4048[1];
var v$4051 = v$4048[2];
var v$4052 = v$4017[0];
var v$4053 = v$4017[2];
var eq_tvs$4022 = compiler0$EliminateEq$$4.eq_tyvars$3741(v$4050);
var eq_lvs$4023;
var fix$6240 = {};
fix$6240.$map = function(v$5342){if (v$5342 == null) {return null;
} else {var v$5343 = v$5342;
var v$5345 = v$5343[1];
return [compiler_objects$Lvars$$1.newLvar$65(0),fix$6240.$map(v$5345)];
};
};
var map$5341 = fix$6240.$map;
eq_lvs$4023 = (map$5341(eq_tvs$4022));
var eq_taus$4026;
var fix$6241 = {};
fix$6241.$map = function(v$5349){if (v$5349 == null) {return null;
} else {var v$5350 = v$5349;
var v$5351 = v$5350[0];
var v$5352 = v$5350[1];
var t$6243;
var t$6242;
var tau$5851 = [0,v$5351];
t$6242 = [3,[[[1,[tau$5851,[tau$5851,null]]],null],[compiler_objects$LambdaExp$$4.boolType$1684,null]]];
t$6243 = [t$6242,fix$6241.$map(v$5352)];
return t$6243;
};
};
var map$5348 = fix$6241.$map;
eq_taus$4026 = (map$5348(eq_tvs$4022));
var fix$6244 = {};
fix$6244.$mk_tau = function(v$4030){if (v$4030 == null) {return v$4051;
} else {var v$4037 = v$4030;
var v$4038 = v$4037[0];
var v$4039 = v$4037[1];
return [3,[[v$4038,null],[fix$6244.$mk_tau(v$4039),null]]];
};
};
var mk_tau$4027 = fix$6244.$mk_tau;
var tau$$4040 = mk_tau$4027(eq_taus$4026);
var env_bind$4041 = compiler0$EliminateEq$$4.mk_env_tyvars$2716(eq_tvs$4022,eq_lvs$4023,env$3799);
var env_scope$4042;
var v$5359 = env$3799[0];
var v$5360 = env$3799[1];
var v$5361 = env$3799[2];
env_scope$4042 = [v$5359,v$5360,compiler_objects$Lvars$$2.add$575(v$4049,v$4050,v$5361)];
return [11,[compiler0$EliminateEq$$4.mk_eq_abs$2678(eq_lvs$4023,eq_taus$4026,fix$6215.$t(env_bind$4041,v$4052)),[[v$4049,v$4050,tau$$4040],null],fix$6215.$t(env_scope$4042,v$4053)]];
} else {return tools$Crash$.impossible$50("EliminateEq.t.LET.not single");
};
};
 break; }case 16: {var v$4013 = lexp$3802[1];
var v$4014 = v$4013[0];
var v$4015 = v$4013[1];
var fix$6225 = {};
fix$6225.$env_fs = function(v$3948,v$3951){lab$env_fs: while (true) {if (v$3948 == null) {return v$3951;
} else {var v$3965 = v$3948;
var v$3966 = v$3965[0];
var v$3967 = v$3966[2];
var v$3968 = v$3966[3];
var v$3971 = v$3965[1];
var t$6227 = v$3971;
var t$6226;
var v$5368 = v$3951[0];
var v$5369 = v$3951[1];
var v$5370 = v$3951[2];
t$6226 = [v$5368,v$5369,compiler_objects$Lvars$$2.add$575(v$3967,v$3968,v$5370)];
var t$6228 = t$6227;
var t$6229 = t$6226;
var v$3948 = t$6228;
var v$3951 = t$6229;
continue lab$env_fs;
};
};
};
var env_fs$3945 = fix$6225.$env_fs;
var env_scope$3973 = env_fs$3945(v$4014,env$3799);
var t$6239;
var t$6231;
var fix$6230 = {};
fix$6230.$map = function(v$5390){if (v$5390 == null) {return null;
} else {var v$5391 = v$5390;
var v$5392 = v$5391[0];
var v$5393 = v$5391[1];
var t$6238;
var t$6232;
var v$5853 = v$5392[2];
var v$5854 = v$5392[3];
var v$5855 = v$5392[0];
var v$5856 = v$5392[1];
var eq_tvs$5857 = compiler0$EliminateEq$$4.eq_tyvars$3741(v$5854);
var eq_lvs$5858;
var fix$6233 = {};
fix$6233.$map = function(v$5860){if (v$5860 == null) {return null;
} else {var v$5861 = v$5860;
var v$5862 = v$5861[1];
return [compiler_objects$Lvars$$1.newLvar$65(0),fix$6233.$map(v$5862)];
};
};
var map$5859 = fix$6233.$map;
eq_lvs$5858 = (map$5859(eq_tvs$5857));
var eq_taus$5863;
var fix$6234 = {};
fix$6234.$map = function(v$5865){if (v$5865 == null) {return null;
} else {var v$5866 = v$5865;
var v$5867 = v$5866[0];
var v$5868 = v$5866[1];
var t$6236;
var t$6235;
var tau$5869 = [0,v$5867];
t$6235 = [3,[[[1,[tau$5869,[tau$5869,null]]],null],[compiler_objects$LambdaExp$$4.boolType$1684,null]]];
t$6236 = [t$6235,fix$6234.$map(v$5868)];
return t$6236;
};
};
var map$5864 = fix$6234.$map;
eq_taus$5863 = (map$5864(eq_tvs$5857));
var fix$6237 = {};
fix$6237.$mk_tau = function(v$5871){if (v$5871 == null) {return v$5855;
} else {var v$5872 = v$5871;
var v$5873 = v$5872[0];
var v$5874 = v$5872[1];
return [3,[[v$5873,null],[fix$6237.$mk_tau(v$5874),null]]];
};
};
var mk_tau$5870 = fix$6237.$mk_tau;
var Type$$5875 = mk_tau$5870(eq_taus$5863);
var env_bind$5876 = compiler0$EliminateEq$$4.mk_env_tyvars$2716(eq_tvs$5857,eq_lvs$5858,env_scope$3973);
t$6232 = [Type$$5875,compiler0$EliminateEq$$4.mk_eq_abs$2678(eq_lvs$5858,eq_taus$5863,fix$6215.$t(env_bind$5876,v$5856)),v$5853,v$5854];
t$6238 = [t$6232,fix$6230.$map(v$5393)];
return t$6238;
};
};
var map$5389 = fix$6230.$map;
t$6231 = (map$5389(v$4014));
t$6239 = [t$6231,fix$6215.$t(env_scope$3973,v$4015)];
return [16,t$6239];
 break; }case 14: {var v$3942 = lexp$3802[1];
var v$3943 = v$3942[1];
var lvars$3924;
var fix$6218 = {};
fix$6218.$map = function(v$5432){if (v$5432 == null) {return null;
} else {var v$5433 = v$5432;
var v$5434 = v$5433[0];
var v$5435 = v$5433[1];
return [v$5434[1],fix$6218.$map(v$5435)];
};
};
var map$5431 = fix$6218.$map;
lvars$3924 = (map$5431(v$3943));
var t$6224 = compiler0$EliminateEq$$4.env_frame$3758;
var t$6223;
var fix$6219 = {};
fix$6219.$foldl = function(v$5447,v$5448){lab$foldl: while (true) {if (v$5448 == null) {return v$5447;
} else {var v$5449 = v$5448;
var v$5450 = v$5449[0];
var v$5451 = v$5449[1];
var t$6220;
var v$5464;
var v$5466 = env$3799[2];
v$5464 = (compiler_objects$Lvars$$2.lookup$553(v$5466,v$5450));
switch (v$5464[0]) { case 0: {var v$5467 = v$5464[1];
var v$5472 = v$5447[0];
var v$5473 = v$5447[1];
var v$5474 = v$5447[2];
t$6220 = [v$5472,v$5473,compiler_objects$Lvars$$2.add$575(v$5450,v$5467,v$5474)];
 break; }default: {t$6220 = v$5447;
} };
var t$6221 = t$6220;
var t$6222 = v$5451;
var v$5447 = t$6221;
var v$5448 = t$6222;
continue lab$foldl;
};
};
};
var foldl$5446 = fix$6219.$foldl;
t$6223 = (foldl$5446(empty$2233,lvars$3924));
(t$6224[0] = t$6223,0);
return lexp$3802;
 break; }case 15: {var v$3920 = lexp$3802[1];
var v$3921 = v$3920[1];
var v$3922 = v$3920[0];
return [15,[fix$6215.$t(env$3799,v$3922),v$3921]];
 break; }case 18: {var v$3914 = lexp$3802[1];
var v$3915 = v$3914[0];
var v$3916 = v$3914[1];
return [18,[fix$6215.$t(env$3799,v$3915),fix$6215.$t(env$3799,v$3916),[1]]];
 break; }case 17: {var v$3909 = lexp$3802[1];
var v$3910 = v$3909[0];
var v$3911 = v$3909[1];
var v$3912 = v$3909[2];
return [17,[v$3910,v$3911,fix$6215.$t(env$3799,v$3912)]];
 break; }case 9: {var v$3905 = lexp$3802[1];
var v$3906 = v$3905[0];
var v$3907 = v$3905[1];
return [9,[fix$6215.$t(env$3799,v$3906),v$3907]];
 break; }case 13: {var v$3901 = lexp$3802[1];
var v$3902 = v$3901[0];
var v$3903 = v$3901[1];
return [13,[fix$6215.$t(env$3799,v$3902),fix$6215.$t(env$3799,v$3903)]];
 break; }case 4: {var v$3897 = lexp$3802[1];
var v$3898 = v$3897[1];
return [4,[v$3897[0],compiler0$EliminateEq$$4.t_switch$3759(function(v$5964){return function(v$5965){return fix$6215.$t(v$5964,v$5965);
};
},env$3799,v$3898)]];
 break; }case 2: {var v$3891 = lexp$3802[1];
var v$3892 = v$3891[1];
return [2,[v$3891[0],compiler0$EliminateEq$$4.t_switch$3759(function(v$5966){return function(v$5967){return fix$6215.$t(v$5966,v$5967);
};
},env$3799,v$3892)]];
 break; }case 3: {var v$3887 = lexp$3802[1];
return [3,compiler0$EliminateEq$$4.t_switch$3759(function(v$5968){return function(v$5969){return fix$6215.$t(v$5968,v$5969);
};
},env$3799,v$3887)];
 break; }case 6: {var v$3885 = lexp$3802[1];
return [6,compiler0$EliminateEq$$4.t_switch$3759(function(v$5970){return function(v$5971){return fix$6215.$t(v$5970,v$5971);
};
},env$3799,v$3885)];
 break; }case 5: {var v$3883 = lexp$3802[1];
return [5,compiler0$EliminateEq$$4.t_switch$3759(function(v$5972){return function(v$5973){return fix$6215.$t(v$5972,v$5973);
};
},env$3799,v$3883)];
 break; }default: {return lexp$3802;
} };
};
compiler0$EliminateEq$$4.t$3796 = fix$6215.$t;
compiler0$EliminateEq$$4.elim_eq$4153 = function(v$4192,v$4193){var v$4194 = v$4193[1];
var v$4195 = v$4194[0];
var v$4196 = v$4195[1];
var v$4197 = v$4194[1];
try {var v$4178 = compiler0$EliminateEq$$4.gen_datatype_builtin_eq$3302(0);
var v$4179 = v$4178[0];
var v$4180 = v$4178[1];
var env1$4167;
var v$5486 = v$4192[0];
var v$5487 = v$4192[1];
var v$5488 = v$4192[2];
var v$5490 = v$4180[0];
var v$5491 = v$4180[1];
var v$5492 = v$4180[2];
env1$4167 = [special_objects$TyName$$2.plus$1223(v$5486,v$5490),compiler0$EliminateEq$$3.plus$440(v$5487,v$5491),compiler_objects$Lvars$$2.plus$603(v$5488,v$5492)];
var v$4175 = compiler0$EliminateEq$$4.gen_datatype_eq$3227(env1$4167,v$4196);
var v$4176 = v$4175[0];
var v$4177 = v$4175[1];
var env2$4171;
var v$5495 = env1$4167[0];
var v$5496 = env1$4167[1];
var v$5497 = env1$4167[2];
var v$5499 = v$4177[0];
var v$5500 = v$4177[1];
var v$5501 = v$4177[2];
env2$4171 = [special_objects$TyName$$2.plus$1223(v$5495,v$5499),compiler0$EliminateEq$$3.plus$440(v$5496,v$5500),compiler_objects$Lvars$$2.plus$603(v$5497,v$5501)];
(compiler0$EliminateEq$$4.env_frame$3758[0] = empty$2233,0);
var lexp$$4172 = compiler0$EliminateEq$$4.t$3796(env2$4171,v$4197);
var env_export$4173;
var v$5813 = compiler0$EliminateEq$$4.env_frame$3758[0];
var v$5505 = v$4177[0];
var v$5506 = v$4177[1];
var v$5507 = v$4177[2];
var v$5509 = v$5813[0];
var v$5510 = v$5813[1];
var v$5511 = v$5813[2];
env_export$4173 = [special_objects$TyName$$2.plus$1223(v$5505,v$5509),compiler0$EliminateEq$$3.plus$440(v$5506,v$5510),compiler_objects$Lvars$$2.plus$603(v$5507,v$5511)];
var lexp$$$4174 = (compiler0$EliminateEq$$4.extend_frame$3488(v$4177[0],v$4177[1],v$4177[2]))(lexp$$4172);
return [[0,[v$4195,v$4179(v$4176(lexp$$$4174))]],env_export$4173];
} catch(v$6216) {return (function(e$4185){var t$6217 = e$4185;
if (t$6217[0] == compiler0$EliminateEq$$4.en$DONT_SUPPORT_EQ$2781) {var s$4182 = e$4185[1];
var s$5517 = ("\n ** Equality not supported for datatype " + s$4182) + "\n";
basis$TextIO$.output$101(tools$Flags$$1.log$92[0],s$5517);
tools$Flags$$1.log$92[0];
0;
basis$TextIO$.output$101(tools$Flags$$1.log$92[0]," ** Rewrite the program to use an explicit equality function\n");
tools$Flags$$1.log$92[0];
0;
basis$TextIO$.output$101(tools$Flags$$1.log$92[0]," ** for this particular datatype.\n\n");
tools$Flags$$1.log$92[0];
0;
throw e$4185;
} else {throw e$4185;
};
})(v$6216);
};
};
compiler0$EliminateEq$$4.pu$4198;
var pu_res$4244 = pickle$pickle$.dataGen$1479(["EliminateEq.result",function(v$5528){switch (v$5528[0]) { case 1: {return 0;
 break; }case 0: {return 1;
 break; }default: {return 2;
} };
},[function(v$5529){return pickle$pickle$.con1$2005(function(v$5530){return [1,v$5530];
},function(v$5531){switch (v$5531[0]) { case 1: {return v$5531[1];
 break; }default: {return tools$Crash$.impossible$50("EliminateEq.pu.MONOLVAR");
} };
},pickle$pickle$.pairGen0$974(compiler_objects$Lvars$$3.pu$1758,compiler_objects$LambdaExp$$4.pu_tyvars$4436));
},[function(v$5534){return pickle$pickle$.con1$2005(function(v$5535){return [0,v$5535];
},function(v$5536){switch (v$5536[0]) { case 0: {return v$5536[1];
 break; }default: {return tools$Crash$.impossible$50("EliminateEq.pu.POLYLVAR");
} };
},compiler_objects$Lvars$$3.pu$1758);
},[function(v$5539){return pickle$pickle$.con1$2005(function(v$5540){return [2,v$5540];
},function(v$5541){switch (v$5541[0]) { case 2: {return v$5541[1];
 break; }default: {return tools$Crash$.impossible$50("EliminateEq.pu.FAIL");
} };
},pickle$pickle$.string$900);
},null]]]]);
var pu_tnm$4245 = special_objects$TyName$$2.pu$1755(special_objects$TyName$$1.pu$366,pu_res$4244);
var pu_tvm$4246 = compiler0$EliminateEq$$3.pu$1318(compiler_objects$LambdaExp$$4.pu_tyvar$4432,compiler_objects$Lvars$$3.pu$1758);
var pu_lvm$4247 = compiler_objects$Lvars$$2.pu$1135(compiler_objects$Lvars$$3.pu$1758,compiler_objects$LambdaExp$$4.pu_tyvars$4436);
compiler0$EliminateEq$$4.pu$4198 = (pickle$pickle$.tup3Gen$2403(pu_tnm$4245,pu_tvm$4246,pu_lvm$4247));
return 0;
})();
