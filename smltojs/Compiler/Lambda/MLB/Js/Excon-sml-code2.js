if ((typeof(compiler_objects$Excon$$2)) == "undefined") {compiler_objects$Excon$$2 = {};
};
(function(){compiler_objects$Excon$$2.die$281 = function(s$284){return tools$Crash$.impossible$50("QuasiMap2." + s$284);
};
compiler_objects$Excon$$2.key$285 = function(v$1516,v$1517){return v$1516[0][1];
};
compiler_objects$Excon$$2.rigid$289 = function(v$1518,v$1519){return v$1518[0][2];
};
compiler_objects$Excon$$2.empty$297 = function(v$1546){return null;
};
compiler_objects$Excon$$2.singleton$298 = function(v$309,v$310){var nd$303 = v$309[0];
var k$304 = nd$303[0][1];
return nd$303[0][2]?[[0,tools$IntStringFinMap$.singleton$109(k$304,[v$309,v$310])]]:[[1,[tools$IntStringFinMap$.singleton$109(k$304,[v$309,v$310]),special_objects$Name$.current_matchcount$60(0)]]];
};
compiler_objects$Excon$$2.isEmpty$311 = function(v$314){return (v$314 == null)?true:false;
};
compiler_objects$Excon$$2.imap$319 = function(v$322){if (v$322 == null) {return [1];
} else {var v$331 = v$322;
switch (v$331[0][0]) { case 0: {var v$333 = v$331[0][1];
return [0,v$333];
 break; }default: {var v$334 = v$331[0][1];
var v$335 = v$334[0];
return [0,v$335];
} };
};
};
compiler_objects$Excon$$2.imap$$336 = function(v$339){if (v$339 == null) {return tools$Crash$.impossible$50("QuasiMap2.imap': impossible");
} else {var v$349 = v$339;
switch (v$349[0][0]) { case 0: {return v$349[0][1];
 break; }default: {return v$349[0][1][0];
} };
};
};
compiler_objects$Excon$$2.ensure_consistent_imap$354 = function(imap$357){var v$377 = tools$IntStringFinMap$.Fold$69(function(v$385){var v$394 = v$385[0];
var v$395 = v$394[0];
var v$396 = v$394[1];
var v$397 = v$396[0];
var v$398 = v$385[1];
var v$399 = v$398[0];
var v$400 = v$398[1];
var t$1547;
if (v$399) {var v$1376 = v$397[0][0][1];
t$1547 = ((v$1376[0] == v$395[0])?(v$1376[1] == v$395[1]):false);
} else {t$1547 = false;
};
return [t$1547,v$400?v$397[0][0][2]:false];
},[true,true],imap$357);
var v$378 = v$377[0];
var v$379 = v$377[1];
return [v$378?imap$357:(tools$IntStringFinMap$.fold$53(function(v$370){var v$371 = v$370[0];
var v$372 = v$371[0];
var v$373 = v$371[1];
var v$374 = v$370[1];
return tools$IntStringFinMap$.add$228(v$372[0][0][1],[v$372,v$373],v$374);
},tools$IntStringFinMap$.empty$108(0),imap$357)),v$379];
};
compiler_objects$Excon$$2.ensure_consistent$401 = function(v$404){if (v$404 == null) {return v$404;
} else {var v$417 = v$404;
switch (v$417[0][0]) { case 0: {return v$404;
 break; }default: {var v$437 = v$417[0][1];
var v$438 = v$437[0];
var v$439 = v$437[1];
if (v$439 < (special_objects$Name$.current_matchcount$60(0))) {var v$434 = compiler_objects$Excon$$2.ensure_consistent_imap$354(v$438);
var v$435 = v$434[1];
var v$436 = v$434[0];
if (v$435) {(v$417[0] = [0,v$436],0);
return v$404;
} else {(v$417[0] = [1,[v$436,special_objects$Name$.current_matchcount$60(0)]],0);
return v$404;
};
} else {return v$404;
};
} };
};
};
compiler_objects$Excon$$2.mk_flex$440 = function(imap$443){return [[1,[imap$443,special_objects$Name$.current_matchcount$60(0)]]];
};
compiler_objects$Excon$$2.mk_rigid$444 = function(imap$447){return [[0,imap$447]];
};
compiler_objects$Excon$$2.lookup$448 = function(m$451,d$454){var v$459;
var v$1119 = compiler_objects$Excon$$2.ensure_consistent$401(m$451);
if (v$1119 == null) {v$459 = [1];
} else {var v$1120 = v$1119;
switch (v$1120[0][0]) { case 0: {var v$1121 = v$1120[0][1];
v$459 = [0,v$1121];
 break; }default: {var v$1122 = v$1120[0][1];
var v$1123 = v$1122[0];
v$459 = [0,v$1123];
} };
};
switch (v$459[0]) { case 0: {var v$469 = v$459[1];
var v$465 = tools$IntStringFinMap$.lookup$120(v$469,d$454[0][0][1]);
switch (v$465[0]) { case 0: {var v$467 = v$465[1];
var v$468 = v$467[1];
return [0,v$468];
 break; }default: {return [1];
} };
 break; }default: {return [1];
} };
};
compiler_objects$Excon$$2.add$470 = function(v$495,v$496,v$497){var v$483 = compiler_objects$Excon$$2.ensure_consistent$401(v$497);
if (v$483 == null) {var nd$1128 = v$495[0];
var k$1129 = nd$1128[0][1];
return nd$1128[0][2]?[[0,tools$IntStringFinMap$.singleton$109(k$1129,[v$495,v$496])]]:[[1,[tools$IntStringFinMap$.singleton$109(k$1129,[v$495,v$496]),special_objects$Name$.current_matchcount$60(0)]]];
} else {var v$484 = v$483;
switch (v$484[0][0]) { case 0: {var v$492 = v$484[0][1];
var nd$486 = v$495[0];
var i$487 = nd$486[0][1];
return nd$486[0][2]?[[0,tools$IntStringFinMap$.add$228(i$487,[v$495,v$496],v$492)]]:[[1,[tools$IntStringFinMap$.add$228(i$487,[v$495,v$496],v$492),special_objects$Name$.current_matchcount$60(0)]]];
 break; }default: {var v$493 = v$484[0][1];
var v$494 = v$493[0];
return [[1,[tools$IntStringFinMap$.add$228(v$495[0][0][1],[v$495,v$496],v$494),special_objects$Name$.current_matchcount$60(0)]]];
} };
};
};
compiler_objects$Excon$$2.plus$498 = function(v$532,v$533){var m1$503 = compiler_objects$Excon$$2.ensure_consistent$401(v$532);
var m2$504 = compiler_objects$Excon$$2.ensure_consistent$401(v$533);
if (m1$503 == null) {return m2$504;
} else {if (m2$504 == null) {return m1$503;
} else {var v$523 = m1$503;
switch (v$523[0][0]) { case 0: {var v$525 = m2$504;
switch (v$525[0][0]) { case 0: {var v$527 = v$523[0][1];
var v$528 = v$525[0][1];
return [[0,tools$IntStringFinMap$.plus$246(v$527,v$528)]];
 break; }default: {var t$1554;
var t$1553;
var t$1552;
var t$1551;
var t$1550 = tools$IntStringFinMap$.plus$246;
var t$1549;
if (m1$503 == null) {t$1549 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1453 = m1$503;
switch (v$1453[0][0]) { case 0: {t$1549 = v$1453[0][1];
 break; }default: {t$1549 = v$1453[0][1][0];
} };
};
var t$1548;
if (m2$504 == null) {t$1548 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1454 = m2$504;
switch (v$1454[0][0]) { case 0: {t$1548 = v$1454[0][1];
 break; }default: {t$1548 = v$1454[0][1][0];
} };
};
t$1551 = (t$1550(t$1549,t$1548));
t$1552 = [t$1551,special_objects$Name$.current_matchcount$60(0)];
t$1553 = [1,t$1552];
t$1554 = [t$1553];
return t$1554;
} };
 break; }default: {var t$1561;
var t$1560;
var t$1559;
var t$1558;
var t$1557 = tools$IntStringFinMap$.plus$246;
var t$1556;
if (m1$503 == null) {t$1556 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1456 = m1$503;
switch (v$1456[0][0]) { case 0: {t$1556 = v$1456[0][1];
 break; }default: {t$1556 = v$1456[0][1][0];
} };
};
var t$1555;
if (m2$504 == null) {t$1555 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1457 = m2$504;
switch (v$1457[0][0]) { case 0: {t$1555 = v$1457[0][1];
 break; }default: {t$1555 = v$1457[0][1][0];
} };
};
t$1558 = (t$1557(t$1556,t$1555));
t$1559 = [t$1558,special_objects$Name$.current_matchcount$60(0)];
t$1560 = [1,t$1559];
t$1561 = [t$1560];
return t$1561;
} };
};
};
};
compiler_objects$Excon$$2.remove$534 = function(v$575,v$576){var m$539 = compiler_objects$Excon$$2.ensure_consistent$401(v$576);
if (m$539 == null) {return [1];
} else {var v$548 = m$539;
switch (v$548[0][0]) { case 0: {var v$561 = v$548[0][1];
var v$554 = tools$IntStringFinMap$.remove$253(v$575[0][0][1],v$561);
switch (v$554[0]) { case 0: {var v$560 = v$554[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$560))?[0,null]:[0,[[0,v$560]]];
 break; }default: {return [1];
} };
 break; }default: {var v$573 = v$548[0][1];
var v$574 = v$573[0];
var v$566 = tools$IntStringFinMap$.remove$253(v$575[0][0][1],v$574);
switch (v$566[0]) { case 0: {var v$572 = v$566[1];
return ((tools$IntStringFinMap$.isEmpty$119(0))(v$572))?[0,null]:[0,[[1,[v$572,special_objects$Name$.current_matchcount$60(0)]]]];
 break; }default: {return [1];
} };
} };
};
};
compiler_objects$Excon$$2.dom$577 = function(v$580){if (v$580 == null) {return null;
} else {var l$1152;
var t$1563 = tools$IntStringFinMap$.range$275;
var t$1562;
var v$1158 = compiler_objects$Excon$$2.ensure_consistent$401(v$580);
if (v$1158 == null) {t$1562 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1159 = v$1158;
switch (v$1159[0][0]) { case 0: {t$1562 = v$1159[0][1];
 break; }default: {t$1562 = v$1159[0][1][0];
} };
};
l$1152 = (t$1563(t$1562));
var fix$1564 = {};
fix$1564.$map = function(v$1154){if (v$1154 == null) {return null;
} else {var v$1155 = v$1154;
var v$1156 = v$1155[0];
var v$1157 = v$1155[1];
return [v$1156[0],fix$1564.$map(v$1157)];
};
};
var map$1153 = fix$1564.$map;
return map$1153(l$1152);
};
};
compiler_objects$Excon$$2.range$590 = function(v$593){if (v$593 == null) {return null;
} else {var l$1163;
var t$1566 = tools$IntStringFinMap$.range$275;
var t$1565;
var v$1169 = compiler_objects$Excon$$2.ensure_consistent$401(v$593);
if (v$1169 == null) {t$1565 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1170 = v$1169;
switch (v$1170[0][0]) { case 0: {t$1565 = v$1170[0][1];
 break; }default: {t$1565 = v$1170[0][1][0];
} };
};
l$1163 = (t$1566(t$1565));
var fix$1567 = {};
fix$1567.$map = function(v$1165){if (v$1165 == null) {return null;
} else {var v$1166 = v$1165;
var v$1167 = v$1166[0];
var v$1168 = v$1166[1];
return [v$1167[1],fix$1567.$map(v$1168)];
};
};
var map$1164 = fix$1567.$map;
return map$1164(l$1163);
};
};
compiler_objects$Excon$$2.list$603 = function(v$606){if (v$606 == null) {return null;
} else {var t$1569 = tools$IntStringFinMap$.range$275;
var t$1568;
var v$1173 = compiler_objects$Excon$$2.ensure_consistent$401(v$606);
if (v$1173 == null) {t$1568 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1174 = v$1173;
switch (v$1174[0][0]) { case 0: {t$1568 = v$1174[0][1];
 break; }default: {t$1568 = v$1174[0][1][0];
} };
};
return t$1569(t$1568);
};
};
compiler_objects$Excon$$2.fromList$612 = function(v$615){if (v$615 == null) {return null;
} else {var v$628;
var b$1178 = [tools$IntStringFinMap$.empty$108(0),true];
var fix$1570 = {};
fix$1570.$foldl = function(v$1181,v$1182){lab$foldl: while (true) {if (v$1182 == null) {return v$1181;
} else {var v$1183 = v$1182;
var v$1184 = v$1183[0];
var v$1185 = v$1183[1];
var t$1571;
var v$1462 = v$1184[0];
var v$1463 = v$1184[1];
var v$1465 = v$1181[0];
var v$1466 = v$1181[1];
t$1571 = [tools$IntStringFinMap$.add$228(v$1462[0][0][1],[v$1462,v$1463],v$1465),v$1466?v$1462[0][0][2]:false];
var t$1572 = t$1571;
var t$1573 = v$1185;
var v$1181 = t$1572;
var v$1182 = t$1573;
continue lab$foldl;
};
};
};
var foldl$1180 = fix$1570.$foldl;
v$628 = (foldl$1180(b$1178,v$615));
var v$629 = v$628[0];
return v$628[1]?[[0,v$629]]:[[1,[v$629,special_objects$Name$.current_matchcount$60(0)]]];
};
};
compiler_objects$Excon$$2.composemap$647 = function(f$650,m$653){var v$658;
if (m$653 == null) {v$658 = null;
} else {var t$1575 = tools$IntStringFinMap$.range$275;
var t$1574;
var v$1191 = compiler_objects$Excon$$2.ensure_consistent$401(m$653);
if (v$1191 == null) {t$1574 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1192 = v$1191;
switch (v$1192[0][0]) { case 0: {t$1574 = v$1192[0][1];
 break; }default: {t$1574 = v$1192[0][1][0];
} };
};
v$658 = (t$1575(t$1574));
};
if (v$658 == null) {return null;
} else {var v$666;
var b$1195 = [tools$IntStringFinMap$.empty$108(0),true];
var fix$1576 = {};
fix$1576.$foldl = function(v$1198,v$1199){lab$foldl: while (true) {if (v$1199 == null) {return v$1198;
} else {var v$1200 = v$1199;
var v$1201 = v$1200[0];
var v$1202 = v$1200[1];
var t$1577;
var v$1469 = v$1201[0];
var v$1470 = v$1201[1];
var v$1472 = v$1198[0];
var v$1473 = v$1198[1];
t$1577 = [tools$IntStringFinMap$.add$228(v$1469[0][0][1],[v$1469,f$650(v$1470)],v$1472),v$1473?v$1469[0][0][2]:false];
var t$1578 = t$1577;
var t$1579 = v$1202;
var v$1198 = t$1578;
var v$1199 = t$1579;
continue lab$foldl;
};
};
};
var foldl$1197 = fix$1576.$foldl;
v$666 = (foldl$1197(b$1195,v$658));
var v$667 = v$666[0];
return v$666[1]?[[0,v$667]]:[[1,[v$667,special_objects$Name$.current_matchcount$60(0)]]];
};
};
compiler_objects$Excon$$2.ComposeMap$685 = function(f$688,m$691){var v$696;
if (m$691 == null) {v$696 = null;
} else {var t$1581 = tools$IntStringFinMap$.range$275;
var t$1580;
var v$1208 = compiler_objects$Excon$$2.ensure_consistent$401(m$691);
if (v$1208 == null) {t$1580 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1209 = v$1208;
switch (v$1209[0][0]) { case 0: {t$1580 = v$1209[0][1];
 break; }default: {t$1580 = v$1209[0][1][0];
} };
};
v$696 = (t$1581(t$1580));
};
if (v$696 == null) {return null;
} else {var v$704;
var b$1212 = [tools$IntStringFinMap$.empty$108(0),true];
var fix$1582 = {};
fix$1582.$foldl = function(v$1215,v$1216){lab$foldl: while (true) {if (v$1216 == null) {return v$1215;
} else {var v$1217 = v$1216;
var v$1218 = v$1217[0];
var v$1219 = v$1217[1];
var t$1583;
var v$1476 = v$1218[0];
var v$1477 = v$1218[1];
var v$1479 = v$1215[0];
var v$1480 = v$1215[1];
t$1583 = [tools$IntStringFinMap$.add$228(v$1476[0][0][1],[v$1476,f$688([v$1476,v$1477])],v$1479),v$1480?v$1476[0][0][2]:false];
var t$1584 = t$1583;
var t$1585 = v$1219;
var v$1215 = t$1584;
var v$1216 = t$1585;
continue lab$foldl;
};
};
};
var foldl$1214 = fix$1582.$foldl;
v$704 = (foldl$1214(b$1212,v$696));
var v$705 = v$704[0];
return v$704[1]?[[0,v$705]]:[[1,[v$705,special_objects$Name$.current_matchcount$60(0)]]];
};
};
compiler_objects$Excon$$2.fold$723 = function(f$726,b$729,m$732){var c$1226 = compiler_objects$Excon$$2.range$590(m$732);
var fix$1586 = {};
fix$1586.$foldl = function(v$1228,v$1229){lab$foldl: while (true) {if (v$1229 == null) {return v$1228;
} else {var v$1230 = v$1229;
var v$1231 = v$1230[0];
var v$1232 = v$1230[1];
var t$1587 = f$726([v$1231,v$1228]);
var t$1588 = v$1232;
var v$1228 = t$1587;
var v$1229 = t$1588;
continue lab$foldl;
};
};
};
var foldl$1227 = fix$1586.$foldl;
return foldl$1227(b$729,c$1226);
};
compiler_objects$Excon$$2.Fold$733 = function(f$736,b$739,m$742){var c$1235;
if (m$742 == null) {c$1235 = null;
} else {var t$1590 = tools$IntStringFinMap$.range$275;
var t$1589;
var v$1243 = compiler_objects$Excon$$2.ensure_consistent$401(m$742);
if (v$1243 == null) {t$1589 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1244 = v$1243;
switch (v$1244[0][0]) { case 0: {t$1589 = v$1244[0][1];
 break; }default: {t$1589 = v$1244[0][1][0];
} };
};
c$1235 = (t$1590(t$1589));
};
var fix$1591 = {};
fix$1591.$foldl = function(v$1237,v$1238){lab$foldl: while (true) {if (v$1238 == null) {return v$1237;
} else {var v$1239 = v$1238;
var v$1240 = v$1239[0];
var v$1241 = v$1239[1];
var t$1592 = f$736([v$1240,v$1237]);
var t$1593 = v$1241;
var v$1237 = t$1592;
var v$1238 = t$1593;
continue lab$foldl;
};
};
};
var foldl$1236 = fix$1591.$foldl;
return foldl$1236(b$739,c$1235);
};
compiler_objects$Excon$$2.filter$743 = function(f$746,m$749){var l$750;
if (m$749 == null) {l$750 = null;
} else {var t$1595 = tools$IntStringFinMap$.range$275;
var t$1594;
var v$1247 = compiler_objects$Excon$$2.ensure_consistent$401(m$749);
if (v$1247 == null) {t$1594 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1248 = v$1247;
switch (v$1248[0][0]) { case 0: {t$1594 = v$1248[0][1];
 break; }default: {t$1594 = v$1248[0][1][0];
} };
};
l$750 = (t$1595(t$1594));
};
var l$$751;
var fix$1596 = {};
fix$1596.$filter = function(v$1252){lab$filter: while (true) {if (v$1252 == null) {return null;
} else {var v$1253 = v$1252;
var v$1254 = v$1253[0];
var v$1255 = v$1253[1];
if (f$746(v$1254)) {return [v$1254,fix$1596.$filter(v$1255)];
} else {var t$1597 = v$1255;
var v$1252 = t$1597;
continue lab$filter;
};
};
};
};
var filter$1251 = fix$1596.$filter;
l$$751 = (filter$1251(l$750));
return compiler_objects$Excon$$2.fromList$612(l$$751);
};
compiler_objects$Excon$$2.addList$752 = function(l$755,m1$758){var m2$759 = compiler_objects$Excon$$2.fromList$612(l$755);
return compiler_objects$Excon$$2.plus$498(m1$758,m2$759);
};
compiler_objects$Excon$$2.mergeMap$760 = function(f$763,m1$766,m2$769){var m1$770 = compiler_objects$Excon$$2.ensure_consistent$401(m1$766);
var m2$771 = compiler_objects$Excon$$2.ensure_consistent$401(m2$769);
var f$$772 = function(v$783,v$1520){var v$784 = v$783[0];
var v$785 = v$783[1];
var v$787 = v$1520[0];
var v$788 = v$1520[1];
var t$1598;
var v$1410 = v$784[0][0][1];
var v$1411 = v$787[0][0][1];
t$1598 = ((v$1410[0] == v$1411[0])?(v$1410[1] == v$1411[1]):false);
if (t$1598) {return [v$784,f$763([v$785,v$788])];
} else {return tools$Crash$.impossible$50("QuasiMap2.mergeMap, f'");
};
};
if (m1$770 == null) {return m2$771;
} else {if (m2$771 == null) {return m1$770;
} else {var v$807 = m1$770;
switch (v$807[0][0]) { case 0: {var v$809 = m2$771;
switch (v$809[0][0]) { case 0: {var v$811 = v$807[0][1];
var v$812 = v$809[0][1];
return [[0,tools$IntStringFinMap$.mergeMap$365(function(v$1521){return f$$772(v$1521[0],v$1521[1]);
},v$811,v$812)]];
 break; }default: {var t$1606;
var t$1605;
var t$1604;
var t$1603;
var t$1602 = tools$IntStringFinMap$.mergeMap$365;
var t$1601 = function(v$1522){return f$$772(v$1522[0],v$1522[1]);
};
var t$1600;
if (m1$770 == null) {t$1600 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1483 = m1$770;
switch (v$1483[0][0]) { case 0: {t$1600 = v$1483[0][1];
 break; }default: {t$1600 = v$1483[0][1][0];
} };
};
var t$1599;
if (m2$771 == null) {t$1599 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1484 = m2$771;
switch (v$1484[0][0]) { case 0: {t$1599 = v$1484[0][1];
 break; }default: {t$1599 = v$1484[0][1][0];
} };
};
t$1603 = (t$1602(t$1601,t$1600,t$1599));
t$1604 = [t$1603,special_objects$Name$.current_matchcount$60(0)];
t$1605 = [1,t$1604];
t$1606 = [t$1605];
return t$1606;
} };
 break; }default: {var t$1614;
var t$1613;
var t$1612;
var t$1611;
var t$1610 = tools$IntStringFinMap$.mergeMap$365;
var t$1609 = function(v$1523){return f$$772(v$1523[0],v$1523[1]);
};
var t$1608;
if (m1$770 == null) {t$1608 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1486 = m1$770;
switch (v$1486[0][0]) { case 0: {t$1608 = v$1486[0][1];
 break; }default: {t$1608 = v$1486[0][1][0];
} };
};
var t$1607;
if (m2$771 == null) {t$1607 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1487 = m2$771;
switch (v$1487[0][0]) { case 0: {t$1607 = v$1487[0][1];
 break; }default: {t$1607 = v$1487[0][1][0];
} };
};
t$1611 = (t$1610(t$1609,t$1608,t$1607));
t$1612 = [t$1611,special_objects$Name$.current_matchcount$60(0)];
t$1613 = [1,t$1612];
t$1614 = [t$1613];
return t$1614;
} };
};
};
};
var fix$1615 = {};
fix$1615.$pp_lookup = function(v$819,v$822,v$825){lab$pp_lookup: while (true) {if (v$822 == null) {return tools$Crash$.impossible$50("QuasiMap2.pp_lookup; element not there");
} else {var v$844 = v$822;
var v$845 = v$844[0];
var v$846 = v$844[1];
var t$1616;
var v$1430 = v$845[0][0][1];
t$1616 = ((v$825[0] == v$1430[0])?(v$825[1] == v$1430[1]):false);
if (t$1616) {return v$819(v$845);
} else {var t$1617 = v$819;
var t$1618 = v$846;
var t$1619 = v$825;
var v$819 = t$1617;
var v$822 = t$1618;
var v$825 = t$1619;
continue lab$pp_lookup;
};
};
};
};
compiler_objects$Excon$$2.pp_lookup$816 = fix$1615.$pp_lookup;
compiler_objects$Excon$$2.en$Restrict$848 = new String("Restrict");
compiler_objects$Excon$$2.restrict$849 = function(v$1524,v$1525,v$862){if (v$862 == null) {return null;
} else {var v$869 = compiler_objects$Excon$$2.ensure_consistent$401(v$1525);
if (v$869 == null) {throw [compiler_objects$Excon$$2.en$Restrict$848,"[empty map]"];
} else {var im$870;
if (v$869 == null) {im$870 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1282 = v$869;
switch (v$1282[0][0]) { case 0: {im$870 = v$1282[0][1];
 break; }default: {im$870 = v$1282[0][1][0];
} };
};
var ns$871;
var fix$1620 = {};
fix$1620.$map = function(v$1288){if (v$1288 == null) {return null;
} else {var v$1289 = v$1288;
var v$1290 = v$1289[0];
var v$1291 = v$1289[1];
return [v$1290[0][0][1],fix$1620.$map(v$1291)];
};
};
var map$1287 = fix$1620.$map;
ns$871 = (map$1287(v$862));
var im$$873;
try {var t$1627 = tools$IntStringFinMap$.restrict$382;
var t$1626;
var fix$1622 = {};
fix$1622.$pp_lookup = function(v$1539,v$1540){lab$pp_lookup: while (true) {if (v$1539 == null) {return tools$Crash$.impossible$50("QuasiMap2.pp_lookup; element not there");
} else {var v$1541 = v$1539;
var v$1542 = v$1541[0];
var v$1543 = v$1541[1];
var t$1623;
var v$1544 = v$1542[0][0][1];
t$1623 = ((v$1540[0] == v$1544[0])?(v$1540[1] == v$1544[1]):false);
if (t$1623) {return v$1524(v$1542);
} else {var t$1624 = v$1543;
var t$1625 = v$1540;
var v$1539 = t$1624;
var v$1540 = t$1625;
continue lab$pp_lookup;
};
};
};
};
var pp_lookup$1538 = fix$1622.$pp_lookup;
t$1626 = (function(v$1545){return pp_lookup$1538(v$862,v$1545);
});
im$$873 = (t$1627(t$1626,im$870,ns$871));
} catch(v$1621) {im$$873 = ((function(v$877){var t$1628 = v$877;
if (t$1628[0] == tools$IntStringFinMap$.en$Restrict$381) {var s$874 = v$877[1];
throw [compiler_objects$Excon$$2.en$Restrict$848,s$874];
} else {throw v$877;
};
})(v$1621));
};
return (tools$IntStringFinMap$.fold$53(function(v$882){var v$887 = v$882[0];
var v$888 = v$887[0];
return v$882[1]?v$888[0][0][2]:false;
},true,im$$873))?[[0,im$$873]]:[[1,[im$$873,special_objects$Name$.current_matchcount$60(0)]]];
};
};
};
compiler_objects$Excon$$2.enrich$896 = function(f$899,v$903){var v$927 = v$903[0];
var v$928 = v$903[1];
var m1$904 = compiler_objects$Excon$$2.ensure_consistent$401(v$927);
var m2$905 = compiler_objects$Excon$$2.ensure_consistent$401(v$928);
if (m2$905 == null) {return true;
} else {if (m1$904 == null) {return false;
} else {var im1$916;
if (m1$904 == null) {im1$916 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1297 = m1$904;
switch (v$1297[0][0]) { case 0: {im1$916 = v$1297[0][1];
 break; }default: {im1$916 = v$1297[0][1][0];
} };
};
var im2$917;
if (m2$905 == null) {im2$917 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1301 = m2$905;
switch (v$1301[0][0]) { case 0: {im2$917 = v$1301[0][1];
 break; }default: {im2$917 = v$1301[0][1][0];
} };
};
return tools$IntStringFinMap$.enrich$405(function(v$1304){var v$1305 = v$1304[0];
var v$1306 = v$1305[1];
var v$1307 = v$1304[1];
var v$1308 = v$1307[1];
return f$899([v$1306,v$1308]);
},[im1$916,im2$917]);
};
};
};
compiler_objects$Excon$$2.layoutMap$929 = function(v$963,v$965,v$964,v$962){return function(pp_dom$938){return function(pp_range$941){return function(m$944){var t$1629;
var v$960 = [0,v$964];
var t$1632;
var l$1310;
if (m$944 == null) {l$1310 = null;
} else {var t$1631 = tools$IntStringFinMap$.range$275;
var t$1630;
var v$1321 = compiler_objects$Excon$$2.ensure_consistent$401(m$944);
if (v$1321 == null) {t$1630 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1322 = v$1321;
switch (v$1322[0][0]) { case 0: {t$1630 = v$1322[0][1];
 break; }default: {t$1630 = v$1322[0][1][0];
} };
};
l$1310 = (t$1631(t$1630));
};
var fix$1633 = {};
fix$1633.$map = function(v$1312){if (v$1312 == null) {return null;
} else {var v$1313 = v$1312;
var v$1314 = v$1313[0];
var v$1315 = v$1313[1];
var t$1636;
var t$1634;
var v$1491 = v$1314[0];
var v$1492 = v$1314[1];
var t$1635;
var v$1493 = [0,v$963];
t$1635 = [[pp_dom$938(v$1491),[pp_range$941(v$1492),null]],v$1493,"",1,""];
t$1634 = [0,t$1635];
t$1636 = [t$1634,fix$1633.$map(v$1315)];
return t$1636;
};
};
var map$1311 = fix$1633.$map;
t$1632 = (map$1311(l$1310));
t$1629 = [t$1632,v$960,v$965,1,v$962];
return [0,t$1629];
};
};
};
};
compiler_objects$Excon$$2.reportMap$966 = function(f$969,m$972){var t$1641 = tools$Report$.flatten$78;
var t$1639;
var l$1325;
if (m$972 == null) {l$1325 = null;
} else {var t$1638 = tools$IntStringFinMap$.range$275;
var t$1637;
var v$1332 = compiler_objects$Excon$$2.ensure_consistent$401(m$972);
if (v$1332 == null) {t$1637 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1333 = v$1332;
switch (v$1333[0][0]) { case 0: {t$1637 = v$1333[0][1];
 break; }default: {t$1637 = v$1333[0][1][0];
} };
};
l$1325 = (t$1638(t$1637));
};
var fix$1640 = {};
fix$1640.$map = function(v$1327){if (v$1327 == null) {return null;
} else {var v$1328 = v$1327;
var v$1329 = v$1328[0];
var v$1330 = v$1328[1];
return [f$969(v$1329),fix$1640.$map(v$1330)];
};
};
var map$1326 = fix$1640.$map;
t$1639 = (map$1326(l$1325));
return t$1641(t$1639);
};
compiler_objects$Excon$$2.pu_map0$973 = function(pu_d$976,pu_a$979){var pu_m$988 = pickle$pickle$.combHash$2081(function(m$1335){return tools$IntStringFinMap$.fold$53(function(v$1336){return SmlPrims.chk_ovf_i32(v$1336[1] + 1);
},0,m$1335);
},tools$IntStringFinMap$.pu$479(pickle$pickle$.pairGen$1044([pickle$pickle$.int$720,pickle$pickle$.string$900]),pickle$pickle$.pairGen$1044([pu_d$976,pu_a$979])));
return pickle$pickle$.dataGen$1479(["QuasiMap.map0",function(v$1341){switch (v$1341[0]) { case 0: {return 0;
 break; }default: {return 1;
} };
},[function(v$1342){return pickle$pickle$.con1$2005(function(v$1343){return [0,v$1343];
},function(v$1344){switch (v$1344[0]) { case 0: {return v$1344[1];
 break; }default: {return tools$Crash$.impossible$50("QuasiMap2.pu_map0.Rigid");
} };
},pu_m$988);
},[function(v$1347){return pickle$pickle$.con1$2005(function(v$1348){return [1,[v$1348[1],-1]];
},function(v$1349){switch (v$1349[0]) { case 1: {var v$1350 = v$1349[1];
return [v$1350[1],v$1350[0]];
 break; }default: {return tools$Crash$.impossible$50("QuasiMap2.pu_map0.Flexible");
} };
},pickle$pickle$.pairGen0$974(special_objects$Name$.pu_matchcount$287,pu_m$988));
},null]]]);
};
compiler_objects$Excon$$2.pu$1030 = function(pu_d$1033,pu_a$1036){return pickle$pickle$.convert$2333([function(v$1359){switch (v$1359[0]) { case 0: {var v$1360 = v$1359[1];
return v$1360;
 break; }default: {return null;
} };
},function(v$1361){if (v$1361 == null) {return [1];
} else {var v$1362 = v$1361;
var t$1644;
var t$1643 = tools$IntStringFinMap$.isEmpty$119(0);
var t$1642;
if (v$1361 == null) {t$1642 = (tools$Crash$.impossible$50("QuasiMap2.imap': impossible"));
} else {var v$1364 = v$1361;
switch (v$1364[0][0]) { case 0: {t$1642 = v$1364[0][1];
 break; }default: {t$1642 = v$1364[0][1][0];
} };
};
t$1644 = (t$1643(t$1642));
if (t$1644) {return tools$Crash$.impossible$50("QuasiMap2.pu.hmmm");
} else {return [0,v$1362];
};
};
}],pickle$pickle$.optionGen$2125(pickle$pickle$.ref0ShGen$1259(compiler_objects$Excon$$2.pu_map0$973(pu_d$1033,pu_a$1036))));
};
return 0;
})();
