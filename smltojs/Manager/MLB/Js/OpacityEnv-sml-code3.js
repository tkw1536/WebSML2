if ((typeof(basics$OpacityEnv$$3)) == "undefined") {basics$OpacityEnv$$3 = {};
};
(function(){basics$OpacityEnv$$3.eq_bal$1398 = function(v$1400,v$1401){switch (v$1400) { case 0: {switch (v$1401) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1401) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1401) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
};
var fix$2020 = {};
fix$2020.$eq_tree = function(v$1406,v$1407,v$1403){lab$eq_tree: while (true) {var v$1404 = v$1403[0];
var v$1405 = v$1403[1];
if (v$1404 == null) {return (v$1405 == null)?true:false;
} else {if (v$1405 == null) {return false;
} else {var v$1408 = v$1404;
var v$1409 = v$1405;
if (v$1406([v$1408[0],v$1409[0]])) {if (v$1407([v$1408[1],v$1409[1]])) {if (fix$2020.$eq_tree(v$1406,v$1407,[v$1408[2],v$1409[2]])) {var t$2021 = v$1406;
var t$2022 = v$1407;
var t$2023 = [v$1408[3],v$1409[3]];
var v$1406 = t$2021;
var v$1407 = t$2022;
var v$1403 = t$2023;
continue lab$eq_tree;
} else {return false;
};
} else {return false;
};
} else {return false;
};
};
};
};
};
basics$OpacityEnv$$3.eq_tree$1402 = fix$2020.$eq_tree;
basics$OpacityEnv$$3.die$129 = function(s$132){return tools$Crash$.impossible$50("OrderFinMap." + s$132);
};
basics$OpacityEnv$$3.s$j$133 = function(v$138,v$139){return basics$OpacityEnv$$2.lt$87(v$138,v$139);
};
basics$OpacityEnv$$3.lt$140 = function(v$1413,v$1414){return basics$OpacityEnv$$2.lt$87(v$1413,v$1414);
};
basics$OpacityEnv$$3.eq$141 = function(v$150,v$151){return ((basics$OpacityEnv$$2.lt$87(v$150,v$151))?true:(basics$OpacityEnv$$2.lt$87(v$151,v$150)))?false:true;
};
basics$OpacityEnv$$3.empty$157 = function(v$2019){return null;
};
basics$OpacityEnv$$3.singleton$158 = function(v$2011,v$2012){return [v$2011,v$2012,null,null,2];
};
basics$OpacityEnv$$3.isEmpty$165 = function(v$168){return (v$168 == null)?true:false;
};
basics$OpacityEnv$$3.lookup$173 = function(t$176,key$179){var fix$2024 = {};
fix$2024.$search = function(v$183){lab$search: while (true) {if (v$183 == null) {return [1];
} else {var v$200 = v$183;
var v$201 = v$200[0];
var v$202 = v$200[1];
var v$203 = v$200[2];
var v$204 = v$200[3];
if (basics$OpacityEnv$$2.lt$87(key$179,v$201)) {var t$2025 = v$203;
var v$183 = t$2025;
continue lab$search;
} else {if (basics$OpacityEnv$$2.lt$87(v$201,key$179)) {var t$2026 = v$204;
var v$183 = t$2026;
continue lab$search;
} else {return [0,v$202];
};
};
};
};
};
var search$180 = fix$2024.$search;
return search$180(t$176);
};
basics$OpacityEnv$$3.en$Impossible$205 = new String("Impossible");
basics$OpacityEnv$$3.impossible$206 = function(s$209){throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMap" + s$209];
};
var en$ALREADYTHERE$210 = new String("ALREADYTHERE");
var exn$ALREADYTHERE$210 = [en$ALREADYTHERE$210];
basics$OpacityEnv$$3.add$433 = function(v$442,v$443,v$444){try {var fix$2028 = {};
fix$2028.$ins = function(v$1499){if (v$1499 == null) {return [true,[v$442,v$443,null,null,2]];
} else {var v$1500 = v$1499;
var v$1501 = v$1500[0];
var v$1502 = v$1500[1];
var v$1503 = v$1500[2];
var v$1504 = v$1500[3];
var v$1505 = v$1500[4];
if (basics$OpacityEnv$$2.lt$87(v$442,v$1501)) {var v$1509 = fix$2028.$ins(v$1503);
var v$1510 = v$1509[0];
var v$1511 = v$1509[1];
switch (v$1505) { case 2: {return v$1510?[true,[v$1501,v$1502,v$1511,v$1504,1]]:[false,[v$1501,v$1502,v$1511,v$1504,2]];
 break; }case 0: {return v$1510?[false,[v$1501,v$1502,v$1511,v$1504,2]]:[false,[v$1501,v$1502,v$1511,v$1504,0]];
 break; }default: {if (v$1510) {var v$1513;
if (v$1511 == null) {throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMapAVLfinmap 1"];
} else {v$1513 = v$1511;
};
var v$1516 = v$1513[0];
var v$1517 = v$1513[1];
var v$1518 = v$1513[2];
var v$1519 = v$1513[3];
var v$1520 = v$1513[4];
var t$2029;
var v$1766 = 1;
switch (v$1520) { case 0: {switch (v$1766) { case 0: {t$2029 = true;
 break; }default: {t$2029 = false;
} };
 break; }case 1: {switch (v$1766) { case 1: {t$2029 = true;
 break; }default: {t$2029 = false;
} };
 break; }case 2: {switch (v$1766) { case 2: {t$2029 = true;
 break; }default: {t$2029 = false;
} };
 break; } };
if (t$2029) {return [false,[v$1516,v$1517,v$1518,[v$1501,v$1502,v$1519,v$1504,2],2]];
} else {var v$1528;
if (v$1519 == null) {throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMapAVLfinmap 2"];
} else {v$1528 = v$1519;
};
var v$1531 = v$1528[0];
var v$1532 = v$1528[1];
var v$1533 = v$1528[2];
var v$1534 = v$1528[3];
var v$1535 = v$1528[4];
var t$2050 = false;
var t$2049;
var t$2048;
var t$2047 = v$1531;
var t$2046 = v$1532;
var t$2045;
var t$2044;
var t$2043 = v$1516;
var t$2042 = v$1517;
var t$2041 = v$1518;
var t$2040 = v$1533;
var t$2039;
var t$2038;
var v$1772 = 0;
switch (v$1535) { case 0: {switch (v$1772) { case 0: {t$2038 = true;
 break; }default: {t$2038 = false;
} };
 break; }case 1: {switch (v$1772) { case 1: {t$2038 = true;
 break; }default: {t$2038 = false;
} };
 break; }case 2: {switch (v$1772) { case 2: {t$2038 = true;
 break; }default: {t$2038 = false;
} };
 break; } };
t$2039 = (t$2038?1:2);
t$2044 = [t$2043,t$2042,t$2041,t$2040,t$2039];
t$2045 = t$2044;
var t$2037;
var t$2036;
var t$2035 = v$1501;
var t$2034 = v$1502;
var t$2033 = v$1534;
var t$2032 = v$1504;
var t$2031;
var t$2030;
var v$1776 = 1;
switch (v$1535) { case 0: {switch (v$1776) { case 0: {t$2030 = true;
 break; }default: {t$2030 = false;
} };
 break; }case 1: {switch (v$1776) { case 1: {t$2030 = true;
 break; }default: {t$2030 = false;
} };
 break; }case 2: {switch (v$1776) { case 2: {t$2030 = true;
 break; }default: {t$2030 = false;
} };
 break; } };
t$2031 = (t$2030?0:2);
t$2036 = [t$2035,t$2034,t$2033,t$2032,t$2031];
t$2037 = t$2036;
t$2048 = [t$2047,t$2046,t$2045,t$2037,2];
t$2049 = t$2048;
return [t$2050,t$2049];
};
} else {return [false,[v$1501,v$1502,v$1511,v$1504,1]];
};
} };
} else {if (basics$OpacityEnv$$2.lt$87(v$1501,v$442)) {var v$1553 = fix$2028.$ins(v$1504);
var v$1554 = v$1553[0];
var v$1555 = v$1553[1];
switch (v$1505) { case 2: {return v$1554?[true,[v$1501,v$1502,v$1503,v$1555,0]]:[false,[v$1501,v$1502,v$1503,v$1555,2]];
 break; }case 1: {return v$1554?[false,[v$1501,v$1502,v$1503,v$1555,2]]:[false,[v$1501,v$1502,v$1503,v$1555,1]];
 break; }default: {if (v$1554) {var v$1557;
if (v$1555 == null) {throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMapAVLfinmap 3"];
} else {v$1557 = v$1555;
};
var v$1560 = v$1557[0];
var v$1561 = v$1557[1];
var v$1562 = v$1557[2];
var v$1563 = v$1557[3];
var v$1564 = v$1557[4];
var t$2051;
var v$1786 = 0;
switch (v$1564) { case 0: {switch (v$1786) { case 0: {t$2051 = true;
 break; }default: {t$2051 = false;
} };
 break; }case 1: {switch (v$1786) { case 1: {t$2051 = true;
 break; }default: {t$2051 = false;
} };
 break; }case 2: {switch (v$1786) { case 2: {t$2051 = true;
 break; }default: {t$2051 = false;
} };
 break; } };
if (t$2051) {return [false,[v$1560,v$1561,[v$1501,v$1502,v$1503,v$1562,2],v$1563,2]];
} else {var v$1572;
if (v$1562 == null) {throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMapAVLfinmap 4"];
} else {v$1572 = v$1562;
};
var v$1575 = v$1572[0];
var v$1576 = v$1572[1];
var v$1577 = v$1572[2];
var v$1578 = v$1572[3];
var v$1579 = v$1572[4];
var t$2072 = false;
var t$2071;
var t$2070;
var t$2069 = v$1575;
var t$2068 = v$1576;
var t$2067;
var t$2066;
var t$2065 = v$1501;
var t$2064 = v$1502;
var t$2063 = v$1503;
var t$2062 = v$1577;
var t$2061;
var t$2060;
var v$1792 = 0;
switch (v$1579) { case 0: {switch (v$1792) { case 0: {t$2060 = true;
 break; }default: {t$2060 = false;
} };
 break; }case 1: {switch (v$1792) { case 1: {t$2060 = true;
 break; }default: {t$2060 = false;
} };
 break; }case 2: {switch (v$1792) { case 2: {t$2060 = true;
 break; }default: {t$2060 = false;
} };
 break; } };
t$2061 = (t$2060?1:2);
t$2066 = [t$2065,t$2064,t$2063,t$2062,t$2061];
t$2067 = t$2066;
var t$2059;
var t$2058;
var t$2057 = v$1560;
var t$2056 = v$1561;
var t$2055 = v$1578;
var t$2054 = v$1563;
var t$2053;
var t$2052;
var v$1796 = 1;
switch (v$1579) { case 0: {switch (v$1796) { case 0: {t$2052 = true;
 break; }default: {t$2052 = false;
} };
 break; }case 1: {switch (v$1796) { case 1: {t$2052 = true;
 break; }default: {t$2052 = false;
} };
 break; }case 2: {switch (v$1796) { case 2: {t$2052 = true;
 break; }default: {t$2052 = false;
} };
 break; } };
t$2053 = (t$2052?0:2);
t$2058 = [t$2057,t$2056,t$2055,t$2054,t$2053];
t$2059 = t$2058;
t$2070 = [t$2069,t$2068,t$2067,t$2059,2];
t$2071 = t$2070;
return [t$2072,t$2071];
};
} else {return [false,[v$1501,v$1502,v$1503,v$1555,0]];
};
} };
} else {throw exn$ALREADYTHERE$210;
};
};
};
};
var ins$1498 = fix$2028.$ins;
return (ins$1498(v$444))[1];
} catch(v$2027) {return (function(ALREADYTHERE$441){var t$2073 = ALREADYTHERE$441;
if (t$2073[0] == en$ALREADYTHERE$210) {var fix$2074 = {};
fix$2074.$repl = function(v$1618){if (v$1618 == null) {throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMapAVLupdate.repl"];
} else {var v$1621 = v$1618;
var v$1622 = v$1621[0];
var v$1623 = v$1621[1];
var v$1624 = v$1621[2];
var v$1625 = v$1621[3];
var v$1626 = v$1621[4];
return (basics$OpacityEnv$$2.lt$87(v$442,v$1622))?[v$1622,v$1623,fix$2074.$repl(v$1624),v$1625,v$1626]:((basics$OpacityEnv$$2.lt$87(v$1622,v$442))?[v$1622,v$1623,v$1624,fix$2074.$repl(v$1625),v$1626]:[v$1622,v$443,v$1624,v$1625,v$1626]);
};
};
var repl$1617 = fix$2074.$repl;
return repl$1617(v$444);
} else {throw ALREADYTHERE$441;
};
})(v$2027);
};
};
var fix$2075 = {};
fix$2075.$plus = function(v$463,v$464){lab$plus: while (true) {if (v$464 == null) {return v$463;
} else {var v$458 = v$464;
var v$459 = v$458[0];
var v$460 = v$458[1];
var v$461 = v$458[2];
var v$462 = v$458[3];
var t$2076 = fix$2075.$plus(basics$OpacityEnv$$3.add$433(v$459,v$460,v$463),v$461);
var t$2077 = v$462;
var v$463 = t$2076;
var v$464 = t$2077;
continue lab$plus;
};
};
};
basics$OpacityEnv$$3.plus$445 = fix$2075.$plus;
var en$NOTFOUND$465 = new String("NOTFOUND");
var exn$NOTFOUND$465 = [en$NOTFOUND$465];
var delete$466 = function(v$751,v$752){var balance1$471 = function(v$474){if (v$474 == null) {throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMap(balance1 on an empty map)"];
} else {var v$544 = v$474;
var v$545 = v$544[0];
var v$546 = v$544[1];
var v$547 = v$544[2];
var v$548 = v$544[3];
switch (v$544[4]) { case 1: {return [[v$545,v$546,v$547,v$548,2],true];
 break; }case 2: {return [[v$545,v$546,v$547,v$548,0],false];
 break; }default: {var v$531;
if (v$548 == null) {throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMapAVLfinmap 5"];
} else {v$531 = v$548;
};
var v$532 = v$531[0];
var v$533 = v$531[1];
var v$534 = v$531[2];
var v$535 = v$531[3];
switch (v$531[4]) { case 1: {var v$518;
if (v$534 == null) {throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMapAVLfinmap 6"];
} else {v$518 = v$534;
};
var v$519 = v$518[0];
var v$520 = v$518[1];
var v$521 = v$518[2];
var v$522 = v$518[3];
var v$523 = v$518[4];
var t$2097;
var t$2096;
var t$2095 = v$519;
var t$2094 = v$520;
var t$2093;
var t$2092;
var t$2091 = v$545;
var t$2090 = v$546;
var t$2089 = v$547;
var t$2088 = v$521;
var t$2087;
var t$2086;
var v$1814 = 0;
switch (v$523) { case 0: {switch (v$1814) { case 0: {t$2086 = true;
 break; }default: {t$2086 = false;
} };
 break; }case 1: {switch (v$1814) { case 1: {t$2086 = true;
 break; }default: {t$2086 = false;
} };
 break; }case 2: {switch (v$1814) { case 2: {t$2086 = true;
 break; }default: {t$2086 = false;
} };
 break; } };
t$2087 = (t$2086?1:2);
t$2092 = [t$2091,t$2090,t$2089,t$2088,t$2087];
t$2093 = t$2092;
var t$2085;
var t$2084;
var t$2083 = v$532;
var t$2082 = v$533;
var t$2081 = v$522;
var t$2080 = v$535;
var t$2079;
var t$2078;
var v$1816 = 1;
switch (v$523) { case 0: {switch (v$1816) { case 0: {t$2078 = true;
 break; }default: {t$2078 = false;
} };
 break; }case 1: {switch (v$1816) { case 1: {t$2078 = true;
 break; }default: {t$2078 = false;
} };
 break; }case 2: {switch (v$1816) { case 2: {t$2078 = true;
 break; }default: {t$2078 = false;
} };
 break; } };
t$2079 = (t$2078?0:2);
t$2084 = [t$2083,t$2082,t$2081,t$2080,t$2079];
t$2085 = t$2084;
t$2096 = [t$2095,t$2094,t$2093,t$2085,2];
t$2097 = t$2096;
return [t$2097,true];
 break; }case 2: {return [[v$532,v$533,[v$545,v$546,v$547,v$534,0],v$535,1],false];
 break; }default: {return [[v$532,v$533,[v$545,v$546,v$547,v$534,2],v$535,2],true];
} };
} };
};
};
var balance2$550 = function(v$553){if (v$553 == null) {throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMap(balance2 on an empty map)"];
} else {var v$623 = v$553;
var v$624 = v$623[0];
var v$625 = v$623[1];
var v$626 = v$623[2];
var v$627 = v$623[3];
switch (v$623[4]) { case 0: {return [[v$624,v$625,v$626,v$627,2],true];
 break; }case 2: {return [[v$624,v$625,v$626,v$627,1],false];
 break; }default: {var v$610;
if (v$626 == null) {throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMapAVLfinmap 7"];
} else {v$610 = v$626;
};
var v$611 = v$610[0];
var v$612 = v$610[1];
var v$613 = v$610[2];
var v$614 = v$610[3];
switch (v$610[4]) { case 0: {var v$597;
if (v$614 == null) {throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMapAVLfinmap 8"];
} else {v$597 = v$614;
};
var v$598 = v$597[0];
var v$599 = v$597[1];
var v$600 = v$597[2];
var v$601 = v$597[3];
var v$602 = v$597[4];
var t$2117;
var t$2116;
var t$2115 = v$598;
var t$2114 = v$599;
var t$2113;
var t$2112;
var t$2111 = v$611;
var t$2110 = v$612;
var t$2109 = v$613;
var t$2108 = v$600;
var t$2107;
var t$2106;
var v$1826 = 0;
switch (v$602) { case 0: {switch (v$1826) { case 0: {t$2106 = true;
 break; }default: {t$2106 = false;
} };
 break; }case 1: {switch (v$1826) { case 1: {t$2106 = true;
 break; }default: {t$2106 = false;
} };
 break; }case 2: {switch (v$1826) { case 2: {t$2106 = true;
 break; }default: {t$2106 = false;
} };
 break; } };
t$2107 = (t$2106?1:2);
t$2112 = [t$2111,t$2110,t$2109,t$2108,t$2107];
t$2113 = t$2112;
var t$2105;
var t$2104;
var t$2103 = v$624;
var t$2102 = v$625;
var t$2101 = v$601;
var t$2100 = v$627;
var t$2099;
var t$2098;
var v$1824 = 1;
switch (v$602) { case 0: {switch (v$1824) { case 0: {t$2098 = true;
 break; }default: {t$2098 = false;
} };
 break; }case 1: {switch (v$1824) { case 1: {t$2098 = true;
 break; }default: {t$2098 = false;
} };
 break; }case 2: {switch (v$1824) { case 2: {t$2098 = true;
 break; }default: {t$2098 = false;
} };
 break; } };
t$2099 = (t$2098?0:2);
t$2104 = [t$2103,t$2102,t$2101,t$2100,t$2099];
t$2105 = t$2104;
t$2116 = [t$2115,t$2114,t$2113,t$2105,2];
t$2117 = t$2116;
return [t$2117,true];
 break; }case 2: {return [[v$611,v$612,v$613,[v$624,v$625,v$614,v$627,1],0],false];
 break; }default: {return [[v$611,v$612,v$613,[v$624,v$625,v$614,v$627,2],2],true];
} };
} };
};
};
var fix$2118 = {};
fix$2118.$remove_rightmost = function(v$632){if (v$632 == null) {throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMap(remove_rightmost on empty map)"];
} else {var v$648 = v$632;
var v$649 = v$648[3];
if (v$649 == null) {return [v$648[2],v$648[0],v$648[1],true];
} else {var v$674 = v$648[0];
var v$675 = v$648[1];
var v$676 = v$648[2];
var v$677 = v$648[4];
var v$669 = fix$2118.$remove_rightmost(v$649);
var v$670 = v$669[0];
var v$671 = v$669[1];
var v$672 = v$669[2];
if (v$669[3]) {var v$666 = balance2$550([v$674,v$675,v$676,v$670,v$677]);
return [v$666[0],v$671,v$672,v$666[1]];
} else {return [[v$674,v$675,v$676,v$670,v$677],v$671,v$672,false];
};
};
};
};
var remove_rightmost$629 = fix$2118.$remove_rightmost;
var fix$2119 = {};
fix$2119.$del = function(v$681){lab$del: while (true) {if (v$681 == null) {throw exn$NOTFOUND$465;
} else {var v$741 = v$681;
var v$742 = v$741[0];
var v$743 = v$741[1];
var v$744 = v$741[2];
var v$745 = v$741[3];
var v$746 = v$741[4];
if (basics$OpacityEnv$$2.lt$87(v$751,v$742)) {var v$702 = fix$2119.$del(v$744);
var v$703 = v$702[0];
if (v$702[1]) {return balance1$471([v$742,v$743,v$703,v$745,v$746]);
} else {return [[v$742,v$743,v$703,v$745,v$746],false];
};
} else {if (basics$OpacityEnv$$2.lt$87(v$742,v$751)) {var v$716 = fix$2119.$del(v$745);
var v$717 = v$716[0];
if (v$716[1]) {return balance2$550([v$742,v$743,v$744,v$717,v$746]);
} else {return [[v$742,v$743,v$744,v$717,v$746],false];
};
} else {if (v$745 == null) {return [v$744,true];
} else {if (v$744 == null) {return [v$745,true];
} else {var v$736 = remove_rightmost$629(v$744);
var v$737 = v$736[0];
var v$738 = v$736[1];
var v$739 = v$736[2];
if (v$736[3]) {return balance1$471([v$738,v$739,v$737,v$745,v$746]);
} else {return [[v$738,v$739,v$737,v$745,v$746],false];
};
};
};
};
};
};
};
};
var del$678 = fix$2119.$del;
return (del$678(v$752))[0];
};
basics$OpacityEnv$$3.remove$753 = function(v$761,v$762){try {return [0,delete$466(v$761,v$762)];
} catch(v$2120) {return (function(NOTFOUND$760){var t$2121 = NOTFOUND$760;
if (t$2121[0] == en$NOTFOUND$465) {return [1];
} else {throw NOTFOUND$760;
};
})(v$2120);
};
};
basics$OpacityEnv$$3.delete$763 = function(v$771,v$772){try {return delete$466(v$771,v$772);
} catch(v$2122) {return (function(NOTFOUND$770){var t$2123 = NOTFOUND$770;
if (t$2123[0] == en$NOTFOUND$465) {return v$772;
} else {throw NOTFOUND$770;
};
})(v$2122);
};
};
basics$OpacityEnv$$3.dom$773 = function(m$776){var fix$2124 = {};
fix$2124.$dom$ = function(v$780,v$783){lab$dom$: while (true) {if (v$780 == null) {return v$783;
} else {var v$795 = v$780;
var v$796 = v$795[0];
var v$797 = v$795[2];
var v$798 = v$795[3];
var t$2125 = v$797;
var t$2126 = [v$796,fix$2124.$dom$(v$798,v$783)];
var v$780 = t$2125;
var v$783 = t$2126;
continue lab$dom$;
};
};
};
var dom$$777 = fix$2124.$dom$;
return dom$$777(m$776,null);
};
basics$OpacityEnv$$3.range$800 = function(m$803){var fix$2127 = {};
fix$2127.$ran = function(v$807,v$810){lab$ran: while (true) {if (v$807 == null) {return v$810;
} else {var v$822 = v$807;
var v$823 = v$822[1];
var v$824 = v$822[2];
var v$825 = v$822[3];
var t$2128 = v$824;
var t$2129 = [v$823,fix$2127.$ran(v$825,v$810)];
var v$807 = t$2128;
var v$810 = t$2129;
continue lab$ran;
};
};
};
var ran$804 = fix$2127.$ran;
return ran$804(m$803,null);
};
basics$OpacityEnv$$3.list$827 = function(m$830){var fix$2130 = {};
fix$2130.$li = function(v$834,v$837){lab$li: while (true) {if (v$834 == null) {return v$837;
} else {var v$850 = v$834;
var v$851 = v$850[0];
var v$852 = v$850[1];
var v$853 = v$850[2];
var v$854 = v$850[3];
var t$2131 = v$853;
var t$2132 = [[v$851,v$852],fix$2130.$li(v$854,v$837)];
var v$834 = t$2131;
var v$837 = t$2132;
continue lab$li;
};
};
};
var li$831 = fix$2130.$li;
return li$831(m$830,null);
};
var fix$2133 = {};
fix$2133.$composemap = function(f$859,t$862){if (t$862 == null) {return null;
} else {var v$873 = t$862;
var v$874 = v$873[0];
var v$875 = v$873[1];
var v$876 = v$873[2];
var v$877 = v$873[3];
var v$878 = v$873[4];
var l$$872 = fix$2133.$composemap(f$859,v$876);
return [v$874,f$859(v$875),l$$872,fix$2133.$composemap(f$859,v$877),v$878];
};
};
basics$OpacityEnv$$3.composemap$856 = fix$2133.$composemap;
var fix$2134 = {};
fix$2134.$ComposeMap = function(f$882,t$885){if (t$885 == null) {return null;
} else {var v$896 = t$885;
var v$897 = v$896[0];
var v$898 = v$896[1];
var v$899 = v$896[2];
var v$900 = v$896[3];
var v$901 = v$896[4];
var l$$895 = fix$2134.$ComposeMap(f$882,v$899);
return [v$897,f$882([v$897,v$898]),l$$895,fix$2134.$ComposeMap(f$882,v$900),v$901];
};
};
basics$OpacityEnv$$3.ComposeMap$879 = fix$2134.$ComposeMap;
basics$OpacityEnv$$3.fold$902 = function(f$905,e$908,t$911){var fix$2135 = {};
fix$2135.$fold$ = function(v$915,v$918){lab$fold$: while (true) {if (v$915 == null) {return v$918;
} else {var v$930 = v$915;
var v$931 = v$930[1];
var v$932 = v$930[2];
var v$933 = v$930[3];
var t$2136 = v$933;
var t$2137 = f$905([v$931,fix$2135.$fold$(v$932,v$918)]);
var v$915 = t$2136;
var v$918 = t$2137;
continue lab$fold$;
};
};
};
var fold$$912 = fix$2135.$fold$;
return fold$$912(t$911,e$908);
};
basics$OpacityEnv$$3.Fold$935 = function(f$938,e$941,t$944){var fix$2138 = {};
fix$2138.$fold$ = function(v$948,v$951){lab$fold$: while (true) {if (v$948 == null) {return v$951;
} else {var v$964 = v$948;
var v$965 = v$964[0];
var v$966 = v$964[1];
var v$967 = v$964[2];
var v$968 = v$964[3];
var t$2139 = v$968;
var t$2140 = f$938([[v$965,v$966],fix$2138.$fold$(v$967,v$951)]);
var v$948 = t$2139;
var v$951 = t$2140;
continue lab$fold$;
};
};
};
var fold$$945 = fix$2138.$fold$;
return fold$$945(t$944,e$941);
};
basics$OpacityEnv$$3.filter$970 = function(f$973,t$976){var fix$2141 = {};
fix$2141.$fold$ = function(v$1873,v$1874){lab$fold$: while (true) {if (v$1873 == null) {return v$1874;
} else {var v$1875 = v$1873;
var v$1876 = v$1875[0];
var v$1877 = v$1875[1];
var v$1878 = v$1875[2];
var v$1879 = v$1875[3];
var t$2143 = v$1879;
var t$2142;
var v$2004 = fix$2141.$fold$(v$1878,v$1874);
t$2142 = ((f$973([v$1876,v$1877]))?(basics$OpacityEnv$$3.add$433(v$1876,v$1877,v$2004)):v$2004);
var t$2144 = t$2143;
var t$2145 = t$2142;
var v$1873 = t$2144;
var v$1874 = t$2145;
continue lab$fold$;
};
};
};
var fold$$1872 = fix$2141.$fold$;
return fold$$1872(t$976,basics$OpacityEnv$$3.empty$157(0));
};
var fix$2146 = {};
fix$2146.$addList = function(v$993,v$996){lab$addList: while (true) {if (v$993 == null) {return v$996;
} else {var v$1008 = v$993;
var v$1009 = v$1008[0];
var v$1010 = v$1009[0];
var v$1011 = v$1009[1];
var v$1012 = v$1008[1];
var t$2147 = v$1012;
var t$2148 = basics$OpacityEnv$$3.add$433(v$1010,v$1011,v$996);
var v$993 = t$2147;
var v$996 = t$2148;
continue lab$addList;
};
};
};
basics$OpacityEnv$$3.addList$990 = fix$2146.$addList;
basics$OpacityEnv$$3.fromList$1014 = function(l$1017){return basics$OpacityEnv$$3.addList$990(l$1017,basics$OpacityEnv$$3.empty$157(0));
};
basics$OpacityEnv$$3.fromSortedList$1018 = function(l$1021){var fix$2149 = {};
fix$2149.$build = function(v$1050,v$2013){switch (v$1050) { case 0: {return [v$2013,null];
 break; }default: {var n$$1052 = SmlPrims.div_i32(v$1050,2,CompilerInitial.exn$Div$40);
var v$1083 = fix$2149.$build(n$$1052,v$2013);
var v$1084 = v$1083[0];
var v$1085 = v$1083[1];
var v$1066;
if (v$1084 == null) {throw [basics$OpacityEnv$$3.en$Impossible$205,"OrderFinMapbuild"];
} else {var v$1078 = v$1084;
var v$1079 = v$1078[0];
v$1066 = [v$1079[0],v$1079[1],v$1078[1]];
};
var v$1067 = v$1066[0];
var v$1068 = v$1066[1];
var v$1069 = v$1066[2];
var v$1063 = fix$2149.$build(SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(v$1050 - n$$1052)) - 1),v$1069);
return [v$1063[0],[v$1067,v$1068,v$1085,v$1063[1]]];
} };
};
var build$1039 = fix$2149.$build;
var fix$2150 = {};
fix$2150.$mk_avl = function(v$1101){if (v$1101 == null) {return [null,0];
} else {var v$1130 = v$1101;
var v$1131 = v$1130[0];
var v$1132 = v$1130[1];
var v$1133 = v$1130[2];
var v$1134 = v$1130[3];
var v$1127 = fix$2150.$mk_avl(v$1133);
var v$1128 = v$1127[0];
var v$1129 = v$1127[1];
var v$1124 = fix$2150.$mk_avl(v$1134);
var v$1125 = v$1124[0];
var v$1126 = v$1124[1];
return [[v$1131,v$1132,v$1128,v$1125,(v$1129 == v$1126)?2:((v$1129 > v$1126)?1:0)],SmlPrims.chk_ovf_i32(1 + ((v$1129 > v$1126)?v$1129:v$1126))];
};
};
var mk_avl$1098 = fix$2150.$mk_avl;
var t$2159;
var t$2158 = mk_avl$1098;
var t$2157;
var t$2156;
var t$2155 = build$1039;
var t$2154;
var fix$2151 = {};
fix$2151.$acc = function(v$1688,v$1689){lab$acc: while (true) {if (v$1688 == null) {return v$1689;
} else {var v$1690 = v$1688;
var v$1691 = v$1690[1];
var t$2152 = v$1691;
var t$2153 = SmlPrims.chk_ovf_i32(v$1689 + 1);
var v$1688 = t$2152;
var v$1689 = t$2153;
continue lab$acc;
};
};
};
var acc$1687 = fix$2151.$acc;
t$2154 = (acc$1687(l$1021,0));
t$2156 = (t$2155(t$2154,l$1021));
t$2157 = t$2156[1];
t$2159 = (t$2158(t$2157));
return t$2159[0];
};
basics$OpacityEnv$$3.mergeMap$1143 = function(f$1146,t1$1149,t2$1152){var fix$2160 = {};
fix$2160.$merge = function(v$1173,v$2014){if (v$1173 == null) {return v$2014;
} else {if (v$2014 == null) {return v$1173;
} else {var v$1184 = v$1173;
var v$1185 = v$1184[0];
var v$1186 = v$1185[0];
var v$1187 = v$1185[1];
var v$1188 = v$1184[1];
var v$1189 = v$2014;
var v$1190 = v$1189[0];
var v$1191 = v$1190[0];
var v$1192 = v$1190[1];
var v$1193 = v$1189[1];
return (basics$OpacityEnv$$2.lt$87(v$1186,v$1191))?[[v$1186,v$1187],fix$2160.$merge(v$1188,v$2014)]:((basics$OpacityEnv$$2.lt$87(v$1191,v$1186))?[[v$1191,v$1192],fix$2160.$merge(v$1173,v$1193)]:[[v$1186,f$1146([v$1187,v$1192])],fix$2160.$merge(v$1188,v$1193)]);
};
};
};
var merge$1153 = fix$2160.$merge;
var t$2171 = basics$OpacityEnv$$3.fromSortedList$1018;
var t$2170;
var t$2169 = merge$1153;
var t$2168;
var fix$2165 = {};
fix$2165.$li = function(v$1882,v$1883){lab$li: while (true) {if (v$1882 == null) {return v$1883;
} else {var v$1884 = v$1882;
var v$1885 = v$1884[0];
var v$1886 = v$1884[1];
var v$1887 = v$1884[2];
var v$1888 = v$1884[3];
var t$2166 = v$1887;
var t$2167 = [[v$1885,v$1886],fix$2165.$li(v$1888,v$1883)];
var v$1882 = t$2166;
var v$1883 = t$2167;
continue lab$li;
};
};
};
var li$1881 = fix$2165.$li;
t$2168 = (li$1881(t1$1149,null));
var t$2164;
var fix$2161 = {};
fix$2161.$li = function(v$1891,v$1892){lab$li: while (true) {if (v$1891 == null) {return v$1892;
} else {var v$1893 = v$1891;
var v$1894 = v$1893[0];
var v$1895 = v$1893[1];
var v$1896 = v$1893[2];
var v$1897 = v$1893[3];
var t$2162 = v$1896;
var t$2163 = [[v$1894,v$1895],fix$2161.$li(v$1897,v$1892)];
var v$1891 = t$2162;
var v$1892 = t$2163;
continue lab$li;
};
};
};
var li$1890 = fix$2161.$li;
t$2164 = (li$1890(t2$1152,null));
t$2170 = (t$2169(t$2168,t$2164));
return t$2171(t$2170);
};
var fix$2172 = {};
fix$2172.$oneForWhich = function(f$1197,t$1200){lab$oneForWhich: while (true) {if (t$1200 == null) {return [1];
} else {var v$1220 = t$1200;
var v$1221 = v$1220[0];
var v$1222 = v$1220[1];
var v$1223 = v$1220[2];
var v$1224 = v$1220[3];
if (f$1197([v$1221,v$1222])) {return [0,[v$1221,v$1222]];
} else {var v$1217 = fix$2172.$oneForWhich(f$1197,v$1223);
switch (v$1217[0]) { case 0: {var v$1219 = v$1217[1];
return [0,v$1219];
 break; }default: {var t$2173 = f$1197;
var t$2174 = v$1224;
var f$1197 = t$2173;
var t$1200 = t$2174;
continue lab$oneForWhich;
} };
};
};
};
};
basics$OpacityEnv$$3.oneForWhich$1194 = fix$2172.$oneForWhich;
basics$OpacityEnv$$3.en$Restrict$1225 = new String("Restrict");
basics$OpacityEnv$$3.restrict$1226 = function(v$1245,v$1246,v$1247){var fix$2175 = {};
fix$2175.$foldl = function(v$1702,v$1703){if (v$1703 == null) {return v$1702;
} else {var v$1704 = v$1703;
var v$1705 = v$1704[0];
var v$1706 = v$1704[1];
var t$2180 = fix$2175.$foldl;
var t$2179;
var v$1910;
var fix$2176 = {};
fix$2176.$search = function(v$1914){lab$search: while (true) {if (v$1914 == null) {return [1];
} else {var v$1915 = v$1914;
var v$1916 = v$1915[0];
var v$1917 = v$1915[1];
var v$1918 = v$1915[2];
var v$1919 = v$1915[3];
if (basics$OpacityEnv$$2.lt$87(v$1705,v$1916)) {var t$2177 = v$1918;
var v$1914 = t$2177;
continue lab$search;
} else {if (basics$OpacityEnv$$2.lt$87(v$1916,v$1705)) {var t$2178 = v$1919;
var v$1914 = t$2178;
continue lab$search;
} else {return [0,v$1917];
};
};
};
};
};
var search$1913 = fix$2176.$search;
v$1910 = (search$1913(v$1246));
switch (v$1910[0]) { case 0: {var v$1920 = v$1910[1];
t$2179 = (basics$OpacityEnv$$3.add$433(v$1705,v$1920,v$1702));
 break; }default: {throw [basics$OpacityEnv$$3.en$Restrict$1225,v$1245(v$1705)];
} };
return t$2180(t$2179,v$1706);
};
};
var foldl$1701 = fix$2175.$foldl;
return foldl$1701(basics$OpacityEnv$$3.empty$157(0),v$1247);
};
basics$OpacityEnv$$3.enrich$1248 = function(en$1251,v$1255){var v$1276 = v$1255[0];
var v$1277 = v$1255[1];
var fix$2181 = {};
fix$2181.$fold$ = function(v$1925,v$1926){if (v$1925 == null) {return v$1926;
} else {var v$1927 = v$1925;
var v$1928 = v$1927[0];
var v$1929 = v$1927[1];
var v$1930 = v$1927[2];
var v$1931 = v$1927[3];
var t$2187 = fix$2181.$fold$;
var t$2186 = v$1931;
var t$2185;
if (fix$2181.$fold$(v$1930,v$1926)) {var v$1994;
var fix$2182 = {};
fix$2182.$search = function(v$1996){lab$search: while (true) {if (v$1996 == null) {return [1];
} else {var v$1997 = v$1996;
var v$1998 = v$1997[0];
var v$1999 = v$1997[1];
var v$2000 = v$1997[2];
var v$2001 = v$1997[3];
if (basics$OpacityEnv$$2.lt$87(v$1928,v$1998)) {var t$2183 = v$2000;
var v$1996 = t$2183;
continue lab$search;
} else {if (basics$OpacityEnv$$2.lt$87(v$1998,v$1928)) {var t$2184 = v$2001;
var v$1996 = t$2184;
continue lab$search;
} else {return [0,v$1999];
};
};
};
};
};
var search$1995 = fix$2182.$search;
v$1994 = (search$1995(v$1276));
switch (v$1994[0]) { case 0: {var v$2002 = v$1994[1];
t$2185 = (en$1251([v$2002,v$1929]));
 break; }default: {t$2185 = false;
} };
} else {t$2185 = false;
};
return t$2187(t$2186,t$2185);
};
};
var fold$$1924 = fix$2181.$fold$;
return fold$$1924(v$1277,true);
};
basics$OpacityEnv$$3.layoutMap$1278 = function(v$1311,v$1313,v$1312,v$1310){return function(layoutDom$1287){return function(layoutRan$1290){return function(m$1293){var t$2195;
var t$2191;
var l$1708;
var fix$2188 = {};
fix$2188.$li = function(v$1943,v$1944){lab$li: while (true) {if (v$1943 == null) {return v$1944;
} else {var v$1945 = v$1943;
var v$1946 = v$1945[0];
var v$1947 = v$1945[1];
var v$1948 = v$1945[2];
var v$1949 = v$1945[3];
var t$2189 = v$1948;
var t$2190 = [[v$1946,v$1947],fix$2188.$li(v$1949,v$1944)];
var v$1943 = t$2189;
var v$1944 = t$2190;
continue lab$li;
};
};
};
var li$1942 = fix$2188.$li;
l$1708 = (li$1942(m$1293,null));
var fix$2192 = {};
fix$2192.$map = function(v$1710){if (v$1710 == null) {return null;
} else {var v$1711 = v$1710;
var v$1712 = v$1711[0];
var v$1713 = v$1711[1];
var t$2194;
var t$2193;
var v$1951 = v$1712[0];
var v$1952 = v$1712[1];
t$2193 = [0,[[layoutDom$1287(v$1951),[layoutRan$1290(v$1952),null]],[0,v$1311],"",3,""]];
t$2194 = [t$2193,fix$2192.$map(v$1713)];
return t$2194;
};
};
var map$1709 = fix$2192.$map;
t$2191 = (map$1709(l$1708));
t$2195 = [t$2191,[0,v$1312],v$1313,3,v$1310];
return [0,t$2195];
};
};
};
};
basics$OpacityEnv$$3.reportMap$1314 = function(f$1317,t$1320){var t$2201 = tools$Report$.flatten$78;
var t$2199;
var l$1715;
var fix$2196 = {};
fix$2196.$li = function(v$1955,v$1956){lab$li: while (true) {if (v$1955 == null) {return v$1956;
} else {var v$1957 = v$1955;
var v$1958 = v$1957[0];
var v$1959 = v$1957[1];
var v$1960 = v$1957[2];
var v$1961 = v$1957[3];
var t$2197 = v$1960;
var t$2198 = [[v$1958,v$1959],fix$2196.$li(v$1961,v$1956)];
var v$1955 = t$2197;
var v$1956 = t$2198;
continue lab$li;
};
};
};
var li$1954 = fix$2196.$li;
l$1715 = (li$1954(t$1320,null));
var fix$2200 = {};
fix$2200.$map = function(v$1717){if (v$1717 == null) {return null;
} else {var v$1718 = v$1717;
var v$1719 = v$1718[0];
var v$1720 = v$1718[1];
return [f$1317(v$1719),fix$2200.$map(v$1720)];
};
};
var map$1716 = fix$2200.$map;
t$2199 = (map$1716(l$1715));
return t$2201(t$2199);
};
basics$OpacityEnv$$3.reportMapSORTED$1321 = function(f$1721,t$1722){var t$2207 = tools$Report$.flatten$78;
var t$2205;
var l$1724;
var fix$2202 = {};
fix$2202.$li = function(v$1964,v$1965){lab$li: while (true) {if (v$1964 == null) {return v$1965;
} else {var v$1966 = v$1964;
var v$1967 = v$1966[0];
var v$1968 = v$1966[1];
var v$1969 = v$1966[2];
var v$1970 = v$1966[3];
var t$2203 = v$1969;
var t$2204 = [[v$1967,v$1968],fix$2202.$li(v$1970,v$1965)];
var v$1964 = t$2203;
var v$1965 = t$2204;
continue lab$li;
};
};
};
var li$1963 = fix$2202.$li;
l$1724 = (li$1963(t$1722,null));
var fix$2206 = {};
fix$2206.$map = function(v$1726){if (v$1726 == null) {return null;
} else {var v$1727 = v$1726;
var v$1728 = v$1727[0];
var v$1729 = v$1727[1];
return [f$1721(v$1728),fix$2206.$map(v$1729)];
};
};
var map$1725 = fix$2206.$map;
t$2205 = (map$1725(l$1724));
return t$2207(t$2205);
};
basics$OpacityEnv$$3.pu_bal$1322 = pickle$pickle$.enumGen$2149(function(v$1730){var v$1731 = v$1730[0];
var v$1732 = v$1730[1];
switch (v$1731) { case 0: {switch (v$1732) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$1732) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$1732) { case 2: {return true;
 break; }default: {return false;
} };
 break; } };
},["OrderFinMap.bal",[1,[2,[0,null]]]]);
basics$OpacityEnv$$3.pu$1323 = function(pu_dom$1326,pu_r$1329){var fun_E$1338;
var v$2017 = null;
fun_E$1338 = (function(v$2018){return pickle$pickle$.con0$1979(v$2017,v$2018);
});
return pickle$pickle$.dataGen$1479(["OrderFinMap.map",function(v$1735){return (v$1735 == null)?0:1;
},[fun_E$1338,[function(pu$1736){return pickle$pickle$.con1$2005(function(v$1737){var v$1738 = v$1737[0];
return [v$1738[0],v$1738[1],v$1738[2],v$1738[3],v$1737[1]];
},function(v$1739){if (v$1739 == null) {return tools$Crash$.impossible$50("OrderFinMap.pu.fun_N");
} else {var v$1740 = v$1739;
return [[v$1740[0],v$1740[1],v$1740[2],v$1740[3]],v$1740[4]];
};
},pickle$pickle$.pairGen0$974(pickle$pickle$.tup4Gen0$2368(pu_dom$1326,pu_r$1329,pu$1736,pu$1736),basics$OpacityEnv$$3.pu_bal$1322));
},null]]]);
};
return 0;
})();
