if ((typeof(basics$ParseElab$)) == "undefined") {basics$ParseElab$ = {};
};
(function(){basics$ParseElab$.eq_src$335 = function(v$337,v$338){switch (v$337[0]) { case 0: {switch (v$338[0]) { case 0: {return v$337[1] == v$338[1];
 break; }default: {return false;
} };
 break; }case 1: {switch (v$338[0]) { case 1: {return v$337[1] == v$338[1];
 break; }default: {return false;
} };
 break; } };
};
var report_file_sig$69 = tools$Flags$$6.lookup_flag_entry$5029("report_file_sig");
var debug$70 = tools$Flags$$6.is_on0$5026("debug_compiler");
var en$Parse$112 = new String("Parse");
var fix$414 = {};
fix$414.$append_topdecs = function(v$116){if (v$116 == null) {return [1];
} else {var v$173 = v$116;
var v$174 = v$173[0];
var v$175 = v$173[1];
var t$429;
switch (v$174[0]) { case 0: {var v$159 = v$174[1];
var v$160 = v$159[2];
switch (v$160[0]) { case 1: {t$429 = [0,[v$159[0],v$159[1],fix$414.$append_topdecs(v$175)]];
 break; }default: {var v$163 = v$159[0];
var v$164 = v$159[1];
var v$165 = v$160[1];
t$429 = [0,[v$163,v$164,fix$414.$append_topdecs([v$165,v$175])]];
} };
 break; }case 1: {var v$151 = v$174[1];
var v$152 = v$151[2];
switch (v$152[0]) { case 1: {t$429 = [1,[v$151[0],v$151[1],fix$414.$append_topdecs(v$175)]];
 break; }default: {var v$155 = v$151[0];
var v$156 = v$151[1];
var v$157 = v$152[1];
t$429 = [1,[v$155,v$156,fix$414.$append_topdecs([v$157,v$175])]];
} };
 break; }default: {var v$166 = v$174[1];
var v$167 = v$166[2];
switch (v$167[0]) { case 1: {t$429 = [2,[v$166[0],v$166[1],fix$414.$append_topdecs(v$175)]];
 break; }default: {var v$170 = v$166[0];
var v$171 = v$166[1];
var v$172 = v$167[1];
t$429 = [2,[v$170,v$171,fix$414.$append_topdecs([v$172,v$175])]];
} };
} };
return [0,t$429];
};
};
var append_topdecs$113 = fix$414.$append_topdecs;
var fix$415 = {};
fix$415.$parse0 = function(v$204,v$205){var v$190 = basics$Parse$$17.parse$18563(v$204,v$205);
switch (v$190[0]) { case 0: {var v$200 = v$190[1];
var v$201 = v$200[0];
var v$202 = v$200[1];
var v$203 = v$200[2];
var v$197 = fix$415.$parse0(basics$InfixBasis$.compose$112(function(v$410){return syntax_objects$Ident$.eq_id$237(v$410[0],v$410[1]);
},[v$204,v$201]),v$203);
var v$198 = v$197[0];
var v$199 = v$197[1];
return [basics$InfixBasis$.compose$112(function(v$411){return syntax_objects$Ident$.eq_id$237(v$411[0],v$411[1]);
},[v$201,v$198]),[v$202,v$199]];
 break; }case 2: {var v$192 = v$190[1];
throw [en$Parse$112,v$192];
 break; }default: {return [basics$InfixBasis$.emptyB$74(function(v$412){return syntax_objects$Ident$.eq_id$237(v$412[0],v$412[1]);
}),null];
} };
};
var parse0$176 = fix$415.$parse0;
var empty_success$261 = [0,[basics$ModuleEnvironments$.empty$395,basics$InfixBasis$.emptyB$74(function(v$413){return syntax_objects$Ident$.eq_id$237(v$413[0],v$413[1]);
}),tools$Report$.null$50,basics$PostElabGrammar$$3.empty_topdec$3778]];
basics$ParseElab$.parse_elab$266 = function(v$307,v$306,v$305,v$308){try {tools$Flags$$1.chat$77[0]?(basis$TextIO$.output$101(tools$Flags$$1.log$92[0],"[parsing...")):0;
tools$Timing$.timing_begin$102(0);
var parse_res$273;
try {try {var src$358;
switch (v$308[0]) { case 1: {var v$359 = v$308[1];
src$358 = (basics$Parse$$17.sourceFromFile$18536(v$359));
 break; }default: {var v$360 = v$308[1];
src$358 = (basics$Parse$$17.sourceFromString$18537(v$360));
} };
var state$361 = basics$Parse$$17.begin$18550(src$358);
var v$362 = parse0$176(v$305,state$361);
var v$363 = v$362[0];
var v$364 = v$362[1];
parse_res$273 = [v$363,append_topdecs$113(v$364)];
} catch(v$418) {parse_res$273 = ((function(v$365){var t$419 = v$365;
if (t$419[0] == basis$IO$.en$Io$50) {var v$366 = v$365[1][0];
var t$420 = v$366;
if (t$420[0] == basis$OS$.en$SysErr$48) {var v$367 = v$365[1][2];
var v$368 = v$366[1][0];
var v$369 = v$366[1][1];
var t$426;
var t$425;
var t$424 = tools$Report$.line$51;
var t$423;
var t$422;
var t$421;
switch (v$369[0]) { case 1: {t$421 = v$368;
 break; }default: {t$421 = v$369[1];
} };
t$422 = (t$421 + ": ");
t$423 = (t$422 + v$367);
t$425 = (t$424(t$423));
t$426 = [en$Parse$112,t$425];
throw t$426;
} else {var v$372 = v$365[1][2];
throw [en$Parse$112,tools$Report$.line$51("Failed to read file: " + v$372)];
};
} else {throw v$365;
};
})(v$418));
};
} catch(v$417) {parse_res$273 = ((function(E$276){tools$Timing$.timing_end$209("Parse");
throw E$276;
})(v$417));
};
tools$Timing$.timing_end$209("Parse");
tools$Flags$$1.chat$77[0]?(basis$TextIO$.output$101(tools$Flags$$1.log$92[0],"]\n")):0;
tools$Flags$$1.chat$77[0]?(basis$TextIO$.output$101(tools$Flags$$1.log$92[0],"[elaboration...")):0;
tools$Timing$.timing_begin$102(0);
var elab_res$279;
var v$287 = parse_res$273[1];
switch (v$287[0]) { case 0: {var v$296 = parse_res$273[0];
var v$297 = v$287[1];
if (debug$70(0)) {basis$General$.print$156("AST before elaboration:\n");
var st$379 = basics$PreElabTopdecGrammar$$1.layoutTopdec$1466(v$297);
tools$PrettyPrint$.printTree$1078(st$379);
} else {0;
};
try {var v$385 = basics$ElabTopdec$$9.elab_topdec$7509([v$307,v$306,v$297]);
var v$386 = v$385[0];
var v$387 = v$385[1];
var v$388 = basics$ErrorTraverse$.traverse$1029(v$387);
if (v$388 == null) {elab_res$279 = [0,[v$386,v$296,report_file_sig$69[0]?(basics$TopLevelReport$.report$191(false,v$386,v$296)):tools$Report$.null$50,v$387]];
} else {var v$389 = v$388;
elab_res$279 = [1,[v$389[0],v$389[1]]];
};
} catch(v$427) {elab_res$279 = ((function(E$293){tools$Timing$.timing_end$209("Elab");
throw E$293;
})(v$427));
};
 break; }default: {elab_res$279 = empty_success$261;
} };
tools$Timing$.timing_end$209("Elab");
tools$Flags$$1.chat$77[0]?(basis$TextIO$.output$101(tools$Flags$$1.log$92[0],"]\n")):0;
return elab_res$279;
} catch(v$416) {return (function(v$302){var t$428 = v$302;
if (t$428[0] == en$Parse$112) {var report$299 = v$302[1];
tools$Flags$$1.chat$77[0]?(basis$TextIO$.output$101(tools$Flags$$1.log$92[0],"[parsing end...]\n")):0;
return [1,[report$299,["PARSE",null]]];
} else {throw v$302;
};
})(v$416);
};
};
return 0;
})();
