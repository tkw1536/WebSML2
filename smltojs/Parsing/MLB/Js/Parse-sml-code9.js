if ((typeof(basics$Parse$$9)) == "undefined") {basics$Parse$$9 = {};
};
(function(){basics$Parse$$9.impossible$15424 = function(s$15427){return tools$Crash$.impossible$50("LexUtils." + s$15427);
};
basics$Parse$$9.noSome$15428 = function(v$15431,v$15434){switch (v$15431[0]) { case 1: {return tools$Crash$.impossible$50("LexUtils." + v$15434);
 break; }default: {return v$15431[1];
} };
};
basics$Parse$$9.sourceReaderOf$15447 = function(v$15450){return v$15450[1][2];
};
basics$Parse$$9.asQualId$15456 = function(text$15459){var fix$16862 = {};
fix$16862.$glue = function(v$15482,v$16839){lab$glue: while (true) {switch (v$15482) { case ".": {if (v$16839 == null) {return tools$Crash$.impossible$50("LexUtils.asQualId.glue");
} else {var v$15485 = v$16839;
var v$15486 = v$15485[0];
var v$15487 = v$15485[1];
var t$16863 = SmlPrims.implode([v$15486,null]);
var t$16864 = v$15487;
var v$15482 = t$16863;
var v$16839 = t$16864;
continue lab$glue;
};
 break; }default: {if (v$16839 == null) {return [v$15482,null];
} else {var v$15490 = v$16839;
var v$15491 = v$15490[0];
switch (v$15491) { case 46: {var v$15492 = v$15490[1];
return [v$15482,fix$16862.$glue(".",v$15492)];
 break; }default: {var v$15493 = v$15490[1];
var t$16865 = v$15482 + (SmlPrims.implode([v$15491,null]));
var t$16866 = v$15493;
var v$15482 = t$16865;
var v$16839 = t$16866;
continue lab$glue;
} };
};
} };
};
};
var glue$15460 = fix$16862.$glue;
var t$16872 = glue$15460;
var t$16871 = "";
var t$16870;
var fix$16867 = {};
fix$16867.$h = function(v$16185,v$16186){lab$h: while (true) {if (v$16185 < 0) {return v$16186;
} else {var t$16868 = SmlPrims.chk_ovf_i32(v$16185 - 1);
var t$16869 = [text$15459.charCodeAt(v$16185),v$16186];
var v$16185 = t$16868;
var v$16186 = t$16869;
continue lab$h;
};
};
};
var h$16183 = fix$16867.$h;
t$16870 = (h$16183(SmlPrims.chk_ovf_i32(text$15459.length - 1),null));
return t$16872(t$16871,t$16870);
};
basics$Parse$$9.isQualStar$15494 = function(id$15497){var v$15502 = basis$List$.rev$248(basics$Parse$$9.asQualId$15456(id$15497));
if (v$15502 == null) {return false;
} else {var v$15504 = v$15502;
switch (v$15504[0]) { case "*": {return true;
 break; }default: {return false;
} };
};
};
var chars_to_i$15657 = function(v$15660){if (v$15660 == null) {var base$16274 = basis$IntInf$.fromInt$1820(10);
var fix$16873 = {};
fix$16873.$chars_to_i_in_base0 = function(v$16758,v$16759){if (v$16759 == null) {return v$16758;
} else {var v$16760 = v$16759;
var v$16761 = v$16760[0];
var v$16762 = v$16760[1];
var v$16763;
try {v$16763 = (((65 <= v$16761)?(v$16761 <= 90):false)?[0,basis$IntInf$.s$f$1934(basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16761),basis$IntInf$.fromInt$1820(65)),basis$IntInf$.fromInt$1820(10))]:(((97 <= v$16761)?(v$16761 <= 122):false)?[0,basis$IntInf$.s$f$1934(basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16761),basis$IntInf$.fromInt$1820(97)),basis$IntInf$.fromInt$1820(10))]:(((48 <= v$16761)?(v$16761 <= 57):false)?[0,basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16761),basis$IntInf$.fromInt$1820(48))]:[1])));
} catch(v$16874) {v$16763 = ((function(v$16764){return [1];
})(v$16874));
};
switch (v$16763[0]) { case 0: {var v$16765 = v$16763[1];
var new$16766 = basis$IntInf$.s$f$1934(basis$IntInf$.s$t$1891(v$16758,base$16274),v$16765);
return fix$16873.$chars_to_i_in_base0(new$16766,v$16762);
 break; }default: {return v$16758;
} };
};
};
var chars_to_i_in_base0$16757 = fix$16873.$chars_to_i_in_base0;
var v$16848 = basis$IntInf$.fromInt$1820(0);
return chars_to_i_in_base0$16757(v$16848,v$15660);
} else {var v$15671 = v$15660;
switch (v$15671[0]) { case 48: {var v$15673 = v$15671[1];
if (v$15673 == null) {var base$16268 = basis$IntInf$.fromInt$1820(10);
var fix$16875 = {};
fix$16875.$chars_to_i_in_base0 = function(v$16736,v$16737){if (v$16737 == null) {return v$16736;
} else {var v$16738 = v$16737;
var v$16739 = v$16738[0];
var v$16740 = v$16738[1];
var v$16741;
try {v$16741 = (((65 <= v$16739)?(v$16739 <= 90):false)?[0,basis$IntInf$.s$f$1934(basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16739),basis$IntInf$.fromInt$1820(65)),basis$IntInf$.fromInt$1820(10))]:(((97 <= v$16739)?(v$16739 <= 122):false)?[0,basis$IntInf$.s$f$1934(basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16739),basis$IntInf$.fromInt$1820(97)),basis$IntInf$.fromInt$1820(10))]:(((48 <= v$16739)?(v$16739 <= 57):false)?[0,basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16739),basis$IntInf$.fromInt$1820(48))]:[1])));
} catch(v$16876) {v$16741 = ((function(v$16742){return [1];
})(v$16876));
};
switch (v$16741[0]) { case 0: {var v$16743 = v$16741[1];
var new$16744 = basis$IntInf$.s$f$1934(basis$IntInf$.s$t$1891(v$16736,base$16268),v$16743);
return fix$16875.$chars_to_i_in_base0(new$16744,v$16740);
 break; }default: {return v$16736;
} };
};
};
var chars_to_i_in_base0$16735 = fix$16875.$chars_to_i_in_base0;
var v$16844 = basis$IntInf$.fromInt$1820(0);
return chars_to_i_in_base0$16735(v$16844,v$15660);
} else {var v$15675 = v$15673;
switch (v$15675[0]) { case 120: {var v$15677 = v$15675[1];
var base$16262 = basis$IntInf$.fromInt$1820(16);
var fix$16877 = {};
fix$16877.$chars_to_i_in_base0 = function(v$16714,v$16715){if (v$16715 == null) {return v$16714;
} else {var v$16716 = v$16715;
var v$16717 = v$16716[0];
var v$16718 = v$16716[1];
var v$16719;
try {v$16719 = (((65 <= v$16717)?(v$16717 <= 90):false)?[0,basis$IntInf$.s$f$1934(basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16717),basis$IntInf$.fromInt$1820(65)),basis$IntInf$.fromInt$1820(10))]:(((97 <= v$16717)?(v$16717 <= 122):false)?[0,basis$IntInf$.s$f$1934(basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16717),basis$IntInf$.fromInt$1820(97)),basis$IntInf$.fromInt$1820(10))]:(((48 <= v$16717)?(v$16717 <= 57):false)?[0,basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16717),basis$IntInf$.fromInt$1820(48))]:[1])));
} catch(v$16878) {v$16719 = ((function(v$16720){return [1];
})(v$16878));
};
switch (v$16719[0]) { case 0: {var v$16721 = v$16719[1];
var new$16722 = basis$IntInf$.s$f$1934(basis$IntInf$.s$t$1891(v$16714,base$16262),v$16721);
return fix$16877.$chars_to_i_in_base0(new$16722,v$16718);
 break; }default: {return v$16714;
} };
};
};
var chars_to_i_in_base0$16713 = fix$16877.$chars_to_i_in_base0;
var v$16840 = basis$IntInf$.fromInt$1820(0);
return chars_to_i_in_base0$16713(v$16840,v$15677);
 break; }default: {var base$16265 = basis$IntInf$.fromInt$1820(10);
var fix$16879 = {};
fix$16879.$chars_to_i_in_base0 = function(v$16725,v$16726){if (v$16726 == null) {return v$16725;
} else {var v$16727 = v$16726;
var v$16728 = v$16727[0];
var v$16729 = v$16727[1];
var v$16730;
try {v$16730 = (((65 <= v$16728)?(v$16728 <= 90):false)?[0,basis$IntInf$.s$f$1934(basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16728),basis$IntInf$.fromInt$1820(65)),basis$IntInf$.fromInt$1820(10))]:(((97 <= v$16728)?(v$16728 <= 122):false)?[0,basis$IntInf$.s$f$1934(basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16728),basis$IntInf$.fromInt$1820(97)),basis$IntInf$.fromInt$1820(10))]:(((48 <= v$16728)?(v$16728 <= 57):false)?[0,basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16728),basis$IntInf$.fromInt$1820(48))]:[1])));
} catch(v$16880) {v$16730 = ((function(v$16731){return [1];
})(v$16880));
};
switch (v$16730[0]) { case 0: {var v$16732 = v$16730[1];
var new$16733 = basis$IntInf$.s$f$1934(basis$IntInf$.s$t$1891(v$16725,base$16265),v$16732);
return fix$16879.$chars_to_i_in_base0(new$16733,v$16729);
 break; }default: {return v$16725;
} };
};
};
var chars_to_i_in_base0$16724 = fix$16879.$chars_to_i_in_base0;
var v$16842 = basis$IntInf$.fromInt$1820(0);
return chars_to_i_in_base0$16724(v$16842,v$15660);
} };
};
 break; }default: {var base$16271 = basis$IntInf$.fromInt$1820(10);
var fix$16881 = {};
fix$16881.$chars_to_i_in_base0 = function(v$16747,v$16748){if (v$16748 == null) {return v$16747;
} else {var v$16749 = v$16748;
var v$16750 = v$16749[0];
var v$16751 = v$16749[1];
var v$16752;
try {v$16752 = (((65 <= v$16750)?(v$16750 <= 90):false)?[0,basis$IntInf$.s$f$1934(basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16750),basis$IntInf$.fromInt$1820(65)),basis$IntInf$.fromInt$1820(10))]:(((97 <= v$16750)?(v$16750 <= 122):false)?[0,basis$IntInf$.s$f$1934(basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16750),basis$IntInf$.fromInt$1820(97)),basis$IntInf$.fromInt$1820(10))]:(((48 <= v$16750)?(v$16750 <= 57):false)?[0,basis$IntInf$.s$g$1978(basis$IntInf$.fromInt$1820(v$16750),basis$IntInf$.fromInt$1820(48))]:[1])));
} catch(v$16882) {v$16752 = ((function(v$16753){return [1];
})(v$16882));
};
switch (v$16752[0]) { case 0: {var v$16754 = v$16752[1];
var new$16755 = basis$IntInf$.s$f$1934(basis$IntInf$.s$t$1891(v$16747,base$16271),v$16754);
return fix$16881.$chars_to_i_in_base0(new$16755,v$16751);
 break; }default: {return v$16747;
} };
};
};
var chars_to_i_in_base0$16746 = fix$16881.$chars_to_i_in_base0;
var v$16846 = basis$IntInf$.fromInt$1820(0);
return chars_to_i_in_base0$16746(v$16846,v$15660);
} };
};
};
basics$Parse$$9.asInteger$15753 = function(x$16279){try {var t$16887;
var cs$16621;
var fix$16884 = {};
fix$16884.$h = function(v$16625,v$16626){lab$h: while (true) {if (v$16625 < 0) {return v$16626;
} else {var t$16885 = SmlPrims.chk_ovf_i32(v$16625 - 1);
var t$16886 = [x$16279.charCodeAt(v$16625),v$16626];
var v$16625 = t$16885;
var v$16626 = t$16886;
continue lab$h;
};
};
};
var h$16623 = fix$16884.$h;
cs$16621 = (h$16623(SmlPrims.chk_ovf_i32(x$16279.length - 1),null));
if (cs$16621 == null) {t$16887 = (chars_to_i$15657(cs$16621));
} else {var v$16627 = cs$16621;
switch (v$16627[0]) { case 126: {var v$16628 = v$16627[1];
t$16887 = (basis$IntInf$.s$p$1871(chars_to_i$15657(v$16628)));
 break; }default: {t$16887 = (chars_to_i$15657(cs$16621));
} };
};
return [0,t$16887];
} catch(v$16883) {return (function(Overflow$16280){var t$16888 = Overflow$16280;
if (t$16888[0] == CompilerInitial.en$Overflow$43) {return [1];
} else {throw Overflow$16280;
};
})(v$16883);
};
};
basics$Parse$$9.asWord$15754 = function(x$16294){try {var t$16893;
var v$16670;
var fix$16890 = {};
fix$16890.$h = function(v$16674,v$16675){lab$h: while (true) {if (v$16674 < 0) {return v$16675;
} else {var t$16891 = SmlPrims.chk_ovf_i32(v$16674 - 1);
var t$16892 = [x$16294.charCodeAt(v$16674),v$16675];
var v$16674 = t$16891;
var v$16675 = t$16892;
continue lab$h;
};
};
};
var h$16672 = fix$16890.$h;
v$16670 = (h$16672(SmlPrims.chk_ovf_i32(x$16294.length - 1),null));
if (v$16670 == null) {t$16893 = (tools$Crash$.impossible$50("LexUtils.asWord0"));
} else {var v$16676 = v$16670;
switch (v$16676[0]) { case 48: {var v$16677 = v$16676[1];
if (v$16677 == null) {t$16893 = (tools$Crash$.impossible$50("LexUtils.asWord0"));
} else {var v$16678 = v$16677;
switch (v$16678[0]) { case 119: {var v$16679 = v$16678[1];
if (v$16679 == null) {var v$16686 = v$16670;
var v$16687 = v$16686[1];
var v$16688 = v$16687;
var v$16689 = v$16688[1];
var fix$16894 = {};
fix$16894.$chars_to_w_in_base0 = function(v$16793,v$16794){if (v$16794 == null) {return v$16793;
} else {var v$16795 = v$16794;
var v$16796 = v$16795[0];
var v$16797 = v$16795[1];
var v$16798;
try {var i$16799 = ((65 <= v$16796)?(v$16796 <= 90):false)?(((((SmlPrims.i32_to_w32(v$16796)) - (SmlPrims.i32_to_w32(65))) & 4294967295) + 10) & 4294967295):(((97 <= v$16796)?(v$16796 <= 122):false)?(((((SmlPrims.i32_to_w32(v$16796)) - (SmlPrims.i32_to_w32(97))) & 4294967295) + 10) & 4294967295):(((48 <= v$16796)?(v$16796 <= 57):false)?(((SmlPrims.i32_to_w32(v$16796)) - (SmlPrims.i32_to_w32(48))) & 4294967295):10));
v$16798 = ((i$16799 < 10)?[0,i$16799]:[1]);
} catch(v$16895) {v$16798 = ((function(v$16800){return [1];
})(v$16895));
};
switch (v$16798[0]) { case 0: {var v$16801 = v$16798[1];
var new$16802 = (((v$16793 * 10) & 4294967295) + v$16801) & 4294967295;
if (new$16802 < v$16793) {throw CompilerInitial.exn$Overflow$43;
} else {return fix$16894.$chars_to_w_in_base0(new$16802,v$16797);
};
 break; }default: {return v$16793;
} };
};
};
var chars_to_w_in_base0$16792 = fix$16894.$chars_to_w_in_base0;
t$16893 = (chars_to_w_in_base0$16792(0,v$16689));
} else {var v$16680 = v$16679;
switch (v$16680[0]) { case 120: {var v$16681 = v$16680[1];
var fix$16896 = {};
fix$16896.$chars_to_w_in_base0 = function(v$16769,v$16770){if (v$16770 == null) {return v$16769;
} else {var v$16771 = v$16770;
var v$16772 = v$16771[0];
var v$16773 = v$16771[1];
var v$16774;
try {var i$16775 = ((65 <= v$16772)?(v$16772 <= 90):false)?(((((SmlPrims.i32_to_w32(v$16772)) - (SmlPrims.i32_to_w32(65))) & 4294967295) + 10) & 4294967295):(((97 <= v$16772)?(v$16772 <= 122):false)?(((((SmlPrims.i32_to_w32(v$16772)) - (SmlPrims.i32_to_w32(97))) & 4294967295) + 10) & 4294967295):(((48 <= v$16772)?(v$16772 <= 57):false)?(((SmlPrims.i32_to_w32(v$16772)) - (SmlPrims.i32_to_w32(48))) & 4294967295):16));
v$16774 = ((i$16775 < 16)?[0,i$16775]:[1]);
} catch(v$16897) {v$16774 = ((function(v$16776){return [1];
})(v$16897));
};
switch (v$16774[0]) { case 0: {var v$16777 = v$16774[1];
var new$16778 = (((v$16769 * 16) & 4294967295) + v$16777) & 4294967295;
if (new$16778 < v$16769) {throw CompilerInitial.exn$Overflow$43;
} else {return fix$16896.$chars_to_w_in_base0(new$16778,v$16773);
};
 break; }default: {return v$16769;
} };
};
};
var chars_to_w_in_base0$16768 = fix$16896.$chars_to_w_in_base0;
t$16893 = (chars_to_w_in_base0$16768(0,v$16681));
 break; }default: {var v$16682 = v$16670;
var v$16683 = v$16682[1];
var v$16684 = v$16683;
var v$16685 = v$16684[1];
var fix$16898 = {};
fix$16898.$chars_to_w_in_base0 = function(v$16781,v$16782){if (v$16782 == null) {return v$16781;
} else {var v$16783 = v$16782;
var v$16784 = v$16783[0];
var v$16785 = v$16783[1];
var v$16786;
try {var i$16787 = ((65 <= v$16784)?(v$16784 <= 90):false)?(((((SmlPrims.i32_to_w32(v$16784)) - (SmlPrims.i32_to_w32(65))) & 4294967295) + 10) & 4294967295):(((97 <= v$16784)?(v$16784 <= 122):false)?(((((SmlPrims.i32_to_w32(v$16784)) - (SmlPrims.i32_to_w32(97))) & 4294967295) + 10) & 4294967295):(((48 <= v$16784)?(v$16784 <= 57):false)?(((SmlPrims.i32_to_w32(v$16784)) - (SmlPrims.i32_to_w32(48))) & 4294967295):10));
v$16786 = ((i$16787 < 10)?[0,i$16787]:[1]);
} catch(v$16899) {v$16786 = ((function(v$16788){return [1];
})(v$16899));
};
switch (v$16786[0]) { case 0: {var v$16789 = v$16786[1];
var new$16790 = (((v$16781 * 10) & 4294967295) + v$16789) & 4294967295;
if (new$16790 < v$16781) {throw CompilerInitial.exn$Overflow$43;
} else {return fix$16898.$chars_to_w_in_base0(new$16790,v$16785);
};
 break; }default: {return v$16781;
} };
};
};
var chars_to_w_in_base0$16780 = fix$16898.$chars_to_w_in_base0;
t$16893 = (chars_to_w_in_base0$16780(0,v$16685));
} };
};
 break; }default: {t$16893 = (tools$Crash$.impossible$50("LexUtils.asWord0"));
} };
};
 break; }default: {t$16893 = (tools$Crash$.impossible$50("LexUtils.asWord0"));
} };
};
return [0,t$16893];
} catch(v$16889) {return (function(Overflow$16295){var t$16900 = Overflow$16295;
if (t$16900[0] == CompilerInitial.en$Overflow$43) {return [1];
} else {throw Overflow$16295;
};
})(v$16889);
};
};
basics$Parse$$9.chars_to_w_in_base$15755 = function(base$15758,chars$15761){try {var fix$16902 = {};
fix$16902.$chars_to_w_in_base0 = function(v$16805,v$16806){if (v$16806 == null) {return v$16805;
} else {var v$16807 = v$16806;
var v$16808 = v$16807[0];
var v$16809 = v$16807[1];
var v$16810;
try {var i$16811 = ((65 <= v$16808)?(v$16808 <= 90):false)?(((((SmlPrims.i32_to_w32(v$16808)) - (SmlPrims.i32_to_w32(65))) & 4294967295) + 10) & 4294967295):(((97 <= v$16808)?(v$16808 <= 122):false)?(((((SmlPrims.i32_to_w32(v$16808)) - (SmlPrims.i32_to_w32(97))) & 4294967295) + 10) & 4294967295):(((48 <= v$16808)?(v$16808 <= 57):false)?(((SmlPrims.i32_to_w32(v$16808)) - (SmlPrims.i32_to_w32(48))) & 4294967295):base$15758));
v$16810 = ((i$16811 < base$15758)?[0,i$16811]:[1]);
} catch(v$16903) {v$16810 = ((function(v$16812){return [1];
})(v$16903));
};
switch (v$16810[0]) { case 0: {var v$16813 = v$16810[1];
var new$16814 = (((v$16805 * base$15758) & 4294967295) + v$16813) & 4294967295;
if (new$16814 < v$16805) {throw CompilerInitial.exn$Overflow$43;
} else {return fix$16902.$chars_to_w_in_base0(new$16814,v$16809);
};
 break; }default: {return v$16805;
} };
};
};
var chars_to_w_in_base0$16804 = fix$16902.$chars_to_w_in_base0;
return chars_to_w_in_base0$16804(0,chars$15761);
} catch(v$16901) {return (function(Overflow$15764){var t$16904 = Overflow$15764;
if (t$16904[0] == CompilerInitial.en$Overflow$43) {return tools$Crash$.impossible$50("LexUtils.chars_to_w_in_base");
} else {throw Overflow$15764;
};
})(v$16901);
};
};
basics$Parse$$9.asReal$15765 = function(text$15768){switch ((basis$Real$.fromString$488(text$15768))[0]) { case 0: {return [0,text$15768];
 break; }default: {return [1];
} };
};
basics$Parse$$9.initArg$15774 = function(sourceReader$15777){var t$16905;
var v$15779 = [null];
t$16905 = [[0],[null],sourceReader$15777,v$15779];
return [0,t$16905];
};
basics$Parse$$9.clearString$15782 = function(v$15785){return (v$15785[1][3][0] = null,0);
};
basics$Parse$$9.newComment$15791 = function(v$15794){return (v$15794[1][0][0] = 1,0);
};
basics$Parse$$9.addChars$15800 = function(text$15803,v$15806){var v$15813 = v$15806[1];
var v$15814 = v$15813[3];
return (v$15814[0] = [text$15803,v$15814[0]],0);
};
basics$Parse$$9.addControlChar$15815 = function(text$15818,arg$15821){var text$16334 = SmlPrims.implode([basis$General$.chr$187(SmlPrims.chk_ovf_i32((basis$String$.sub$92(text$15818,2)) - 64)),null]);
var v$16339 = arg$15821[1];
var v$16340 = v$16339[3];
return (v$16340[0] = [text$16334,v$16340[0]],0);
};
basics$Parse$$9.asDigit$15822 = function(text$15825){try {return SmlPrims.chk_ovf_i32((basis$String$.sub$92(text$15825,0)) - 48);
} catch(v$16906) {return (function(v$15827){return tools$Crash$.impossible$50("LexUtils.asDigit");
})(v$16906);
};
};
basics$Parse$$9.addAsciiChar$15848 = function(v$15887,v$15888){return function(arg$15855){var n$16695;
var v$15867;
var fix$16907 = {};
fix$16907.$h = function(v$16364,v$16365){lab$h: while (true) {if (v$16364 < 0) {return v$16365;
} else {var t$16908 = SmlPrims.chk_ovf_i32(v$16364 - 1);
var t$16909 = [v$15888.charCodeAt(v$16364),v$16365];
var v$16364 = t$16908;
var v$16365 = t$16909;
continue lab$h;
};
};
};
var h$16362 = fix$16907.$h;
v$15867 = (h$16362(SmlPrims.chk_ovf_i32(v$15888.length - 1),null));
if (v$15867 == null) {n$16695 = (tools$Crash$.impossible$50("LexUtils.addAsciiChar"));
} else {var v$15869 = v$15867;
switch (v$15869[0]) { case 92: {var v$15871 = v$15869[1];
if (v$15871 == null) {n$16695 = (tools$Crash$.impossible$50("LexUtils.addAsciiChar"));
} else {var v$15873 = v$15871;
var v$15874 = v$15873[1];
if (v$15874 == null) {n$16695 = (tools$Crash$.impossible$50("LexUtils.addAsciiChar"));
} else {var v$15876 = v$15874;
var v$15877 = v$15876[1];
if (v$15877 == null) {n$16695 = (tools$Crash$.impossible$50("LexUtils.addAsciiChar"));
} else {var v$15879 = v$15877;
if (v$15879[1] == null) {var v$15883 = v$15873[0];
var v$15884 = v$15876[0];
var v$15885 = v$15879[0];
try {var t$16911;
var chars$16370 = [v$15883,[v$15884,[v$15885,null]]];
try {var fix$16913 = {};
fix$16913.$chars_to_w_in_base0 = function(v$16817,v$16818){if (v$16818 == null) {return v$16817;
} else {var v$16819 = v$16818;
var v$16820 = v$16819[0];
var v$16821 = v$16819[1];
var v$16822;
try {var i$16823 = ((65 <= v$16820)?(v$16820 <= 90):false)?(((((SmlPrims.i32_to_w32(v$16820)) - (SmlPrims.i32_to_w32(65))) & 4294967295) + 10) & 4294967295):(((97 <= v$16820)?(v$16820 <= 122):false)?(((((SmlPrims.i32_to_w32(v$16820)) - (SmlPrims.i32_to_w32(97))) & 4294967295) + 10) & 4294967295):(((48 <= v$16820)?(v$16820 <= 57):false)?(((SmlPrims.i32_to_w32(v$16820)) - (SmlPrims.i32_to_w32(48))) & 4294967295):10));
v$16822 = ((i$16823 < 10)?[0,i$16823]:[1]);
} catch(v$16914) {v$16822 = ((function(v$16824){return [1];
})(v$16914));
};
switch (v$16822[0]) { case 0: {var v$16825 = v$16822[1];
var new$16826 = (((v$16817 * 10) & 4294967295) + v$16825) & 4294967295;
if (new$16826 < v$16817) {throw CompilerInitial.exn$Overflow$43;
} else {return fix$16913.$chars_to_w_in_base0(new$16826,v$16821);
};
 break; }default: {return v$16817;
} };
};
};
var chars_to_w_in_base0$16816 = fix$16913.$chars_to_w_in_base0;
t$16911 = (chars_to_w_in_base0$16816(0,chars$16370));
} catch(v$16912) {t$16911 = ((function(Overflow$16373){var t$16915 = Overflow$16373;
if (t$16915[0] == CompilerInitial.en$Overflow$43) {return tools$Crash$.impossible$50("LexUtils.chars_to_w_in_base");
} else {throw Overflow$16373;
};
})(v$16912));
};
n$16695 = (SmlPrims.chk_ovf_i32(t$16911));
} catch(v$16910) {n$16695 = ((function(v$15882){return tools$Crash$.impossible$50("LexUtils.addAsciiChar.Overflow");
})(v$16910));
};
} else {n$16695 = (tools$Crash$.impossible$50("LexUtils.addAsciiChar"));
};
};
};
};
 break; }default: {n$16695 = (tools$Crash$.impossible$50("LexUtils.addAsciiChar"));
} };
};
if (n$16695 > 255) {throw [basics$LexBasics$.en$LEXICAL_ERROR$623,[v$15887,(("ASCII escape " + v$15888) + " must be <= ") + (basis$Int32$.toString$449(255))]];
} else {var text$16696 = SmlPrims.implode([basis$General$.chr$187(n$16695),null]);
var v$16697 = arg$15855[1];
var v$16698 = v$16697[3];
return (v$16698[0] = [text$16696,v$16698[0]],0);
};
};
};
basics$Parse$$9.addUnicodeChar$15889 = function(v$15940,v$15941){return function(arg$15896){var n$16704;
var v$15912;
var fix$16916 = {};
fix$16916.$h = function(v$16399,v$16400){lab$h: while (true) {if (v$16399 < 0) {return v$16400;
} else {var t$16917 = SmlPrims.chk_ovf_i32(v$16399 - 1);
var t$16918 = [v$15941.charCodeAt(v$16399),v$16400];
var v$16399 = t$16917;
var v$16400 = t$16918;
continue lab$h;
};
};
};
var h$16397 = fix$16916.$h;
v$15912 = (h$16397(SmlPrims.chk_ovf_i32(v$15941.length - 1),null));
if (v$15912 == null) {n$16704 = (tools$Crash$.impossible$50("LexUtils.addUnicodeChar"));
} else {var v$15914 = v$15912;
switch (v$15914[0]) { case 92: {var v$15916 = v$15914[1];
if (v$15916 == null) {n$16704 = (tools$Crash$.impossible$50("LexUtils.addUnicodeChar"));
} else {var v$15918 = v$15916;
switch (v$15918[0]) { case 117: {var v$15920 = v$15918[1];
if (v$15920 == null) {n$16704 = (tools$Crash$.impossible$50("LexUtils.addUnicodeChar"));
} else {var v$15922 = v$15920;
var v$15923 = v$15922[1];
if (v$15923 == null) {n$16704 = (tools$Crash$.impossible$50("LexUtils.addUnicodeChar"));
} else {var v$15925 = v$15923;
var v$15926 = v$15925[1];
if (v$15926 == null) {n$16704 = (tools$Crash$.impossible$50("LexUtils.addUnicodeChar"));
} else {var v$15928 = v$15926;
var v$15929 = v$15928[1];
if (v$15929 == null) {n$16704 = (tools$Crash$.impossible$50("LexUtils.addUnicodeChar"));
} else {var v$15931 = v$15929;
if (v$15931[1] == null) {var v$15935 = v$15922[0];
var v$15936 = v$15925[0];
var v$15937 = v$15928[0];
var v$15938 = v$15931[0];
try {var t$16920;
var chars$16405 = [v$15935,[v$15936,[v$15937,[v$15938,null]]]];
try {var fix$16922 = {};
fix$16922.$chars_to_w_in_base0 = function(v$16829,v$16830){if (v$16830 == null) {return v$16829;
} else {var v$16831 = v$16830;
var v$16832 = v$16831[0];
var v$16833 = v$16831[1];
var v$16834;
try {var i$16835 = ((65 <= v$16832)?(v$16832 <= 90):false)?(((((SmlPrims.i32_to_w32(v$16832)) - (SmlPrims.i32_to_w32(65))) & 4294967295) + 10) & 4294967295):(((97 <= v$16832)?(v$16832 <= 122):false)?(((((SmlPrims.i32_to_w32(v$16832)) - (SmlPrims.i32_to_w32(97))) & 4294967295) + 10) & 4294967295):(((48 <= v$16832)?(v$16832 <= 57):false)?(((SmlPrims.i32_to_w32(v$16832)) - (SmlPrims.i32_to_w32(48))) & 4294967295):16));
v$16834 = ((i$16835 < 16)?[0,i$16835]:[1]);
} catch(v$16923) {v$16834 = ((function(v$16836){return [1];
})(v$16923));
};
switch (v$16834[0]) { case 0: {var v$16837 = v$16834[1];
var new$16838 = (((v$16829 * 16) & 4294967295) + v$16837) & 4294967295;
if (new$16838 < v$16829) {throw CompilerInitial.exn$Overflow$43;
} else {return fix$16922.$chars_to_w_in_base0(new$16838,v$16833);
};
 break; }default: {return v$16829;
} };
};
};
var chars_to_w_in_base0$16828 = fix$16922.$chars_to_w_in_base0;
t$16920 = (chars_to_w_in_base0$16828(0,chars$16405));
} catch(v$16921) {t$16920 = ((function(Overflow$16408){var t$16924 = Overflow$16408;
if (t$16924[0] == CompilerInitial.en$Overflow$43) {return tools$Crash$.impossible$50("LexUtils.chars_to_w_in_base");
} else {throw Overflow$16408;
};
})(v$16921));
};
n$16704 = (SmlPrims.chk_ovf_i32(t$16920));
} catch(v$16919) {n$16704 = ((function(v$15934){return tools$Crash$.impossible$50("LexUtils.addUnicodeChar.Overflow");
})(v$16919));
};
} else {n$16704 = (tools$Crash$.impossible$50("LexUtils.addUnicodeChar"));
};
};
};
};
};
 break; }default: {n$16704 = (tools$Crash$.impossible$50("LexUtils.addUnicodeChar"));
} };
};
 break; }default: {n$16704 = (tools$Crash$.impossible$50("LexUtils.addUnicodeChar"));
} };
};
if (n$16704 > 255) {throw [basics$LexBasics$.en$LEXICAL_ERROR$623,[v$15940,(("ASCII escape " + v$15941) + " must be <= ") + (basis$Int32$.toString$449(255))]];
} else {var text$16705 = SmlPrims.implode([basis$General$.chr$187(n$16704),null]);
var v$16706 = arg$15896[1];
var v$16707 = v$16706[3];
return (v$16707[0] = [text$16705,v$16707[0]],0);
};
};
};
basics$Parse$$9.asString$15942 = function(v$15945){var v$15949 = v$15945[1];
var v$15950 = v$15949[3];
return SmlPrims.concat(basis$List$.rev$641(v$15950[0]));
};
basics$Parse$$9.identifier$15951 = function(v$16061,v$16062,v$16063){switch (v$16061) { case "abstype": {return basics$Parse$$8.ABSTYPE$13317(v$16062,v$16063);
 break; }case "and": {return basics$Parse$$8.AND$13324(v$16062,v$16063);
 break; }case "andalso": {return basics$Parse$$8.ANDALSO$13331(v$16062,v$16063);
 break; }case "as": {return basics$Parse$$8.AS$13338(v$16062,v$16063);
 break; }case "case": {return basics$Parse$$8.CASE$13345(v$16062,v$16063);
 break; }case "do": {return basics$Parse$$8.DO$13352(v$16062,v$16063);
 break; }case "datatype": {return basics$Parse$$8.DATATYPE$13359(v$16062,v$16063);
 break; }case "else": {return basics$Parse$$8.ELSE$13366(v$16062,v$16063);
 break; }case "end": {return basics$Parse$$8.END$13373(v$16062,v$16063);
 break; }case "eqtype": {return basics$Parse$$8.EQTYPE$13225(v$16062,v$16063);
 break; }case "exception": {return basics$Parse$$8.EXCEPTION$13380(v$16062,v$16063);
 break; }case "fn": {return basics$Parse$$8.FN$13387(v$16062,v$16063);
 break; }case "fun": {return basics$Parse$$8.FUN$13394(v$16062,v$16063);
 break; }case "functor": {return basics$Parse$$8.FUNCTOR$13232(v$16062,v$16063);
 break; }case "handle": {return basics$Parse$$8.HANDLE$13401(v$16062,v$16063);
 break; }case "if": {return basics$Parse$$8.IF$13408(v$16062,v$16063);
 break; }case "in": {return basics$Parse$$8.IN$13415(v$16062,v$16063);
 break; }case "include": {return basics$Parse$$8.INCLUDE$13239(v$16062,v$16063);
 break; }case "infix": {return basics$Parse$$8.INFIX$13422(v$16062,v$16063);
 break; }case "infixr": {return basics$Parse$$8.INFIXR$13429(v$16062,v$16063);
 break; }case "let": {return basics$Parse$$8.LET$13436(v$16062,v$16063);
 break; }case "local": {return basics$Parse$$8.LOCAL$13443(v$16062,v$16063);
 break; }case "nonfix": {return basics$Parse$$8.NONFIX$13450(v$16062,v$16063);
 break; }case "of": {return basics$Parse$$8.OF$13457(v$16062,v$16063);
 break; }case "op": {return basics$Parse$$8.OP$13464(v$16062,v$16063);
 break; }case "open": {return basics$Parse$$8.OPEN$13471(v$16062,v$16063);
 break; }case "orelse": {return basics$Parse$$8.ORELSE$13478(v$16062,v$16063);
 break; }case "raise": {return basics$Parse$$8.RAISE$13485(v$16062,v$16063);
 break; }case "rec": {return basics$Parse$$8.REC$13492(v$16062,v$16063);
 break; }case "sharing": {return basics$Parse$$8.SHARING$13246(v$16062,v$16063);
 break; }case "sig": {return basics$Parse$$8.SIG$13253(v$16062,v$16063);
 break; }case "signature": {return basics$Parse$$8.SIGNATURE$13260(v$16062,v$16063);
 break; }case "struct": {return basics$Parse$$8.STRUCT$13267(v$16062,v$16063);
 break; }case "structure": {return basics$Parse$$8.STRUCTURE$13274(v$16062,v$16063);
 break; }case "then": {return basics$Parse$$8.THEN$13499(v$16062,v$16063);
 break; }case "type": {return basics$Parse$$8.TYPE$13506(v$16062,v$16063);
 break; }case "val": {return basics$Parse$$8.VAL$13513(v$16062,v$16063);
 break; }case "where": {return basics$Parse$$8.WHERE$13303(v$16062,v$16063);
 break; }case "with": {return basics$Parse$$8.WITH$13520(v$16062,v$16063);
 break; }case "withtype": {return basics$Parse$$8.WITHTYPE$13527(v$16062,v$16063);
 break; }case "while": {return basics$Parse$$8.WHILE$13534(v$16062,v$16063);
 break; }case ":": {return basics$Parse$$8.COLON$13590(v$16062,v$16063);
 break; }case ":>": {return basics$Parse$$8.COLONGREATER$13310(v$16062,v$16063);
 break; }case "|": {return basics$Parse$$8.BAR$13618(v$16062,v$16063);
 break; }case "=": {return basics$Parse$$8.EQUALS$13646(v$16062,v$16063);
 break; }case "=>": {return basics$Parse$$8.DARROW$13625(v$16062,v$16063);
 break; }case "->": {return basics$Parse$$8.ARROW$13632(v$16062,v$16063);
 break; }case "#": {return basics$Parse$$8.HASH$13639(v$16062,v$16063);
 break; }case "*": {return basics$Parse$$8.STAR$13653(v$16062,v$16063);
 break; }default: {return basics$Parse$$8.ID$13777(v$16061,v$16062,v$16063);
} };
};
basics$Parse$$9.incComment$16064 = function(v$16067){var v$16071 = v$16067[1];
var v$16072 = v$16071[0];
return (v$16072[0] = (SmlPrims.chk_ovf_i32(v$16072[0] + 1)),0);
};
basics$Parse$$9.decComment$16073 = function(v$16076){var v$16082 = v$16076[1];
var v$16083 = v$16082[0];
(v$16083[0] = (SmlPrims.chk_ovf_i32(v$16083[0] - 1)),0);
return v$16083[0];
};
basics$Parse$$9.parStackTop$16084 = function(v$16087){var v$16099 = v$16087[1];
var v$16100 = v$16099[1];
var v$16095 = v$16100[0];
if (v$16095 == null) {throw [basis$Initial$.en$Fail$45,"LexUtils.parStackTop"];
} else {return v$16095[0];
};
};
basics$Parse$$9.parStackPush$16101 = function(r$16104,v$16107){var v$16114 = v$16107[1];
var v$16115 = v$16114[1];
return (v$16115[0] = [r$16104,v$16115[0]],0);
};
basics$Parse$$9.parStackPop$16116 = function(v$16119){var v$16133 = v$16119[1];
var v$16134 = v$16133[1];
var v$16128 = v$16134[0];
if (v$16128 == null) {throw [basis$Initial$.en$Fail$45,"LexUtils.parStackPop"];
} else {return (v$16134[0] = v$16128[1],0);
};
};
basics$Parse$$9.parStackIsEmpty$16135 = function(v$16138){var v$16146 = v$16138[1];
var v$16147 = v$16146[1];
return (v$16147[0] == null)?true:false;
};
return 0;
})();
