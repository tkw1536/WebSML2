if ((typeof(basis$String$)) == "undefined") {basis$String$ = {};
};
(function(){basis$String$.sub_unsafe$45 = function(v$620,v$621){return v$620.charCodeAt(v$621);
};
basis$String$.size$52 = function(s$55){return s$55.length;
};
basis$String$.s$r$56 = function(v$622,v$623){return v$622 + v$623;
};
basis$String$.sub_array_unsafe$63 = function(v$624,v$625){return v$624[v$625];
};
basis$String$.update_array_unsafe$70 = function(v$626,v$627,v$628){return (v$626[v$627] = v$628,0);
};
basis$String$.alloc_array_unsafe$79 = function(i$82){return Array(i$82);
};
basis$String$.length_array$83 = function(a$86){return a$86.length;
};
basis$String$.array_to_string$87 = function(a$90){return SmlPrims.charArrayToString(a$90);
};
basis$String$.maxSize$91 = 16777211;
basis$String$.sub$92 = function(v$105,v$106){if ((v$106 < 0)?true:(v$106 >= v$105.length)) {throw basis$General$.exn$Subscript$51;
} else {return v$105.charCodeAt(v$106);
};
};
basis$String$.extract$107 = function(v$157,v$158,v$159){var n$113;
switch (v$159[0]) { case 1: {n$113 = (SmlPrims.chk_ovf_i32(v$157.length - v$158));
 break; }default: {n$113 = v$159[1];
} };
var newvec$120;
if ((v$158 < 0)?true:((n$113 < 0)?true:((n$113 > 16777211)?true:((v$158 > v$157.length)?true:((SmlPrims.chk_ovf_i32(v$158 + n$113)) > v$157.length))))) {throw basis$General$.exn$Subscript$51;
} else {newvec$120 = (Array(n$113));
};
var fix$641 = {};
fix$641.$blit = function(v$153,v$154){lab$blit: while (true) {if (v$154 >= n$113) {return 0;
} else {var e$150 = v$157.charCodeAt(v$153);
(newvec$120[v$154] = e$150,0);
var t$642 = SmlPrims.chk_ovf_i32(v$153 + 1);
var t$643 = SmlPrims.chk_ovf_i32(v$154 + 1);
var v$153 = t$642;
var v$154 = t$643;
continue lab$blit;
};
};
};
var blit$141 = fix$641.$blit;
blit$141(v$158,0);
return SmlPrims.charArrayToString(newvec$120);
};
basis$String$.substring$160 = function(v$166,v$167,v$168){return basis$String$.extract$107(v$166,v$167,[0,v$168]);
};
basis$String$.concat$169 = function(x$172){return SmlPrims.concat(x$172);
};
basis$String$.concatWith$173 = function(v$176,v$179){if (v$179 == null) {return "";
} else {var t$647;
var t$646 = basis$List$.tl$636;
var t$644;
var b$499 = null;
var fix$645 = {};
fix$645.$foldr = function(v$502){if (v$502 == null) {return b$499;
} else {var v$503 = v$502;
var v$504 = v$503[0];
var v$505 = v$503[1];
return [v$176,[v$504,fix$645.$foldr(v$505)]];
};
};
var foldr$501 = fix$645.$foldr;
t$644 = (foldr$501(v$179));
t$647 = (t$646(t$644));
return SmlPrims.concat(t$647);
};
};
basis$String$.implode$196 = function(l$199){return SmlPrims.implode(l$199);
};
basis$String$.explode$200 = function(s$203){var fix$648 = {};
fix$648.$h = function(v$510,v$511){lab$h: while (true) {if (v$510 < 0) {return v$511;
} else {var t$649 = SmlPrims.chk_ovf_i32(v$510 - 1);
var t$650 = [s$203.charCodeAt(v$510),v$511];
var v$510 = t$649;
var v$511 = t$650;
continue lab$h;
};
};
};
var h$508 = fix$648.$h;
return h$508(SmlPrims.chk_ovf_i32(s$203.length - 1),null);
};
basis$String$.str$204 = function(c$207){return SmlPrims.implode([c$207,null]);
};
basis$String$.translate$208 = function(f$211,s$214){return basis$StrBase$.translate$279(f$211,[s$214,0,s$214.length]);
};
basis$String$.tokens$215 = function(p$218,s$221){var l$515 = basis$StrBase$.tokens$303(p$218,[s$221,0,s$221.length]);
var fix$651 = {};
fix$651.$map = function(v$517){if (v$517 == null) {return null;
} else {var v$518 = v$517;
var v$519 = v$518[0];
var v$520 = v$518[1];
var t$653;
var t$652;
var v$611 = v$519[0];
var v$612 = v$519[1];
var v$613 = v$519[2];
t$652 = (basis$String$.extract$107(v$611,v$612,[0,v$613]));
t$653 = [t$652,fix$651.$map(v$520)];
return t$653;
};
};
var map$516 = fix$651.$map;
return map$516(l$515);
};
basis$String$.fields$222 = function(p$225,s$228){var l$527 = basis$StrBase$.fields$336(p$225,[s$228,0,s$228.length]);
var fix$654 = {};
fix$654.$map = function(v$529){if (v$529 == null) {return null;
} else {var v$530 = v$529;
var v$531 = v$530[0];
var v$532 = v$530[1];
var t$656;
var t$655;
var v$615 = v$531[0];
var v$616 = v$531[1];
var v$617 = v$531[2];
t$655 = (basis$String$.extract$107(v$615,v$616,[0,v$617]));
t$656 = [t$655,fix$654.$map(v$532)];
return t$656;
};
};
var map$528 = fix$654.$map;
return map$528(l$527);
};
basis$String$.map$229 = function(x$232){return function(v$638){return basis$ByteTable$$5.map$411(x$232,v$638);
};
};
basis$String$.isSuffix$233 = function(s1$236,s2$239){var n1$240 = s1$236.length;
var n2$241 = s2$239.length;
var offset$242 = SmlPrims.chk_ovf_i32(n2$241 - n1$240);
var fix$657 = {};
fix$657.$h = function(j$246){lab$h: while (true) {if (j$246 == n1$240) {return true;
} else {if ((s1$236.charCodeAt(j$246)) == (s2$239.charCodeAt(SmlPrims.chk_ovf_i32(j$246 + offset$242)))) {var t$658 = SmlPrims.chk_ovf_i32(j$246 + 1);
var j$246 = t$658;
continue lab$h;
} else {return false;
};
};
};
};
var h$243 = fix$657.$h;
if (n1$240 <= n2$241) {return h$243(0);
} else {return false;
};
};
basis$String$.isSubstring$259 = function(v$262,v$265){switch (v$262) { case "": {return true;
 break; }default: {var n1$275 = v$262.length;
var n2$276 = v$265.length;
var stop1$277 = SmlPrims.chk_ovf_i32(n1$275 - 1);
var stop2$278 = SmlPrims.chk_ovf_i32(n2$276 - n1$275);
var fix$659 = {};
fix$659.$issub = function(offset$298){if (offset$298 <= stop2$278) {var t$662;
if ((v$262.charCodeAt(stop1$277)) == (v$265.charCodeAt(SmlPrims.chk_ovf_i32(stop1$277 + offset$298)))) {var fix$660 = {};
fix$660.$h = function(j$550){lab$h: while (true) {if (j$550 >= stop1$277) {return true;
} else {if ((v$262.charCodeAt(j$550)) == (v$265.charCodeAt(SmlPrims.chk_ovf_i32(j$550 + offset$298)))) {var t$661 = SmlPrims.chk_ovf_i32(j$550 + 1);
var j$550 = t$661;
continue lab$h;
} else {return false;
};
};
};
};
var h$549 = fix$660.$h;
t$662 = (h$549(0));
} else {t$662 = false;
};
if (t$662) {return true;
} else {return fix$659.$issub(SmlPrims.chk_ovf_i32(offset$298 + 1));
};
} else {return false;
};
};
var issub$295 = fix$659.$issub;
return issub$295(0);
} };
};
basis$String$.isPrefix$312 = function(s1$315,s2$318){var n1$319 = s1$315.length;
var n2$320 = s2$318.length;
var stop$321 = (n1$319 < n2$320)?n1$319:n2$320;
var fix$663 = {};
fix$663.$h = function(j$329){lab$h: while (true) {if (j$329 == stop$321) {return true;
} else {if ((s1$315.charCodeAt(j$329)) == (s2$318.charCodeAt(j$329))) {var t$664 = SmlPrims.chk_ovf_i32(j$329 + 1);
var j$329 = t$664;
continue lab$h;
} else {return false;
};
};
};
};
var h$326 = fix$663.$h;
if (n1$319 <= n2$320) {return h$326(0);
} else {return false;
};
};
basis$String$.compare$342 = function(v$355,v$356){return (v$355 < v$356)?0:((v$355 > v$356)?1:2);
};
basis$String$.collate$357 = function(cmp$360,v$364){var v$394 = v$364[0];
var v$395 = v$364[1];
var n1$365 = v$394.length;
var n2$366 = v$395.length;
var stop$367 = (n1$365 < n2$366)?n1$365:n2$366;
var fix$665 = {};
fix$665.$h = function(j$375){lab$h: while (true) {if (j$375 == stop$367) {return (n1$365 < n2$366)?0:((n1$365 > n2$366)?1:2);
} else {switch (cmp$360([v$394.charCodeAt(j$375),v$395.charCodeAt(j$375)])) { case 0: {return 0;
 break; }case 1: {return 1;
 break; }default: {var t$666 = SmlPrims.chk_ovf_i32(j$375 + 1);
var j$375 = t$666;
continue lab$h;
} };
};
};
};
var h$372 = fix$665.$h;
return h$372(0);
};
basis$String$.fromString$396 = function(s$399){var fix$667 = {};
fix$667.$h = function(src$411,res$414){var v$423 = (src$411 < s$399.length)?[0,[s$399.charCodeAt(src$411),SmlPrims.chk_ovf_i32(src$411 + 1)]]:[1];
switch (v$423[0]) { case 1: {return [0,SmlPrims.implode(basis$List$.rev$641(res$414))];
 break; }default: {var v$424 = v$423[1];
var v$425 = v$424[0];
switch (v$425) { case 92: {var v$435 = v$424[1];
var v$431 = basis$StrBase$.fromMLescape$458(function(i$566){return (i$566 < s$399.length)?[0,[s$399.charCodeAt(i$566),SmlPrims.chk_ovf_i32(i$566 + 1)]]:[1];
},v$435);
switch (v$431[0]) { case 1: {return [1];
 break; }default: {var v$432 = v$431[1];
var v$433 = v$432[0];
var v$434 = v$432[1];
return fix$667.$h(v$434,[v$433,res$414]);
} };
 break; }default: {var v$436 = v$424[1];
return fix$667.$h(v$436,[v$425,res$414]);
} };
} };
};
var h$408 = fix$667.$h;
return h$408(0,null);
};
basis$String$.toString$437 = function(s$440){return basis$StrBase$.translate$279(function(v$639){return basis$StrBase$.toMLescape$617(v$639);
},[s$440,0,s$440.length]);
};
basis$String$.fromCString$441 = function(s$444){return basis$StrBase$.fromCString$839(s$444);
};
basis$String$.toCString$445 = function(s$448){return basis$StrBase$.translate$279(function(v$640){return basis$StrBase$.toCescape$653(v$640);
},[s$448,0,s$448.length]);
};
basis$String$.s$j$449 = function(v$629,v$630){return v$629 < v$630;
};
basis$String$.s$jk$451 = function(v$631,v$632){return v$631 <= v$632;
};
basis$String$.s$l$453 = function(v$633,v$634){return v$633 > v$634;
};
basis$String$.s$lk$455 = function(v$635,v$636){return v$635 >= v$636;
};
basis$String$.substring$457 = function(v$571,v$572,v$573){return basis$String$.extract$107(v$571,v$572,[0,v$573]);
};
return 0;
})();
